<div class="page-header i-header-fit">
    <div class="row">
        <div class="col-sm-12 col-md-12">
            <h3 style="margin-top: 0">Port Assignment</h3>
        </div>
    </div>
</div>

<div class="panel panel-success">
        <div class="panel-heading">
            <h3 class="panel-title">
                <span>Search Panel</span>
                <a data-toggle="collapse" class="pull-right" href="#SearchPanel" onclick="onPanelToggle(this);" id="SearchPanelHeader"><i class="fa fa-chevron-circle-down fa-lg" id="SearchPanelHeaderArrow"></i></a>
            </h3>
        </div>
        <div id="SearchPanel" class="panel-collapse collapse in">
            <div class="panel-body" style="min-height: 370px;">

                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label>ชื่อโครงการ</label>
                            <div class="i-fg-data-entry">
                                @(Html.Kendo().DropDownList()
                                          .Name("NodeName")
                                          .HtmlAttributes(new { @class = "form-control i-form-control-extend" })
                                          .DataTextField("Text")
                                          .DataValueField("Value")
                                          .DataSource(source =>
                                          {
                                              source.Read(read =>
                                              {
                                                  read.Action("GetNodeNameTH", "Report");
                                              });
                                          })
                                          .Events(e => e.Change("onChange"))
                                    )
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-group">
                            <label>Node ID</label>
                            <div class="i-fg-data-entry">
                                @(Html.Kendo().DropDownList()
                                          .Name("NodeID")
                                          .HtmlAttributes(new { @class = "form-control i-form-control-extend" })
                                          .DataTextField("Text")
                                          .DataValueField("Value")
                                          .DataSource(source =>
                                          {
                                              source.Read(read =>
                                              {
                                                  read.Action("GetNodeID", "Report");
                                              });
                                          })
                                    )
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <label></label>
                        <div class="i-fg-data-entry">                            
                                <a onclick="onSearch()" class="btn btn-info i-width-sm"><i class="fa fa-search fa-lg"></i>&nbsp;&nbsp;ค้นหา</a>
                        </div>
                    </div>
                </div>

                <div class="i-enter-4"></div>

                <div class="row i-hidden" id="loading">
                    <div class="col-md-12 i-text-align-center">
                        <i class="fa fa-spinner fa-spin i-fa-2"></i>
                        <div class="i-enter-2"></div>
                        <span class="i-red">Report กำลังคำนวณ ระบบจะแจ้งเตือนทาง Email หลังจากทำงานเสร็จ<br />
                        คุณสามารถปิด Page นี้ได้ทันที</span>
                    </div>
                </div>

            </div>
        </div>
    </div>   

<script>
    function onChange() {
        $("#NodeID").data("kendoDropDownList").dataSource.read({ nodeNameTH: $("#NodeName").val() });
    }

    function onSearch() {
        $("#loading").fadeIn("slow");
        setTimeout("timing()", 5000);

        $.ajax({
            url: '/Report/SearchRptAssignment',
            data: {
                nodeNameTH: $("#NodeName").val(), nodeId: $("#NodeID").val()
            },
            dataType: "json",
            type: 'POST',
            success: function (data) {
                
            }
        });
    }

    function timing() {
        window.location.href = "@Url.Action("Assignment", "Report")";
    }
</script>