@model WBBEntity.PanelModels.LeavemessagePanelModel
@using System.Collections.Generic;
@using WBBEntity.PanelModels
@using WBBWeb.Controllers;
@{
    Layout = "~/Views/Shared/_NewLayoutReferencesLeaveMessageI.cshtml";

    string UrlRef = "";
    string SaveStatus = "";
    string RefNo = "";

    if (ViewBag.UrlRef != null)
    {
        UrlRef = ViewBag.UrlRef;
    }

    if (null != ViewBag.SaveStatus)
    {
        SaveStatus = ViewBag.SaveStatus;
        ViewBag.SaveStatus = null;
    }
    else
    {
        SaveStatus = "";
    }

    if (null != ViewBag.RefNo)
    {
        RefNo = ViewBag.RefNo;
        ViewBag.RefNo = null;
    }
    else
    {
        RefNo = "";
    }

    string L_LEAVE_MESSAGE_A = "";
    string L_SELECT_SERVICE_A = "";
    string L_NAME_A = "";
    string L_SURNAME_A = "";
    string L_CONTACT_MOBILE_A = "";
    string L_EMAIL_A = "";
    string L_INSTALL_ADDRESS_A = "";
    string L_PROVINCE_A = "";
    string L_DISTRICT_A = "";
    string L_SUB_DISTRICT_A = "";
    string L_POSTAL_CODE_A = "";
    string L_SELECT_ADDRESS_TYPE_A = "";
    string L_BUILDING_A = "";
    string L_VILLAGE_A = "";
    string L_BUILDING_NAME_A = "";
    string L_VILLAGE_NAME_A = "";
    string L_HOUSE_NO_A = "";
    string L_SOI_A = "";
    string L_ROAD_A = "";
    string L_CONTACT_TIME_A = "";
    string L_ENTER_WORD_A = "";
    string B_CLEAR_A = "";
    string B_REGISTER_A = "";
    string L_PLEASE_SELECT_A = "";
    string L_POPUP_SUCCESS_A = "";
    string L_POPUP_ERROR_A = "";
    string B_CLOSE_A = "";
    string H_TYPE_BUILDING_A = "";
    string L_TYPE_MY_HOME_A = "";
    string L_TYPE_RENTAL_A = "";
    string L_MESSAGE_ERROR_RENTAL_A = "";
    string L_SERVICE_LEAVEMESSAGE_A = "";
    string L_MESSAGE_ERROR_EMAIL_A = "";

    if (ViewBag.LabelFBBOR037 != null)
    {
        var LabelFBBOR037 = (List<LovScreenValueModel>)ViewBag.LabelFBBOR037;

        L_LEAVE_MESSAGE_A = LabelFBBOR037.Any(c => c.Name == "L_LEAVE_MESSAGE_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_LEAVE_MESSAGE_A").DisplayValue : "";
        L_SELECT_SERVICE_A = LabelFBBOR037.Any(c => c.Name == "L_SELECT_SERVICE_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_SELECT_SERVICE_A").DisplayValue : "";
        L_NAME_A = LabelFBBOR037.Any(c => c.Name == "L_NAME_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_NAME_A").DisplayValue : "";
        L_SURNAME_A = LabelFBBOR037.Any(c => c.Name == "L_SURNAME_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_SURNAME_A").DisplayValue : "";
        L_CONTACT_MOBILE_A = LabelFBBOR037.Any(c => c.Name == "L_CONTACT_MOBILE_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_CONTACT_MOBILE_A").DisplayValue : "";
        L_EMAIL_A = LabelFBBOR037.Any(c => c.Name == "L_EMAIL_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_EMAIL_A").DisplayValue : "";

        L_INSTALL_ADDRESS_A = LabelFBBOR037.Any(c => c.Name == "L_INSTALL_ADDRESS_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_INSTALL_ADDRESS_A").DisplayValue : "";

        L_PROVINCE_A = LabelFBBOR037.Any(c => c.Name == "L_PROVINCE_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_PROVINCE_A").DisplayValue : "";
        L_DISTRICT_A = LabelFBBOR037.Any(c => c.Name == "L_DISTRICT_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_DISTRICT_A").DisplayValue : "";
        L_SUB_DISTRICT_A = LabelFBBOR037.Any(c => c.Name == "L_SUB_DISTRICT_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_SUB_DISTRICT_A").DisplayValue : "";
        L_POSTAL_CODE_A = LabelFBBOR037.Any(c => c.Name == "L_POSTAL_CODE_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_POSTAL_CODE_A").DisplayValue : "";
        L_SELECT_ADDRESS_TYPE_A = LabelFBBOR037.Any(c => c.Name == "L_SELECT_ADDRESS_TYPE_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_SELECT_ADDRESS_TYPE_A").DisplayValue : "";
        L_BUILDING_A = LabelFBBOR037.Any(c => c.Name == "L_BUILDING_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_BUILDING_A").DisplayValue : "";
        L_VILLAGE_A = LabelFBBOR037.Any(c => c.Name == "L_VILLAGE_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_VILLAGE_A").DisplayValue : "";
        L_BUILDING_NAME_A = LabelFBBOR037.Any(c => c.Name == "L_BUILDING_NAME_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_BUILDING_NAME_A").DisplayValue : "";
        L_VILLAGE_NAME_A = LabelFBBOR037.Any(c => c.Name == "L_VILLAGE_NAME_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_VILLAGE_NAME_A").DisplayValue : "";
        L_HOUSE_NO_A = LabelFBBOR037.Any(c => c.Name == "L_HOUSE_NO_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_HOUSE_NO_A").DisplayValue : "";
        L_SOI_A = LabelFBBOR037.Any(c => c.Name == "L_SOI_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_SOI_A").DisplayValue : "";
        L_ROAD_A = LabelFBBOR037.Any(c => c.Name == "L_ROAD_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_ROAD_A").DisplayValue : "";
        L_CONTACT_TIME_A = LabelFBBOR037.Any(c => c.Name == "L_CONTACT_TIME_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_CONTACT_TIME_A").DisplayValue : "";
        L_ENTER_WORD_A = LabelFBBOR037.Any(c => c.Name == "L_ENTER_WORD_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_ENTER_WORD_A").DisplayValue : "";
        B_CLEAR_A = LabelFBBOR037.Any(c => c.Name == "B_CLEAR_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "B_CLEAR_A").DisplayValue : "";
        B_REGISTER_A = LabelFBBOR037.Any(c => c.Name == "B_REGISTER_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "B_REGISTER_A").DisplayValue : "";
        L_PLEASE_SELECT_A = LabelFBBOR037.Any(c => c.Name == "L_PLEASE_SELECT_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_PLEASE_SELECT_A").DisplayValue : "";
        L_POPUP_SUCCESS_A = LabelFBBOR037.Any(c => c.Name == "L_POPUP_SUCCESS_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_POPUP_SUCCESS_A").DisplayValue : "";
        L_POPUP_ERROR_A = LabelFBBOR037.Any(c => c.Name == "L_POPUP_ERROR_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_POPUP_ERROR_A").DisplayValue : "";
        B_CLOSE_A = LabelFBBOR037.Any(c => c.Name == "B_CLOSE_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "B_CLOSE_A").DisplayValue : "";

        H_TYPE_BUILDING_A = LabelFBBOR037.Any(c => c.Name == "H_TYPE_BUILDING_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "H_TYPE_BUILDING_A").DisplayValue : "";
        L_TYPE_MY_HOME_A = LabelFBBOR037.Any(c => c.Name == "L_TYPE_MY_HOME_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_TYPE_MY_HOME_A").DisplayValue : "";
        L_TYPE_RENTAL_A = LabelFBBOR037.Any(c => c.Name == "L_TYPE_RENTAL_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_TYPE_RENTAL_A").DisplayValue : "";
        L_MESSAGE_ERROR_RENTAL_A = LabelFBBOR037.Any(c => c.Name == "L_MESSAGE_ERROR_RENTAL_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_MESSAGE_ERROR_RENTAL_A").DisplayValue : "";
        L_SERVICE_LEAVEMESSAGE_A = LabelFBBOR037.Any(c => c.Name == "L_SERVICE_LEAVEMESSAGE_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_SERVICE_LEAVEMESSAGE_A").DisplayValue : "";
        L_MESSAGE_ERROR_EMAIL_A = LabelFBBOR037.Any(c => c.Name == "L_MESSAGE_ERROR_EMAIL_A") ? LabelFBBOR037.FirstOrDefault(c => c.Name == "L_MESSAGE_ERROR_EMAIL_A").DisplayValue : "";
    }

    string FBB_Con_CharNotonName = "";
    string FBB_Input_MobileNo = "";
    string FBB_Con_Input_Mooban = "";
    string FBB_Con_Input_Building = "";
    string FBB_Con_Input_Home_Number = "";
    string FBB_Con_Input_Soi = "";
    string FBB_Con_Input_Road = "";

    if (ViewBag.FbbConstant != null)
    {
        var FbbConstant = (List<FbbConstantModel>)ViewBag.FbbConstant;

        FBB_Con_CharNotonName = FbbConstant.Any(f => f.Field == "Char Not on Name") ? FbbConstant.First(f => f.Field == "Char Not on Name").Validation : "";
        FBB_Input_MobileNo = FbbConstant.Any(f => f.Field == "Input_MobileNo") ? FbbConstant.First(f => f.Field == "Input_MobileNo").Validation : "";
        FBB_Con_Input_Mooban = FbbConstant.Any(f => f.Field == "Input_Mooban") ? FbbConstant.First(f => f.Field == "Input_Mooban").Validation : "";
        FBB_Con_Input_Building = FbbConstant.Any(f => f.Field == "Input_Building") ? FbbConstant.First(f => f.Field == "Input_Building").Validation : "";
        FBB_Con_Input_Home_Number = FbbConstant.Any(f => f.Field == "Input_Home_Number") ? FbbConstant.First(f => f.Field == "Input_Home_Number").Validation : "";
        FBB_Con_Input_Soi = FbbConstant.Any(f => f.Field == "Input_Soi") ? FbbConstant.First(f => f.Field == "Input_Soi").Validation : "";
        FBB_Con_Input_Road = FbbConstant.Any(f => f.Field == "Input_Road") ? FbbConstant.First(f => f.Field == "Input_Road").Validation : "";
    }

    
    string L_FOR_OFFICER_A = "";
    string L_LOCATION_CODE_A = "";
    string L_ASC_CODE_A = "";
    string L_EMPLOYEE_CODE_A = "";
    string L_SALES_REP_A = "";
    

    string L_POPUP_INVALID_LOC_ASC = "";
    string L_POPUP_INVALID_EMP_CODE = "";

    if (ViewBag.LabelFBBOR028 != null)
    {
        var LabelFBBOR028 = (List<LovScreenValueModel>)ViewBag.LabelFBBOR028;

        L_FOR_OFFICER_A = LabelFBBOR028.Any(c => c.Name == "L_FOR_OFFICER") ? LabelFBBOR028.FirstOrDefault(c => c.Name == "L_FOR_OFFICER").DisplayValue : "";
        L_LOCATION_CODE_A = LabelFBBOR028.Any(c => c.Name == "L_LOCATION_CODE") ? LabelFBBOR028.FirstOrDefault(c => c.Name == "L_LOCATION_CODE").DisplayValue : "";
        L_ASC_CODE_A = LabelFBBOR028.Any(c => c.Name == "L_ASC_CODE") ? LabelFBBOR028.FirstOrDefault(c => c.Name == "L_ASC_CODE").DisplayValue : "";
        L_EMPLOYEE_CODE_A = LabelFBBOR028.Any(c => c.Name == "L_EMPLOYEE_CODE") ? LabelFBBOR028.FirstOrDefault(c => c.Name == "L_EMPLOYEE_CODE").DisplayValue : "";
        L_SALES_REP_A = LabelFBBOR028.Any(c => c.Name == "L_SALES_REP") ? LabelFBBOR028.FirstOrDefault(c => c.Name == "L_SALES_REP").DisplayValue : "";     
        
        L_POPUP_INVALID_LOC_ASC = LabelFBBOR028.Any(c => c.Name == "L_POPUP_INVALID_LOC_ASC") ? LabelFBBOR028.FirstOrDefault(c => c.Name == "L_POPUP_INVALID_LOC_ASC").DisplayValue : "";
        L_POPUP_INVALID_EMP_CODE = LabelFBBOR028.Any(c => c.Name == "L_POPUP_INVALID_EMP_CODE") ? LabelFBBOR028.FirstOrDefault(c => c.Name == "L_POPUP_INVALID_EMP_CODE").DisplayValue : ""; 
    }

    string language = "";

    if (Session[WBBWeb.Extension.WebConstants.SessionKeys.CurrentUICulture].ToString() == "1")
    {
        language = "th";
    }
    else
    {
        language = "en";
    }
    }


@using (Html.BeginForm("SaveRegister", "LeavemessageA", FormMethod.Post, new { id = "RegisterForm", enctype = "multipart/form-data", autocomplete = "off" }))
{
    <h4 class="page-header tgreen">@L_LEAVE_MESSAGE_A</h4>
    <div>
        <div class="col-xs-12 col-sm-12">
            @Html.Label("L_SELECT_SERVICE_A", L_SELECT_SERVICE_A)
            <div class="clear-fix"></div>
            <h4 class="page-header tgreen"><b>@L_SERVICE_LEAVEMESSAGE_A</b></h4>
            @Html.Hidden("SELECT_SERVICE", L_SERVICE_LEAVEMESSAGE_A)
        </div>
        <p class="clearfix"></p>

        <div class="col-xs-10 col-sm-5">
            @Html.Label("L_NAME", L_NAME_A)
            @Html.TextBoxFor(m => m.NAME, "",
                        new
                        {
                            @class = "form-control",
                            @title = L_NAME_A,
                            @maxlength = 50
                        })
        </div>
        <div class="col-xs-2 col-sm-2">
        </div>
        <div class="col-xs-10 col-sm-5">
            @Html.Label("L_SURNAME", L_SURNAME_A)
            @Html.TextBoxFor(m => m.SURNAME, "",
                        new
                        {
                            @class = "form-control",
                            @title = L_SURNAME_A,
                            @maxlength = 50
                        })
        </div>
        <p class="clearfA"></p>

        <div class="col-xs-10 col-sm-5">
            @Html.Label("L_CONTACT_MOBILE", L_CONTACT_MOBILE_A)
            @Html.TextBoxFor(m => m.CONTACT_MOBILE, "",
                        new
                        {
                            @class = "form-control",
                            @title = L_CONTACT_MOBILE_A,
                            @maxlength = 10
                        })
            @Html.HiddenFor(m => m.MOBILE_IS_AIS)
        </div>
        <div class="col-xs-2 col-sm-2">
            <p class="clearfix"></p>
            <p class="clearfix"></p>
            <p class="clearfix"></p>
            <div id="IsAIS" style="display: none;">
                <img src="Images/is_ais.png" alt="" style="max-width: none !important; width: 30px; height: 30px; color: white;">
            </div>
        </div>
        <div class="col-xs-10 col-sm-5">
            @Html.Label("L_EMAIL", L_EMAIL_A)
            @Html.TextBoxFor(m => m.EMAIL, "",
                        new
                        {
                            @class = "form-control",
                            @title = L_EMAIL_A,
                            @maxlength = 50
                        })
        </div>
        <p class="clearfix"></p>

        <p class="clearfix"></p>

        <div class="col-xs-10 col-sm-5">
            <div class="short-div">@Html.Label("L_INSTALL_ADDRESS", L_INSTALL_ADDRESS_A)</div>
            <p class="clearfix"></p>
            <div class="short-div">@Html.Label("L_SELECT_ADDRESS_TYPE", L_SELECT_ADDRESS_TYPE_A)</div>
            <div class="short-div">
                @*<label for="R_BUILD">
                    @L_BUILDING_A
                    <input type="radio" name="R_BUILD" id="R_BUILD" value="B" onclick="onBuildChange()">
                </label>
                &nbsp;&nbsp;*@
                <label for="R_MOOBAN">
                    @L_VILLAGE_A
                    <input type="radio" name="R_BUILD" id="R_MOOBAN" value="V" onclick="onBuildChange()">
                </label>
                @Html.HiddenFor(m => m.SELECT_ADDRESS_TYPE)
            </div>
            <p class="clearfix"></p>
            <div class="short-div">@Html.Label("H_TYPE_BUILDING", H_TYPE_BUILDING_A)</div>
            <div class="short-div">
                <label for="R_TYPE_MY_HOME">
                    @L_TYPE_MY_HOME_A
                    <input type="radio" name="R_TYPE_BUILD" id="R_TYPE_MY_HOME" value="N" onclick="onTypeBuildChange()">
                </label>
                &nbsp;&nbsp;
                <label for="R_TYPE_RENTAL">
                    @L_TYPE_RENTAL_A
                    <input type="radio" name="R_TYPE_BUILD" id="R_TYPE_RENTAL" value="Y" onclick="onTypeBuildChange()">
                </label>
                @Html.HiddenFor(m => m.SELECT_TYPE_BUILD)
            </div>
            <p class="clearfix"></p>
            <div class="short-div">
                <div id="divCondo" style="display: none;">
                    @Html.Label("L_BUILDING_NAME", L_BUILDING_NAME_A)
                </div>
                <div id="divMoban">
                    @Html.Label("L_VILLAGE_NAME", L_VILLAGE_NAME_A)
                </div>
                @Html.TextBoxFor(m => m.BUILDING, "",
                        new
                        {
                            @class = "form-control",
                            @maxlength = 50
                        })
            </div>
        </div>

        <div class="col-xs-10 col-sm-7">
        </div>

        <p class="clearfix"></p>

        <div class="col-xs-10 col-sm-5">
            @Html.Label("L_PROVINCE", L_PROVINCE_A)
            <select class="select" style="width: 100%" id="PROVINCE" name="PROVINCE" onchange="onProvinceChange()">
                <option disabled selected value="">@L_PROVINCE_A</option>
            </select>
        </div>
        <div class="col-xs-2 col-sm-2"></div>
        <div class="col-xs-10 col-sm-5">
            @Html.Label("L_DISTRICT", L_DISTRICT_A)
            <select class="select" style="width: 100%" id="DISTRICT" name="DISTRICT" onchange="onAmphurChange()">
                <option disabled selected value="">@L_DISTRICT_A</option>
            </select>
        </div>
        <p class="clearfA"></p>

        <div class="col-xs-10 col-sm-5">
            @Html.Label("L_SUB_DISTRICT", L_SUB_DISTRICT_A)
            <select class="select" style="width: 100%" id="SUB_DISTRICT" name="SUB_DISTRICT" onchange="onTumbolChange()">
                <option disabled selected value="">@L_SUB_DISTRICT_A</option>
            </select>
        </div>
        <div class="col-xs-2 col-sm-2">
        </div>
        <div class="col-xs-10 col-sm-5">
            @Html.Label("L_POSTAL_CODE", L_POSTAL_CODE_A)
            <select class="select" style="width: 100%" id="POSTAL_CODE" name="POSTAL_CODE" onchange="onZipCodeChange()">
                <option disabled selected value="">@L_POSTAL_CODE_A</option>
            </select>
        </div>
        <p class="clearfix"></p>

        <div class="col-xs-10 col-sm-5">
            @Html.Label("L_HOUSE_NO", L_HOUSE_NO_A)
            @Html.TextBoxFor(m => m.HOUSE_NO, "",
                        new
                        {
                            @class = "form-control",
                            @title = L_HOUSE_NO_A,
                            @maxlength = 50
                        })
        </div>
        <div class="col-xs-2 col-sm-2"></div>
        <div class="col-xs-10 col-sm-5">
            @Html.Label("L_SOI", L_SOI_A)
            @Html.TextBoxFor(m => m.SOI, "",
                        new
                        {
                            @class = "form-control",
                            @title = L_SOI_A,
                            @maxlength = 50
                        })
        </div>
        <p class="clearfix"></p>

        <div class="col-xs-10  col-sm-5">
            @Html.Label("L_ROAD", L_ROAD_A)
            @Html.TextBoxFor(m => m.ROAD, "",
                        new
                        {
                            @class = "form-control",
                            @title = L_ROAD_A,
                            @maxlength = 50
                        })

            <p class="clearfix"></p>

            @Html.Label("L_CONTACT_TIME", L_CONTACT_TIME_A)
            <select class="select" style="width: 100%" id="CONTACT_TIME" name="CONTACT_TIME">
            </select>

            <p class="clearfix"></p>
            @Html.Label("L_ENTER_WORD", L_ENTER_WORD_A)
            <input type="text" id="defaultReal" name="defaultReal" class="form-control">
        </div>
        <div class="col-xs-10 col-sm-7">
            @if (language == "th")
            {
                <img src="../../Images/AISFIBRE_600_A_TH.jpg" class="pull-right img-responsive" style="padding-top: 25px;" />
            }
            else
            {
                <img src="../../Images/AISFIBRE_600_A_EN.jpg" class="pull-right img-responsive" style="padding-top: 25px;" />
            }
        </div>
        <p class="clearfix"></p>
        <div class="col-md-10 col-md-offset-1 col-xs-12">
            <div id="divShowStaffSection">
                <i class="fa fa-chevron-right tgreen"></i>
                @Html.Raw(L_FOR_OFFICER_A)
                <i class="fa fa-plus tgreen"></i>
            </div>
            <p class="clearfix"></p>
            <div id="divStaffSection" style="display: none;">
                <div class="col-sm-6 col-xs-12">
                    @Html.TextBoxFor(m => m.LOCATION_CODE, "",
                        new
                        {
                            @title = L_LOCATION_CODE_A,
                            @id = "L_LOC_CODE",
                            @class = "form-control",
                            @maxlength = "50",
                            @placeholder = L_LOCATION_CODE_A
                        })
                </div>
                <div class="col-sm-6 col-xs-12">
                    @Html.TextBoxFor(m => m.ASC_CODE, "",
                        new
                        {
                            @title = L_ASC_CODE_A,
                            @id = "L_ASC_CODE",
                            @class = "form-control",
                            @maxlength = "50",
                            @placeholder = L_ASC_CODE_A
                        })
                </div>
                <p class="clearfix"></p>
                <div class="col-sm-6 col-xs-12">
                    @Html.TextBoxFor(m => m.EMP_ID, "",
                        new
                        {
                            @title = L_EMPLOYEE_CODE_A,
                            @id = "L_STAFF_ID",
                            @class = "form-control",
                            @maxlength = "30",
                            @placeholder = L_EMPLOYEE_CODE_A
                        })
                </div>
                <div class="col-sm-6 col-xs-12">
                    @Html.TextBoxFor(m => m.SALES_REP, "",
                        new
                        {
                            @title = L_SALES_REP_A,
                            @id = "L_SALE_REP",
                            @class = "form-control",
                            @maxlength = "30",
                            @placeholder = L_SALES_REP_A
                        })
                </div>
                <p class="clearfix"></p>
            </div>
        </div>
        <p class="clearfix"></p>
    </div>
    <p class="clearfix"></p>
    
    <p class="clearfix"></p>
    <p class="clearfix page-header"></p>

    <div class="col-md-12 text-center">
        <a class="btn btn-default btn-for-xs" role="button" style="color: #8DC63F;" onclick="Clear()">@B_CLEAR_A</a>
        <a class="btn btn-success rippler rippler-default btn-for-xs" role="button" onclick="Register();">@B_REGISTER_A</a>
    </div>
    <p class="clearfix"></p>
    <p class="clearfix"></p>
    
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="modal001_label">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header" style="border-bottom: none;">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="Clear()"><span aria-hidden="true">&times;</span></button>
                </div>
                <div class="modal-body">
                    <div class="add-border-rounded-green">
                        <p class="clearfix"></p>
                        <h5 id="modal001txt" class="text-center">
                            <span id="LastPopupMessage"></span>
                        </h5>
                        <p class="clearfix"></p>
                        <div class="col-md-12 text-center">
                            <p class="clearfix"></p>
                            <button type="button" id="modal001btn" class="btn btn-default" data-dismiss="modal" onclick="Clear()">&nbsp; @B_CLOSE_A &nbsp; </button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="border-top: none;">
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="myModalerror" tabindex="-1" role="dialog" aria-labelledby="modal001_label">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header" style="border-bottom: none;">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="Clear()"><span aria-hidden="true">&times;</span></button>
                </div>
                <div class="modal-body">
                    <div class="add-border-rounded-green">
                        <p class="clearfix"></p>
                        <h3 id="modal001txt1" class="text-center">
                            <span id="LastPopupMessageError"></span>
                        </h3>
                        <p class="clearfix"></p>
                        <div class="col-md-12 text-center">
                            <p class="clearfix"></p>
                            <button type="button" id="modal001btn1" class="btn btn-default" data-dismiss="modal" onclick="">&nbsp; @B_CLOSE_A &nbsp; </button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="border-top: none;">
                </div>
            </div>
        </div>
    </div>
}
<script type="text/javascript">
    var language = "";
    language = "@language";

    var digitalData = {};
    digitalData.page = {};
    digitalData.page.pageInfo = {};

    var validateModel = new Array();

    $(document).ready(function () {

        var saveStatus = '@SaveStatus';

        if (saveStatus != '') {

            digitalData.page = {
                pageInfo: {
                    pageName: "Leavemessage:" + language + ":LeavemessageSave",
                    site: "newfibre",
                    language: language
                },
                category: {
                    pageType: "content page",
                    primaryCategory: "newfibre:" + language + ":LeavemessageSave",
                    subCategory1: "",
                    subCategory2: ""
                }
            }

            if (saveStatus == "Y") {
                PopupMessage('@Html.Raw(L_POPUP_SUCCESS_A.Replace("{0}", RefNo))');
            }
            else {
                PopupMessage('@Html.Raw(L_POPUP_ERROR_A)');
            }
            $('#myModal').modal('show');
        }
        else {
            digitalData.page = {
                pageInfo: {
                    pageName: "Leavemessage:" + language + ":Leavemessage",
                    site: "newfibre",
                    language: language
                },
                category: {
                    pageType: "content page",
                    primaryCategory: "newfibre:" + language + ":leavemessage",
                    subCategory1: "",
                    subCategory2: ""
                }
            }

        }

        

        $("#R_MOOBAN").prop("checked", true);
        //$("#R_BUILD").prop("checked", true);
        $("#SELECT_ADDRESS_TYPE").val("V");
        //getServiceSpeed();
        getProvince();
        getContactTime();

        $('#NAME').keyup(function () {
            CheckKeyUps("NAME", "@FBB_Con_CharNotonName");
        });
        $('#SURNAME').keyup(function () {
            CheckKeyUps("SURNAME", "@FBB_Con_CharNotonName");
        });
        $("#CONTACT_MOBILE").keyup(function () {
            CheckKeyUps("CONTACT_MOBILE", '@FBB_Input_MobileNo');
            CheckKeyUpsMobile("CONTACT_MOBILE");
        });
        $('#BUILDING').keyup(function () {
            CheckKeyUps("BUILDING", "@FBB_Con_Input_Building");
        });
        $('#HOUSE_NO').keyup(function () {
            CheckKeyUps("HOUSE_NO", "@FBB_Con_Input_Home_Number");
        });
        $('#SOI').keyup(function () {
            CheckKeyUps("SOI", "@FBB_Con_Input_Soi");
        });
        $('#ROAD').keyup(function () {
            CheckKeyUps("ROAD", "@FBB_Con_Input_Road");
        });

        $('#divShowStaffSection').css("cursor", "pointer");

        $('#divShowStaffSection').click(function() {
            $("#divStaffSection").slideToggle("fast");
            $('i.fa.fa-plus').toggleClass('fa-minus');
        });

        $('#defaultReal').realperson({
            length: 5,
            regenerate: 'Change',
            dot: '*',
            dots: $.realperson.defaultDots,
            chars: $.realperson.alphanumeric
        });

        $("#CONTACT_MOBILE").focusout(function () {
 
            var a = [];

            $("#IsAIS").hide();
            $("#MOBILE_IS_AIS").val("N");

            a.pop({ id: "CONTACT_MOBILE" });
            a.push({ id: "CONTACT_MOBILE" });

            var chk = ValidationProcessing(a, "err001");
            if (chk) {
                if ($("#CONTACT_MOBILE").val().length == 10) {
                    if (GetCCCustInfo()) {
                        $("#IsAIS").show();
                        $("#MOBILE_IS_AIS").val("Y");
                    }
                    $("#CONTACT_MOBILE")[0].className = "form-control";
                } else {
                    $("#CONTACT_MOBILE")[0].className = "form-control errorinput";
                }
            }

        });
    });

    function ValidateCaptcha() {
        var cap = false;
        $.ajax({
            url: '/Process/ValidateCaptcha',
            data: { inputUser: $('#defaultReal').val(), inputHash: $('#defaultReal').realperson('getHash') },
            dataType: "json",
            async: false,
            type: 'POST',
            success: function(response) {
                if (!response) {
                    $("#defaultReal")[0].className = "form-control errorinput";
                    $('#defaultReal').realperson({
                        length: 5,
                        regenerate: 'Change',
                        dot: '*',
                        dots: $.realperson.defaultDots,
                        chars: $.realperson.alphanumeric
                    });
                } else {
                    cap = true;
                }
            }
        });
        return cap;
    }

    function Register() {

        // Update 17.4 Script Adobe Analytic
        digitalData.customLinkName = "Leavemessage:save-button";

        // Update 17.11 Script
        fbq('track', 'Click_Submit_Fibre_Leavemessage');

        var a = [];

        a.pop({ id: "NAME" });
        a.pop({ id: "SURNAME" });
        a.pop({ id: "CONTACT_MOBILE" });
        a.pop({ id: "PROVINCE" });
        a.pop({ id: "DISTRICT" });
        a.pop({ id: "SUB_DISTRICT" });
        a.pop({ id: "POSTAL_CODE" });
        a.pop({ id: "BUILDING" });
        a.pop({ id: "HOUSE_NO" });
        a.pop({ id: "CONTACT_TIME" });

        a.push({ id: "NAME" });
        a.push({ id: "SURNAME" });
        a.push({ id: "CONTACT_MOBILE", condition: "MobileNumber" });
        a.push({ id: "PROVINCE" });
        a.push({ id: "DISTRICT" });
        a.push({ id: "SUB_DISTRICT" });
        a.push({ id: "POSTAL_CODE" });
        a.push({ id: "BUILDING" });
        a.push({ id: "HOUSE_NO" });
        a.push({ id: "CONTACT_TIME" });

        var chkEmail = true;
        if ($("#EMAIL").val() != "") {
            // a.push({ id: "EMAIL", condition: "Email" });
            chkEmail = validateEmailleavemessageA($("#EMAIL").val());

            if (chkEmail) {
                $("#EMAIL").removeClass("textFieldFalse").removeClass("form-control errorinput ").addClass("form-control");
            } else {
                $("#EMAIL").addClass("form-control errorinput textFieldFalse");
            }
        } else {
            $("#EMAIL").removeClass("form-control errorinput ").addClass("form-control");
        }

        $('#LastPopupMessageError').text('');

        var chk = ValidationProcessing(a, "err001");

        //=================== Start เจ้าหน้าที่  =====================
        $("#L_LOC_CODE").removeClass('form-control errorinput').addClass('form-control');
        $("#L_ASC_CODE").removeClass('form-control errorinput').addClass('form-control');
        $("#L_STAFF_ID").removeClass('form-control errorinput').addClass('form-control');

        if ($('#L_LOC_CODE').val() != "" || $('#L_ASC_CODE').val() != "" || $('#L_STAFF_ID').val() != "" || $('#L_SALE_REP').val() != "") {

            var chkStaffSection = true;
            var aB = [];

            if ($('#L_LOC_CODE').val() != "") {
                if ($("#L_STAFF_ID").val() == "") {
                    aB.push({ id: "L_ASC_CODE" });
                }
                if ($("#L_ASC_CODE").val() == "") {
                    aB.push({ id: "L_STAFF_ID" });
                }
            }
            else if ($("#L_STAFF_ID").val() != "") {
                aB.push({ id: "L_LOC_CODE" });
            }

            chkStaffSection = ValidationProcessing(aB, "err001");

            if (chkStaffSection) {
                if ($("#L_STAFF_ID").val() != "") {
                    if (!CheckEmpCode($('#L_STAFF_ID').val())) {
                        $("#L_STAFF_ID").removeClass('form-control').addClass('form-control errorinput');
                        PopupMessage('@Html.Raw(L_POPUP_INVALID_EMP_CODE)');
                        $('#myModalerror').modal('show');
                        LockScreen(false);
                        chk = false;
                        return;
                    }
                }
            }
            else {
                LockScreen(false);
                chk = false;
                return;
            }

            if ($('#L_LOC_CODE').val() != "" || $('#L_ASC_CODE').val() != "" || $('#L_STAFF_ID').val() != "") {
                if (!CheckSeibel()) {
                    LockScreen(false);
                    chk = false;
                    return;
                }
            }
        }
        //=================== end เจ้าหน้าที่  =====================


        if (chk && chkEmail && ValidateCaptcha()) {
            // Validate Check RadioButton Type Build ( true = pop up alert validate , false = click submit )
            if ($("input[name=R_TYPE_BUILD]:checked").val() == undefined) {
                toastrErrorMessage("@L_MESSAGE_ERROR_RENTAL_A");
            } else {

                $("#RegisterForm").submit();
            }
        } else if (chk && !chkEmail && ValidateCaptcha()) {
            toastrErrorMessage("@L_MESSAGE_ERROR_EMAIL_A");
        }
    

    }

    function CheckSeibel() {
        var chkSeibel = false;
        var location_code = $('#L_LOC_CODE').val();
        var asc_code = $('#L_ASC_CODE').val();
        $.ajax({
            url: '/officer/CheckSeibel',
            data: { LocationCode: location_code, ASCCode: asc_code },
            dataType: "json",
            async: false,
            type: 'POST',
            success: function (response) {
                if (response.outStatus == "Error") {
                    $("#L_ASC_CODE").removeClass('form-control').addClass('form-control errorinput');
                    PopupMessage('@Html.Raw(L_POPUP_INVALID_LOC_ASC)');
                    $('#myModalerror').modal('show');
                }
                else {
                    $("#CustomerRegisterPanelModel_outType").val(response.outType);
                    $("#CustomerRegisterPanelModel_outSubType").val(response.outSubType);
                    $("#CustomerRegisterPanelModel_outMobileNo").val(response.outMobileNo);
                    $("#CustomerRegisterPanelModel_PartnerName").val(response.outPartnerName);
                    chkSeibel = true;
                }
            }
        });
        return chkSeibel;
    }

    function CheckEmpCode(EmpCode) {
        var IsEmp = false;
        $.ajax({
            url: '/Campaign/CheckEmpCode',
            data: { empCode: EmpCode },
            dataType: "json",
            type: 'POST',
            async: false,
            success: function (response) {
                if (response == "Y") {
                    IsEmp = true;
                }
            }
        });
        return IsEmp;
    }

    function validateEmailleavemessageA(email) {
        var filter = /^(((([a-zA-Z0-9\_\-]{1,50})+(([\.]{1,50}[a-zA-Z0-9\_\-]{1,50}){0,50})){1,95})+@@([\w-]+\.)+[\w-]{2,4})?$/;
        if (email.substr(0, 2) == "-@@" || email.substr(0, 2) == "_@@") {
            return false;
        }
        if (!(email.indexOf('@@') > -1)) {
            return false;
        }
        if (filter.test(email)) {
            return true;
        }
        else {
            return false;
        }
    }

    function Clear() {
        // Update 17.4 Script Adobe Analytic
        digitalData.customLinkName = "Leavemessage:cancel-button";
        

        // Clear RadioButton Type Build
        $("#R_TYPE_MY_HOME").prop("checked", false);
        $("#R_TYPE_RENTAL").prop("checked", false);
        $("#SELECT_TYPE_BUILD").val("");

        $('#L_LOC_CODE').val("");
        $('#L_ASC_CODE').val("");
        $('#L_STAFF_ID').val("");
        $('#L_SALE_REP').val("");

        window.location.href = '@UrlRef';
    }

    function onBuildChange() {

        if ($("#R_BUILD").is(":checked")) {
            $("#SELECT_ADDRESS_TYPE").val("B");
            $("#divCondo").show();
            $("#divMoban").hide();
        }
        else if ($("#R_MOOBAN").is(":checked")) {
            $("#SELECT_ADDRESS_TYPE").val("V");
            $("#divCondo").hide();
            $("#divMoban").show();
        }
    }

    function onTypeBuildChange() {
        if ($("#R_TYPE_MY_HOME").is(":checked")) {
            $("#SELECT_TYPE_BUILD").val("N");
        }
        else if ($("#R_TYPE_RENTAL").is(":checked")) {
            $("#SELECT_TYPE_BUILD").val("Y");
        }
    }

    function getContactTime() {
        $('#CONTACT_TIME').empty();
        var str = '<option disabled selected value="">' + "@L_PLEASE_SELECT_A" + '</option>';

        $('#CONTACT_TIME').append(str);
        $.ajax({
            type: "GET",
            url: "/LeavemessageII/GetContactTime",
            dataType: "json",
            async: false,
            success: function (data) {
                var strBuilder = '';
                $.each(data, function (i, e) {
                    var s = "";

                    var str = '<option value="' + e.Value + '"' + s + '>' + e.Text + '</option>';
                    strBuilder += str;
                });

                $('#CONTACT_TIME').append(strBuilder);
                $('#CONTACT_TIME').select2();
            }
        });
    }

    function getProvince(province) {
        $('#PROVINCE').empty();
        var str = '<option disabled selected value="">' + "@L_PLEASE_SELECT_A" + '</option>';

        $('#PROVINCE').append(str);
        $.ajax({
            type: "GET",
            url: "/LeavemessageII/GetProvince",
            dataType: "json",
            async: false,
            success: function (data) {
                var strBuilder = '';
                $.each(data, function (i, e) {
                    var s = "";

                    if (province == e.Text) s = "selected";

                    var str = '<option value="' + e.Value + '"' + s + '>' + e.Text + '</option>';
                    strBuilder += str;
                });

                $('#PROVINCE').append(strBuilder);
                $('#PROVINCE').select2();
            }
        });
    }

    function onProvinceChange(amphur, province) {

        var pv = $('#PROVINCE').val();

        if (province != undefined) {
            pv = province;
        }

        $('#DISTRICT').empty();
        $('#SUB_DISTRICT').empty();
        $('#POSTAL_CODE').empty();
        $.ajax({
            type: "GET",
            url: "/LeavemessageII/GetAmphur",
            dataType: "json",
            data: { 'provinceFilter': pv },
            async: false,
            success: function (data) {

                var strBuilder = "<option value='' disabled selected >" + "@L_PLEASE_SELECT_A" + "</option>";
                $.each(data, function (i, e) {
                    var s = "";
                    if (amphur == e.Value) s = "selected";

                    var str = '<option value="' + e.Value + '"' + s + '>' + e.Text + '</option>';
                    strBuilder += str;
                });
                $('#DISTRICT').append(strBuilder);
            }
        });
            $('#DISTRICT').select2();
            $('#SUB_DISTRICT').append("<option value='' disabled selected >" + "@L_SUB_DISTRICT_A" + "</option>");
        $('#SUB_DISTRICT').select2();
        $('#POSTAL_CODE').append("<option value='' disabled selected >" + "@L_POSTAL_CODE_A" + "</option>");
        $('#POSTAL_CODE').select2();
    }

    function onAmphurChange(tumbol, amphur, province) {

        $('#SUB_DISTRICT').empty();
        $('#POSTAL_CODE').empty();

        var pv = $('#PROVINCE').val();

        if (province != undefined) {
            pv = province;
        }

        var aphur = ""
        if ($('#DISTRICT').val() != "" && $('#DISTRICT').val() != null) {
            aphur = $('#DISTRICT').val();
        }
        else {
            aphur = amphur;
        }

        $.ajax({
            type: "GET",
            url: "/LeavemessageII/GetTumbon",
            async: false,
            data: { 'provinceFilter': pv, 'amphurFilter': aphur },
            dataType: "json",
            success: function (data) {

                var strBuilder = "<option value='' disabled selected >" + "@L_PLEASE_SELECT_A" + "</option>";
                $.each(data, function (i, e) {

                    var s = "";
                    if (tumbol == e.Value) s = "selected";

                    var str = '<option value="' + e.Value + '"' + s + '>' + e.Text + '</option>';
                    strBuilder += str;
                });

                $('#SUB_DISTRICT').append(strBuilder);
            },
            error: function (data) {
                var dd = data.error;

            }
        });

            $('#SUB_DISTRICT').select2();
            $('#POSTAL_CODE').append("<option value='' disabled selected >" + "@L_POSTAL_CODE_A" + "</option>");
        $('#POSTAL_CODE').select2();

    }

    function onTumbolChange() {
        $('#POSTAL_CODE').empty();

        var pro = $("#PROVINCE").val();
        var amp = $("#DISTRICT").val();
        var tum = $("#SUB_DISTRICT").val();

        $.ajax({
            type: "GET",
            url: "/LeavemessageII/GetCoverageZipCode",
            dataType: "json",
            data: {
                'provinceFilter': pro,
                'amphurFilter': amp,
                'tumbonFilter': tum,
                "sso": ""
            },
            async: false,
            success: function (data) {
                var tempZipCode = "";
                if (data.zipCodeList.length == 1)
                    $("#POSTAL_CODE option[value='']").remove();

                $.each(data.zipCodeList, function (i, e) {
                    var str = '<option value="' + e.Text + '">' + e.Text + '</option>';
                    tempZipCode += str;
                });
                $('#POSTAL_CODE').append(tempZipCode);
                onZipCodeChange();

            }
        });
        $('#POSTAL_CODE').select2();

    }

    function onZipCodeChange() {
        $("#POSTAL_CODE").val($('#POSTAL_CODE').val());
    }

    function GetCCCustInfo() {
        var IsAIS = false;
        $.ajax({
            url: '/CheckCoverage/GetCCCustInfoQuery',
            data: { mobileNo: $.trim($("#CONTACT_MOBILE").val()) },
            dataType: "json",
            type: 'POST',
            async: false,
            success: function (response) {
                var data = response.data;
                if (data) {

                    $.ajax({
                        url: '/CheckCoverage/GetCCCustInfo',
                        data: { key: data.GUIDKEY, },
                        dataType: "json",
                        type: 'POST',
                        async: false,
                        success: function (response) {

                            var data = response.data;

                            var chkSubNetworkType = data.TYPE;

                            if (chkSubNetworkType == "Pre-paid") {
                                /// IsAIS
                                IsAIS = true;
                            }
                            else if (chkSubNetworkType == "Post-paid") {
                                /// IsAIS
                                IsAIS = true;
                            }
                        }
                    });

                }
            }
        });
        return IsAIS;
    }

    function base64_decode(str) {
        if (window.atob) // Internet Explorer 10 and above  
            return decodeURIComponent(escape(window.atob(str)));
        else {
            // Cross-Browser Method (compressed)  

            // Create Base64 Object  
            var Base64 = { _keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", encode: function (e) { var t = ""; var n, r, i, s, o, u, a; var f = 0; e = Base64._utf8_encode(e); while (f < e.length) { n = e.charCodeAt(f++); r = e.charCodeAt(f++); i = e.charCodeAt(f++); s = n >> 2; o = (n & 3) << 4 | r >> 4; u = (r & 15) << 2 | i >> 6; a = i & 63; if (isNaN(r)) { u = a = 64 } else if (isNaN(i)) { a = 64 } t = t + this._keyStr.charAt(s) + this._keyStr.charAt(o) + this._keyStr.charAt(u) + this._keyStr.charAt(a) } return t }, decode: function (e) { var t = ""; var n, r, i; var s, o, u, a; var f = 0; e = e.replace(/[^A-Za-z0-9\+\/\=]/g, ""); while (f < e.length) { s = this._keyStr.indexOf(e.charAt(f++)); o = this._keyStr.indexOf(e.charAt(f++)); u = this._keyStr.indexOf(e.charAt(f++)); a = this._keyStr.indexOf(e.charAt(f++)); n = s << 2 | o >> 4; r = (o & 15) << 4 | u >> 2; i = (u & 3) << 6 | a; t = t + String.fromCharCode(n); if (u != 64) { t = t + String.fromCharCode(r) } if (a != 64) { t = t + String.fromCharCode(i) } } t = Base64._utf8_decode(t); return t }, _utf8_encode: function (e) { e = e.replace(/\r\n/g, "\n"); var t = ""; for (var n = 0; n < e.length; n++) { var r = e.charCodeAt(n); if (r < 128) { t += String.fromCharCode(r) } else if (r > 127 && r < 2048) { t += String.fromCharCode(r >> 6 | 192); t += String.fromCharCode(r & 63 | 128) } else { t += String.fromCharCode(r >> 12 | 224); t += String.fromCharCode(r >> 6 & 63 | 128); t += String.fromCharCode(r & 63 | 128) } } return t }, _utf8_decode: function (e) { var t = ""; var n = 0; var r = c1 = c2 = 0; while (n < e.length) { r = e.charCodeAt(n); if (r < 128) { t += String.fromCharCode(r); n++ } else if (r > 191 && r < 224) { c2 = e.charCodeAt(n + 1); t += String.fromCharCode((r & 31) << 6 | c2 & 63); n += 2 } else { c2 = e.charCodeAt(n + 1); c3 = e.charCodeAt(n + 2); t += String.fromCharCode((r & 15) << 12 | (c2 & 63) << 6 | c3 & 63); n += 3 } } return t } }
            // Encode the String  
            return decodeURIComponent(escape(Base64.decode(str)));
        }
    }

    function CheckKeyUps(id, RexStr) {
        var strKey = $("#" + id).val();
        var strBuilder = "";
        var filter = new RegExp(RexStr);
        for (var i = 0; i < strKey.length; i++) {
            if (filter.test(strKey.substr(i, 1))) {
                strBuilder += strKey.substr(i, 1);
            }
        }
        $("#" + id).val(strBuilder);

    }

    function CheckKeyUpsMobile(id) {
        var strKey = $("#" + id).val();
        var strBuilder = "";
        for (var i = 0; i < strKey.length; i++) {
            if (i == 0) {
                if (strKey.substr(i, 1) == 0) {
                    strBuilder += strKey.substr(i, 1);
                }
            }
            else if (i == 1) {
                if (strKey.substr(i, 1) != 0) {
                    strBuilder += strKey.substr(i, 1);
                }
            }
            else {
                strBuilder += strKey.substr(i, 1);
            }
        }
        $("#" + id).val(strBuilder);
    }

    function PopupMessage(msg) {
        $('#LastPopupMessage').append(msg);
        $('#LastPopupMessageError').append(msg);
    }

</script>
