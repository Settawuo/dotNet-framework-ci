@model WBBEntity.PanelModels.QuickWinPanelModel
@using System.Collections.Generic;
@using WBBEntity.PanelModels;
@using WBBEntity.Extensions;
@using WBBWeb.Extension;

@{
    string H_FBB001 = "";
    string L_SPECIFIC_ADDR_1 = "";
    string L_SPECIFIC_BUILD = "";
    string L_BUILD_NAME = "";
    string L_SEARCH_BUILDING = "";
    string L_FLOOR_CONDO = "";
    string L_HAVE_FIXED_LINE = "";
    string L_SPECIFIC_ADDR_2 = "";
    string L_LAT_LONG = "";
    string L_FLOOR = "";
    string L_PROVINCE = "";
    string L_TUMBOL = "";
    string L_AMPHUR = "";
    string L_MOOBAN = "";
    string L_MOOBAN2 = "";
    string L_OTHER2 = "";
    string L_HOME_NUMBER_1 = "";
    string L_MOO = "";
    string L_SOI = "";
    string L_ROAD = "";
    string L_ZIPCODE = "";
    string B_CONFIRM = "";
    string B_NEXT = "";
    string L_CLICK = "";
    string L_HOW_LAT_LONG = "";
    string L_BUILD_NO = "";
    string B_CHECKING = "";
    string L_DECIMAL = "";
    string L_SPECIFIC_LOC = "";
    string L_HOW_TO = "";
    string L_GGMAP_TOOLTIP = "";
    string L_BUILDING = "";
    string HowtoMap = "";
    string SPECIFICMap = "";
    string L_THK = "";
    string L_NO = "";
    string L_YES = "";
    string L_CHECK_PLUG_AND_PLAY_FLOW = "";
    string L_CHECK_NORMAL_FLOW = "";
    string L_REMARK_PLUG_AND_PLAY = "";
    string L_REMARK_BUILDING_IN_LIST = "";
    string L_REMARK_TIMESLOT_FULL = "";
    string L_REGISTRATION_FLOW = "";

    string FBB_Con_LengthIDCardNumberHILL_CARD = "";
    string FBB_Con_LengthIDCardNumberID_CARD = "";
    string FBB_Con_LengthIDCardNumberIMM_CARD = "";
    string FBB_Con_LengthIDCardNumberMONK_CERT = "";
    string FBB_Con_Input_CERT_FOUND = "";
    string FBB_Con_Input_EMB_LET = "";
    string FBB_Con_Input_HILL_CARD = "";
    string FBB_Con_Input_ID_CARD = "";
    string FBB_Con_Input_IMM_CARD = "";
    string FBB_Con_Input_MONK_CERT = "";
    string FBB_Con_Input_PASSPORT = "";
    string FBB_Con_Input_ROY_LET = "";
    string FBB_Con_Input_STA_LET = "";
    string FBB_Con_Input_TAX_ID = "";
    string FBB_Con_Input_GOV_LET = "";
    string FBB_Con_Length_ID_Card_Number_STA_LET = "";
    string FBB_Con_Length_ID_Card_Number_ROY_LET = "";
    string FBB_Con_Length_ID_Card_Number_EMB_LET = "";
    string FBB_Con_Length_ID_Card_Number_CERT_FOUND = "";
    string FBB_Con_Length_ID_Card_Number_TAX_ID = "";
    string FBB_Con_Length_ID_Card_Number_PASSPORT = "";
    string FBB_Con_Length_ID_Card_Number_GOV_LET = "";
    string L_NEW_CUST = "";
    string L_AIS_CUST = "";
    string L_SEARCH_NONMOBILE = "";
    string L_SEARCH_IDCARD = "";
    string B_SEARCH_NEW_CUST = "";
    string L_NEW_CUST_NOT_FOUND = "";
    string L_NEW_CUST_VALIDATE_REQUIRE = "";
    string L_NEW_CUST_NOT_FOUND9 = "";
    string L_NEW_CUST_NOT_FOUND11 = "";
    string B_BACK = "";
    string lCARD_TYPE = "";
    string L_RESULT_PLANSITE = "";
    string L_IMG_NEW = "";
    string FBB_Con_MobileLength = "";
    string FBB_Con_Input_MobileNo = "";
    string[] CheckSerenadeArray;
    string ProductSpecCode = "";
    string L_ERROR_LOAD_CARD = "";
    string FBB_Con_WEB_CONFIG = "";

    //Case Channel IM
    bool isChannelIM = string.Equals(Request["channel"], "im", StringComparison.OrdinalIgnoreCase);
    string AssetNumber = Request["assetnumber"];
    string ServiceCaseId = Request["servicecaseid"];


    if (ViewBag.LabelFBBTR003 != null)
    {
        var labelFBBTR003 = (List<LovScreenValueModel>)ViewBag.LabelFBBTR003;
        lCARD_TYPE = labelFBBTR003.Any(c => c.Name == "L_CARD_TYPE") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_CARD_TYPE").DisplayValue : "";
        L_ERROR_LOAD_CARD = labelFBBTR003.Any(c => c.Name == "L_ERROR_LOAD_CARD") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_ERROR_LOAD_CARD").DisplayValue : "";
    }


    if (ViewBag.FbbConstant != null)
    {
        var FbbConstant = (List<FbbConstantModel>)ViewBag.FbbConstant;

        FBB_Con_LengthIDCardNumberHILL_CARD = FbbConstant.Any(f => f.Field == "Length ID Card Number HILL_CARD") ? FbbConstant.First(f => f.Field == "Length ID Card Number HILL_CARD").Validation : "";
        FBB_Con_LengthIDCardNumberID_CARD = FbbConstant.Any(f => f.Field == "Length ID Card Number ID_CARD") ? FbbConstant.First(f => f.Field == "Length ID Card Number ID_CARD").Validation : "";
        FBB_Con_LengthIDCardNumberIMM_CARD = FbbConstant.Any(f => f.Field == "Length ID Card Number IMM_CARD") ? FbbConstant.First(f => f.Field == "Length ID Card Number IMM_CARD").Validation : "";
        FBB_Con_LengthIDCardNumberMONK_CERT = FbbConstant.Any(f => f.Field == "Length ID Card Number MONK_CERT") ? FbbConstant.First(f => f.Field == "Length ID Card Number MONK_CERT").Validation : "";

        FBB_Con_Input_CERT_FOUND = FbbConstant.Any(f => f.Field == "Input CERT_FOUND") ? FbbConstant.First(f => f.Field == "Input CERT_FOUND").Validation : "";
        FBB_Con_Input_EMB_LET = FbbConstant.Any(f => f.Field == "Input EMB_LET") ? FbbConstant.First(f => f.Field == "Input EMB_LET").Validation : "";
        FBB_Con_Input_HILL_CARD = FbbConstant.Any(f => f.Field == "Input HILL_CARD") ? FbbConstant.First(f => f.Field == "Input HILL_CARD").Validation : "";
        FBB_Con_Input_ID_CARD = FbbConstant.Any(f => f.Field == "Input ID_CARD") ? FbbConstant.First(f => f.Field == "Input ID_CARD").Validation : "";
        FBB_Con_Input_IMM_CARD = FbbConstant.Any(f => f.Field == "Input IMM_CARD") ? FbbConstant.First(f => f.Field == "Input IMM_CARD").Validation : "";
        FBB_Con_Input_MONK_CERT = FbbConstant.Any(f => f.Field == "Input MONK_CERT") ? FbbConstant.First(f => f.Field == "Input MONK_CERT").Validation : "";
        FBB_Con_Input_PASSPORT = FbbConstant.Any(f => f.Field == "Input PASSPORT") ? FbbConstant.First(f => f.Field == "Input PASSPORT").Validation : "";
        FBB_Con_Input_ROY_LET = FbbConstant.Any(f => f.Field == "Input ROY_LET") ? FbbConstant.First(f => f.Field == "Input ROY_LET").Validation : "";
        FBB_Con_Input_STA_LET = FbbConstant.Any(f => f.Field == "Input STA_LET") ? FbbConstant.First(f => f.Field == "Input STA_LET").Validation : "";
        FBB_Con_Input_TAX_ID = FbbConstant.Any(f => f.Field == "Input TAX_ID") ? FbbConstant.First(f => f.Field == "Input TAX_ID").Validation : "";
        FBB_Con_Input_GOV_LET = FbbConstant.Any(f => f.Field == "Input GOV_LET") ? FbbConstant.First(f => f.Field == "Input GOV_LET").Validation : "";

        FBB_Con_Length_ID_Card_Number_STA_LET = FbbConstant.Any(f => f.Field == "Length ID Card Number STA_LET") ? FbbConstant.First(f => f.Field == "Length ID Card Number STA_LET").Validation : "";
        FBB_Con_Length_ID_Card_Number_ROY_LET = FbbConstant.Any(f => f.Field == "Length ID Card Number ROY_LET") ? FbbConstant.First(f => f.Field == "Length ID Card Number ROY_LET").Validation : "";
        FBB_Con_Length_ID_Card_Number_EMB_LET = FbbConstant.Any(f => f.Field == "Length ID Card Number EMB_LET") ? FbbConstant.First(f => f.Field == "Length ID Card Number EMB_LET").Validation : "";
        FBB_Con_Length_ID_Card_Number_CERT_FOUND = FbbConstant.Any(f => f.Field == "Length ID Card Number CERT_FOUND") ? FbbConstant.First(f => f.Field == "Length ID Card Number CERT_FOUND").Validation : "";
        FBB_Con_Length_ID_Card_Number_TAX_ID = FbbConstant.Any(f => f.Field == "Length ID Card Number TAX_ID") ? FbbConstant.First(f => f.Field == "Length ID Card Number TAX_ID").Validation : "";
        FBB_Con_Length_ID_Card_Number_PASSPORT = FbbConstant.Any(f => f.Field == "Length ID Card Number PASSPORT") ? FbbConstant.First(f => f.Field == "Length ID Card Number PASSPORT").Validation : "";
        FBB_Con_Length_ID_Card_Number_GOV_LET = FbbConstant.Any(f => f.Field == "Length ID Card Number GOV LET") ? FbbConstant.First(f => f.Field == "Length ID Card Number GOV LET").Validation : "";

        FBB_Con_MobileLength = FbbConstant.Any(f => f.Field == "Mobile Length") ? FbbConstant.First(f => f.Field == "Mobile Length").Validation : "";
        FBB_Con_Input_MobileNo = FbbConstant.Any(f => f.Field == "Input_MobileNo") ? FbbConstant.First(f => f.Field == "Input_MobileNo").Validation : "";
        CheckSerenadeArray = FbbConstant.Where(p => p.Field == "SERENADE_MOBILE_SEGMENT").Select(p => p.Validation).ToArray();
        ProductSpecCode = FbbConstant.Any(f => f.Field == "ProductSpecCode") ? FbbConstant.First(f => f.Field == "ProductSpecCode").Validation : "";

        FBB_Con_WEB_CONFIG = FbbConstant.Any(f => f.Field == "WEB_CONFIG") ? FbbConstant.First(f => f.Field == "WEB_CONFIG").Validation : "";
    }
    else
    {
        CheckSerenadeArray = null;
    }

    string Input_Building = "";
    string Input_Building_No = "";
    string Input_Mooban = "";
    string Input_Home_Number = "";
    string Input_Moo = "";
    string Input_Soi = "";
    string Input_Road = "";
    string Input_Floor = "";
    string Input_Lat_Long = "";

    string Length_Building = "";
    string Length_Building_No = "";
    string Length_Mooban = "";
    string Length_Home_Number = "";
    string Length_Moo = "";
    string Length_Soi = "";
    string Length_Road = "";
    string Length_Floor = "";
    string Length_Lat_Long = "";
    //20.4 Service Level
    string SERVICE_LEVEL_H = "";
    string SERVICE_LEVEL_M = "";
    string SERVICE_LEVEL_L = "";
    string DISPLAY_SERVICE_LEVEL_H = "";
    string DISPLAY_SERVICE_LEVEL_M = "";
    string DISPLAY_SERVICE_LEVEL_L = "";

    if (ViewBag.FbbConstant != null)
    {
        var LabelFbbConstant = (List<FbbConstantModel>)ViewBag.FbbConstant;
        Input_Floor = LabelFbbConstant.Any(f => f.Field == "Input_Floor") ? LabelFbbConstant.First(f => f.Field == "Input_Floor").Validation : "";
        Input_Building = LabelFbbConstant.Any(f => f.Field == "Input_Building") ? LabelFbbConstant.First(f => f.Field == "Input_Building").Validation : "";
        Input_Building_No = LabelFbbConstant.Any(f => f.Field == "Input_Building_No") ? LabelFbbConstant.First(f => f.Field == "Input_Building_No").Validation : "";
        Input_Mooban = LabelFbbConstant.Any(f => f.Field == "Input_Mooban") ? LabelFbbConstant.First(f => f.Field == "Input_Mooban").Validation : "";
        Input_Home_Number = LabelFbbConstant.Any(f => f.Field == "Input_Home_Number") ? LabelFbbConstant.First(f => f.Field == "Input_Home_Number").Validation : "";
        Input_Moo = LabelFbbConstant.Any(f => f.Field == "Input_Moo") ? LabelFbbConstant.First(f => f.Field == "Input_Moo").Validation : "";
        Input_Soi = LabelFbbConstant.Any(f => f.Field == "Input_Soi") ? LabelFbbConstant.First(f => f.Field == "Input_Soi").Validation : "";
        Input_Road = LabelFbbConstant.Any(f => f.Field == "Input_Road") ? LabelFbbConstant.First(f => f.Field == "Input_Road").Validation : "";
        Input_Lat_Long = LabelFbbConstant.Any(f => f.Field == "Input_Lat_Long") ? LabelFbbConstant.First(f => f.Field == "Input_Lat_Long").Validation : "";
        Length_Building = LabelFbbConstant.Any(f => f.Field == "Length_Building") ? LabelFbbConstant.First(f => f.Field == "Length_Building").Validation : "";
        Length_Building_No = LabelFbbConstant.Any(f => f.Field == "Length_Building_No") ? LabelFbbConstant.First(f => f.Field == "Length_Building_No").Validation : "";
        Length_Mooban = LabelFbbConstant.Any(f => f.Field == "Length_Mooban") ? LabelFbbConstant.First(f => f.Field == "Length_Mooban").Validation : "";
        Length_Home_Number = LabelFbbConstant.Any(f => f.Field == "Length_Home_Number") ? LabelFbbConstant.First(f => f.Field == "Length_Home_Number").Validation : "";
        Length_Moo = LabelFbbConstant.Any(f => f.Field == "Length_Moo") ? LabelFbbConstant.First(f => f.Field == "Length_Moo").Validation : "";
        Length_Soi = LabelFbbConstant.Any(f => f.Field == "Length_Soi") ? LabelFbbConstant.First(f => f.Field == "Length_Soi").Validation : "";
        Length_Road = LabelFbbConstant.Any(f => f.Field == "Length_Road") ? LabelFbbConstant.First(f => f.Field == "Length_Road").Validation : "";
        Length_Floor = LabelFbbConstant.Any(f => f.Field == "Length_Floor") ? LabelFbbConstant.First(f => f.Field == "Length_Floor").Validation : "";
        Length_Lat_Long = LabelFbbConstant.Any(f => f.Field == "Length_Lat_Long") ? LabelFbbConstant.First(f => f.Field == "Length_Lat_Long").Validation : "";

        //20.4 Service Level
        SERVICE_LEVEL_H = LabelFbbConstant.Any(f => f.Field == "SERVICE_LEVEL_H") ? LabelFbbConstant.First(f => f.Field == "SERVICE_LEVEL_H").Validation : "";
        SERVICE_LEVEL_M = LabelFbbConstant.Any(f => f.Field == "SERVICE_LEVEL_M") ? LabelFbbConstant.First(f => f.Field == "SERVICE_LEVEL_M").Validation : "";
        SERVICE_LEVEL_L = LabelFbbConstant.Any(f => f.Field == "SERVICE_LEVEL_L") ? LabelFbbConstant.First(f => f.Field == "SERVICE_LEVEL_L").Validation : "";
        DISPLAY_SERVICE_LEVEL_H = LabelFbbConstant.Any(f => f.Field == "SERVICE_LEVEL_H") ? LabelFbbConstant.First(f => f.Field == "SERVICE_LEVEL_H").SubValidation : "";
        DISPLAY_SERVICE_LEVEL_M = LabelFbbConstant.Any(f => f.Field == "SERVICE_LEVEL_M") ? LabelFbbConstant.First(f => f.Field == "SERVICE_LEVEL_M").SubValidation : "";
        DISPLAY_SERVICE_LEVEL_L = LabelFbbConstant.Any(f => f.Field == "SERVICE_LEVEL_L") ? LabelFbbConstant.First(f => f.Field == "SERVICE_LEVEL_L").SubValidation : "";
    }

    string L_POPUP_AIRNET_DETAIL = "";
    string L_POPUP_AIRNET_REMARK = "";
    string B_CANCEL = "";
    string B_CONFIRM_TO_SUBSCRIBE = "";

    string SHOW_POPUP_PLANSITE_SSO = "";
    string SHOW_POPUP_PLANSITE_CUST = "";
    string SHOW_POPUP_NOPLAN_CUST = "";
    string SHOW_POPUP_NOPLAN_SSO = "";
    string B_LEAVE_INFO = "";
    string B_SUBSCRIBE_AIRNET = "";
    string L_RESULT_DETAIL = "";
    string L_RESULT_NOPLAN = "";
    string L_RESULT_NOPLAN_WTTX = "";
    string L_RESULT_PLAN_EXCUSIVE_3BB = "";

    string L_EXISTING_MOBILE_NO = "";
    string L_EXISTING_CARD_NUMBER = "";

    string L_NEW_CUS_NON_AIS = "";
    string L_USE_ADDR_CARD = "";
    string B_YES = "";
    string B_NO = "";

    string L_CHK_INCOVERAGE = "";
    string L_CHK_NOCOVERAGE_3BB = "";
    string B_CHK_REGISTER = "";
    string B_LEAVE_CONTACT = "";
    string isSaleManager = "";

    string L_TYPE_OF_RESIDENCE = "";
    string L_OWNER = "";
    string L_RENTAL = "";

    string L_SERVICE_LEVEL = "";

    if (ViewBag.LabelFBBTR001 != null)
    {
        var LabelFBBTR001 = (List<LovScreenValueModel>)ViewBag.LabelFBBTR001;
        var LabelFBBTR000 = (List<LovScreenValueModel>)ViewBag.LabelFBBTR000;
        var LabelFBBTR004 = (List<LovScreenValueModel>)ViewBag.LabelFBBTR004;
        B_CANCEL = LabelFBBTR004.Any(c => c.Name == "B_CANCEL") ? LabelFBBTR004.FirstOrDefault(c => c.Name == "B_CANCEL").DisplayValue : "";
        L_POPUP_AIRNET_DETAIL = LabelFBBTR001.Any(c => c.Name == "L_POPUP_AIRNET_DETAIL") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_POPUP_AIRNET_DETAIL").DisplayValue : "";
        L_POPUP_AIRNET_REMARK = LabelFBBTR001.Any(c => c.Name == "L_POPUP_AIRNET_REMARK") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_POPUP_AIRNET_REMARK").DisplayValue : "";
        B_CONFIRM_TO_SUBSCRIBE = LabelFBBTR001.Any(c => c.Name == "B_CONFIRM_TO_SUBSCRIBE") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "B_CONFIRM_TO_SUBSCRIBE").DisplayValue : "";

        SHOW_POPUP_PLANSITE_SSO = LabelFBBTR001.Any(c => c.Name == "SHOW_POPUP_PLANSITE_SSO") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "SHOW_POPUP_PLANSITE_SSO").DisplayValue : "";
        SHOW_POPUP_PLANSITE_CUST = LabelFBBTR001.Any(c => c.Name == "SHOW_POPUP_PLANSITE_CUST") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "SHOW_POPUP_PLANSITE_CUST").DisplayValue : "";
        SHOW_POPUP_NOPLAN_CUST = LabelFBBTR001.Any(c => c.Name == "SHOW_POPUP_NOPLAN_CUST") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "SHOW_POPUP_NOPLAN_CUST").DisplayValue : "";
        SHOW_POPUP_NOPLAN_SSO = LabelFBBTR001.Any(c => c.Name == "SHOW_POPUP_NOPLAN_SSO") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "SHOW_POPUP_NOPLAN_SSO").DisplayValue : "";
        B_LEAVE_INFO = LabelFBBTR001.Any(c => c.Name == "B_LEAVE_INFO") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "B_LEAVE_INFO").DisplayValue : "";
        B_SUBSCRIBE_AIRNET = LabelFBBTR001.Any(c => c.Name == "B_SUBSCRIBE_AIRNET") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "B_SUBSCRIBE_AIRNET").DisplayValue : "";
        L_RESULT_DETAIL = LabelFBBTR001.Any(c => c.Name == "L_RESULT_DETAIL") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_RESULT_DETAIL").DisplayValue : "";
        L_RESULT_NOPLAN = LabelFBBTR001.Any(c => c.Name == "L_RESULT_NOPLAN") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_RESULT_NOPLAN").DisplayValue : "";
        L_RESULT_NOPLAN_WTTX = LabelFBBTR001.Any(c => c.Name == "L_RESULT_NOPLAN_WTTX") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_RESULT_NOPLAN_WTTX").DisplayValue : "";
        L_RESULT_PLAN_EXCUSIVE_3BB = LabelFBBTR001.Any(c => c.Name == "L_RESULT_PLAN_EXCUSIVE_3BB") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_RESULT_PLAN_EXCUSIVE_3BB").DisplayValue : "";

        H_FBB001 = LabelFBBTR001.Any(c => c.Name == "H_FBB001") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "H_FBB001").DisplayValue : "";
        L_SPECIFIC_ADDR_1 = LabelFBBTR001.Any(c => c.Name == "L_SPECIFIC_ADDR_1") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_SPECIFIC_ADDR_1").DisplayValue : "";
        L_SPECIFIC_BUILD = LabelFBBTR001.Any(c => c.Name == "L_SPECIFIC_BUILD") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_SPECIFIC_BUILD").DisplayValue : "";
        L_BUILD_NAME = LabelFBBTR001.Any(c => c.Name == "L_BUILD_NAME") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_BUILD_NAME").DisplayValue : "";
        L_SEARCH_BUILDING = LabelFBBTR001.Any(c => c.Name == "L_SEARCH_BUILDING") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_SEARCH_BUILDING").DisplayValue : "";
        L_FLOOR_CONDO = LabelFBBTR001.Any(c => c.Name == "L_FLOOR_CONDO") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_FLOOR_CONDO").DisplayValue : "";
        L_HAVE_FIXED_LINE = LabelFBBTR001.Any(c => c.Name == "L_HAVE_FIXED_LINE") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_HAVE_FIXED_LINE").DisplayValue : "";
        L_SPECIFIC_ADDR_2 = LabelFBBTR001.Any(c => c.Name == "L_SPECIFIC_ADDR_2") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_SPECIFIC_ADDR_2").DisplayValue : "";
        L_LAT_LONG = LabelFBBTR001.Any(c => c.Name == "L_LAT_LONG") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_LAT_LONG").DisplayValue : "";
        L_PROVINCE = LabelFBBTR000.Any(c => c.Name == "L_PROVINCE") ? LabelFBBTR000.FirstOrDefault(c => c.Name == "L_PROVINCE").DisplayValue : "";
        L_TUMBOL = LabelFBBTR000.Any(c => c.Name == "L_TUMBOL") ? LabelFBBTR000.FirstOrDefault(c => c.Name == "L_TUMBOL").DisplayValue : "";
        L_AMPHUR = LabelFBBTR000.Any(c => c.Name == "L_AMPHUR") ? LabelFBBTR000.FirstOrDefault(c => c.Name == "L_AMPHUR").DisplayValue : "";
        L_MOOBAN = LabelFBBTR001.Any(c => c.Name == "L_SEARCH_VILLAGE") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_SEARCH_VILLAGE").DisplayValue : "";
        L_MOOBAN2 = LabelFBBTR001.Any(c => c.Name == "L_MOOBAN2") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_MOOBAN2").DisplayValue : "";
        L_OTHER2 = LabelFBBTR001.Any(c => c.Name == "L_OTHER2") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_OTHER2").DisplayValue : "";
        L_HOME_NUMBER_1 = LabelFBBTR000.Any(c => c.Name == "L_HOME_NUMBER_1") ? LabelFBBTR000.FirstOrDefault(c => c.Name == "L_HOME_NUMBER_1").DisplayValue : "";
        L_MOO = LabelFBBTR000.Any(c => c.Name == "L_MOO") ? LabelFBBTR000.FirstOrDefault(c => c.Name == "L_MOO").DisplayValue : "";
        L_SOI = LabelFBBTR000.Any(c => c.Name == "L_SOI") ? LabelFBBTR000.FirstOrDefault(c => c.Name == "L_SOI").DisplayValue : "";
        L_ROAD = LabelFBBTR000.Any(c => c.Name == "L_ROAD") ? LabelFBBTR000.FirstOrDefault(c => c.Name == "L_ROAD").DisplayValue : "";
        L_ZIPCODE = LabelFBBTR000.Any(c => c.Name == "L_ZIPCODE") ? LabelFBBTR000.FirstOrDefault(c => c.Name == "L_ZIPCODE").DisplayValue : "";
        B_CONFIRM = LabelFBBTR000.Any(c => c.Name == "B_CONFIRM") ? LabelFBBTR000.FirstOrDefault(c => c.Name == "B_CONFIRM").DisplayValue : "";
        B_NEXT = LabelFBBTR000.Any(c => c.Name == "B_NEXT") ? LabelFBBTR000.FirstOrDefault(c => c.Name == "B_NEXT").DisplayValue : "";
        L_CLICK = LabelFBBTR001.Any(c => c.Name == "L_CLICK") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_CLICK").DisplayValue : "";
        L_HOW_LAT_LONG = LabelFBBTR001.Any(c => c.Name == "L_HOW_LAT_LONG") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_HOW_LAT_LONG").DisplayValue : "";
        L_BUILD_NO = LabelFBBTR001.Any(c => c.Name == "L_BUILD_NO") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_BUILD_NO").DisplayValue : "";
        L_FLOOR = LabelFBBTR000.Any(c => c.Name == "L_FLOOR") ? LabelFBBTR000.FirstOrDefault(c => c.Name == "L_FLOOR").DisplayValue : "";
        B_CHECKING = LabelFBBTR001.Any(c => c.Name == "B_CHECKING") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "B_CHECKING").DisplayValue : "";
        L_DECIMAL = LabelFBBTR001.Any(c => c.Name == "L_DECIMAL") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_DECIMAL").DisplayValue : "";
        L_SPECIFIC_LOC = LabelFBBTR001.Any(c => c.Name == "L_SPECIFIC_LOC") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_SPECIFIC_LOC").DisplayValue : "";
        L_HOW_TO = LabelFBBTR001.Any(c => c.Name == "L_HOW_TO") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_HOW_TO").DisplayValue : "";
        L_GGMAP_TOOLTIP = LabelFBBTR001.Any(c => c.Name == "L_GGMAP_TOOLTIP") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_GGMAP_TOOLTIP").DisplayValue : "";
        L_BUILDING = LabelFBBTR001.Any(c => c.Name == "L_BUILDING") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_BUILDING").DisplayValue : "";
        L_THK = LabelFBBTR001.Any(c => c.Name == "L_THK") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_THK").DisplayValue : "";
        L_YES = LabelFBBTR001.Any(c => c.Name == "L_YES") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_YES").DisplayValue : "";
        L_NO = LabelFBBTR001.Any(c => c.Name == "L_NO") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_NO").DisplayValue : "";

        L_NEW_CUST = LabelFBBTR001.Any(c => c.Name == "L_NEW_CUST") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_NEW_CUST").DisplayValue : "";
        L_AIS_CUST = LabelFBBTR001.Any(c => c.Name == "L_AIS_CUST") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_AIS_CUST").DisplayValue : "";
        L_SEARCH_NONMOBILE = LabelFBBTR001.Any(c => c.Name == "L_SEARCH_NONMOBILE") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_SEARCH_NONMOBILE").DisplayValue : "";
        L_SEARCH_IDCARD = LabelFBBTR001.Any(c => c.Name == "L_SEARCH_IDCARD") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_SEARCH_IDCARD").DisplayValue : "";
        B_SEARCH_NEW_CUST = LabelFBBTR001.Any(c => c.Name == "B_SEARCH_NEW_CUST") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "B_SEARCH_NEW_CUST").DisplayValue : "";
        L_NEW_CUST_NOT_FOUND = LabelFBBTR001.Any(c => c.Name == "L_NEW_CUST_NOT_FOUND") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_NEW_CUST_NOT_FOUND").DisplayValue : "";
        L_NEW_CUST_VALIDATE_REQUIRE = LabelFBBTR001.Any(c => c.Name == "L_NEW_CUST_VALIDATE_REQUIRE") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_NEW_CUST_VALIDATE_REQUIRE").DisplayValue : "";
        L_RESULT_PLANSITE = LabelFBBTR001.Any(c => c.Name == "L_RESULT_PLANSITE") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_RESULT_PLANSITE").DisplayValue : "";
        L_NEW_CUST_NOT_FOUND9 = LabelFBBTR001.Any(c => c.Name == "L_NEW_CUST_NOT_FOUND9") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_NEW_CUST_NOT_FOUND9").DisplayValue : "";
        L_NEW_CUST_NOT_FOUND11 = LabelFBBTR001.Any(c => c.Name == "L_NEW_CUST_NOT_FOUND11") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_NEW_CUST_NOT_FOUND11").DisplayValue : "";

        L_IMG_NEW = LabelFBBTR001.Any(c => c.Name == "L_IMG_NEW") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_IMG_NEW").Blob : "";

        SPECIFICMap = LabelFBBTR001.Any(c => c.Name == "L_SPECIFIC_ADDR_2") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_SPECIFIC_ADDR_2").DisplayValue : "";
        HowtoMap = LabelFBBTR001.Any(c => c.Name == "L_HOW_TO") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_HOW_TO").DisplayValue : "";

        L_EXISTING_MOBILE_NO = LabelFBBTR001.Any(c => c.Name == "L_EXISTING_MOBILE_NO") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_EXISTING_MOBILE_NO").DisplayValue : "";
        L_EXISTING_CARD_NUMBER = LabelFBBTR001.Any(c => c.Name == "L_EXISTING_CARD_NUMBER") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_EXISTING_CARD_NUMBER").DisplayValue : "";

        L_NEW_CUS_NON_AIS = LabelFBBTR001.Any(c => c.Name == "L_NEW_CUS_NON_AIS") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_NEW_CUS_NON_AIS").DisplayValue : "";


        var labelFBBTR000 = (List<LovScreenValueModel>)ViewBag.LabelFBBTR000;
        B_BACK = labelFBBTR000.Any(c => c.Name == "B_BACK") ? labelFBBTR000.FirstOrDefault(c => c.Name == "B_BACK").DisplayValue : "";


        L_USE_ADDR_CARD = LabelFBBTR001.Any(c => c.Name == "L_USE_ADDR_CARD") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_USE_ADDR_CARD").DisplayValue : "";
        B_YES = LabelFBBTR001.Any(c => c.Name == "B_YES") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "B_YES").DisplayValue : "";
        B_NO = LabelFBBTR001.Any(c => c.Name == "B_NO") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "B_NO").DisplayValue : "";

        L_CHK_INCOVERAGE = LabelFBBTR001.Any(c => c.Name == "L_CHK_INCOVERAGE") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_CHK_INCOVERAGE").DisplayValue : "";
        L_CHK_NOCOVERAGE_3BB = LabelFBBTR001.Any(c => c.Name == "L_CHK_NOCOVERAGE_3BB") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_CHK_NOCOVERAGE_3BB").DisplayValue : "ที่อยู่ของคุณ ไม่อยู่ในพื้นที่ให้บริการ AIS Fibre";
        B_CHK_REGISTER = LabelFBBTR001.Any(c => c.Name == "B_CHK_REGISTER") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "B_CHK_REGISTER").DisplayValue : "";
        B_LEAVE_CONTACT = LabelFBBTR001.Any(c => c.Name == "B_LEAVE_CONTACT") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "B_LEAVE_CONTACT").DisplayValue : "";

        L_CHECK_PLUG_AND_PLAY_FLOW = LabelFBBTR001.Any(c => c.Name == "L_CHECK_PLUG_AND_PLAY_FLOW") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_CHECK_PLUG_AND_PLAY_FLOW").DisplayValue : "";
        L_CHECK_NORMAL_FLOW = LabelFBBTR001.Any(c => c.Name == "L_CHECK_NORMAL_FLOW") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_CHECK_NORMAL_FLOW").DisplayValue : "";
        L_REMARK_PLUG_AND_PLAY = LabelFBBTR001.Any(c => c.Name == "L_REMARK_PLUG_AND_PLAY") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_REMARK_PLUG_AND_PLAY").DisplayValue : "";
        L_REMARK_BUILDING_IN_LIST = LabelFBBTR001.Any(c => c.Name == "L_REMARK_BUILDING_IN_LIST") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_REMARK_BUILDING_IN_LIST").DisplayValue : "";
        L_REMARK_TIMESLOT_FULL = LabelFBBTR001.Any(c => c.Name == "L_REMARK_TIMESLOT_FULL") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_REMARK_TIMESLOT_FULL").DisplayValue : "";
        L_REGISTRATION_FLOW = LabelFBBTR001.Any(c => c.Name == "L_REGISTRATION_FLOW") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_REGISTRATION_FLOW").DisplayValue : "";

        L_TYPE_OF_RESIDENCE = LabelFBBTR001.Any(c => c.Name == "L_TYPE_OF_RESIDENCE") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_TYPE_OF_RESIDENCE").DisplayValue : "";
        L_OWNER = LabelFBBTR001.Any(c => c.Name == "L_OWNER") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_OWNER").DisplayValue : "";
        L_RENTAL = LabelFBBTR001.Any(c => c.Name == "L_RENTAL") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_RENTAL").DisplayValue : "";

        L_SERVICE_LEVEL = LabelFBBTR001.Any(c => c.Name == "L_SERVICE_LEVEL") ? LabelFBBTR001.FirstOrDefault(c => c.Name == "L_SERVICE_LEVEL").DisplayValue : "";
    }

    var L_CLOSE001 = "";
    if (null != ViewBag.LCLOSE)
    {
        L_CLOSE001 = ViewBag.LCLOSE;
    }

    var L_CLOSE002 = "";
    if (null != ViewBag.LCLOSE2)
    {
        L_CLOSE002 = ViewBag.LCLOSE2;
    }

    string officer = "";
    if (null != ViewBag.officer)
    {
        officer = "1";
    }
    else
    {
        if (Session["OfficerModel"] != null)
        {
            officer = "1";
        }
    }

    string ESRIflag = "false";
    if (null != ViewBag.ESRIflag)
    {
        ESRIflag = ViewBag.ESRIflag;
    }

    string BypassESRIflag = "false";
    if (null != ViewBag.BypassESRIflag)
    {
        BypassESRIflag = ViewBag.BypassESRIflag;
    }

    string FromFBBxEOS = "";
    if (ViewBag.FromFBBxEOS != null)
    {
        FromFBBxEOS = ViewBag.FromFBBxEOS;
    }

    string CARD_NOsFBBxEOS = "";
    if (ViewBag.CARD_NOsFBBxEOS != null)
    {
        CARD_NOsFBBxEOS = ViewBag.CARD_NOsFBBxEOS;
    }

    string PromotionCodeFBBxEOS = "";
    if (ViewBag.PromotionCodeFBBxEOS != null)
    {
        PromotionCodeFBBxEOS = ViewBag.PromotionCodeFBBxEOS;
    }

    string LanguageEOS = "";
    if (ViewBag.LanguageEOS != null)
    {
        LanguageEOS = ViewBag.LanguageEOS;
    }

    var vas_flag = "";
    if (null != ViewBag.Vas)
    {
        vas_flag = ViewBag.Vas;
    }

    var chkCoverage = false;
    if (null != ViewBag.chkCoverage)
    {
        chkCoverage = ViewBag.chkCoverage;
    }

    var isSaveCommplete = false;
    var lpopupsave = "";
    var lclose = "";
    var lsave = "";
    var productSubType = "";
    var languagePage = "";
    var officeEnd = "";

    if (null != ViewBag.LPOPUPSAVE)
    {
        lpopupsave = ViewBag.LPOPUPSAVE;
    }
    if (null != ViewBag.LCLOSE)
    {
        lclose = ViewBag.LCLOSE;
    }
    if (null != ViewBag.LSAVE)
    {
        lsave = ViewBag.LSAVE;
    }
    if (null != ViewBag.SaveSuccess)
    {
        isSaveCommplete = ViewBag.SaveSuccess;
    }
    if (null != ViewBag.SWifi)
    {
        productSubType = ViewBag.SWiFi;
    }
    if (null != ViewBag.LanguagePage)
    {
        languagePage = ViewBag.LanguagePage;
    }
    if (null != ViewBag.officeEnd)
    {
        officeEnd = ViewBag.officeEnd;
    }

    var stlyeDisplay = "";
    if (ESRIflag == "true" || BypassESRIflag == "true")
    {
        stlyeDisplay = "style=\"display: none;\"";
    }

    if (null != ViewBag.isSaleManager)
    {
        isSaleManager = ViewBag.isSaleManager;
    }
    string floor = Model.CoveragePanelModel.CoverageMemberGetMember.FLOOR;
    string moo = Model.CoveragePanelModel.CoverageMemberGetMember.MOO;
}

@Html.HiddenFor(model => model.CoveragePanelModel.CVRID)
@Html.HiddenFor(model => model.CoveragePanelModel.CVR_NODE)
@Html.HiddenFor(model => model.CoveragePanelModel.CVR_TOWER)

@Html.HiddenFor(model => model.CoveragePanelModel.L_LAT, new { @id = "CoveragePanelModel_L_LAT" })
@Html.HiddenFor(model => model.CoveragePanelModel.L_LONG, new { @id = "CoveragePanelModel_L_LONG" })
@Html.HiddenFor(model => model.CoveragePanelModel.L_LAT2)
@Html.HiddenFor(model => model.CoveragePanelModel.L_LONG2)

@Html.HiddenFor(model => model.CoveragePanelModel.ChargeType, new { @id = "CoveragePanelModel_ChargeType" })
@Html.HiddenFor(model => model.PlugAndPlayFlow, new { @id = "PlugAndPlayFlow" })

@*R18.11 IdCard Reader on PC*@
@Html.Hidden("hdIdCardReaderOnPcFlag", "Y") @*Flag ต้องการให้ระบบ อ่านบัตรประชาชน บน PC*@
@Html.Hidden("hdIdCardNoUserAis", "")


<div id="page1" class="container addrounded" @Html.Raw(stlyeDisplay)>
    <h4 class="page-header tgreen">@H_FBB001</h4>
    @if (ViewBag.vas != "3")
    {
        @*<div class="col-md-12">
                <button type="button" id="btnCusNew"
                        class="btn btn-success btn-for-xs rippler rippler-default" onclick="onCustype('NEW')">
                    @L_NEW_CUST
                </button>
                <button type="button" id="btnCusAis"
                        class="btn btn-default btn-for-xs rippler rippler-default" onclick="onCustype('AIS')">
                    @L_AIS_CUST
                </button>
            </div>
            <p class="clearfix"></p>
            <p class="clearfix"></p>*@
    }

    @*NEW CUS*@
    <div id="cvrbody">
        <div class="col-md-12 title-form">
            <i class="fa fa-chevron-right tgreen"></i>@L_SPECIFIC_BUILD
        </div>
        <p class="clearfix"></p>
        <div class="col-md-12 title-form divServiceLevel" style="display:none">
            <i class="fa fa-chevron-right tgreen"></i>
            <span>@L_SERVICE_LEVEL</span>
            <span class="valueServiceLevel tgreen" style="font-weight:bold; font-size: 16px;"></span>
            <p class="clearfix"></p>
        </div>
        <div class="col-md-10 col-md-offset-1">
            <!--===radio address====-->
            <div class="col-md-12 radio">
                <label class="radio-inline" for="R_BUILD" style="font-weight: normal !important; padding-right: 15px;">
                    <input type="radio" name="R_BUILD" id="R_BUILD" value="CONDOMINIUM" onclick="onBuildChange()" checked="checked">
                    @L_BUILDING
                </label>
                <p class="visible-xs"></p>

                <label class="radio-inline" for="R_MOOBAN" style="font-weight: normal !important; padding-right: 15px; display: none">
                    <input type="radio" name="R_BUILD" id="R_MOOBAN" value="VILLAGE" onclick="onBuildChange()">
                    @L_MOOBAN2
                </label>
                <p class="visible-xs"></p>

                <label class="radio-inline" for="R_OTHER" style="font-weight: normal !important;">
                    <input type="radio" name="R_BUILD" id="R_OTHER" value="OTHER" onclick="onBuildChange()">
                    @L_OTHER2
                    @*<img src=data:image/png;base64,@L_IMG_NEW />*@
                </label>
                <p class="clearfix"></p>
            </div>
            <!--===END radio address====-->
            <!--===radio rental====-->
            <div id="divrental" class="col-md-12" style="display: none;">
                @L_TYPE_OF_RESIDENCE
                <p class="clearfix"></p>
                <label class="radio-inline" for="R_OWNER" style="font-weight: normal !important; padding-right: 15px;">
                    <input type="radio" name="R_RENTAL" id="R_OWNER" value="N" onclick="onRentalChange('N')">
                    @L_OWNER
                </label>
                <p class="visible-xs"></p>
                <label class="radio-inline" for="R_RENTAL" style="font-weight: normal !important; padding-right: 15px">
                    <input type="radio" name="R_RENTAL" id="R_RENTAL" value="Y" onclick="onRentalChange('Y')">
                    @L_RENTAL
                </label>
                <p class="clearfix"></p>
                <p class="clearfix"></p>
            </div>
            <!--===END radio rental====-->
            <div id="divTower">
                <div class="col-md-12">
                    <div style="display: none;" id="DIV_L_BUILD_NAME">
                        <input id="L_BUILD_NAME" type="hidden" value="0" />
                    </div>
                    @Html.TextBoxFor(model => model.CoveragePanelModel.Address.L_BUILD_NAME_Hied,
                        new
                        {
                            @class = "form-control",
                            @title = @L_SEARCH_BUILDING,
                            @maxlength = Length_Building,
                            @placeholder = @L_SEARCH_BUILDING,
                        })
                </div>
                <p class="clearfix"></p>
            </div>
            <div id="divBaan" style="display: none">
                <input type="hidden" id="CoveragePanelModel_Address_L_MOOBAN" />
                <div class="col-md-12">
                    <div style="display: none;" id="divMooban1">
                        <select class="select" style="width: 100%;" id="Mooban1" onchange="onMoobanChang()">
                            <option value="" disabled selected>@L_MOOBAN</option>
                        </select>
                    </div>
                    <input type="text" id="Mooban2" class="form-control" title="@L_MOOBAN"
                           maxlength="@Length_Mooban" placeholder=@L_MOOBAN />
                </div>
                <p class="clearfix"></p>
            </div>
            <div class="col-md-8 col-md-offset-2" id="div_condo_carousel">
            </div>
            <div id="DIV_ADDRESS">
                <div class="col-sm-4 col-xs-12">
                    @Html.TextBoxFor(model => model.CoveragePanelModel.Address.L_HOME_NUMBER_1,
                        new
                        {
                            @class = "form-control",
                            @title = @L_HOME_NUMBER_1,
                            @maxlength = Length_Home_Number,
                            @id = "CoveragePanelModel_Address_L_HOME_NUMBER_1",
                            @placeholder = @L_HOME_NUMBER_1
                        })
                    <p class="clearfix"></p>
                </div>
                <div class="col-sm-4 col-xs-12" id="div_l_build_no">
                    <div id="DIV_D_L_BUILD_NO">
                        <select class="select" style="width: 100%" id="L_BUILD_NO" name="L_BUILD_NO">
                            <option value="" disabled selected>@L_BUILD_NO</option>
                        </select>
                    </div>
                    <input type="hidden" id="OwnerByBuild" />
                    @Html.TextBoxFor(model => model.CoveragePanelModel.Address.L_BUILD_NO_Hied,
                            new
                            {
                                @class = "form-control",
                                @title = @L_BUILD_NO,
                                @Style = "display: none;",
                                @maxlength = Length_Building_No,
                                @placeholder = @L_BUILD_NO
                            })
                    <p class="clearfix"></p>
                </div>
                <div class="col-sm-4 col-xs-12" id="div_l_floor">
                    @Html.TextBoxFor(model => model.CoveragePanelModel.Address.L_FLOOR,
                            new
                            {
                                @class = "form-control",
                                @title = @L_FLOOR_CONDO,
                                @maxlength = Length_Floor,
                                @id = "CoveragePanelModel_Address_L_FLOOR",
                                @placeholder = @L_FLOOR_CONDO,
                            })
                    @Html.HiddenFor(model => model.CoveragePanelModel.L_FLOOR_CONDO)
                    <p class="clearfix"></p>
                </div>
                <div class="col-sm-4 col-xs-12">
                    @Html.TextBoxFor(model => model.CoveragePanelModel.Address.L_MOO,
                        new
                        {
                            @class = "form-control",
                            @title = @L_MOO,
                            @maxlength = Length_Moo,
                            @id = "CoveragePanelModel_Address_L_MOO",
                            @placeholder = @L_MOO,
                        })
                    <p class="clearfix"></p>
                </div>
                <div class="col-sm-4 col-xs-12">
                    @Html.TextBoxFor(model => model.CoveragePanelModel.Address.L_SOI,
                        new
                        {
                            @class = "form-control",
                            @title = @L_SOI,
                            @maxlength = Length_Soi,
                            @id = "CoveragePanelModel_Address_L_SOI",
                            @placeholder = @L_SOI,
                        })
                    <p class="clearfix"></p>
                </div>
                <div class="col-sm-4 col-xs-12">
                    @Html.TextBoxFor(model => model.CoveragePanelModel.Address.L_ROAD,
                        new
                        {
                            @class = "form-control",
                            @maxlength = Length_Road,
                            @id = "CoveragePanelModel_Address_L_ROAD",
                            @title = @L_ROAD,
                            @placeholder = @L_ROAD,
                        })
                    <p class="clearfix"></p>
                </div>
                <div class="col-sm-4 col-xs-12">
                    <select class="select" style="width: 100%" id="COVERAGE_L_TUMBOL" name="COVERAGE_L_TUMBOL"
                            onchange="getZipCode()">
                        <option disabled selected value="">@L_TUMBOL</option>
                    </select>
                    <p class="clearfix"></p>
                </div>
                <div class="col-sm-4 col-xs-12">
                    <select class="select" style="width: 100%" id="COVERAGE_L_AMPHUR" name="COVERAGE_L_AMPHUR"
                            onchange="onAmphurChange()">
                        <option disabled selected value="">@L_AMPHUR</option>
                    </select>
                    <p class="clearfix"></p>
                </div>
                <div class="col-sm-4 col-xs-12" id="Div_Province">
                    <select class="select" style="width: 100%" id="COVERAGE_L_PROVINCE" name="COVERAGE_L_PROVINCE"
                            onchange="onProvinceChange()">
                        <option disabled selected value="">@L_PROVINCE</option>
                    </select>
                    <p class="clearfix"></p>
                </div>
                <div class="col-sm-4 col-xs-12" id="Div_Postcode">
                    <select class="select" style="width: 100%" name="CoveragePanelModel.Address.L_ZIPCODE"
                            id="CoveragePanelModel_Address_L_ZIPCODE" onchange="onZipCodeChange()">
                        <option disabled selected value="">@L_ZIPCODE</option>
                    </select>
                    @Html.HiddenFor(model => model.CoveragePanelModel.Address.ZIPCODE_ID)
                    <p class="clearfix"></p>
                </div>
                <p class="clearfix"></p>
                <div class="col-xs-12" id="DIV_HAVE_FIXED_LINE">
                    <div class="radio">
                        @L_HAVE_FIXED_LINE&nbsp;&nbsp;
                        <p class="clearfix visible-xs"></p>
                        <label class="radio-inline">
                            <input type="radio" name="L_HAVE_FIXED_LINE" value="Y" />@L_YES
                        </label>
                        &nbsp;&nbsp;
                        <label class="radio-inline">
                            <input type="radio" name="L_HAVE_FIXED_LINE" value="N" />@L_NO
                        </label>
                        &nbsp;&nbsp;
                    </div>
                </div>
                <div class="col-xs-12" id="DIV_PLUG_AND_PLAY" style="display: none">
                    <div class="radio">
                        @L_REGISTRATION_FLOW
                        <p class="clearfix"></p>
                        <label class="radio-inline">
                            <input type="radio" id="PLUG_AND_PLAY_FLOW" name="L_CHECK_PLUG_AND_PLAY_FLOW" value="Y" /> &nbsp; @L_CHECK_PLUG_AND_PLAY_FLOW
                        </label>
                        <p class="clearfix"></p>
                        <div id="L_REMARK_PLUG_AND_PLAY" class="col-sm-6 col-xs-12" style="color:red; display: none;">
                            @(Html.Raw(L_REMARK_PLUG_AND_PLAY))
                        </div>
                        <p class="clearfix"></p>
                        <label class="radio-inline">
                            <input type="radio" id="NORMAL_FLOW" name="L_CHECK_PLUG_AND_PLAY_FLOW" value="N" />  &nbsp; @L_CHECK_NORMAL_FLOW
                        </label>
                        <p class="clearfix"></p>

                        <div id="L_REMARK_BUILDING_IN_LIST" class="col-sm-6 col-xs-12" style="color:red; display: none;">
                            @(Html.Raw(L_REMARK_BUILDING_IN_LIST))
                        </div>
                        <div id="L_REMARK_TIMESLOT_FULL" class="col-sm-6 col-xs-12" style="color:red; display: none;">
                            @(Html.Raw(L_REMARK_TIMESLOT_FULL))
                        </div>
                    </div>
                </div>
            </div>
            <div id="BM1">
            </div>
            <div id="DIViframeMap" style="display: none;">
                <div class="col-md-12 title-form">
                    <i class="fa fa-chevron-right tgreen"></i>@SPECIFICMap
                    <br>
                    <p class="clearfix">@HowtoMap</p>
                </div>
                <div class="col-md-12">
                    <div class="widget" id="w_iframe">
                        <div class="widget-footer">
                            <a href="javascript:void(0)" class="fa fa-expand fa-1x" id="expandFibreMap"
                               data-placement="right" title="" data-original-title="FA-EXPAND"><i></i></a>
                        </div>
                        <div class="widget-body">
                            <iframe name="my-iframe" id="iframeMap" height="680"
                                    frameborder="0" scrolling="no"
                                    marginheight="0" marginwidth="0"
                                    data-src="https://staging-mapfibre.ais.co.th/mapfibre/" src="about:blank" allow="geolocation" ></iframe>
                        </div>
                    </div>
                </div>
                <p class="clearfix"></p>
            </div>

            <input type="hidden" id="HdFunctionProduct" name="HdFunctionProduct" value="" />
            <input type="hidden" id="HdFunctionSubProduct" name="HdFunctionSubProduct" value="" />
            <input type="hidden" id="HdFunctionSubProducts" name="HdFunctionSubProducts" value="" />
            <input type="hidden" id="HdFunctionCoverageResult" name="HdFunctionCoverageResult" value="" />
            <input type="hidden" id="HdFunctionOwner" name="HdFunctionOwner" value="" />
            <input type="hidden" id="HdAddTriple" name="HdAddTriple" value="" />

            @Html.HiddenFor(model => model.CoveragePanelModel.PRODUCT_SUBTYPE)
            @Html.HiddenFor(model => model.CoveragePanelModel.BuildingType)
            @Html.HiddenFor(model => model.CoveragePanelModel.P_FTTX_VENDOR)

            <p class="clearfix"></p>
        </div>
        <p class="clearfix"></p>
    </div>

    @*AIS CUS*@
    <div id="cvrbodyno" style="display: none;">
        <div class="col-md-12 title-form">
            <i class="fa fa-chevron-right tgreen"></i>
            @L_SEARCH_NONMOBILE
            <p class="clearfix"></p>
        </div>
        <div class="col-md-10 col-md-offset-1">
            <div class="col-sm-4 col-xs-12">
                <input type="text" class="form-control" id="AisAirNumber" maxlength="10"
                       placeholder="@L_EXISTING_MOBILE_NO" />
                <p class="clearfix"></p>
            </div>
            <p class="clearfix"></p>
        </div>
        <div class="col-md-12 title-form">
            <i class="fa fa-chevron-right tgreen"></i>
            @L_SEARCH_IDCARD
            <p class="clearfix"></p>
        </div>
        <div class="col-md-10 col-md-offset-1">
            <div class="col-sm-4 col-xs-12">
                <select id="ID_CARD_NAMEs" class="select" style="width: 100%" onchange="onChangeID_CARD_NAMEs(this);"
                        title="@lCARD_TYPE"></select>
                <p class="clearfix"></p>
            </div>
            <div class="col-sm-4 col-xs-12">
                <input type="text" class="form-control" id="L_CARD_NOs"
                       maxlength="30" placeholder="@L_EXISTING_CARD_NUMBER" />
                <p class="clearfix"></p>
            </div>
        </div>
    </div>

    <p class="clearfix"></p>
    <p class="clearfix page-header"></p>
    <div class="col-md-12 text-right" id="cvrbodybtn">

        @if (!chkCoverage && Model.StaffPrivilegeBypass_Flag.ToSafeString() != "Y")
        {
            @*<a href="/Process/Index" class="btn btn-default btn-for-xs" style="color: #8DC63F;" role="button">@B_BACK</a>*@
            <a href="javascript:void(0);" id="backPageCheckCoverage" class="btn btn-default btn-for-xs" style="color: #8DC63F;" role="button">@B_BACK</a>
        }
        <a href="javascript:void(0);" id="checkProcess"
           class="btn btn-success rippler rippler-default btn-for-xs" role="button">@B_CHECKING</a>

    </div>
    <div class="col-md-12" id="cvrbodynobtn" style="display: none">
        <a href="javascript:void(0);"
           class="btn btn-success pull-right btn-for-xs" onclick="checkProcessAisAirnet()" role="button">@B_SEARCH_NEW_CUST</a>
    </div>
    <p class="clearfix"></p>
    <p class="clearfix"></p>
</div>
<div class="modal fade" id="modal001" tabindex="-1" role="dialog" aria-labelledby="modal001_label" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header" style="border-bottom: none;">
                @*<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>*@
            </div>
            <div class="modal-body">
                <div class="add-border-rounded-green">
                    <p class="clearfix"></p>
                    <h3 id="modal001txt" class="text-center">
                        @(Html.Raw(L_THK))
                    </h3>
                    <p class="clearfix"></p>
                    <div class="col-md-12 text-center">
                        <p class="clearfix"></p>
                        @* hide button case channel im  *@
                        @if (!isChannelIM)
                        {
                            <button type="button" id="modal001btn" class="btn btn-default" data-dismiss="modal" onclick="$.modal.close();">&nbsp; @L_CLOSE001 &nbsp; </button>
                        }
                        @if (chkCoverage)
                        {
                            <button type="button" id="modal002btn" class="btn btn-default" data-dismiss="modal" onclick="$.modal.close();">&nbsp; @L_CLOSE001 &nbsp; </button>
                        }
                        <button type="button" id="modal003btn" style="display: none" class="btn btn-default" data-dismiss="modal" onclick="$.modal.close();">&nbsp; @L_CLOSE001 &nbsp; </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="border-top: none;">
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modal_close" tabindex="-1" role="dialog" aria-labelledby="modal_close_label" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header" style="border-bottom: none;">
                @*<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>*@
            </div>
            <div class="modal-body">
                <div class="add-border-rounded-green">
                    <p class="clearfix"></p>
                    <h3 id="modal_close_txt" class="text-center">
                        @(Html.Raw(L_THK))
                    </h3>
                    <p class="clearfix"></p>
                    <div class="col-md-12 text-center">
                        <p class="clearfix"></p>
                        @if (chkCoverage)
                        {
                            <button type="button" id="modal002btn" class="btn btn-default" data-dismiss="modal" onclick="$.modal.close();">&nbsp; @L_CLOSE001 &nbsp; </button>
                        }
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="border-top: none;">
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modal002" tabindex="-1" role="dialog" aria-labelledby="modal002_label">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header" style="border-bottom: none;">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body">
                <div class="add-border-rounded-green">
                    <p class="clearfix"></p>
                    <h3 class="text-center">
                        <label style="font-size: 20px;" id="lbCoveragePopup"></label>
                    </h3>
                    <p class="clearfix"></p>
                    <div class="col-md-12 text-center">
                        <p class="clearfix"></p>
                        <button type="button" class="btn btn-success" onclick="coverageConfirm(0); $.modal.close();">
                            &nbsp; @B_LEAVE_INFO &nbsp; <i class="fa fa-arrow-circle-o-right "></i>
                        </button>
                        &nbsp;&nbsp;
                        <button type="button" class="btn btn-default" data-dismiss="modal" onclick="coverageConfirm(1); $.modal.close();">&nbsp; @B_SUBSCRIBE_AIRNET &nbsp; </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="border-top: none;">
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modal-nocoverage-wttx" tabindex="-1" role="dialog" aria-labelledby="modal003_label">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header" style="border-bottom: none;">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body">
                <div class="add-border-rounded-green">
                    <p class="clearfix"></p>
                    <h3 class="text-center">
                        <label style="font-size: 20px;" id="lbCoveragePopup-WTTX"></label>
                    </h3>
                </div>
                <div class="col-md-12 text-center">
                    <p class="clearfix"></p>
                    <button type="button" class="btn btn-default" data-dismiss="modal" onclick="ctrlNoCoveragePopupWTTX(1);">&nbsp; @L_CLOSE001 &nbsp; </button>
                    &nbsp;&nbsp;
                    <button id="btnLeaveMSG" type="button" class="btn btn-success" onclick="ctrlNoCoveragePopupWTTX(2);">
                        &nbsp; @B_LEAVE_INFO &nbsp; <i class="fa fa-arrow-circle-o-right "></i>
                    </button>
                </div>
            </div>
            <div class="modal-footer" style="border-top: none;">
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="basic-modal-content" tabindex="-1" role="dialog" aria-labelledby="basic-modal-content_label">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header" style="border-bottom: none;">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body">
                <div class="add-border-rounded-green">
                    <p class="clearfix"></p>
                    <div id="LastPopupMessage">
                    </div>
                    <h3 class="text-center">
                        @B_LEAVE_INFO
                    </h3>
                    <p class="clearfix"></p>
                    <p class="clearfix"></p>
                    <div class="col-md-12 text-center">
                        <p class="clearfix"></p>
                        <button type="button" class="btn btn-success" onclick="DownloadPDF();">
                            &nbsp; @B_LEAVE_INFO &nbsp; <i class="fa fa-arrow-circle-o-right "></i>
                        </button>
                        &nbsp;&nbsp;
                        <button type="button" class="btn btn-default" data-dismiss="modal" onclick="$.modal.close();Reload();">&nbsp; @lclose &nbsp; </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="border-top: none;">
            </div>
        </div>
    </div>
</div>
<input type="hidden" id="check_modal_status" value="1" name="check_modal_status" />
<div class="modal fade" id="modal_cardreader" tabindex="-1" role="dialog" aria-labelledby="modal_cardreader_label">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header" style="border-bottom: none;">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body">
                <p class="clearfix"></p>
                <h3 class="text-center">
                    @L_USE_ADDR_CARD
                </h3>
                <p class="clearfix"></p>
                <div class="col-md-12 text-center">
                    <p class="clearfix"></p>
                    <button type="button" class="btn btn-success" onclick="setValueToAisMap();">
                        &nbsp; @B_YES&nbsp; <i class="fa fa-arrow-circle-o-right "></i>
                    </button>
                    &nbsp;&nbsp;
                    @* <button type="button" class="btn btn-default" data-dismiss="modal" onclick="closeModal();">*@
                    <button type="button" class="btn btn-default" data-dismiss="modal" onclick="$.modal.close();">
                        &nbsp; @B_NO&nbsp;
                    </button>
                </div>
            </div>
            <div class="modal-footer" style="border-top: none;">
            </div>
        </div>
    </div>
</div>

<input type="hidden" id="chkTypePass" />
<input type="hidden" id="tAisAirNumber" />
<input type="hidden" id="tL_CARD_NOs" />
<input type="hidden" id="tID_CARD_NAMEs" />
<input type="hidden" id="tDD" />
<input type="hidden" id="tMM" />
<input type="hidden" id="tYY" />
<input type="hidden" id="tCardType" />
<input type="hidden" id="tBuilding" />
<input type="hidden" id="tTitle" />
<input type="hidden" id="tMooban" />
<input type="hidden" id="tOrderRef" />
<input type="hidden" name="SffProfileLogID" id="SffProfileLogID" />
<input type="hidden" id="IsAWNProduct" />
<input type="hidden" id="ZTEAddressID" />
<input type="hidden" id="ZTEIsPartner" />
<input type="hidden" id="ZTEPartnerName" />
<input type="hidden" id="ZTEAccessModeSerializer" />
<input type="hidden" id="ZTECoverage" />
<input type="hidden" id="ZTEAccessModeFWA" />
<input type="hidden" id="ZTEPlanSite" />
<input type="hidden" id="ZTEPlanSite2" />
<input type="hidden" id="ZTEInterfaceLogID" />
<input type="hidden" id="OpenCoveragePopup" />
<input type="hidden" id="P_Region" />

<input type="hidden" id="P_addrtype" />
<input type="hidden" id="P_build_name" />
<input type="hidden" id="P_build_no" />
<input type="hidden" id="onCus_type" />

@Html.HiddenFor(a => a.CoveragePanelModel.CA_ID, new { @id = "CoveragePanelModel_CA_ID" })
@Html.HiddenFor(a => a.CoveragePanelModel.BA_ID, new { @id = "CoveragePanelModel_BA_ID" })
@Html.HiddenFor(a => a.CoveragePanelModel.SA_ID, new { @id = "CoveragePanelModel_SA_ID" })
@Html.HiddenFor(a => a.CoveragePanelModel.P_MOBILE, new { @id = "CoveragePanelModel_P_MOBILE" })
@Html.HiddenFor(a => a.CoveragePanelModel.SffProductName, new { @id = "CoveragePanelModel_SffProductName" })
@Html.HiddenFor(a => a.CoveragePanelModel.MobileSegment, new { @id = "CoveragePanelModel_MobileSegment" })
@Html.HiddenFor(a => a.CoveragePanelModel.SffServiceYear, new { @id = "CoveragePanelModel_SffServiceYear" })
@Html.HiddenFor(a => a.CoveragePanelModel.L_HAVE_FIXED_LINE, new { @id = "CoveragePanelModel_L_HAVE_FIXED_LINE" })
@Html.HiddenFor(a => a.CoveragePanelModel.BillingSystem, new { @id = "CoveragePanelModel_BillingSystem" })
@Html.HiddenFor(a => a.CoveragePanelModel.Address.AddressId, new { @id = "CoveragePanelModel_Address_AddressId" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageResult, new { @id = "CoveragePanelModel_CoverageResult" })
@Html.HiddenFor(a => a.CoveragePanelModel.OneBill, new { @id = "CoveragePanelModel_OneBill" })
@Html.HiddenFor(a => a.address_flag, new { @id = "address_flag" })
<input type="hidden" id="CoveragePanelModel__CoveragePanelModel_L_LAT2" />
<input type="hidden" id="CoveragePanelModel__CoveragePanelModel_L_LONG2" />
@Html.HiddenFor(a => a.FlowFlag, new { @id = "CoveragePanelModel_L_FLOWFLAG" })
@Html.HiddenFor(a => a.SiteCode, new { @id = "CoveragePanelModel_L_SITECODE" })

@Html.HiddenFor(a => a.CoveragePanelModel.L_CONTACT_PHONE, new { @id = "CoveragePanelModel_L_CONTACT_PHONE" })
@Html.HiddenFor(a => a.CustomerRegisterPanelModel.L_MOBILE, new { @id = "CustomerRegisterPanelModel_L_MOBILE" })
@Html.HiddenFor(a => a.CoveragePanelModel.NetworkType, new { @id = "CoveragePanelModel_NetworkType" })
@Html.HiddenFor(a => a.CustomerRegisterPanelModel.L_CARD_NO, new { @id = "CustomerRegisterPanelModel_L_CARD_NO" })
@Html.HiddenFor(a => a.CustomerRegisterPanelModel.Project_name, new { @id = "CustomerRegisterPanelModel_Project_name" })
@Html.HiddenFor(a => a.CustomerRegisterPanelModel.L_LOC_CODE, new { @id = "CustomerRegisterPanelModel_L_LOC_CODE" })
@Html.HiddenFor(a => a.CustomerRegisterPanelModel.outMobileNo, new { @id = "CustomerRegisterPanelModel_outMobileNo" })
@Html.HiddenFor(a => a.CustomerRegisterPanelModel.PartnerName, new { @id = "CustomerRegisterPanelModel_PartnerName" })
@Html.HiddenFor(a => a.CustomerRegisterPanelModel.L_ASC_CODE, new { @id = "CustomerRegisterPanelModel_L_ASC_CODE" })
@Html.HiddenFor(a => a.CustomerRegisterPanelModel.L_STAFF_ID, new { @id = "CustomerRegisterPanelModel_L_STAFF_ID" })
@Html.HiddenFor(a => a.CoverageAreaResultModel.IS_3BB_COVERAGE, new { @id = "CoverageAreaResultModel_IS_3BB_COVERAGE" })
@Html.Hidden("CoverageAreaResultModel.SPLITTER_3BB_RESERVED_LIST[0].referenceId", "")
@Html.Hidden("CoverageAreaResultModel.SPLITTER_3BB_RESERVED_LIST[0].splitterCode", "")
@Html.Hidden("CoverageAreaResultModel.SPLITTER_3BB_RESERVED_LIST[0].splitterAlias", "")
@Html.Hidden("CoverageAreaResultModel.SPLITTER_3BB_RESERVED_LIST[0].distance", "")
@Html.Hidden("CoverageAreaResultModel.SPLITTER_3BB_RESERVED_LIST[0].splitterPort", "")
@Html.Hidden("CoverageAreaResultModel.SPLITTER_3BB_RESERVED_LIST[0].splitterLatitude", "")
@Html.Hidden("CoverageAreaResultModel.SPLITTER_3BB_RESERVED_LIST[0].splitterLongitude", "")
@Html.Hidden("CoverageAreaResultModel.SPLITTER_3BB_RESERVED_LIST[0].mdfName", "")
@Html.Hidden("CoverageAreaResultModel.SPLITTER_3BB_RESERVED_LIST[0].mdfPort", "")
@Html.Hidden("CoverageAreaResultModel.SPLITTER_3BB_RESERVED_LIST[0].isHome", "")

@{int i = 0;

    if (Model != null)
    {
        if (!String.IsNullOrEmpty(Model.CoverageAreaResultModel.SPLITTER_3BB_JSON))
        {
            <div id="tempSplitter3BB">
                @Html.Hidden("CoverageAreaResultModel_SPLITTER_3BB_JSON", Model.CoverageAreaResultModel.SPLITTER_3BB_JSON)
            </div>
        }
        else
        {
            <div id="tempSplitter3BB">
                @Html.Hidden("CoverageAreaResultModel_SPLITTER_3BB_JSON", "")
            </div>
        }

        if (Model.CoverageAreaResultModel.SPLITTER_LIST != null && Model.CoverageAreaResultModel.SPLITTER_LIST.Count != 0)
        {
            <div id="tempSplitterMap">
                @foreach (var item in Model.CoverageAreaResultModel.SPLITTER_LIST)
                {
                    @Html.Hidden("CoverageAreaResultModel.SPLITTER_LIST[" + i + "].Splitter_Name", item.Splitter_Name)
                    @Html.Hidden("CoverageAreaResultModel.SPLITTER_LIST[" + i + "].Distance", item.Distance)
                    @Html.Hidden("CoverageAreaResultModel.SPLITTER_LIST[" + i + "].Distance_Type", item.Distance_Type)
                    i++;
                }
            </div>
        }
    }

}

<!---- Member ger member ----->
@Html.HiddenFor(a => a.MemberGetMemberFlag, new { @id = "MemberGetMemberFlag" })
@Html.HiddenFor(a => a.RegisterChannel, new { @id = "RegisterChannel" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.FULL_ADDRESS, new { @id = "CoverageMemberGetMember_FULL_ADDRESS" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.AddressType, new { @id = "CoverageMemberGetMember_AddressType" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.RefferenceNo, new { @id = "CoverageMemberGetMember_RefferenceNo" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.BuildingName, new { @id = "CoverageMemberGetMember_BuildingName" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.VillageName, new { @id = "CoverageMemberGetMember_VillageName" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.Province, new { @id = "CoverageMemberGetMember_Province" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.Distrinct, new { @id = "CoverageMemberGetMember_Distrinct" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.SubDistrict, new { @id = "CoverageMemberGetMember_SubDistrict" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.PostCode, new { @id = "CoverageMemberGetMember_PostCode" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.HouseNo, new { @id = "CoverageMemberGetMember_HouseNo" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.Soi, new { @id = "CoverageMemberGetMember_Soi" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.Road, new { @id = "CoverageMemberGetMember_Road" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.Language, new { @id = "CoverageMemberGetMember_Language" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.CustomerName, new { @id = "CoverageMemberGetMember_CustomerName" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.CustomerSurname, new { @id = "CoverageMemberGetMember_CustomerSurname" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.CustomerEmail, new { @id = "CoverageMemberGetMember_CustomerEmail" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.CustomerMobileNo, new { @id = "CoverageMemberGetMember_CustomerMobileNo" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.CustomerLineId, new { @id = "CoverageMemberGetMember_CustomerLineId" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.VoucherDesc, new { @id = "CoverageMemberGetMember_VoucherDesc" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.CampaignProjectName, new { @id = "CoverageMemberGetMember_CampaignProjectName" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.VoucherPin, new { @id = "CoverageMemberGetMember_VoucherPin" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.IM_ORDER, new { @id = "CoverageMemberGetMember_IM_ORDER" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.SERVICE_CASE_ID, new { @id = "CoverageMemberGetMember_SERVICE_CASE_ID" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.FLOOR, new { @id = "CoverageMemberGetMember_FLOOR" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.MOO, new { @id = "CoverageMemberGetMember_MOO" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.BUILDING_NO, new { @id = "CoverageMemberGetMember_BUILDING_NO" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.RELATE_MOBILE_NO, new { @id = "CoverageMemberGetMember_RELATE_MOBILE_NO" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.FBB_PERCENT_DISCOUNT, new { @id = "CoverageMemberGetMember_FBB_PERCENT_DISCOUNT" })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.IS_CHANNEL_IM, new { @Value = isChannelIM })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.ASSET_NUMBER, new { @Value = AssetNumber })
@Html.HiddenFor(a => a.CoveragePanelModel.CoverageMemberGetMember.CASE_ID, new { @Value = ServiceCaseId })

@Html.Hidden("EOS_CheckBindValueAddress", false)
@Html.Hidden("EOS_CheckIsCondo", false)
@Html.Hidden("EOS_AccountTitle")
@Html.Hidden("EOS_CustomerName")
@Html.Hidden("EOS_OfficeTelNo")
@Html.Hidden("EOS_AccountCat")
@Html.Hidden("EOS_AccountSubCat")
@Html.Hidden("EOS_AccountHouseNo")
@Html.Hidden("EOS_AccountSoi")
@Html.Hidden("EOS_AccountMoo")
@Html.Hidden("EOS_AccountMooban")
@Html.Hidden("EOS_AccountBuildingName")
@Html.Hidden("EOS_AccountFloor")
@Html.Hidden("EOS_AccountRoom")
@Html.Hidden("EOS_AccountStreetName")
@Html.Hidden("EOS_AccountTumbol")
@Html.Hidden("EOS_AccountAmphur")
@Html.Hidden("EOS_AccountProvince")
@Html.Hidden("EOS_AccountZipCode")
@Html.Hidden("FromCoverageFBBxEOS")

@Html.HiddenFor(a => a.CoveragePanelModel.LOCATION, new { @id = "CoveragePanelModel_LOCATION" })

@Html.Hidden("tempDslamJson")

<div id="tempDslam"></div>

<script type="text/javascript">

    @Html.JsMinify(
    @<text>
    var checkcondoFlag = false;
    var appointmentFlag = false;
    var locationPlugAndplay = true;
    var checkHavePlugAndPlayFlow = false;

    function setSelectionRange(input, selectionStart, selectionEnd) {
        if (input.setSelectionRange) {
            input.focus();
            input.setSelectionRange(selectionStart, selectionEnd);
        } else if (input.createTextRange) {
            var range = input.createTextRange();
            range.collapse(true);
            range.moveEnd('character', selectionEnd);
            range.moveStart('character', selectionStart);
            range.select();
        }
    }

    function setCaretToPos(input, pos) {
        setSelectionRange(input, pos, pos);
    }

    @*R18.11 IdCard Reader on PC*@
    window.addEventListener('unload', function (event) {
        onPageUnloadIdCARDInfoBySocketPc();
        console.log("Close _ws: ID Card Reader USB")
    });

    $(document).ready(function () {
        //LockScreen(true, "");

        loadScript("https://tags.crwdcntrl.net/c/8394/cc_af.js", function () { });

        var success = '@isSaveCommplete';
        if (success == 'True') {
            setTimeout(function () {
                PopupMessage();
                $('#basic-modal-content').modal();
            }, 200);
        }

        setTimeout(function () {
            changePageHeader(1);
        }, 5);

        $("#expandFibreMap").click(function () {
            $('#w_iframe').toggleClass('fullscreen');
        });

        $.ajax({
            type: "GET",
            url: "/WBB/GetCurrentCulture",
            dataType: "json",
            async: false,
            success: function (x) {
                $("#LanguagePage").val(x);

                //Script Adobe Analytic
                var lang = $("#LanguagePage").val() == 1 ? "th" : "en";
                digitalData.page = {
                    pageInfo: {
                        pageName: "newfibre:" + lang + ":checkCoverage",
                        site: "newfibre",
                        language: lang
                    }
                }
                console.log("page load checkCoverage : ", lang);


                return false;
            }
        });

        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
            //R18.11 IdCard Reader on PC
            $("#hdIdCardNoUserAis").val($("#CustomerRegisterPanelModel_L_CARD_NO").val())
            if ($("#hdIdCardReaderOnPcFlag").val() == "Y") {
                getIdCARDInfoBySocketPc();
            }
        }
        else {
            $("#hdIdCardNoUserAis").val($("#CustomerRegisterPanelModel_L_CARD_NO").val())
            $.ajax({
                type: "GET",
                url: "/Process/get_usedData_flag",
                dataType: "json",
                success: function (data) {
                    if (data.result == 'Y') {
                        var chk_open = sessionStorage.getItem('chk_open');
                        if (chk_open == "Y") {
                            sessionStorage.setItem('chk_open', 'N');
                            setTimeout(function () {
                                $('#modal_cardreader').modal('show');
                            }, 1100);
                        }

                    }

                }
            });

        }

        //set map role 3 for engineers line
        if ($('#TopUp').val() == "7") {
            UserMap = '3';
            if ("@isSaleManager" == "true")
                UserMap = '4';
        }
        else if ($('#TopUp').val() == "5") {
            // set map role 2 for officer line
            UserMap = '2';
            //$("#DIV_PLUG_AND_PLAY").show();
            //checkHavePlugAndPlayFlow = true;
            if ("@isSaleManager" == "true")
                UserMap = '4';
        }

        if ("@officer" != "") {
            $("#HdAddTriple").val("N");
        }

        $("#dataSFF").val("");

        if ("@Session["PopupStatus"]" == "Success") {
            $('#modal_close').modal();
            $(".simplemodal-container").addClass("modelStyleFix");
            $("#detail001").show();
        }

        if ("@ESRIflag" != "true") {
            // กรณีถ้ามาจากแมพจะไม่ fix ค่า radio
            if ("@ViewBag.Vas" != "3") {

                if (sessionStorage.getItem('firstloadCheckcount') != null && sessionStorage.getItem('firstloadCheckcount') > 0) {
                    sessionStorage.setItem('firstloadCheckcount', Number(sessionStorage.getItem('firstloadCheckcount')) + 1);

                    $("#R_BUILD").prop("checked", true);
                } else {
                    sessionStorage.setItem('firstloadCheckcount', 1);

                    if ($('#CoverageMemberGetMember_AddressType').val() === 'V') {
                        $("#R_OTHER").prop("checked", true);
                        $("#R_BUILD").prop("checked", false);
                        $("#R_MOOBAN").prop("checked", false);
                    }
                    else {
                        $("#R_BUILD").prop("checked", true);
                    }
                }
            }
        }

        //pharse new

        if ("@ViewBag.Vas" != "3") {
            getCustomerCardTypes();
            setTimeout(function () {
                if (!$("#L_CARD_NOs").val() || $("#L_CARD_NOs").val() == "null") {
                    //getProvince();
                    if ("@FromFBBxEOS" != "Y") {
                        onBuildChange();
                    }
                }
                else {
                    getBuildingBatch();
                }
            }, 100);

        } else {
            setTimeout(function () {
                getBuildingBatch();
            }, 10);
        }


        $("#CoveragePanelModel_Address_L_HOME_NUMBER_1").keypress(function () {
            hideMap();
        });

        $("#CoveragePanelModel_Address_L_SOI").keypress(function () {
            hideMap();
        });

        $("#CoveragePanelModel_Address_L_ROAD").keypress(function () {
            hideMap();
        });

        $("#CoveragePanelModel_Address_L_MOO").keypress(function () {
            hideMap();
        });

        $("#CoveragePanelModel_Address_L_FLOOR").inputmask('Regex', {
            regex: "@Input_Floor",
        });

        $('#CoveragePanelModel_Address_L_BUILD_NAME_Hied').inputmask('Regex', {
            regex: "@Input_Building",
        });


        $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").inputmask('Regex', {
            regex: "@Input_Building_No",
        });

        $("#CoveragePanelModel_Address_L_ROAD").inputmask('Regex', {
            regex: "@Input_Road",
        });

        $("#CoveragePanelModel_Address_L_SOI").inputmask('Regex', {
            regex: "@Input_Soi",
        });

        $("#CoveragePanelModel_Address_L_MOO").inputmask('Regex', {
            regex: "@Input_Moo",
        });

        $("#CoveragePanelModel_Address_L_HOME_NUMBER_1").inputmask('Regex', {
            regex: "@Input_Home_Number",
        });

        $('#CoveragePanelModel_Address_L_BUILD_NAME_Hied').bind('typeahead:select', function (ev, suggestion) {
            console.log("A " + suggestion);
            typeaheadoncomplete(suggestion);
            $("#CoveragePanelModel_Address_L_HOME_NUMBER_1").focus();
        });
        $('#CoveragePanelModel_Address_L_BUILD_NAME_Hied').bind('typeahead:change', function (ev, suggestion) {
            console.log("B " + suggestion);
            typeaheadoncomplete(suggestion);
            if (!CheckShowBuildNo) $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").show();
        });

        $("input:text.tt-hint").remove();
        if ("@ESRIflag" == "true") {
            setTimeout(function () {
                //R21.10 MOU
                var SAVEORDER_FMPA_FLAG = sessionStorage.getItem("CoveragePanelModel_SAVEORDER_FMPA_FLAG") != null ? sessionStorage.getItem("CoveragePanelModel_SAVEORDER_FMPA_FLAG"):"";
                var SAVEORDER_CVM_FLAG = sessionStorage.getItem("CoveragePanelModel_SAVEORDER_CVM_FLAG") != null ? sessionStorage.getItem("CoveragePanelModel_SAVEORDER_CVM_FLAG") : "";
                var SAVEORDER_FMC_SPECIAL_FLAG = sessionStorage.getItem("CoveragePanelModel_SAVEORDER_FMC_SPECIAL_FLAG") != null ? sessionStorage.getItem("CoveragePanelModel_SAVEORDER_FMC_SPECIAL_FLAG"):"";
                var EXISTING_MOBILE_FLAG = sessionStorage.getItem("CoveragePanelModel_EXISTING_MOBILE_FLAG") != null ? sessionStorage.getItem("CoveragePanelModel_EXISTING_MOBILE_FLAG"):"";
                var USE_INPUT_MOBILE_ONLINE_QUERY = sessionStorage.getItem("CoveragePanelModel_USE_INPUT_MOBILE_ONLINE_QUERY") != null ? sessionStorage.getItem("CoveragePanelModel_USE_INPUT_MOBILE_ONLINE_QUERY"):"";
                var SAVEORDER_MOU_FLAG = sessionStorage.getItem("CoveragePanelModel_SAVEORDER_MOU_FLAG") != null ? sessionStorage.getItem("CoveragePanelModel_SAVEORDER_MOU_FLAG"):"";
                var FIBRE_ID = sessionStorage.getItem("CustomerRegisterPanelModel_FIBRE_ID") != null ? sessionStorage.getItem("CustomerRegisterPanelModel_FIBRE_ID"):"";
                var ID_CARD_NAMEs = sessionStorage.getItem("ID_CARD_NAMEs") != null ? sessionStorage.getItem("ID_CARD_NAMEs"):"";
                var L_CARD_NOs = sessionStorage.getItem("L_CARD_NOs") != null ? sessionStorage.getItem("L_CARD_NOs"):"";
                $("#CoveragePanelModel_SAVEORDER_FMPA_FLAG").val(SAVEORDER_FMPA_FLAG);
                $("#CoveragePanelModel_SAVEORDER_CVM_FLAG").val(SAVEORDER_CVM_FLAG);
                $("#CoveragePanelModel_SAVEORDER_FMC_SPECIAL_FLAG").val(SAVEORDER_FMC_SPECIAL_FLAG);
                $("#CoveragePanelModel_EXISTING_MOBILE_FLAG").val(EXISTING_MOBILE_FLAG);
                $("#CoveragePanelModel_USE_INPUT_MOBILE_ONLINE_QUERY").val(USE_INPUT_MOBILE_ONLINE_QUERY);
                $("#CoveragePanelModel_SAVEORDER_MOU_FLAG").val(SAVEORDER_MOU_FLAG);
                $("#CustomerRegisterPanelModel_FIBRE_ID").val(FIBRE_ID);
                $("#ID_CARD_NAMEs").val(ID_CARD_NAMEs);
                $("#L_CARD_NOs").val(L_CARD_NOs);
                //-------End R21.10 MOU

                $("#HdAddTriple").val('@Model.TriplePlayFlag');
                getProvince('@Model.CoverageAreaResultModel.PROVINCE');
                onProvinceChangeNew('@Model.CoverageAreaResultModel.AUMPHUR', '@Model.CoverageAreaResultModel.PROVINCE');
                onAmphurChangeNew('@Model.CoverageAreaResultModel.AUMPHUR', '@Model.CoverageAreaResultModel.SUB_DISTRICT_NAME', '@Model.CoverageAreaResultModel.PROVINCE');
                $('#address_flag').val('@Model.address_flag');
                getZipCodeNew();
                GetP_Region();
                Get_Region();
                $('#CoveragePanelModel_Address_L_MOOBAN').val('@Model.CoverageAreaResultModel.BUILDING_NAME');
                $("#CoveragePanelModel_Address_L_HOME_NUMBER_1").val('@Model.CoverageAreaResultModel.ADDRESS_NO');
                $('#CoveragePanelModel_Address_L_FLOOR').val('@Model.CoverageAreaResultModel.FLOOR_NO');

                if ('@Model.CoverageAreaResultModel.MOO' == '0') {
                    $('#CoveragePanelModel_Address_L_MOO').val('');
                }
                else {
                    $('#CoveragePanelModel_Address_L_MOO').val('@Model.CoverageAreaResultModel.MOO');
                }

                $('#CoveragePanelModel_Address_L_SOI').val('@Model.CoverageAreaResultModel.SOI');
                $('#CoveragePanelModel_Address_L_ROAD').val('@Model.CoverageAreaResultModel.ROAD');

                $("#CoveragePanelModel_L_LAT").val('@Model.CoverageAreaResultModel.LATITUDE');
                $("#CoveragePanelModel_L_LONG").val('@Model.CoverageAreaResultModel.LONGITUDE');
                $("#CoveragePanelModel__CoveragePanelModel_L_LAT2").val('@Model.CoverageAreaResultModel.LATITUDE');
                $("#CoveragePanelModel__CoveragePanelModel_L_LONG2").val('@Model.CoverageAreaResultModel.LONGITUDE');

                if ('@Model.CallfeascheckFlag' == 'Y') { //Partner
                    //LockScreen(false);
                    $("#LanguagePage").val('@Model.CoverageAreaResultModel.LANGUAGE');
                    $("input[name=L_HAVE_FIXED_LINE]:checked").val('@Model.CoverageAreaResultModel.PHONE_FLAG');
                    $("#CoveragePanelModel_L_SITECODE").val('@Model.SiteCode');
                    $("#CoveragePanelModel_L_FLOWFLAG").val('@Model.FlowFlag');
                    checkCoverageZTE(function () {
                        if ('@Model.CoverageAreaResultModel.ADDRRESS_TYPE' == "B") {
                            $("#CoveragePanelModel_CVR_TOWER").val("");
                        }

                        if ($("#CoveragePanelModel_CoverageResult").val() == "PLAN") {

                            if ((("@ViewBag.Vas" == "" && "@SHOW_POPUP_PLANSITE_CUST" == "Y") || ("@ViewBag.Vas" != "" && "@SHOW_POPUP_PLANSITE_SSO" == "Y"))
                                && $("#OpenCoveragePopup").val() == "") {
                                openCoveragePopup($("#CoveragePanelModel_CoverageResult").val());
                            } else {
                                gotoOutOfCoverage();
                            }
                        }
                        else if ($("#CoveragePanelModel_CoverageResult").val() == "NO") {

                            if ((("@ViewBag.Vas" == "" && "@SHOW_POPUP_NOPLAN_CUST" == "Y") || ("@ViewBag.Vas" != "" && "@SHOW_POPUP_NOPLAN_SSO" == "Y"))
                                && $("#OpenCoveragePopup").val() == "") {
                                openCoveragePopup($("#CoveragePanelModel_CoverageResult").val());
                            }
                            else {
                                gotoOutOfCoverage();
                            }
                        }
                        else {
                            if ("@ViewBag.chkCoverage" == "True") {
                                InCoveragePopUp();
                            }
                        }

                        $("#CoveragePanelModel_PRODUCT_SUBTYPE").val($("#HdFunctionSubProduct").val());
                        $(".simplemodal-container").removeClass("modelStyleFix");
                        $("#tOrderRef").val("Default");
                        if ($("#chkTypePass").val() == "1" && $("#tAisAirNumber").val().substr(0, 1) == "0") {
                            insertVSMPLog();
                        }

                        insertFBSSCoverageResult();

                        if ($("#CoveragePanelModel_CoverageResult").val() == "YES") {
                            $("#page1").hide();
                            $("#page2").show();

                            // 18.9 no select Router
                            getPackageNewV2(0);
                        }

                    });
                } else { //vendor
                    //LockScreen(false);
                    $("#page1").hide();
                    $("#page2").show();
                    $("#ZTEIsPartner").val('@Model.CoverageAreaResultModel.IS_PARTNER');
                    $("#ZTEPartnerName").val('@Model.CoverageAreaResultModel.PARTNER_NAME');

                    var modelAcessESRI = [];
                    var accessModeModel = new FBSSAccessModeInfo();
                    accessModeModel.AccessMode = '@Model.CoverageAreaResultModel.ACCESS_MODE_LIST';
                    accessModeModel.InserviceDate = '';
                    modelAcessESRI.push(accessModeModel);

                    $("#ZTEAccessModeSerializer").val(JSON.stringify(modelAcessESRI));
                    $("#ZTEInterfaceLogID").val('@Model.CoverageAreaResultModel.TRANSACTION_ID');

                    $("#CoveragePanelModel_Address_ZIPCODE_ID").val('@Model.CoveragePanelModel.Address.ZIPCODE_ID');

                    $("#P_addrtype").val('@Model.CoverageAreaResultModel.ADDRRESS_TYPE');
                    $("#P_build_name").val('@Model.TempBuildnameforlistpackage');
                    $("#P_build_no").val('@Model.CoverageAreaResultModel.BUILDING_NO');
                    $('#CoveragePanelModel_Address_L_BUILD_NAME_Hied').val('@Model.CoverageAreaResultModel.BUILDING_NAME');
                    selected_building_obj.building_name = '@Model.CoverageAreaResultModel.BUILDING_NAME';
                    $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val("")

                    $("#CoveragePanelModel_Address_AddressId").val('@Model.CoverageAreaResultModel.ADDRESS_ID');
                    $("#ZTEAddressID").val('@Model.CoverageAreaResultModel.ADDRESS_ID');
                    $('#CoveragePanelModel_P_FTTX_VENDOR').val('@Model.CoverageAreaResultModel.PARTNER_NAME');
                    $('#address_flag').val('@Model.address_flag');

                    //EXCLUSIVE_3BB
                    if ('@Model.CoverageAreaResultModel.EXCLUSIVE_3BB' == 'Y')
                    {
                        $('#btnLeaveMSG').hide();
                        $('#lbCoveragePopup-WTTX').html("@Html.Raw(L_RESULT_PLAN_EXCUSIVE_3BB)");
                        $("#modal-nocoverage-wttx").modal();
                        $("#modal-nocoverage-wttx-detail").show();
                        LockScreen(false);
                    }
                    else if ('@Model.CoverageAreaResultModel.WTTX_COVERAGE_RESULT' != '') {
                        if ('@Model.CoverageAreaResultModel.WTTX_COVERAGE_RESULT' == 'YES') {
                            $('#GRID_ID').val('@Model.CoverageAreaResultModel.GRID_ID');
                            $('#WTTX_MAXBANDWITH').val('@Model.CoverageAreaResultModel.WTTX_MAXBANDWITH');
                            $('#WTTX_COVERAGE_RESULT').val('@Model.CoverageAreaResultModel.WTTX_COVERAGE_RESULT');

                            try {
                                // 18.9 no select Router
                                getPackageNewV2(0);
                            } catch (e) {
                                LockScreen(false);
                                console.log(e);
                            }
                        } else {
                            LockScreen(false);
                            openNoCoveragePopupWTTX('@Model.CoverageAreaResultModel.WTTX_COVERAGE_RESULT');
                        }
                    } else {
                        try {
                            // 18.9 no select Router
                            getPackageNewV2(0);
                        } catch (e) {
                            LockScreen(false);
                            console.log(e);
                        }
                    }

                    $(".wrapSwitchLanguage").hide();
                }
            }, 4500);
        }

        if ("@BypassESRIflag" == "true") {
            LockScreen(true, "");
            $(".wrapSwitchLanguage").hide();
            setTimeout(function () {
                if ('@Model.CoveragePanelModel.BuildingType' == 'C') {
                    $("#CoveragePanelModel_L_FLOWFLAG").val('@Html.Raw(Model.DataBypass_FlowFlag.ToSafeString())');
                    $("#L_SplitterFlagFirstTime").val('@Html.Raw(Model.DataBypass_Casecode.ToSafeString())');
                    $("#L_SplitterFlag").val('@Html.Raw(Model.DataBypass_Casecode.ToSafeString())');
                    $("#checkShowtimeslotCaseDslam").val('@Html.Raw(Model.DataBypass_ShowTimeSlot.ToSafeString())');
                    $("#messageNotShowtimeslot").val('@Html.Raw(Model.DataBypass_CasecodeMessage.ToSafeString())');
                    getProvince('@Model.CoverageAreaResultModel.PROVINCE');
                    onProvinceChangeNew('@Model.CoverageAreaResultModel.AUMPHUR', '@Model.CoverageAreaResultModel.PROVINCE');
                    onAmphurChangeNew('@Model.CoverageAreaResultModel.AUMPHUR', '@Model.CoverageAreaResultModel.SUB_DISTRICT_NAME', '@Model.CoverageAreaResultModel.PROVINCE');
                    $('#address_flag').val('@Model.address_flag');
                    getZipCodeNew();
                    GetP_Region();
                    Get_Region();
                    $('#CoveragePanelModel_Address_L_MOOBAN').val('@Model.CoverageAreaResultModel.BUILDING_NAME');
                    $("#CoveragePanelModel_Address_L_HOME_NUMBER_1").val('@Model.CoverageAreaResultModel.ADDRESS_NO');
                    $('#CoveragePanelModel_Address_L_FLOOR').val('@Model.CoverageAreaResultModel.FLOOR_NO');

                    if ('@Model.CoverageAreaResultModel.MOO' == '0') {
                        $('#CoveragePanelModel_Address_L_MOO').val('');
                    }
                    else {
                        $('#CoveragePanelModel_Address_L_MOO').val('@Model.CoverageAreaResultModel.MOO');
                    }

                    $('#CoveragePanelModel_Address_L_SOI').val('@Model.CoverageAreaResultModel.SOI');
                    $('#CoveragePanelModel_Address_L_ROAD').val('@Model.CoverageAreaResultModel.ROAD');

                    $("#page1").hide();
                    $("#page2").show();
                    $("#ZTEIsPartner").val('@Model.CoverageAreaResultModel.IS_PARTNER');
                    $("#ZTEPartnerName").val('@Model.CoverageAreaResultModel.PARTNER_NAME');

                    $("#ZTEAccessModeSerializer").val('@Html.Raw(Model.CoverageAreaResultModel.ACCESS_MODE_LIST)');
                    $("#ZTEInterfaceLogID").val('@Model.CoverageAreaResultModel.TRANSACTION_ID');

                    $("#CoveragePanelModel_Address_ZIPCODE_ID").val('@Model.CoveragePanelModel.Address.ZIPCODE_ID');

                    $("#P_addrtype").val('@Model.CoverageAreaResultModel.ADDRRESS_TYPE');
                    $("#P_build_name").val('@Model.DataBypass_BuildName');
                    $("#P_build_no").val('@Model.CoverageAreaResultModel.BUILDING_NO');
                    $('#CoveragePanelModel_Address_L_BUILD_NAME_Hied').val('@Model.CoverageAreaResultModel.BUILDING_NAME');
                    selected_building_obj.building_name = '@Model.CoverageAreaResultModel.BUILDING_NAME';
                    $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val("")

                    $("#CoveragePanelModel_Address_AddressId").val('@Model.CoverageAreaResultModel.ADDRESS_ID');
                    $("#ZTEAddressID").val('@Model.CoverageAreaResultModel.ADDRESS_ID');
                    $('#CoveragePanelModel_P_FTTX_VENDOR').val('@Model.CoverageAreaResultModel.PARTNER_NAME');
                    $('#address_flag').val('@Model.address_flag');
                    $("#CoveragePanelModel_Address_L_ZIPCODE").val('@Model.CoveragePanelModel.Address.L_ZIPCODE');

                    try {
                        getPackageNewV2(0);

                    } catch (e) {
                        LockScreen(false);
                        console.log(e);
                    }

                }
                else {
                    $("#HdAddTriple").val('@Model.TriplePlayFlag');
                    getProvince('@Model.CoverageAreaResultModel.PROVINCE');
                    onProvinceChangeNew('@Model.CoverageAreaResultModel.AUMPHUR', '@Model.CoverageAreaResultModel.PROVINCE');
                    onAmphurChangeNew('@Model.CoverageAreaResultModel.AUMPHUR', '@Model.CoverageAreaResultModel.SUB_DISTRICT_NAME', '@Model.CoverageAreaResultModel.PROVINCE');
                    $('#address_flag').val('@Model.address_flag');
                    getZipCodeNew();
                    GetP_Region();
                    Get_Region();
                    $('#CoveragePanelModel_Address_L_MOOBAN').val('@Model.CoverageAreaResultModel.BUILDING_NAME');
                    $("#CoveragePanelModel_Address_L_HOME_NUMBER_1").val('@Model.CoverageAreaResultModel.ADDRESS_NO');
                    $('#CoveragePanelModel_Address_L_FLOOR').val('@Model.CoverageAreaResultModel.FLOOR_NO');

                    if ('@Model.CoverageAreaResultModel.MOO' == '0') {
                        $('#CoveragePanelModel_Address_L_MOO').val('');
                    }
                    else {
                        $('#CoveragePanelModel_Address_L_MOO').val('@Model.CoverageAreaResultModel.MOO');
                    }

                    $('#CoveragePanelModel_Address_L_SOI').val('@Model.CoverageAreaResultModel.SOI');
                    $('#CoveragePanelModel_Address_L_ROAD').val('@Model.CoverageAreaResultModel.ROAD');

                    $("#CoveragePanelModel_L_LAT").val('@Model.CoverageAreaResultModel.LATITUDE');
                    $("#CoveragePanelModel_L_LONG").val('@Model.CoverageAreaResultModel.LONGITUDE');
                    $("#CoveragePanelModel__CoveragePanelModel_L_LAT2").val('@Model.CoverageAreaResultModel.LATITUDE');
                    $("#CoveragePanelModel__CoveragePanelModel_L_LONG2").val('@Model.CoverageAreaResultModel.LONGITUDE');

                    if ('@Model.CallfeascheckFlag' == 'Y') { //Partner
                        $("#LanguagePage").val('@Model.CoverageAreaResultModel.LANGUAGE');
                        $("input[name=L_HAVE_FIXED_LINE]:checked").val('@Model.CoverageAreaResultModel.PHONE_FLAG');
                        $("#CoveragePanelModel_L_SITECODE").val('@Model.SiteCode');
                        $("#CoveragePanelModel_L_FLOWFLAG").val('@Model.FlowFlag');
                        checkCoverageZTE(function () {
                            if ('@Model.CoverageAreaResultModel.ADDRRESS_TYPE' == "B") {
                                $("#CoveragePanelModel_CVR_TOWER").val("");
                            }

                            if ($("#CoveragePanelModel_CoverageResult").val() == "PLAN") {

                                if ((("@ViewBag.Vas" == "" && "@SHOW_POPUP_PLANSITE_CUST" == "Y") || ("@ViewBag.Vas" != "" && "@SHOW_POPUP_PLANSITE_SSO" == "Y"))
                                    && $("#OpenCoveragePopup").val() == "") {
                                    openCoveragePopup($("#CoveragePanelModel_CoverageResult").val());
                                } else {
                                    gotoOutOfCoverage();
                                }
                            }
                            else if ($("#CoveragePanelModel_CoverageResult").val() == "NO") {

                                if ((("@ViewBag.Vas" == "" && "@SHOW_POPUP_NOPLAN_CUST" == "Y") || ("@ViewBag.Vas" != "" && "@SHOW_POPUP_NOPLAN_SSO" == "Y"))
                                    && $("#OpenCoveragePopup").val() == "") {
                                    openCoveragePopup($("#CoveragePanelModel_CoverageResult").val());
                                }
                                else {
                                    gotoOutOfCoverage();
                                }
                            }
                            else {
                                if ("@ViewBag.chkCoverage" == "True") {
                                    InCoveragePopUp();
                                }
                            }

                            $("#CoveragePanelModel_PRODUCT_SUBTYPE").val($("#HdFunctionSubProduct").val());
                            $(".simplemodal-container").removeClass("modelStyleFix");
                            $("#tOrderRef").val("Default");
                            if ($("#chkTypePass").val() == "1" && $("#tAisAirNumber").val().substr(0, 1) == "0") {
                                insertVSMPLog();
                            }

                            insertFBSSCoverageResult();

                            if ($("#CoveragePanelModel_CoverageResult").val() == "YES") {
                                $("#page1").hide();
                                $("#page2").show();

                                // 18.9 no select Router
                                getPackageNewV2(0);
                            }

                        });
                    } else { //vendor
                        $("#page1").hide();
                        $("#page2").show();
                        $("#ZTEIsPartner").val('@Model.CoverageAreaResultModel.IS_PARTNER');
                        $("#ZTEPartnerName").val('@Model.CoverageAreaResultModel.PARTNER_NAME');

                        var modelAcessESRI = [];
                        var accessModeModel = new FBSSAccessModeInfo();
                        accessModeModel.AccessMode = '@Html.Raw(Model.CoverageAreaResultModel.ACCESS_MODE_LIST)';
                        accessModeModel.InserviceDate = '';
                        modelAcessESRI.push(accessModeModel);

                        $("#ZTEAccessModeSerializer").val(JSON.stringify(modelAcessESRI));
                        $("#ZTEInterfaceLogID").val('@Model.CoverageAreaResultModel.TRANSACTION_ID');

                        $("#CoveragePanelModel_Address_ZIPCODE_ID").val('@Model.CoveragePanelModel.Address.ZIPCODE_ID');

                        $("#P_addrtype").val('@Model.CoverageAreaResultModel.ADDRRESS_TYPE');
                        $("#P_build_name").val('@Model.TempBuildnameforlistpackage');
                        $("#P_build_no").val('@Model.CoverageAreaResultModel.BUILDING_NO');
                        $('#CoveragePanelModel_Address_L_BUILD_NAME_Hied').val('@Model.CoverageAreaResultModel.BUILDING_NAME');
                        selected_building_obj.building_name = '@Model.CoverageAreaResultModel.BUILDING_NAME';
                        $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val("");

                        $("#CoveragePanelModel_Address_AddressId").val('@Model.CoverageAreaResultModel.ADDRESS_ID');
                        $("#ZTEAddressID").val('@Model.CoverageAreaResultModel.ADDRESS_ID');
                        $('#CoveragePanelModel_P_FTTX_VENDOR').val('@Model.CoverageAreaResultModel.PARTNER_NAME');
                        $('#address_flag').val('@Model.address_flag');

                        //EXCLUSIVE_3BB
                        if ('@Model.CoverageAreaResultModel.EXCLUSIVE_3BB' == 'Y')
                        {
                            $('#btnLeaveMSG').hide();
                            $('#lbCoveragePopup-WTTX').html("@Html.Raw(L_RESULT_PLAN_EXCUSIVE_3BB)");
                            $("#modal-nocoverage-wttx").modal();
                            $("#modal-nocoverage-wttx-detail").show();
                            LockScreen(false);
                        }
                        else if ('@Model.CoverageAreaResultModel.GRID_ID' != '') {
                            if ('@Model.CoverageAreaResultModel.WTTX_COVERAGE_RESULT' == 'YES') {
                                $('#GRID_ID').val('@Model.CoverageAreaResultModel.GRID_ID');
                                $('#WTTX_MAXBANDWITH').val('@Model.CoverageAreaResultModel.WTTX_MAXBANDWITH');
                                $('#WTTX_COVERAGE_RESULT').val('@Model.CoverageAreaResultModel.WTTX_COVERAGE_RESULT');

                                try {
                                    // 18.9 no select Router
                                    getPackageNewV2(0);
                                } catch (e) {
                                    LockScreen(false);
                                    console.log(e);
                                }
                            } else {
                                LockScreen(false);
                                openNoCoveragePopupWTTX('@Model.CoverageAreaResultModel.WTTX_COVERAGE_RESULT');
                            }
                        } else {
                            try {
                                // 18.9 no select Router
                                getPackageNewV2(0);
                            } catch (e) {
                                LockScreen(false);
                                console.log(e);
                            }
                        }
                    }
                }
            }, 4500);
        }

        if ("@FromFBBxEOS" == "Y" && "@ESRIflag" != "true") {
            $(".wrapSwitchLanguage").hide();
            if (!evAMQueryCustomerProfileByTaxId()) {
                QueryDBDProfile();
                onBuildChange();
            }
            else {
                if ($("#EOS_CheckIsCondo").val() == "true") {
                    $("#R_BUILD").prop("checked", true)
                    onBuildChange();
                    getProvince($('#EOS_AccountProvince').val());
                    onProvinceChangeNew($('#EOS_AccountAmphur').val(), $('#EOS_AccountProvince').val());
                    onAmphurChangeNew($('#EOS_AccountAmphur').val(), $('#EOS_AccountTumbol').val(), $('#EOS_AccountProvince').val());
                    getZipCodeNew();
                    GetP_Region();
                    Get_Region();
                    $('#CoveragePanelModel_Address_L_MOOBAN').val($('#EOS_AccountBuildingName').val());
                    $("#CoveragePanelModel_Address_L_HOME_NUMBER_1").val($('#EOS_AccountHouseNo').val());
                    $('#CoveragePanelModel_Address_L_FLOOR').val($('#EOS_AccountFloor').val());

                    if ($("#EOS_AccountMoo").val() == '0') {
                        $('#CoveragePanelModel_Address_L_MOO').val('');
                    }
                    else {
                        $('#CoveragePanelModel_Address_L_MOO').val($("#EOS_AccountMoo").val());
                    }
                    $('#CoveragePanelModel_Address_L_SOI').val($('#EOS_AccountSoi').val());
                    $('#CoveragePanelModel_Address_L_ROAD').val($('#EOS_AccountStreetName').val());
                    $("#CoveragePanelModel_Address_ZIPCODE_ID").val($('#EOS_AccountZipCode').val());
                    $('#CoveragePanelModel_Address_L_BUILD_NAME_Hied').val($('#EOS_AccountBuildingName').val());
                    selected_building_obj.building_name = $('#EOS_AccountBuildingName').val();
                    $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val("");
                    $("#EOS_CheckBindValueAddress").val(true);
                }
                else {
                    // ByPassSME Use Map
                    $("#R_OTHER").prop("checked", true);
                    $("#EOS_CheckBindValueAddress").val(true);
                    onBuildChange();
                }
            }
        }

        if ("@Model.PlugAndPlayFlow" == "") {
            $("#NORMAL_FLOW").attr("checked", "");
            $("#PLUG_AND_PLAY_FLOW").attr("disabled", "");
            locationPlugAndplay = false;
        }

        $("input[name*='L_CHECK_PLUG_AND_PLAY_FLOW']").click(function () {
            if (locationPlugAndplay) {
                if ($("#PLUG_AND_PLAY_FLOW:checked").length > 0 && appointmentFlag) {
                    $("#L_REMARK_BUILDING_IN_LIST").hide();
                    $("#L_REMARK_TIMESLOT_FULL").hide();

                    $("#L_REMARK_PLUG_AND_PLAY").show();
                    $("#PlugAndPlayFlow").val($("input[name*='L_CHECK_PLUG_AND_PLAY_FLOW']:checked").val());
                }
                else if ($("#NORMAL_FLOW:checked").length > 0 && checkcondoFlag && !appointmentFlag) {
                    $("#L_REMARK_BUILDING_IN_LIST").hide();
                    $("#L_REMARK_PLUG_AND_PLAY").hide();

                    $("#L_REMARK_TIMESLOT_FULL").show();
                    $("#PlugAndPlayFlow").val($("input[name*='L_CHECK_PLUG_AND_PLAY_FLOW']:checked").val());
                }
                else if ($("#NORMAL_FLOW:checked").length > 0 && !checkcondoFlag && !appointmentFlag) {
                    $("#L_REMARK_PLUG_AND_PLAY").hide();
                    $("#L_REMARK_TIMESLOT_FULL").hide();


                    $("#L_REMARK_BUILDING_IN_LIST").show();
                    $("#PlugAndPlayFlow").val($("input[name*='L_CHECK_PLUG_AND_PLAY_FLOW']:checked").val());
                }
                else {

                    $("#L_REMARK_BUILDING_IN_LIST").hide();
                    $("#L_REMARK_PLUG_AND_PLAY").hide();
                    $("#L_REMARK_TIMESLOT_FULL").hide();

                    $("#PlugAndPlayFlow").val($("input[name*='L_CHECK_PLUG_AND_PLAY_FLOW']:checked").val());
                }
            }
            //PLUG_AND_PLAY_FLOW
            //NORMAL_FLOW



        });
        if (sessionStorage.getItem("ShowRental") == "true") {
            $("#divrental").show();
        }
        else {
            $("#divrental").hide();
            sessionStorage.setItem("rentalflag", "N");
        }

        //LockScreen(false);
        //20.4 service level
        setTimeout(function () {
            displayServiceLevel_Checkcoverage();
        }, 0);
    });

    function displayServiceLevel_Checkcoverage() {
        //console.log("Model.TopUp","@Model.TopUp")
        if ("@Model.TopUp" == "5") {
            var action = $('#ServiceLevel_Action').val();
            //console.log("action", action)
            if (action == 1 || action == 2 || action == 3) {
                if ($("#ServiceLevel").val() == '@SERVICE_LEVEL_H') {
                    $(".valueServiceLevel").text('@DISPLAY_SERVICE_LEVEL_H');
                } else if ($("#ServiceLevel").val() == '@SERVICE_LEVEL_M') {
                    $(".valueServiceLevel").text('@DISPLAY_SERVICE_LEVEL_M');
                } else if ($("#ServiceLevel").val() == '@SERVICE_LEVEL_L') {
                    $(".valueServiceLevel").text('@DISPLAY_SERVICE_LEVEL_L');
                } else {
                    $(".valueServiceLevel").text('@DISPLAY_SERVICE_LEVEL_L');
                }
                $(".divServiceLevel").show();
            }
        }
    }
    </text>)
</script>

<script type="text/javascript">
   @Html.JsMinify(
    @<text>
    if ('@ViewBag.Vas' != "") {

    }
    if ('@Model.TopUp' == "7") {
        $('#btnCusAis').show();
        $('#btnCusNew').show();
    }
    else if ('@ViewBag.Vas' == "6") {
        sessionStorage.setItem("vas_flag", "6")
        $('#btnCusAis').show();
        $('#btnCusNew').show();
    }
    else {
        $('#btnCusAis').hide();
        $('#btnCusNew').hide();
    }

    var UserMap = '1';
    @*if ("@ViewBag.chkCoverage" == "True") {
        UserMap = '5';
    }*@


    if ("@ViewBag.Vas" == "3") {
        $(".wrapSwitchLanguage").hide();
        bindTriple();
    }
    else if ("@officer" != "") {
        $(".wrapSwitchLanguage").hide();
    }
    else if ("@ViewBag.Vas" == "6") {
        $("#HdAddTriple").val('N');
    }

    function onCustype(type) {
        if (type == "NEW") {
            sessionStorage.setItem("type", "NEW");

            location.reload();
            if ($("#chkTypePass").val() != "1") {
                resetBody();
            }
            $("#cvrbody").show();
            $("#cvrbodybtn").show();
            $("#cvrbodyno").hide();
            $("#cvrbodynobtn").hide();
            $("#btnCusAis").removeClass('btn-success').addClass('btn-default');
            $("#btnCusNew").addClass('btn-success');

        }
        else {

            sessionStorage.setItem("type", "AIS");

            $("#AisAirNumber").removeClass("form-control errorinput");
            $("#L_CARD_NOs").removeClass("form-control errorinput");
            $("#AisAirNumber").addClass("form-control");
            $("#L_CARD_NOs").addClass("form-control");

            $("#cvrbodyno").show();
            $("#cvrbodynobtn").show();
            $("#cvrbody").hide();
            $("#cvrbodybtn").hide();
            $("#btnCusNew").removeClass('btn-success').addClass('btn-default');
            $("#btnCusAis").addClass('btn-success');

            if ($("#chkTypePass").val() != "1") {
                $("#AisAirNumber").val("");
                getCustomerCardTypes();
                $("#L_CARD_NOs").val("");
            }
        }
    }

    function resetBody() {
        resetOrDefault();
        $("#COVERAGE_L_PROVINCE option[value='']").attr("selected", "selected");
        $("#COVERAGE_L_AMPHUR option[value='']").attr("selected", "selected");
        $("#COVERAGE_L_TUMBOL option[value='']").attr("selected", "selected");
    }

    function getMonthTH(m) {
        var mm = ["มกราคม", "กุมภาพันธ์", "มีนาคม", "เมษายน", "พฤษภาคม", "มิถุนายน", "กรกฏาคม", "สิงหาคม", "กันยายน", "ตุลาคม", "พฤศจิกายน", "ธันวาคม"];
        return mm[m - 1];
    }

    function getMonthEN(m) {
        var mm = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
        return mm[m - 1];
    }

    function gotoOutOfCoverage() {
        $("#page1").hide();
        AddDetail();
        loadAddress("@L_HOME_NUMBER_1", "@L_BUILD_NO", "@L_FLOOR", "@L_MOO", "@L_SOI", "@L_ROAD", "@L_TUMBOL", "@L_AMPHUR", "@L_PROVINCE", "@L_ZIPCODE");
        $("#page12").show();
        $(".wrapSwitchLanguage").hide();
        LockScreen(false);
    }

    function openCoveragePopup(coverage) {
        var ztePlanSite = $("#ZTEPlanSite2").val().split(',');
        var psAccessMode = ztePlanSite[0];
        var psDate = ztePlanSite[1];

        $("#modal002").modal();
        $("#modal002-detail").show();
        var div1 = $("#simplemodal-container");
        div1.css('width', '650px');

        if (coverage == "NO" || psAccessMode == "FWA") {
            div1.css('height', '255px');
            $("#lbCoveragePopup").html("@Html.Raw(L_RESULT_NOPLAN)");
        }
        else {
            var planDate = convertToJsDate(psDate);
            if ($("#LanguagePage").val() == "1") {
                var m = planDate.dateFormat("m");
                var yy = (planDate.dateFormat("Y") + 543);
                var mm = getMonthTH(m);
            }
            else {
                var yy = (planDate.dateFormat("Y"));
                var m = planDate.dateFormat("m");
                var mm = getMonthEN(m);
            }
            var replaceDate = mm + " " + yy;
            div1.css('height', '280px');
            var context = "@Html.Raw(L_RESULT_PLANSITE)".replace("{1}", replaceDate);
            $("#lbCoveragePopup").html(context);
        }
    }

    //20.2 : WTTx
    function openNoCoveragePopupWTTX(coverage) {
        @*if (coverage == "NO") {
            $('#lbCoveragePopup-WTTX').html("@Html.Raw(L_RESULT_NOPLAN_WTTX)");
        } else if (coverage == "FULL") {
            $('#lbCoveragePopup-WTTX').html("@Html.Raw(L_RESULT_NOPLAN_WTTX)");
        }*@
        $('#lbCoveragePopup-WTTX').html("@Html.Raw(L_RESULT_NOPLAN_WTTX)");
        $("#modal-nocoverage-wttx").modal();
        $("#modal-nocoverage-wttx-detail").show();
    }
    function ctrlNoCoveragePopupWTTX(button) {
        if (button == 1) {
            backPage002();

        } else {
            window.location.href = "/Leavemessage/Index/?locationWTTX=" + $("#CoveragePanelModel_L_LAT").val() + "," + $("#CoveragePanelModel_L_LONG").val() + "&WTTxFull=true";
        }
        $.modal.close();
    }

    function coverageConfirm(c) {
        if (c == 1) {
            showMap();
            clearLatLong();
            searchPlace();
        }
        else {
            gotoOutOfCoverage();
        }
    }

    function hideMap() {
        $("#BM1").hide();
        $("#Map").hide();
        $("#OpenCoveragePopup").val("");
    }

    function showMap() {

        $("#BM1").show();
        $("#Map").show();
        $("#OpenCoveragePopup").val("1");
    }

    var selected_building_obj = sgst_selected_building_obj = "";
    function clear_building_ogj() {
        selected_building_obj = sgst_selected_building_obj = {
            "address_id": "",
            "amphur": "",
            "building_name": "",
            "building_name_for_srh": "",
            "lang": "",
            "province": "",
            "sitecode": "",
            "tumbon": "",
            "zipcode": "",
            "zipcode_rowid": ""
        };
    };
    clear_building_ogj();

    function typeaheadoncomplete(suggestion, round, builono) {
        console.log("typeaheadoncomplete(" + suggestion + ", " + round + ", " + builono + ")");
        if (sgst_selected_building_obj.building_name === suggestion) {

            return false;
        }

        buildnos = [];
        var lang = "T";
        if ($("#LanguagePage").val() == "2")
            lang = "E";

        var addrType = $('input[name=R_BUILD]:checked').val();
        var selected_building = '';
        var addressid = addressIdMathced(suggestion);
        var pro = '';
        var aum = '';
        var tum = '';
        var zipcode = '';
        var sitecode = '';
        var latitude = '';
        var longtitude = '';

        $("#CoveragePanelModel_L_LAT").val("");
        $("#CoveragePanelModel_L_LONG").val("");
        $("#CoveragePanelModel__CoveragePanelModel_L_LAT2").val("");
        $("#CoveragePanelModel__CoveragePanelModel_L_LONG2").val("");

        selected_building = $.grep(buildings, function (e) {
            return (e.address_id == addressid && e.lang == lang);
        });

        sgst_selected_building = $.grep(buildings, function (e) {
            return (e.building_name_for_srh == suggestion);
        });

        if (suggestion) {
            if (addressid && selected_building.length > 0) {
                CheckVillCoverage = true;
                CheckBuildCoverage = true;
                CheckShowBuildNo = true;

                selected_building_obj = selected_building[0];
                sgst_selected_building_obj = sgst_selected_building[0];

                pro = selected_building[0].province;
                aum = selected_building[0].amphur;
                tum = selected_building[0].tumbon;
                zipcode = selected_building[0].zipcode;
                sitecode = selected_building[0].sitecode;
                latitude = selected_building[0].latitude;
                longtitude = selected_building[0].longtitude;

                getProvince(pro);
                onProvinceChangeNew(aum, pro);
                onAmphurChangeNew(aum, tum, pro);
                getZipCodeNew();
                onZipCodeChangeByBuildingName(selected_building[0].zipcode_rowid);

                getBuildingNoBatch(selected_building[0].zipcode_rowid, selected_building_obj.building_name, builono);
                $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").hide();
                $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val("");
                $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").typeahead('val', sgst_selected_building_obj.building_name);
                $("#CoveragePanelModel_Address_L_ZIPCODE").attr("disabled", "disabled");

                if ($('#TopUp').val() == "5" && locationPlugAndplay) {
                    CheckCondo(selected_building[0].address_id, selected_building[0].AccessMode);
                }

                $("#CoveragePanelModel_L_LAT").val(latitude);
                $("#CoveragePanelModel_L_LONG").val(longtitude);
                $("#CoveragePanelModel__CoveragePanelModel_L_LAT2").val(latitude);
                $("#CoveragePanelModel__CoveragePanelModel_L_LONG2").val(longtitude);
            }
            else {
                handleSuggestionNotMatched();
                $("#CoveragePanelModel_Address_L_ZIPCODE").removeAttr("disabled");
            }
        }
        else {
            clear_building_ogj();
            CheckBuildCoverage = false;
            CheckShowBuildNo = true;
            $("#DIV_D_L_BUILD_NO").show();
            var strBuilder = '<option value="">' + '@L_BUILD_NO' + '</option>';
            $("#L_BUILD_NO").empty();
            $("#L_BUILD_NO").append(strBuilder);
            $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").hide();
            $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val("");
            $("#CoveragePanelModel_Address_L_ZIPCODE").removeAttr("disabled");
        }

        $('#COVERAGE_L_PROVINCE').select2();
        $('#COVERAGE_L_AMPHUR').select2();
        $('#COVERAGE_L_TUMBOL').select2();
        $("#L_BUILD_NO").select2();
        if ($("#CoverageMemberGetMember_IM_ORDER").val().toLowerCase() == "true") {
            SetDataDefault()
        }
        return false;
    };

    function SetDataDefault() {
        $('#CoveragePanelModel_Address_L_FLOOR').val($('#CoverageMemberGetMember_FLOOR').val());
        $('#CoveragePanelModel_Address_L_MOO').val($('#CoverageMemberGetMember_MOO').val());
        $('#CoveragePanelModel_Address_L_HOME_NUMBER_1').val($('#CoverageMemberGetMember_HouseNo').val());
        $('#CoveragePanelModel_Address_L_SOI').val($('#CoverageMemberGetMember_Soi').val());
        $('#CoveragePanelModel_Address_L_ROAD').val($('#CoverageMemberGetMember_Road').val());
        $('#CoveragePanelModel_Address_L_BUILD_NAME_Hied').val($('#CoverageMemberGetMember_BuildingName').val());
        $('#CoveragePanelModel_Address_L_BUILD_NO_Hied').val($('#CoverageMemberGetMember_BUILDING_NO').val());
        $('#L_BUILD_NO').val($('#CoverageMemberGetMember_BUILDING_NO').val()).trigger('change');
    }

    function typeaheadoncompleteMembergetmember(suggestion, round, builono) {
        console.log("typeaheadoncompleteMembergetmember(" + suggestion + ", " + round + ", " + builono + ")");
        if (sgst_selected_building_obj.building_name === suggestion) {

            return false;
        }

        buildnos = [];
        var selected_building = '';
        var buildingNameSearch = '';
        var buildingSuggestSearch = null;
        var addressid = null;
        var pro = '';
        var aum = '';
        var tum = '';
        var zipcode = '';
        var sitecode = '';
        var latitude = '';
        var longtitude = '';

        $("#CoveragePanelModel_L_LAT").val("");
        $("#CoveragePanelModel_L_LONG").val("");
        $("#CoveragePanelModel__CoveragePanelModel_L_LAT2").val("");
        $("#CoveragePanelModel__CoveragePanelModel_L_LONG2").val("");

        //============ case MGM By pass =================
        var lang = $('#CoverageMemberGetMember_Language').val();
        var pTumbon = $('#CoverageMemberGetMember_SubDistrict').val();
        var pAmphur = $('#CoverageMemberGetMember_Distrinct').val();
        var pProvince = $('#CoverageMemberGetMember_Province').val();
        var pZipcode = $('#CoverageMemberGetMember_PostCode').val();

        var mgmSelectBuilding = $.grep(buildings, function (e) {
            return (e.lang == lang && e.tumbon == pTumbon && e.amphur == pAmphur && e.province == pProvince && e.zipcode == pZipcode && e.building_name == suggestion);
        });

        if (mgmSelectBuilding == null || mgmSelectBuilding.length == 0) {
            mgmSelectBuilding = $.grep(buildings, function (e) {
                return (e.lang == lang && e.tumbon == pTumbon && e.amphur == pAmphur && e.province == pProvince && e.zipcode == pZipcode);
            });

            buildingSuggestSearch = $.grep(mgmSelectBuilding, function (e) {
                return (e.building_name == suggestion);
            });
            buildingNameSearch = suggestion;
        } else {
            buildingSuggestSearch = mgmSelectBuilding;
        }

        if (mgmSelectBuilding[0] != null && buildingSuggestSearch != null && buildingSuggestSearch.length > 0) {
            var mgmSelectBuilding2 = $.grep(buildings, function (e) {
                return (e.building_name_for_srh == mgmSelectBuilding[0].building_name_for_srh);
            });

            if (mgmSelectBuilding2[0] != null) {
                addressid = mgmSelectBuilding[0].address_id;
            }
            selected_building = mgmSelectBuilding;
            sgst_selected_building = mgmSelectBuilding2;
        }
        //==============================================


        if (suggestion) {
            if (addressid && selected_building.length > 0 && buildingSuggestSearch.length > 0) {
                CheckVillCoverage = true;
                CheckBuildCoverage = true;
                CheckShowBuildNo = true;

                selected_building_obj = selected_building[0];
                sgst_selected_building_obj = sgst_selected_building[0];

                pro = selected_building[0].province;
                aum = selected_building[0].amphur;
                tum = selected_building[0].tumbon;
                zipcode = selected_building[0].zipcode;
                sitecode = selected_building[0].sitecode;
                latitude = selected_building[0].latitude;
                longtitude = selected_building[0].longtitude;

                getProvince(pro);
                onProvinceChangeNew(aum, pro);
                onAmphurChangeNew(aum, tum, pro);
                getZipCodeNew();
                onZipCodeChangeByBuildingName(selected_building[0].zipcode_rowid);
                if (buildingNameSearch != '') {
                    getBuildingNoBatch(selected_building[0].zipcode_rowid, buildingNameSearch, builono);
                    $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").hide();
                    $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val("");
                    $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").typeahead('val', buildingNameSearch);
                    $("#CoveragePanelModel_Address_L_ZIPCODE").attr("disabled", "disabled");
                } else {
                    getBuildingNoBatch(selected_building[0].zipcode_rowid, selected_building_obj.building_name, builono);
                    $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").hide();
                    $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val("");
                    $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").typeahead('val', sgst_selected_building_obj.building_name);
                    $("#CoveragePanelModel_Address_L_ZIPCODE").attr("disabled", "disabled");
                }

                if ($('#TopUp').val() == "5" && locationPlugAndplay) {
                    CheckCondo(selected_building[0].address_id, selected_building[0].AccessMode);
                }

                $("#CoveragePanelModel_L_LAT").val(latitude);
                $("#CoveragePanelModel_L_LONG").val(longtitude);
                $("#CoveragePanelModel__CoveragePanelModel_L_LAT2").val(latitude);
                $("#CoveragePanelModel__CoveragePanelModel_L_LONG2").val(longtitude);
            }
            else {
                if (mgmSelectBuilding != null && mgmSelectBuilding.length > 0) {
                    pro = mgmSelectBuilding[0].province;
                    aum = mgmSelectBuilding[0].amphur;
                    tum = mgmSelectBuilding[0].tumbon;
                    zipcode = mgmSelectBuilding[0].zipcode;
                    sitecode = mgmSelectBuilding[0].sitecode;

                    getProvince(pro);
                    onProvinceChangeNew(aum, pro);
                    onAmphurChangeNew(aum, tum, pro);
                    getZipCodeNew();
                    onZipCodeChangeByBuildingName(mgmSelectBuilding[0].zipcode_rowid);
                }

                handleSuggestionNotMatched();
                $("#CoveragePanelModel_Address_L_ZIPCODE").removeAttr("disabled");
            }
        }
        else {
            clear_building_ogj();
            CheckBuildCoverage = false;
            CheckShowBuildNo = true;
            $("#DIV_D_L_BUILD_NO").show();
            var strBuilder = '<option value="">' + '@L_BUILD_NO' + '</option>';
            $("#L_BUILD_NO").empty();
            $("#L_BUILD_NO").append(strBuilder);
            $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").hide();
            $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val("");
            $("#CoveragePanelModel_Address_L_ZIPCODE").removeAttr("disabled");
        }

        $('#COVERAGE_L_PROVINCE').select2();
        $('#COVERAGE_L_AMPHUR').select2();
        $('#COVERAGE_L_TUMBOL').select2();
        $("#L_BUILD_NO").select2();

        return false;
    };

    function addressIdMathced(suggestion) {
        try {
            return addressIds[getIndexIfObjWithOwnAttr(states, suggestion)];
        } catch (e) {
            return "";
        }
    }

    function addressIdMathcedShortName(suggestion) {
        try {
            return addressIds[getIndexIfObjWithOwnAttrShortName(states, suggestion)];
        } catch (e) {
            return "";
        }
    }

    function handleSuggestionNotMatched() {
        CheckBuildCoverage = false;
        CheckShowBuildNo = false;
        $("#DIV_D_L_BUILD_NO").hide();
        $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").show();
    }

    function chunkBloodHoudDataSet(data) {
        var dataSources = [];
        var i, j, chunkSize = 1000;
        for (i = 0, j = data.length; i < j; i += chunkSize) {
            tempArray = data.slice(i, i + chunkSize);
            var d = $.map(tempArray, function (item) {
                return item;
            });
            dataSources.push(createBloodhoundEngine(d));
        }

        return dataSources;
    }

    function createTypeahead(idName, datasets) {

        //bloodEngine = createBloodhoundEngine(datasets);
        //bloodEngine.initialize();

        $(idName).typeahead({
            hint: true,
            highlight: true,
            minLength: 1,
        }, chunkBloodHoudDataSet(datasets));

        removeTypeaheadLoading(idName);
    };

    function createBloodhoundEngine(datasets) {

        var engine = new Bloodhound({
            //initialize: false,
            local: datasets,
            limit: 1,
            queryTokenizer: Bloodhound.tokenizers.whitespace,
            datumTokenizer: function (d) {
                var tokens;
                var wordSprites = ["อาคาร", "บ้าน"];
                try {
                    var bloodHoundtokens = Bloodhound.tokenizers.whitespace(d);
                    tokens = [d].concat(bloodHoundtokens);
                    //$.each(bloodHoundtokens, function (k, v) {
                    //    $.each(v.split("-"), function (i, t) {
                    //        tokens.push(t);
                    //    });
                    //})
                    var dewhiteSpaceToke = bloodHoundtokens.join('');
                    tokens.push(dewhiteSpaceToke);

                    if (dewhiteSpaceToke.indexOf('-') > -1) {
                        tokens.push(dewhiteSpaceToke.replace('-', ''));
                    }

                    for (var i = 0; i < wordSprites.length; i++) {
                        var word = wordSprites[i];
                        if (dewhiteSpaceToke.indexOf(word) > -1) {
                            tokens = tokens.concat(Bloodhound.tokenizers.whitespace(dewhiteSpaceToke.replace(word, word + ' ')));
                        }
                    }
                } catch (e) {
                    console.log(e);
                    tokens = [""];
                }

                return tokens;
            },
        });

        engine.initialize();

        var src = {
            source: engine.ttAdapter(),
        }
        return src;
    }

    function removeTypeaheadLoading(id) {
        $(id).removeClass('ui-autocomplete-loading');
        $(id).removeAttr('disabled');
    }

    function showTypeaheadLoading(id) {
        $(id).addClass('ui-autocomplete-loading');
        $(id).attr('disabled', 'disabled');
    }

    function destroyTypeahead(idName) {
        $(idName).typeahead('destroy');
        if (bloodEngine) {
            bloodEngine.clear();
        }
    };

    function substringMatcher(strs) {
        return function findMatches(q, cb) {
            var matches, substringRegex;
            matches = [];
            substrRegex = new RegExp(q, 'i');
            $.each(strs, function (i, str) {
                if (substrRegex.test(str)) {
                    matches.push(str);
                }
            });
            cb(matches);
        };
    };

    function getIndexIfObjWithOwnAttr(array, value) {
        for (var i = 0; i < array.length; i++) {
            if (array[i] === value) {
                return i;
            }
        }
        return -1;
    };


    var bloodEngine = null;
    var buildings = [];
    var states = [];
    var buildnos = [];
    var zipcodes = [];
    var addressIds = [];
    var provincess = [];
    var amphurss = [];
    var tumbonss = [];
    var zipcode5 = [];
    var sitecodess = [];
    var latitudes = [];
    var longtitudes = [];
    var CheckVillCoverage = false;
    var CheckBuildCoverage = true;
    var CheckShowBuildNo = true;

    function getProvince(province) {
        ajaxGetProvince(province, false);
    }

    function getProvinceAsync(province) {
        ajaxGetProvince(province, true);
    }

    function ajaxGetProvince(selectedProvice, isAsync) {
        $('#COVERAGE_L_PROVINCE').empty();
        var str = '<option disabled selected value="">' + "@L_PROVINCE" + '</option>';

        $('#COVERAGE_L_PROVINCE').append(str);
        $.ajax({
            type: "GET",
            url: "/CheckCoverage/GetProvince",
            dataType: "json",
            async: isAsync,
            success: function (data) {
                var strBuilder = '';
                $.each(data, function (i, e) {
                    var s = "";

                    if (selectedProvice == e.Text) s = "selected";

                    var str = '<option value="' + e.Value + '"' + s + '>' + e.Text + '</option>';
                    strBuilder += str;
                });

                $('#COVERAGE_L_PROVINCE').append(strBuilder);
                $('#COVERAGE_L_PROVINCE').select2();
            }
        });
    }

    function CheckKeyUps(id, RexStr) {
        var strKey = $("#" + id).val();
        var strBuilder = "";
        var filter = new RegExp(RexStr);
        for (var i = 0; i < strKey.length; i++) {
            if (filter.test(strKey.substr(i, 1))) {
                strBuilder += strKey.substr(i, 1);
            }
        }
        $("#" + id).val(strBuilder);
    }

    function hideDefault() {
        hideMap();
        $("#silder").css("visibility", "inherit");
        $("body").css("overflow-y", "auto");
    }

    function disabledMooBan() {
        clear_building_ogj();
        $("#CoveragePanelModel_Address_L_MOOBAN").val("");
        $("#tMooban").val("");
        $("#Mooban1").val("");
        $("#Mooban2").val("");
        $("#Mooban2").typeahead("val", "");
    }

    function disabledTower() {
        clear_building_ogj();
        //$("#DIV_D_L_BUILD_NO").show();
        $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").val("");
        $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").typeahead("val", "");
        $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val("");
        $("#CoveragePanelModel_Address_L_FLOOR").val("");
        $("#L_BUILD_NAME option[value='']").attr("selected", "selected");
        $("#L_BUILD_NO option[value='']").attr("selected", "selected");
        $("input[name=L_HAVE_FIXED_LINE]").prop("checked", false);

        //clear validate
        $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").removeClass();
        $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").addClass("form-control");
        $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").removeClass();
        $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").addClass("form-control");

        $("#CoveragePanelModel_Address_L_FLOOR").removeClass();
        $("#CoveragePanelModel_Address_L_FLOOR").addClass("form-control");
    }

    function onRentalChange(rentalFlg) {

        if ($("#R_OTHER").is(":checked") && sessionStorage.getItem("rentalflag") == 'null') {
            $("#DIViframeMap").show();
            var iframe = $("#iframeMap");
            iframe.attr("src", iframe.data("src"));

            if (($('#MemberGetMemberFlag').val() != 'Y')
                || ($('#MemberGetMemberFlag').val() == 'Y' && (sessionStorage.getItem('firstloadcount') != 'null' && sessionStorage.getItem('firstloadcount') > 0))) {
                sessionStorage.setItem('firstloadbuildingcount', Number(sessionStorage.getItem('firstloadbuildingcount')) + 1);
                postCheckcoverage('@FBB_Con_WEB_CONFIG',
                {
                    role: UserMap,
                    langFlag: $("#LanguagePage").val(),
                    postcode: '',
                    province: '',
                    district: '',
                    subDistrict: '',
                    moo: '',
                    soi: '',
                    road: '',
                    houseNo: '',
                    buildingName: '',
                    TriplePlayFlag: $("#HdAddTriple").val(),
                    locationCode: $("#CustomerRegisterPanelModel_L_LOC_CODE").val(),
                    ascCode: $("#CustomerRegisterPanelModel_L_ASC_CODE").val(),
                    employeeID: $("#CustomerRegisterPanelModel_L_STAFF_ID").val(),
                    saleFirstname: $("#THFirstName").val(),
                    saleLastname: $("#THLastName").val(),
                    locationName: $("#CustomerRegisterPanelModel_PartnerName").val(),
                    subRegion: $("#outLocationSubRegion").val(),
                    region: $("#outLocationRegion").val(),
                    ascName: $("#outASCPartnerName").val(),
                    channelName: $("#CustomerRegisterPanelModel_PartnerName").val(),
                    saleChannel: $("#outChnSales").val(),
                    mobileNo: $("#CoveragePanelModel_P_MOBILE").val()
                }, "post", "my-iframe");
            } else {
                sessionStorage.setItem('firstloadbuildingcount', 1);

                var lang = $('#CoverageMemberGetMember_Language').val();
                var pTumbon = $('#CoverageMemberGetMember_SubDistrict').val();
                var pAmphur = $('#CoverageMemberGetMember_Distrinct').val();
                var pProvince = $('#CoverageMemberGetMember_Province').val();
                var pZipcode = $('#CoverageMemberGetMember_PostCode').val();
                var pSoi = $('#CoverageMemberGetMember_Soi').val();
                var pRoad = $('#CoverageMemberGetMember_Road').val();
                var pHouseNo = $('#CoverageMemberGetMember_HouseNo').val();
                var pBuildingName = $('#CoverageMemberGetMember_VillageName').val();
                var pLocation = $('#CoveragePanelModel_LOCATION').val();
                var pTriplePlayFlag = $("#HdAddTriple").val() + '|' + $('#CoverageMemberGetMember_RefferenceNo').val();

                var fulladdress = $('#CoverageMemberGetMember_FULL_ADDRESS').val();
                if (pLocation != "") {
                    pTumbon = "";
                    pAmphur = "";
                    pProvince = "";
                    pZipcode = "";
                    pSoi = "";
                    pRoad = "";
                    pHouseNo = pLocation;
                    pBuildingName = "";
                }
                if (fulladdress != "") {
                    pTumbon = "";
                    pAmphur = "";
                    pProvince = "";
                    pZipcode = "";
                    pSoi = "";
                    pRoad = "";
                    pHouseNo = fulladdress;
                    pBuildingName = "";
                }

                postCheckcoverage('@FBB_Con_WEB_CONFIG',
                {
                    role: UserMap,
                    langFlag: $("#LanguagePage").val(),
                    postcode: pZipcode,
                    province: pProvince,
                    district: pAmphur,
                    subDistrict: pTumbon,
                    moo: '',
                    soi: pSoi,
                    road: pRoad,
                    houseNo: pHouseNo,
                    buildingName: pBuildingName,
                    TriplePlayFlag: pTriplePlayFlag,
                    locationCode: $("#CustomerRegisterPanelModel_L_LOC_CODE").val(),
                    ascCode: $("#CustomerRegisterPanelModel_L_ASC_CODE").val(),
                    employeeID: $("#CustomerRegisterPanelModel_L_STAFF_ID").val(),
                    saleFirstname: $("#THFirstName").val(),
                    saleLastname: $("#THLastName").val(),
                    locationName: $("#CustomerRegisterPanelModel_PartnerName").val(),
                    subRegion: $("#outLocationSubRegion").val(),
                    region: $("#outLocationRegion").val(),
                    ascName: $("#outASCPartnerName").val(),
                    channelName: $("#CustomerRegisterPanelModel_PartnerName").val(),
                    saleChannel: $("#outChnSales").val(),
                    mobileNo: $("#CoveragePanelModel_P_MOBILE").val()
                }, "post", "my-iframe");
            }

        }
        var showRental = sessionStorage.getItem("ShowRental");
        var mobileStatus = sessionStorage.getItem("MobileStatus");
        var isSerenade = sessionStorage.getItem("IsSerenade");
        var isServicYear = sessionStorage.getItem("IsServiceYear");

        var Rental = "";
        if (showRental == "true") {
            if (mobileStatus == "post") {
                if (rentalFlg == "Y") {
                    if (isSerenade == "true") {
                        Rental = "S";
                    }
                    else {
                        if (isServicYear == "true") {
                            Rental = "X";
                        }
                        else {
                            Rental = "Y";
                        }
                    }
                }
                else {
                    Rental = "N";
                }
            }
            else if (mobileStatus == "pre") {
                if (isSerenade == "true") {
                    if (rentalFlg == "Y") {
                        Rental = "S";
                    }
                    else {
                        Rental = "N";
                    }
                }
                else {
                    if (rentalFlg == "Y") {
                        Rental = "Y";
                    }
                    else {
                        Rental = "N";
                    }
                }
            }
            else {
                if (rentalFlg == "Y") {
                    Rental = "Y";
                }
                else {
                    Rental = "N";
                }
            }
        }
        else {
            Rental = "";
        }
        sessionStorage.setItem("rentalflag", Rental);
    }

    function onBuildChange(flgBind) {


        if (sessionStorage.getItem("ShowRental") == "true") {
            $('input[name=R_RENTAL]:checked').each(function () {
                $(this).prop('checked', false);
            });
            sessionStorage.setItem("rentalflag", null);
        }



        var strBuilder = '<option value="">' + '@L_BUILD_NO' + '</option>';
        $("#PicPOI").hide();
        $("#L_BUILD_NO").empty();
        $("#L_BUILD_NO").append(strBuilder);
        resetMainAddress2();

        if ($("#R_BUILD").is(":checked")) {
            $("#DIViframeMap").hide();
            $('#checkProcess').show();

            CheckVillCoverage = false;
            disabledMooBan();
            $("#divBaan").hide();
            disabledTower();
            $("#divTower").hide();
            onZipCodeChange();

            $("#divBaan").hide();
            $("#DIV_ADDRESS").show();
            clearaddressPanel();
            if (flgBind != "notBind") {
                clearAddressDropdown();
                getBuildingBatch();
            } else {
                $("#L_BUILD_NAME").val("0");
            }

            //อาคาร
            //$("#L_BUILD_NAME").removeAttr("disabled");
            $("#L_BUILD_NO").removeAttr("disabled");
            $("#L_BUILD_NO").select2();
            $("#CoveragePanelModel_Address_L_FLOOR").val("");
            $("#CoveragePanelModel_Address_L_FLOOR").removeAttr("disabled");
            $("#CoveragePanelModel_Address_L_FLOOR").removeClass();
            $("#CoveragePanelModel_Address_L_FLOOR").addClass("form-control");
            $("input[name=L_HAVE_FIXED_LINE]").removeAttr("disabled");

            //หมู่บ้าน
            $("#clearformuban").css("clear", "");
            $("#clearforprovince").css("clear", "");

            disabledMooBan();
            $("#divTower").show();
            $("#DIV_BUILD_NO_OUTER").show();
            $("#DIV_Floor").show();
            $("#DIV_HAVE_FIXED_LINE").show();
            $("#div_l_build_no").show();
            $("#div_l_floor").show();
            //$("#div_condo_carousel").show();

            //console.log('test2');
            //$("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").val('Condo Pu Test');
        }
        else if ($("#R_MOOBAN").is(":checked")) {
            $("#PicPOI").hide();
            $("#DIViframeMap").hide();
            $('#checkProcess').show();
            CheckVillCoverage = false;
            disabledMooBan();
            $("#divBaan").hide();
            disabledTower();
            $("#divTower").hide();
            onZipCodeChange();
            clearaddressPanel();

            $("#divTower").hide();
            $("#divBaan").show();
            $("#DIV_ADDRESS").show();

            $("#DIV_BUILD_NO_OUTER").hide();
            $("#DIV_Floor").hide();
            $("#DIV_HAVE_FIXED_LINE").hide();

            if (flgBind != "notBind") {
                clearAddressDropdown();
                getBuildingBatch();
            } else {
                $("#Mooban1").val("0");
            }

            $("#CoveragePanelModel_Address_L_MOOBAN").removeAttr("disabled");
            $("#CoveragePanelModel_Address_L_MOOBAN").removeClass();
            $("#CoveragePanelModel_Address_L_MOOBAN").addClass("form-control");
            //$("#divMooban1").removeClass("select-error");
            //$("#divMooban1").addClass("select");
            $("#Mooban2").removeClass("form-control errorinput");
            $("#Mooban2").addClass("form-control");

            disabledTower();

            $("#clearformuban").css("clear", "both");
            $("#clearforprovince").css("clear", "both");

            if ($("#COVERAGE_L_PROVINCE").val() == "") {
                $("#RD_L_LAT_LONG").attr("disabled", "disabled");
                $("#L_SPECIFIC_LOC222").attr("disabled", "disabled");
            }
            else {
                $("#RD_L_LAT_LONG").removeAttr("disabled");
                $("#L_SPECIFIC_LOC222").removeAttr("disabled");
            }
            $("#div_l_build_no").hide();
            $("#div_l_floor").hide();
            $("#div_condo_carousel").hide();
        }
        else if ($("#R_OTHER").is(":checked")) {
            $("#PicPOI").hide();
            $("#DIV_ADDRESS").hide();
            disabledMooBan();
            $("#divBaan").hide();
            disabledTower();
            $("#divTower").hide();
            onZipCodeChange();
            clearaddressPanel();
            if (sessionStorage.getItem("ShowRental") != "true") {
                $("#DIViframeMap").show();
                var iframe = $("#iframeMap");
                iframe.attr("src", iframe.data("src"));
                if ($("#EOS_CheckBindValueAddress").val() == "true") {
                    var pTumbon = $('#EOS_AccountTumbol').val();
                    var pAmphur = $('#EOS_AccountAmphur').val();
                    var pProvince = $('#EOS_AccountProvince').val();
                    var pZipcode = $('#EOS_AccountZipCode').val();
                    var pSoi = $('#EOS_AccountSoi').val();
                    var pRoad = $('#EOS_AccountStreetName').val();
                    var pHouseNo = $('#EOS_AccountHouseNo').val();
                    var pBuildingName = $("#EOS_AccountMooban").val();
                    var pTriplePlayFlag = "EOS" + "|" + "@PromotionCodeFBBxEOS" + "|" + $("#EOS_AccountTitle").val() + "|" + $("#EOS_CustomerName").val() + "|" + $("#EOS_OfficeTelNo").val()
                        + "|" + "@CARD_NOsFBBxEOS" + "|" + "@LanguageEOS";

                    postCheckcoverage('@FBB_Con_WEB_CONFIG',
                        {
                            role: UserMap,
                            langFlag: $("#LanguagePage").val(),
                            postcode: pZipcode,
                            province: pProvince,
                            district: pAmphur,
                            subDistrict: pTumbon,
                            moo: '',
                            soi: pSoi,
                            road: pRoad,
                            houseNo: pHouseNo,
                            buildingName: pBuildingName,
                            TriplePlayFlag: pTriplePlayFlag,
                            locationCode: $("#CustomerRegisterPanelModel_L_LOC_CODE").val(),
                            ascCode: $("#CustomerRegisterPanelModel_L_ASC_CODE").val(),
                            employeeID: $("#CustomerRegisterPanelModel_L_STAFF_ID").val(),
                            saleFirstname: $("#THFirstName").val(),
                            saleLastname: $("#THLastName").val(),
                            locationName: $("#CustomerRegisterPanelModel_PartnerName").val(),
                            subRegion: $("#outLocationSubRegion").val(),
                            region: $("#outLocationRegion").val(),
                            ascName: $("#outASCPartnerName").val(),
                            channelName: $("#CustomerRegisterPanelModel_PartnerName").val(),
                            saleChannel: $("#outChnSales").val(),
                            mobileNo: $("#CoveragePanelModel_P_MOBILE").val()
                        }, "post", "my-iframe");
                }
                else {
                    if (($('#MemberGetMemberFlag').val() != 'Y')
                        || ($('#MemberGetMemberFlag').val() == 'Y' && (sessionStorage.getItem('firstloadcount') != null && sessionStorage.getItem('firstloadcount') > 0))) {
                        const urlParams = new URLSearchParams(window.location.search);
                        var assetNumber = urlParams.get('assetnumber');
                        var serviceCaseID = urlParams.get('ServiceCaseId');
                        var dataTriplePlayFlag = '';
                        if (assetNumber && serviceCaseID) {
                            dataTriplePlayFlag = assetNumber + '$' + serviceCaseID; //For IM Order.
                        } else {
                            dataTriplePlayFlag = $("#HdAddTriple").val();
                        }
                        if ("@FromFBBxEOS" == "Y") {
                            dataTriplePlayFlag = "EOS" + "|" + "@PromotionCodeFBBxEOS" + "|" + $("#EOS_AccountTitle").val() + "|" + $("#EOS_CustomerName").val() + "|" + $("#EOS_OfficeTelNo").val()
                        + "|" + "@CARD_NOsFBBxEOS" + "|" + "@LanguageEOS";
                        }
                        sessionStorage.setItem('firstloadbuildingcount', Number(sessionStorage.getItem('firstloadbuildingcount')) + 1);
                        postCheckcoverage('@FBB_Con_WEB_CONFIG',
                            {
                                role: UserMap,
                                langFlag: $("#LanguagePage").val(),
                                postcode: '',
                                province: '',
                                district: '',
                                subDistrict: '',
                                moo: '',
                                soi: '',
                                road: '',
                                houseNo: '',
                                buildingName: '',
                                TriplePlayFlag: dataTriplePlayFlag,
                                locationCode: $("#CustomerRegisterPanelModel_L_LOC_CODE").val(),
                                ascCode: $("#CustomerRegisterPanelModel_L_ASC_CODE").val(),
                                employeeID: $("#CustomerRegisterPanelModel_L_STAFF_ID").val(),
                                saleFirstname: $("#THFirstName").val(),
                                saleLastname: $("#THLastName").val(),
                                locationName: $("#CustomerRegisterPanelModel_PartnerName").val(),
                                subRegion: $("#outLocationSubRegion").val(),
                                region: $("#outLocationRegion").val(),
                                ascName: $("#outASCPartnerName").val(),
                                channelName: $("#CustomerRegisterPanelModel_PartnerName").val(),
                                saleChannel: $("#outChnSales").val(),
                                mobileNo: $("#CoveragePanelModel_P_MOBILE").val()
                            }, "post", "my-iframe");
                    } else {
                        sessionStorage.setItem('firstloadbuildingcount', 1);

                        var lang = $('#CoverageMemberGetMember_Language').val();
                        var pTumbon = $('#CoverageMemberGetMember_SubDistrict').val();
                        var pAmphur = $('#CoverageMemberGetMember_Distrinct').val();
                        var pProvince = $('#CoverageMemberGetMember_Province').val();
                        var pZipcode = $('#CoverageMemberGetMember_PostCode').val();
                        var pSoi = $('#CoverageMemberGetMember_Soi').val();
                        var pRoad = $('#CoverageMemberGetMember_Road').val();
                        var pHouseNo = $('#CoverageMemberGetMember_HouseNo').val();
                        var pBuildingName = $('#CoverageMemberGetMember_VillageName').val();
                        var pLocation = $('#CoveragePanelModel_LOCATION').val();
                        var pTriplePlayFlag = $("#HdAddTriple").val() + '|' + $('#CoverageMemberGetMember_RefferenceNo').val();
                        if (pLocation != "") {
                            pTumbon = "";
                            pAmphur = "";
                            pProvince = "";
                            pZipcode = "";
                            pSoi = "";
                            pRoad = "";
                            pHouseNo = pLocation;
                            pBuildingName = "";
                        }

                        postCheckcoverage('@FBB_Con_WEB_CONFIG',
                            {
                                role: UserMap,
                                langFlag: $("#LanguagePage").val(),
                                postcode: pZipcode,
                                province: pProvince,
                                district: pAmphur,
                                subDistrict: pTumbon,
                                moo: '',
                                soi: pSoi,
                                road: pRoad,
                                houseNo: pHouseNo,
                                buildingName: pBuildingName,
                                TriplePlayFlag: pTriplePlayFlag,
                                locationCode: $("#CustomerRegisterPanelModel_L_LOC_CODE").val(),
                                ascCode: $("#CustomerRegisterPanelModel_L_ASC_CODE").val(),
                                employeeID: $("#CustomerRegisterPanelModel_L_STAFF_ID").val(),
                                saleFirstname: $("#THFirstName").val(),
                                saleLastname: $("#THLastName").val(),
                                locationName: $("#CustomerRegisterPanelModel_PartnerName").val(),
                                subRegion: $("#outLocationSubRegion").val(),
                                region: $("#outLocationRegion").val(),
                                ascName: $("#outASCPartnerName").val(),
                                channelName: $("#CustomerRegisterPanelModel_PartnerName").val(),
                                saleChannel: $("#outChnSales").val(),
                                mobileNo: $("#CoveragePanelModel_P_MOBILE").val()
                            }, "post", "my-iframe");
                    }
                }
            }
            $('#checkProcess').hide();
            $("#div_l_build_no").hide();
            $("#div_l_floor").hide();
            $("#div_condo_carousel").hide();
        }
        hideMap();
        clearLatLong();
    }

    $('#backPageCheckCoverage').click(function () {
        // Update 17.4 Script Adobe Analytic
        digitalData.customLinkName = "check-coverage:cancel-button";

        if ('@FromFBBxEOS' == 'Y') {
            $('#iFormByPassEOS').submit();
        }
        else {
            window.location.href = "/Process/Index";
        }
    });

    $('#checkProcess').click(function () {
        LockScreen(true, "");

        var chkCoverageStatus = "";
        if ('@ViewBag.chkCoverage' != "") {
            chkCoverageStatus = '@ViewBag.chkCoverage';
        }
        // Update 17.4 Script Adobe Analytic
        digitalData.customLinkName = "check-coverage:next-button";


        var chk = false;
        var s = true;
        var y = true;
        var chkRental = true;
        var a = [];

        a.push({ id: "COVERAGE_L_PROVINCE" });
        a.push({ id: "COVERAGE_L_AMPHUR" });
        a.push({ id: "COVERAGE_L_TUMBOL" });

        if ($("#R_BUILD").is(":checked")) {
            if ($("#L_BUILD_NAME").val() == "0") {
                a.push({ id: "CoveragePanelModel_Address_L_BUILD_NAME_Hied" });
                a.push({ id: "L_BUILD_NO" });

                if ($("#DIV_D_L_BUILD_NO").css('display') == 'none') {
                    // case buildname has not buildno
                    a.pop({ id: "L_BUILD_NO" });
                }
            }
            else if ($("#L_BUILD_NAME").val() == "-9") {
                //case symphony check lat long
            }
            else {
                a.push({ id: "L_BUILD_NAME" });
                a.push({ id: "L_BUILD_NO" });
                if ($("#DIV_D_L_BUILD_NO").css('display') == 'none') {
                    // case buildname has not buildno
                    a.pop({ id: "L_BUILD_NO" });
                }
            }

            if ($("input[name=L_HAVE_FIXED_LINE]:checked").val() == undefined)
                y = false;

            $('#CoveragePanelModel_BuildingType').val("C");
        }
        else if ($("#R_MOOBAN").is(":checked")) {
            if ($("#Mooban1").val() == "0") {
                a.push({ id: "Mooban2", required: false });
            }
            else {
                a.push({ id: "Mooban1" });
            }
            $('#CoveragePanelModel_BuildingType').val("V");
        }
        else if ($("#R_OTHER").is(":checked")) {
            $('#CoveragePanelModel_BuildingType').val("O");
        }
        else {
            s = false;
        }

        if ($("input[name=R_RENTAL]:checked").val() == undefined) {
            chkRental = false;
        }

        a.push({ id: "CoveragePanelModel_Address_L_HOME_NUMBER_1" });
        a.push({ id: "CoveragePanelModel_Address_L_SOI", required: false });
        a.push({ id: "CoveragePanelModel_Address_L_ROAD", required: false });
        a.push({ id: "CoveragePanelModel_Address_L_MOO", required: false });
        a.push({ id: "CoveragePanelModel_Address_L_ZIPCODE" });

        chk = ValidationProcessing(a, "err001");

        if (chk == true) {

            $("#CoveragePanelModel_Address_L_MOOBAN").val(selected_building_obj.building_name);
            //if ($("#Mooban1").val() == "0")
            //    $("#CoveragePanelModel_Address_L_MOOBAN").val(selected_building_obj.building_name);
            //else
            //    $("#CoveragePanelModel_Address_L_MOOBAN").val($("#Mooban1 option:selected").text());

            if (!s) {
                LockScreen(false);

                if ($("#LanguagePage").val() == "1")
                    toastrErrorMessage("กรุณาระบุข้อมูลอาคาร หรือหมู่บ้าน");
                else
                    toastrErrorMessage("Please Select Building Or Village.");

            }
            else if (!y) {
                LockScreen(false);
                toastrErrorMessage("@L_HAVE_FIXED_LINE");
            }
            else if (checkHavePlugAndPlayFlow && $("input[name=L_CHECK_PLUG_AND_PLAY_FLOW]:checked").val() == undefined) {
                LockScreen(false);
                if ($("#LanguagePage").val() == "1") {
                    toastrErrorMessage("กรุณาระบุข้อมูลให้ถูกต้องและครบถ้วน");
                }
                else {
                    toastrErrorMessage("Please Fill In All Required Fields.");
                }
            }
            else if (!chkRental && ('' != '@L_TYPE_OF_RESIDENCE' && '' != '@L_OWNER' && '' != '@L_RENTAL') && sessionStorage.getItem("ShowRental") == "true") {
                LockScreen(false);
                toastrErrorMessage('@L_TYPE_OF_RESIDENCE');
            }
            else {
                $("#CoveragePanelModel_CVRID").val($("#L_BUILD_NO").val());

                if ($("#L_BUILD_NAME").val() == "0") {
                    if (selected_building_obj.building_name != "") {
                        $("#CoveragePanelModel_CVR_NODE").val(selected_building_obj.building_name);
                    }
                    else {
                        $("#CoveragePanelModel_CVR_NODE").val($("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").val());
                    }
                } else if ($("#L_BUILD_NAME").val() != "") {
                    $("#CoveragePanelModel_CVR_NODE").val($("#L_BUILD_NAME option:selected").text());
                }

                $("#CoveragePanelModel_CVR_TOWER").val($("#L_BUILD_NO option:selected").text());

                if ($('#CoveragePanelModel_Address_L_BUILD_NO_Hied').css('display') == 'block' && $("#CoverageMemberGetMember_IM_ORDER").val().toLowerCase() == "true") {
                    $("#CoveragePanelModel_CVRID").val($('#CoveragePanelModel_Address_L_BUILD_NO_Hied').val());
                    $("#CoveragePanelModel_CVR_TOWER").val($('#CoveragePanelModel_Address_L_BUILD_NO_Hied').val());
                }

                handleCheckingCoverage(function () {

                    if ($("#R_MOOBAN").is(":checked")) {
                        LockScreen(false);
                        $("#CoveragePanelModel_CVR_TOWER").val("");
                    }

                    if ($("#CoveragePanelModel_CoverageResult").val() == "PLAN") {
                        LockScreen(false);
                        if ((("@ViewBag.Vas" == "" && "@SHOW_POPUP_PLANSITE_CUST" == "Y") || ("@ViewBag.Vas" != "" && "@SHOW_POPUP_PLANSITE_SSO" == "Y"))
                            && $("#OpenCoveragePopup").val() == "")
                            openCoveragePopup($("#CoveragePanelModel_CoverageResult").val());
                        else {

                            gotoOutOfCoverage();
                        }
                    }
                    else if ($("#CoveragePanelModel_CoverageResult").val() == "NO") {
                        LockScreen(false);

                        if ((("@ViewBag.Vas" == "" && "@SHOW_POPUP_NOPLAN_CUST" == "Y") || ("@ViewBag.Vas" != "" && "@SHOW_POPUP_NOPLAN_SSO" == "Y"))
                            && $("#OpenCoveragePopup").val() == "") {
                            openCoveragePopup($("#CoveragePanelModel_CoverageResult").val());
                        }
                        else {

                            if ((selected_building_obj.building_name == "" || !CheckVillCoverage)
                                    && $('input[name=R_BUILD]:checked').val() == "VILLAGE") {
                                $("#DIViframeMap").show();
                                var iframe = $("#iframeMap");
                                iframe.attr("src", iframe.data("src"));
                                $('#checkProcess').hide();

                                postCheckcoverage('@FBB_Con_WEB_CONFIG',
                                {
                                    role: UserMap,
                                    langFlag: $("#LanguagePage").val(),
                                    postcode: $("#CoveragePanelModel_Address_L_ZIPCODE option:selected").text(),
                                    province: $("#COVERAGE_L_PROVINCE").val(),
                                    district: $("#COVERAGE_L_AMPHUR").val(),
                                    subDistrict: $("#COVERAGE_L_TUMBOL").val(),
                                    moo: $("#CoveragePanelModel_Address_L_MOO").val(),
                                    soi: $("#CoveragePanelModel_Address_L_SOI").val(),
                                    road: $("#CoveragePanelModel_Address_L_ROAD").val(),
                                    houseNo: $("#CoveragePanelModel_Address_L_HOME_NUMBER_1").val(),
                                    buildingName: selected_building_obj.building_name,
                                    TriplePlayFlag: $("#HdAddTriple").val(),
                                    locationCode: $("#CustomerRegisterPanelModel_L_LOC_CODE").val(),
                                    ascCode: $("#CustomerRegisterPanelModel_L_ASC_CODE").val(),
                                    employeeID: $("#CustomerRegisterPanelModel_L_STAFF_ID").val(),
                                    saleFirstname: $("#THFirstName").val(),
                                    saleLastname: $("#THLastName").val(),
                                    locationName: $("#CustomerRegisterPanelModel_PartnerName").val(),
                                    subRegion: $("#outLocationSubRegion").val(),
                                    region: $("#outLocationRegion").val(),
                                    ascName: $("#outASCPartnerName").val(),
                                    channelName: $("#CustomerRegisterPanelModel_PartnerName").val(),
                                    saleChannel: $("#outChnSales").val(),
                                    mobileNo: $("#CoveragePanelModel_P_MOBILE").val()
                                }, "post", "my-iframe");
                            }
                            else {

                                gotoOutOfCoverage();
                            }
                        }
                    }
                    else {

                        //YES + FULL
                        if (chkCoverageStatus == "True") {
                            LockScreen(false);
                            //Bind Value

                            InCoveragePopUp();
                        } else {
                            setTimeout(function () {
                                try {

                                    // 18.9 no select Router

                                    $("#CustomerRegisterPanelModel_SffServiceYear").val(sessionStorage.getItem("SffServiceYear"));
                                    $("#CoveragePanelModel_SffServiceYear").val(sessionStorage.getItem("SffServiceYear"));
                                    $("#CustomerRegisterPanelModel_SubNetworkType").val(sessionStorage.getItem("SubNetworkType"));

                                    getPackageNewV2(0);

                                } catch (e) {
                                    LockScreen(false);
                                    console.log(e);
                                }
                                window.scrollTo(0, 0); // scorll page to top
                            }, 10);
                        }
                    }

                    $("#CoveragePanelModel_L_LAT").val($("#CoveragePanelModel__CoveragePanelModel_L_LAT2").val());
                    $("#CoveragePanelModel_L_LONG").val($("#CoveragePanelModel__CoveragePanelModel_L_LONG2").val());

                    $("#CoveragePanelModel_PRODUCT_SUBTYPE").val($("#HdFunctionSubProduct").val());
                    $(".simplemodal-container").removeClass("modelStyleFix");
                    $("#tOrderRef").val("Default");
                    if ($("#chkTypePass").val() == "1" && $("#tAisAirNumber").val().substr(0, 1) == "0") {
                        insertVSMPLog();
                    }

                    insertFBSSCoverageResult();
                });
            }
        } else {
            LockScreen(false);
        }
    });

    var tmpLatitude3bb = "";
    var tmpongtitude3bb = "";
    function handleCheckingCoverage(callback) {

        if (($('input[name=R_BUILD]:checked').val() == 'VILLAGE'
                        && (selected_building_obj.building_name == "" || !CheckVillCoverage))
                    || ($('input[name=R_BUILD]:checked').val() == 'CONDOMINIUM'
                && (selected_building_obj.building_name == "" || !CheckBuildCoverage))) {
            //case หมู่บ้านระดับตำบลจะไม่เช็คให้โชว์แมพแทน
            $("#CoveragePanelModel_CoverageResult").val('NO');
            $("#ZTECoverage").val("NO");

            callback();
        }
        else if ($('input[name=R_BUILD]:checked').val() == 'CONDOMINIUM') {
            var tmpBuildName = "";
            var tmpBuildNo = "";
            tmpLatitude3bb = "";
            tmpongtitude3bb = "";
            if ($("#L_BUILD_NAME").val() == "0") {
                if (selected_building_obj.building_name != "") {
                    tmpBuildName = selected_building_obj.building_name;
                }
                else {
                    tmpBuildName = $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").val();
                }
            }
            else {
                tmpBuildName = $("#L_BUILD_NAME option:selected").text();
            }
            tmpBuildNo = $('#L_BUILD_NO option:selected').val();
            if ($("#L_BUILD_NAME").val() === '0') {
                if (tmpBuildNo == "")
                    tmpBuildNo = $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val();
            }

            $.ajax({
                url: '/CheckCoverage/GetBuildingByBuildingNameAndNo',
                data: {
                    build_name: tmpBuildName,
                    build_no: tmpBuildNo
                },
                dataType: "json",
                type: 'POST',
                success: function (dataBuilding) {

                    if (dataBuilding.Exclusive_3bb == "Y") {
                        $('#btnLeaveMSG').hide();
                        $('#lbCoveragePopup-WTTX').html("@Html.Raw(L_RESULT_PLAN_EXCUSIVE_3BB)");
                        $("#modal-nocoverage-wttx").modal();
                        $("#modal-nocoverage-wttx-detail").show();
                        LockScreen(false);
                    } else {

                        if (dataBuilding.Partner.toUpperCase() == "3BB") {
                            //true
                            //SetAddressID
                            $("#CoveragePanelModel_Address_AddressId").val(dataBuilding.Address_id);
                            $("#ZTEAddressID").val(dataBuilding.Address_id);
                            $("#P_addrtype").val("B");
                            tmpLatitude3bb = dataBuilding.latitude;
                            tmpongtitude3bb = dataBuilding.longtitude;
                            CheckCoverageFTTR3BB(callback);
                        }
                        else {
                            checkCoverageZTE(callback);
                        }
                    }
                }
            });
        }
        else {
            checkCoverageZTE(callback);
        }
    }

    function insertVSMPLog() {
        $.ajax({
            url: '/VasSummary/GetAisMobile',
            data: { msisdn: $("#tAisAirNumber").val(), orderRef: $("#HdResultId").val(), cond: "dbspeed" },
            dataType: "json",
            type: 'GET',
            //async: false,
            success: function (data) {
                $("#tOrderRef").val(data);
                $("#paramSelectPackage").val($("#paramSelectPackage").val() + ", OrderRef: " + data);
            }
        });
    }

    function checkCoverageZTE(callback) {

        $("#HdFunctionCoverageResult").val("");
        $("#ZTEAccessModeFWA").val("");
        $("#ZTECoverage").val("");
        $("#ZTEPlanSite").val("");
        $("#ZTEAddressID").val("");
        $("#ZTEIsPartner").val("");
        $("#ZTEPartnerName").val("");
        $("#ZTEAccessModeSerializer").val("");
        $("#ZTEInterfaceLogID").val("");
        $("#tempDslam").html("");
        $("#tempDslamJson").val("");
        $("#L_SplitterFlagFirstTime").val("");
        $("#checkShowtimeslotCaseDslam").val("");
        $("#messageNotShowtimeslot").val("");
        $("#DataBypass_BuildName").val("");
        $("#DataBypass_BuildNo").val("");

        var addrType = $('input[name=R_BUILD]:checked').val();
        var floor = "";
        var lat = "";
        var lng = "";
        var postCode = $("#CoveragePanelModel_Address_L_ZIPCODE option:selected").text();
        var lang = "T";
        var subDisName = $("#COVERAGE_L_TUMBOL").val();
        var buildName = "";
        var buildNo = "";
        var phoneFlag = $("input[name=L_HAVE_FIXED_LINE]:checked").val();

        $("#CoveragePanelModel_L_HAVE_FIXED_LINE").val(phoneFlag);

        if (phoneFlag == "" || phoneFlag == undefined)
            phoneFlag = "N";

        if ($("#LanguagePage").val() == "2")
            lang = "E";

        if (addrType == "CONDOMINIUM") {
            floor = $("#CoveragePanelModel_Address_L_FLOOR").val();

            buildNo = $('#L_BUILD_NO option:selected').val();
            if ($("#L_BUILD_NAME").val() === '0') {
                if (buildNo == "")
                    buildNo = $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val();
            }

            addrType = "B";
        }
        else if (addrType == "VILLAGE") {
            addrType = "V";
            buildNo = "";
        }
        else
            addrType = "O";

        if (addrType == "B") {
            if ($("#L_BUILD_NAME").val() == "0") {
                if (selected_building_obj.building_name != "") {
                    buildName = selected_building_obj.building_name;
                }
                else {
                    buildName = $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").val();
                }
            }
            else {
                buildName = $("#L_BUILD_NAME option:selected").text();
            }
        }
        else if (addrType == "V") {
            if ($("#Mooban1").val() == "0")
                buildName = selected_building_obj.building_name;
            else
                buildName = $("#Mooban1 option:selected").text();
        }

        lat = $('#CoveragePanelModel__CoveragePanelModel_L_LAT2').val();
        lng = $('#CoveragePanelModel__CoveragePanelModel_L_LONG2').val();

        $('#P_addrtype').val(addrType);
        if ('@Model.CallfeascheckFlag' == 'Y') {
            $("#P_build_name").val('@Model.TempBuildnameforlistpackage');
        }
        else {
            $('#P_build_name').val(buildName);
            $("#DataBypass_BuildName").val(buildName);
        }
        $('#P_build_no').val(buildNo);
        $("#DataBypass_BuildNo").val(buildNo);
        // For Test
        //if (true) {
        //    console.log("Bypass GetFBSSFeasibilityCheck");
        //    $('#HdFunctionCoverageResult').val("Y");
        //    $("#ZTEIsPartner").val("");
        //    $("#ZTEPartnerName").val("");
        //    $("#ZTEAddressID").val("");
        //    $('#CoveragePanelModel_P_FTTX_VENDOR').val("");
        //    $("#CoveragePanelModel_Address_AddressId").val("");
        //    callback();
        //}
        $.ajax({
            type: "GET",
            url: "/CheckCoverage/GetFBSSFeasibilityCheck",
            data: {
                "addrType": addrType, "postCode": postCode, "lang": lang, "subDisName": subDisName, "buildName": buildName, "buildNo": buildNo,
                "phoneFlag": phoneFlag, "latitude": lat, "longitude": lng, "unitNo": "", "floor": floor, "aisAirNumber": sessionStorage.getItem("AisAirNumber")
            },
            dataType: "json",
            //async: false,
            success: function (data) {
                var haveVDSL = false;
                var strResult = "";
                $("#ZTECoverage").val(data.Coverage);
                $("#CoveragePanelModel_CoverageResult").val(data.Coverage);
                $("#ZTEInterfaceLogID").val(data.InterfaceLogId);

                if (data.Coverage == "YES" || data.Coverage == "FULL") {

                    $('#HdFunctionCoverageResult').val("Y");
                    $("#ZTEIsPartner").val(data.IsPartner);
                    $("#ZTEPartnerName").val(data.PartnerName);
                    $("#ZTEAddressID").val(data.AddressId);
                    $('#CoveragePanelModel_P_FTTX_VENDOR').val(data.PartnerName);
                    $("#CoveragePanelModel_Address_AddressId").val(data.AddressId);

                    GetP_Region();
                    Get_Region();

                    var model = [];
                    var ResourceList = [];
                    var tmpDslamList = [];
                    var countDslam = 0;
                    $.each(data.AccessModeList, function (i, e) {
                        var accessModeModel = new FBSSAccessModeInfo();
                        accessModeModel.AccessMode = e.AccessMode;
                        accessModeModel.InserviceDate = convertToJsDate(data.AccessModeList[0].InserviceDate);

                        if (e.AccessMode == "VDSL") {
                            accessModeModel.ResourceList = [];
                            $.each(e.ResourceList, function (j, ej) {
                                haveVDSL = true;
                                var resourceModel = new ResourceInfo();
                                resourceModel.ResourceName = ej.ResourceName;
                                accessModeModel.ResourceList.push(resourceModel);
                                tmpDslamList.push(resourceModel);
                                strResult += "<input type='hidden' id='CoverageAreaResultModel_RESOURCE_LIST_" + countDslam + "__Dslam_Name' name='CoverageAreaResultModel.RESOURCE_LIST[" + countDslam + "].Dslam_Name' value='" + ej.ResourceName + "'>";
                                countDslam++;
                            });
                        }
                        model.push(accessModeModel);
                    });
                    $("#ZTEAccessModeSerializer").val(JSON.stringify(model));

                    if (haveVDSL) {
                        $("#fromVDSL").val(true);
                        $("#tempDslam").html(strResult);
                        $("#tempDslamJson").val(JSON.stringify(tmpDslamList));
                        getZTEResQuery("VDSL", JSON.stringify(tmpDslamList), phoneFlag);
                    }
                    else {
                        $("#fromVDSL").val(false);
                        $("#tempDslam").html("");
                        $("#tempDslamJson").val("");
                    }

                }
                else {
                    $("#HdFunctionCoverageResult").val("N");

                    if (data.Coverage == "PLAN") {
                        $("#ZTEPlanSite").val(data.PlanningSite.AccessMode + "," + convertToJsDate(data.PlanningSite.InserviceDate));
                        $("#ZTEPlanSite2").val(data.PlanningSite.AccessMode + "," + data.PlanningSite.InserviceDate);
                    }
                    else {
                    }
                }

                if (callback) {
                    callback();
                }
            }
        });
    }

    function getZTEResQuery(ACCESS_MODE_LIST, RESOURCE_LIST, PHONE_FLAGE) {
        $.ajax({
            type: "GET",
            url: "/Process/ZTEResQuery",
            data: {
                "ACCESS_MODE_LIST": ACCESS_MODE_LIST, "RESOURCE_LIST": RESOURCE_LIST, "PHONE_FLAGE": PHONE_FLAGE, "TRANSACTION_ID": $("#AisAirNumber").val(), "ADDRESS_ID": $("#CoveragePanelModel_Address_AddressId").val()
            },
            dataType: "json",
            success: function (data) {
                var ShowTimeSlot = data.ShowTimeSlot;
                var CasecodeMessage = data.CasecodeMessage;
                if (ShowTimeSlot == "Y") {
                    CasecodeMessage = "";
                }
                $("#CoveragePanelModel_L_FLOWFLAG").val(data.FlowFlag);
                $("#L_SplitterFlagFirstTime").val(data.Casecode);
                $("#L_SplitterFlag").val(data.Casecode);
                $("#checkShowtimeslotCaseDslam").val(ShowTimeSlot);
                $("#messageNotShowtimeslot").val(CasecodeMessage);
                if ('@chkCoverage' == "True")
                {
                    $("#DataBypass_FlowFlag").val(data.FlowFlag);
                    $("#DataBypass_Casecode").val(data.Casecode);
                    $("#DataBypass_ShowTimeSlot").val(ShowTimeSlot);
                    $("#DataBypass_CasecodeMessage").val(CasecodeMessage);
                }
            }
        });
    }

    function convertToJsDate(d) {
        var parsedDate = new Date(parseInt(d.substr(6)));
        return new Date(parsedDate);
    }

    function insertFBSSCoverageResult() {
        $("#HdResultId").val("");
        var addrType = $('input[name=R_BUILD]:checked').val();
        var floor = "";
        var lat = "";
        var lng = "";
        var postCode = $("#CoveragePanelModel_Address_L_ZIPCODE option:selected").text();
        var lang = "T";
        var subDisName = $("#COVERAGE_L_TUMBOL").val();
        var buildName = $("#L_BUILD_NAME option:selected").text();
        var buildNo = $('#L_BUILD_NO option:selected').text();
        var phoneFlag = $("input[name=L_HAVE_FIXED_LINE]:checked").val();
        var addrNo = $("#CoveragePanelModel_Address_L_HOME_NUMBER_1").val();
        var zipRowId = $("#CoveragePanelModel_Address_ZIPCODE_ID").val();
        var moo = $("#CoveragePanelModel_Address_L_MOO").val();
        var soi = $("#CoveragePanelModel_Address_L_SOI").val();
        var road = $("#CoveragePanelModel_Address_L_ROAD").val();
        var lcCode = $("#CustomerRegisterPanelModel_L_LOC_CODE").val();
        var ascCode = $("#CustomerRegisterPanelModel_L_ASC_CODE").val();
        var employeeID = $("#CustomerRegisterPanelModel_L_STAFF_ID").val();
        var saleFirstname = $("#THFirstName").val();
        var saleLastname = $("#THLastName").val();
        var locationName = $("#CustomerRegisterPanelModel_PartnerName").val();
        var subRegion = $("#outLocationSubRegion").val();
        var region = $("#outLocationRegion").val();
        var ascName = $("#outASCPartnerName").val();
        var channelName = $("#CustomerRegisterPanelModel_PartnerName").val();
        var saleChannel = $("#outChnSales").val();

        if (phoneFlag == "" || phoneFlag == undefined)
            phoneFlag = "N";

        if (buildNo == "@L_BUILD_NO")
            buildNo = "";

        if ($("#LanguagePage").val() == "2")
            lang = "E";

        if (addrType == "CONDOMINIUM") {
            floor = $("#CoveragePanelModel_Address_L_FLOOR").val();
            addrType = "B";
        }
        else if (addrType == "VILLAGE")
            addrType = "V";
        else
            addrType = "O";

        if (addrType == "B") {
            if ($("#L_BUILD_NAME").val() === "0") {
                buildName = $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").val();
                if (buildNo == "") {
                    buildNo = $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val();
                }
            }
        }
        else if (addrType == "V") {
            if ($("#Mooban1").val() == "0")
                buildName = $("#Mooban2").val();
            else
                buildName = $("#Mooban1 option:selected").text();
        }

        lat = $('#CoveragePanelModel__CoveragePanelModel_L_LAT2').val();
        lng = $('#CoveragePanelModel__CoveragePanelModel_L_LONG2').val();

        var chkCoveragetemp = "@ViewBag.chkCoverage"
        var chkCoverage;
        if (chkCoveragetemp == "True")
            chkCoverage = true;

        $.ajax({
            type: "GET",
            url: "/CheckCoverage/FBSSCoverageResultCommand",
            data: {
                "actionType": "Insert", "addrType": addrType, "postCode": postCode, "subDistrict": subDisName,
                "lang": lang, "buildName": buildName, "buildNo": buildNo, "phoneFlg": phoneFlag, "floor": floor, "addrNo": addrNo,
                "moo": moo, "soi": soi, "road": road, "lat": lat, "lng": lng, "coverage": $("#ZTECoverage").val(), "addrId": $("#ZTEAddressID").val(),
                "accessMode": $("#ZTEAccessModeSerializer").val(), "planSite": $("#ZTEPlanSite").val(), "isPartner": $("#ZTEIsPartner").val(),
                "partner": $("#ZTEPartnerName").val(), "productType": "", "zipRowId": zipRowId, "owner": "", "interfaceId": $("#ZTEInterfaceLogID").val(),"chkCoverage": chkCoverage,
                "lcCode": lcCode, "ascCode": ascCode, "employeeID": employeeID, "saleFirstname": saleFirstname, "saleLastname": saleLastname,
                "locationName": locationName, "subRegion": subRegion, "region": region, "ascName": ascName, "channelName": channelName, "saleChannel": saleChannel,
                "addressTypeDTL": "", "remark": "", "technology": "","projectName": ""
            },
            dataType: "json",
            //async: false,
            success: function (data) {
                $("#HdResultId").val(data);
            }
        });
    }

    function updateFBSSCoverageResult() {
        //R20.9
        var lcCode = $("#CustomerRegisterPanelModel_L_LOC_CODE").val();
        var ascCode = $("#CustomerRegisterPanelModel_L_ASC_CODE").val();
        var employeeID = $("#CustomerRegisterPanelModel_L_STAFF_ID").val();
        var saleFirstname = $("#THFirstName").val();
        var saleLastname = $("#THLastName").val();
        var locationName = $("#CustomerRegisterPanelModel_PartnerName").val();
        var subRegion = $("#outLocationSubRegion").val();
        var region = $("#outLocationRegion").val();
        var ascName = $("#outASCPartnerName").val();
        //R20.12
        var channelName = $("#CustomerRegisterPanelModel_PartnerName").val();
        var saleChannel = $("#outChnSales").val();

        $.ajax({
            type: "GET",
            url: "/CheckCoverage/FBSSCoverageResultCommand",
            data: {
                "action": "Update", "preName": $("#COVERATE_RESULT_TITLE_CODE").val(), "fName": $("#L_FIRST_NAME_PAGE12").val(),
                "lName": $("#L_LAST_NAME_PAGE12").val(), "contactNo": $("#L_CONTACT_PHONE_PAGE12").val(),
                "lcCode": lcCode, "ascCode": ascCode, "employeeID": employeeID, "saleFirstname": saleFirstname, "saleLastname": saleLastname,
                "locationName": locationName, "subRegion": subRegion, "region": region, "ascName": ascName, "channelName": channelName, "saleChannel": saleChannel,
                "addressTypeDTL": "", "remark": "", "technology": "", "projectName": ""
            },
            dataType: "json",
            async: false,
            success: function (data) {

            }
        });
    }

    function insertCoverageResult() {
        var onlineFlag = $('input[name=L_HAVE_FIXED_LINE]:checked').val();

        if (onlineFlag == undefined)
            onlineFlag = "N";

        var bSelected = $('input[name=R_BUILD]:checked').val();
        var nodeNameText = $('#L_BUILD_NAME option:selected').text();
        var towerText = $('#L_BUILD_NO option:selected').text();
        var floor = $('#CoveragePanelModel_Address_L_FLOOR').val();

        var coverageType = "N/A";

        if (bSelected != undefined && bSelected == 'CONDOMINIUM') {
            coverageType = "CONDOMINIUM";
        } else if (bSelected != undefined && bSelected == 'VILLAGE') {
            nodeNameText = $('#CoveragePanelModel_Address_L_MOOBAN').val();
            towerText = "";
            floor = "";
            coverageType = "VILLAGE";
        }

        if ($.trim(floor) == "")
            floor = 1;

        if ($.trim(nodeNameText) == "")
            nodeNameText = "-";

        if ($.trim(selected_building_obj.building_name) != "") {
            nodeNameText = selected_building_obj.building_name;
            towerText = "";
        }

        //for mapp lat long
        $("#CoveragePanelModel_L_LAT").val($("#CoveragePanelModel__CoveragePanelModel_L_LAT2").val());
        $("#CoveragePanelModel_L_LONG").val($("#CoveragePanelModel__CoveragePanelModel_L_LONG2").val());


        var response = $.ajax({
            type: "POST",
            url: "/CheckCoverage/InsertCoverageResult",
            data: {
                'cvrid': $('#L_BUILD_NO').val(),
                'nodeName': nodeNameText,
                'tower': towerText,
                'floor': floor,
                'isOnlineNumber': onlineFlag,
                'addressNo': $('#CoveragePanelModel_Address_L_HOME_NUMBER_1').val(),
                'moo': $('#CoveragePanelModel_Address_L_MOO').val(),
                'soi': $('#CoveragePanelModel_Address_L_SOI').val(),
                'road': $('#CoveragePanelModel_Address_L_ROAD').val(),
                'coverageType': coverageType,
                'coverageResult': $('#HdFunctionCoverageResult').val(),
                'lat': $("#CoveragePanelModel_L_LAT").val(),
                'lng': $('#CoveragePanelModel_L_LONG').val(),
                'prodType': $('#HdFunctionSubProducts').val(),
                'zipCodeRowId': $('#CoveragePanelModel_Address_ZIPCODE_ID').val(),
                'owner': $('#HdFunctionOwner').val(),
            },
            dataType: "json",
            async: false,

        }).responseText;

        var resultId = response;
        $("#CoveragePanelModel_L_HAVE_FIXED_LINE").val(onlineFlag);
        $("#HdResultId").val(resultId);
    }

    function CheckOn_Long_In() {
        $('#CoveragePanelModel__CoveragePanelModel_L_LAT').removeClass();
        $('#CoveragePanelModel__CoveragePanelModel_L_LONG').removeClass();
        $('#CoveragePanelModel__CoveragePanelModel_L_LAT').addClass("form-control");
        $('#CoveragePanelModel__CoveragePanelModel_L_LONG').addClass("form-control");
        $('#CoveragePanelModel__CoveragePanelModel_L_LAT').show();
        $('#CoveragePanelModel__CoveragePanelModel_L_LONG').show();

    }

    function CheckOn_Long_In_tpp() {
        $('#CoveragePanelModel__CoveragePanelModel_L_LAT_tpp').removeClass();
        $('#CoveragePanelModel__CoveragePanelModel_L_LONG_tpp').removeClass();
        $('#CoveragePanelModel__CoveragePanelModel_L_LAT_tpp').addClass("form-control");
        $('#CoveragePanelModel__CoveragePanelModel_L_LONG_tpp').addClass("form-control");
        $('#CoveragePanelModel__CoveragePanelModel_L_LAT_tpp').show();
        $('#CoveragePanelModel__CoveragePanelModel_L_LONG_tpp').show();

    }

    function onAmphurChange(amphur, tumbol, province) {
        $("#PicPOI").hide();
        $("#PicPOI").children("ol").html("");
        $("#PicPOI").children("div.carousel-inner").html("");
        $("#DIViframeMap").hide();
        $('#checkProcess').show();
        $('#COVERAGE_L_TUMBOL').empty();
        clearaddressPanel();

        var pv = $('#COVERAGE_L_PROVINCE').val();

        if (province != undefined) pv = province;

        var aphur = ""
        if ($('#COVERAGE_L_AMPHUR').val() != "" && $('#COVERAGE_L_AMPHUR').val() != null)
            aphur = $('#COVERAGE_L_AMPHUR').val();
        else
            aphur = amphur;

        $.ajax({
            type: "GET",
            url: "/CheckCoverage/GetTumbon",
            data: { 'provinceFilter': pv, 'amphurFilter': aphur },
            dataType: "json",
            async: false,
            success: function (data) {

                var strBuilder = "<option value='' disabled selected >" + "@L_TUMBOL" + "</option>";
                $.each(data, function (i, e) {
                    var s = "";
                    if (tumbol == e.Value) s = "selected";

                    var str = '<option value="' + e.Value + '"' + s + '>' + e.Text + '</option>';
                    strBuilder += str;
                });

                $('#COVERAGE_L_TUMBOL').append(strBuilder);
            }
        });
        resetOrDefault();
        $('#COVERAGE_L_TUMBOL').select2();
    }

    function onAmphurChangeNew(amphur, tumbol, province) {

        $('#COVERAGE_L_TUMBOL').empty();

        var pv = $('#COVERAGE_L_PROVINCE').val();

        if (province != undefined) pv = province;

        var aphur = ""
        if ($('#COVERAGE_L_AMPHUR').val() != "" && $('#COVERAGE_L_AMPHUR').val() != null)
            aphur = $('#COVERAGE_L_AMPHUR').val();
        else
            aphur = amphur;

        $.ajax({
            type: "GET",
            url: "/CheckCoverage/GetTumbon",
            async: false,
            data: { 'provinceFilter': pv, 'amphurFilter': aphur },
            dataType: "json",
            success: function (data) {
                var strBuilder = "<option value='' disabled selected >" + "@L_TUMBOL" + "</option>";
                if (aphur != "" && tumbol != "" && aphur != undefined && tumbol != undefined) {
                    strBuilder = "";
                }
                $.each(data, function (i, e) {

                    var s = "";
                    if (tumbol == e.Value) s = "selected";

                    var str = '<option value="' + e.Value + '"' + s + '>' + e.Text + '</option>';
                    strBuilder += str;
                });

                $('#COVERAGE_L_TUMBOL').append(strBuilder);
                $('#COVERAGE_L_TUMBOL').select2();
            },
            error: function (data) {
                var dd = data.error;

            }
        });

    }

    function onProvinceChangeNew(amphur, province) {

        var pv = $('#COVERAGE_L_PROVINCE').val();

        if (province != undefined) pv = province;

        $('#COVERAGE_L_AMPHUR').empty();
        $('#COVERAGE_L_TUMBOL').empty();
        $.ajax({
            type: "GET",
            url: "/CheckCoverage/GetAmphur",
            dataType: "json",
            data: { 'provinceFilter': pv },
            async: false,
            success: function (data) {
                var strBuilder = "<option value='' disabled selected >" + "@L_AMPHUR" + "</option>";
                if (amphur != "" && amphur != undefined) {
                    strBuilder = "";
                }
                $.each(data, function (i, e) {
                    var s = "";
                    if (amphur == e.Value) s = "selected";

                    var str = '<option value="' + e.Value + '"' + s + '>' + e.Text + '</option>';
                    strBuilder += str;
                });
                $('#COVERAGE_L_AMPHUR').append(strBuilder);
                $('#COVERAGE_L_AMPHUR').select2();
            }
        });

        $('#COVERAGE_L_TUMBOL').append("<option value='' disabled selected >" + "@L_TUMBOL" + "</option>");
    }

    function onProvinceChange(amphur, province) {
        $("#PicPOI").hide();
        $("#PicPOI").children("ol").html("");
        $("#PicPOI").children("div.carousel-inner").html("");
        $("#DIViframeMap").hide();
        $('#checkProcess').show();
        clearaddressPanel();

        var pv = $('#COVERAGE_L_PROVINCE').val();

        if (province != undefined) pv = province;

        $('#COVERAGE_L_AMPHUR').empty();
        $('#COVERAGE_L_TUMBOL').empty();
        $.ajax({
            type: "GET",
            url: "/CheckCoverage/GetAmphur",
            dataType: "json",
            data: { 'provinceFilter': pv },
            async: false,
            success: function (data) {
                var strBuilder = "<option value='' disabled selected >" + "@L_AMPHUR" + "</option>";
                $.each(data, function (i, e) {
                    var s = "";
                    if (amphur == e.Value) s = "selected";

                    var str = '<option value="' + e.Value + '"' + s + '>' + e.Text + '</option>';
                    strBuilder += str;
                });
                $('#COVERAGE_L_AMPHUR').append(strBuilder);
            }
        });

        $('#COVERAGE_L_TUMBOL').append("<option value='' disabled selected >" + "@L_TUMBOL" + "</option>");
        resetOrDefault();
        $('#COVERAGE_L_AMPHUR').select2();
        $('#COVERAGE_L_TUMBOL').select2();
    }

    function resetOrDefault(mb, bn) {
        disabledTower();
        disabledMooBan();
        if ((mb == undefined || mb == null || mb == "") && (bn != undefined && bn != null && bn != "")) {
            $("#R_BUILD").prop("checked", true);
        }
        else
            $("#CoveragePanelModel_Address_L_MOOBAN").val(mb);
        clearLatLong();
        $("#RD_L_LAT_LONG").prop("checked", false);
        $("#L_SPECIFIC_LOC222").prop("checked", false);
        hideMap();
        resetMainAddress();
        getBuildingBatch(undefined, undefined, undefined, undefined, undefined, undefined);


    }

    function resetMainAddress() {
        resetMainAddress2();
        $('#CoveragePanelModel_Address_L_ZIPCODE').empty();
        $('#CoveragePanelModel_Address_L_ZIPCODE').append("<option value='' disabled selected>" + "@L_ZIPCODE" + "</option>");
    }

    function resetMainAddress2() {
        $("#CoveragePanelModel_Address_L_ZIPCODE").removeAttr("disabled");
    }

    function clearLatLong() {
        $("#CoveragePanelModel__CoveragePanelModel_L_LAT2").val("");
        $("#CoveragePanelModel__CoveragePanelModel_L_LONG2").val("");
    }

    function onZipCodeChangeByBuildingName(buildingZipcodeRowId) {
        $('#CoveragePanelModel_Address_L_ZIPCODE').val(buildingZipcodeRowId);
        $('#CoveragePanelModel_Address_L_ZIPCODE').select2();
        $("#CoveragePanelModel_Address_ZIPCODE_ID").val(buildingZipcodeRowId);
    }

    function onZipCodeChange() {
        if ("@ESRIflag" != "true") {
            $("#CoveragePanelModel_Address_ZIPCODE_ID").val($('#CoveragePanelModel_Address_L_ZIPCODE').val());
        }
    }

    function getZipCode(tw, bd, p, a, t, mb, bn) {
        //console.log("getZipCode");
        clearaddressPanel();

        $("#DIViframeMap").hide();
        $('#checkProcess').show();
        $("#OwnerByBuild").val("");
        $("#CoveragePanelModel_Address_L_ZIPCODE").removeAttr("disabled");

        var pro = $("#COVERAGE_L_PROVINCE").val();
        var amp = $("#COVERAGE_L_AMPHUR").val();
        var tum = $("#COVERAGE_L_TUMBOL").val();

        if (p != undefined) pro = p;
        if (a != undefined) amp = a;
        if (t != undefined) tum = t;

        //onBuildChange("notBind");
        //resetOrDefault(mb, bn);

        $.ajax({
            type: "GET",
            url: "/CheckCoverage/GetCoverageZipCode",
            dataType: "json",
            data: {
                'provinceFilter': pro,
                'amphurFilter': amp,
                'tumbonFilter': tum,
                "sso": "@ViewBag.Vas"
            },
            async: false,
            success: function (data) {
                var tempZipCode = "";
                if (data.zipCodeList.length == 1)
                    $("#CoveragePanelModel_Address_L_ZIPCODE option[value='']").remove();

                $.each(data.zipCodeList, function (i, e) {
                    var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                    tempZipCode += str;
                });

                $('#CoveragePanelModel_Address_L_ZIPCODE').empty();
                $('#CoveragePanelModel_Address_L_ZIPCODE').append(tempZipCode);
                $('#CoveragePanelModel_Address_L_ZIPCODE').select2();
                onZipCodeChange();

                $('#R_BUILD').removeAttr('disabled');
                $('#R_MOOBAN').removeAttr('disabled');
                getBuildingBatch(p, a, t, mb, tw, bd);
            }
        });

    }
    function getZipCodeNew(tw, bd, p, a, t, mb, bn) {
        //console.log("getZipCodeNew");
        $("#OwnerByBuild").val("");
        $("#CoveragePanelModel_Address_L_ZIPCODE").removeAttr("disabled");
        var pro = $("#COVERAGE_L_PROVINCE").val();
        var amp = $("#COVERAGE_L_AMPHUR").val();
        var tum = $("#COVERAGE_L_TUMBOL").val();

        if (p != undefined) pro = p;
        if (a != undefined) amp = a;
        if (t != undefined) tum = t;

        $.ajax({
            type: "GET",
            url: "/CheckCoverage/GetCoverageZipCode",
            dataType: "json",
            data: {
                'provinceFilter': pro,
                'amphurFilter': amp,
                'tumbonFilter': tum,
                "sso": "@ViewBag.Vas"
            },
            async: false,
            success: function (data) {
                var tempZipCode = "";
                if (data.zipCodeList.length == 1)
                    $("#CoveragePanelModel_Address_L_ZIPCODE option[value='']").remove();

                $.each(data.zipCodeList, function (i, e) {
                    var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                    tempZipCode += str;
                });
                $('#CoveragePanelModel_Address_L_ZIPCODE').empty();
                $('#CoveragePanelModel_Address_L_ZIPCODE').append(tempZipCode);
                $('#CoveragePanelModel_Address_L_ZIPCODE').select2();
                onZipCodeChange();

                $('#R_BUILD').removeAttr('disabled');
                $('#R_MOOBAN').removeAttr('disabled');
            }
        });

    }

    function Onchage_GetCoverrageValueModel(zipId) {

        $('#L_BUILD_NAME').empty();
        $.ajax({
            type: "GET",
            url: "/CheckCoverage/GetCoverrageValueModel",
            dataType: "json",
            data: {
                'zipCodeId': zipId
            },
            success: function (data) {

                var strBuilder = '<option value="">' + '@L_BUILD_NAME' + '</option>';
                $.each(data, function (i, e) {
                    var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                    strBuilder += str;
                });
                $('#L_BUILD_NAME').append(strBuilder);
            }
        });
    }

    function onTowerChange(n, nt, b) {

        $("#CoveragePanelModel__CoveragePanelModel_L_LAT").val("");
        $("#CoveragePanelModel__CoveragePanelModel_L_LONG").val("");

        var nodeName = $("#L_BUILD_NAME").val();
        var nodeNameText = $("#L_BUILD_NAME option:selected").text();


        if (nodeName == "") {
        }
        else if (nodeName == "0") {
            resetMainAddress2();
            $("#DIV_L_BUILD_NAME").hide();
            $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").show();
            $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").removeAttr("disabled");
            var strBuilder = '<option value="">' + '@L_BUILD_NO' + '</option>';
            $('#L_BUILD_NO').empty();
            $('#L_BUILD_NO').append(strBuilder);

            if ($("#COVERAGE_L_PROVINCE").val() == "") {
                $("#RD_L_LAT_LONG").attr("disabled", "disabled");
                $("#L_SPECIFIC_LOC222").attr("disabled", "disabled");
            }
            else {
                $("#RD_L_LAT_LONG").removeAttr("disabled");
                $("#L_SPECIFIC_LOC222").removeAttr("disabled");
            }
            onZipCodeChange();
        }
        else {
            onZipCodeChangeByBuildingName($("#L_BUILD_NAME").val());
            hideMap();
            $("#DIV_D_L_BUILD_NO").show();
            getBuildingNoBatch(n, nt, b);
        }
    }

    function setLatLongFTTx(data) {
        $("#OwnerByBuild").val(data.OWNER_PRODUCT);
        $("#RD_L_LAT_LONG").prop("checked", true);
        $("#RD_L_LAT_LONG").click();

        if (data.LATITUDE != undefined && data.LONGITUDE != undefined && data.LATITUDE != "" && data.LONGITUDE != "") {
            $("#CoveragePanelModel__CoveragePanelModel_L_LAT").val(data.LATITUDE);
            $("#CoveragePanelModel__CoveragePanelModel_L_LONG").val(data.LONGITUDE);
        }
        else {
            $("#CoveragePanelModel__CoveragePanelModel_L_LAT").val("10.000000");
            $("#CoveragePanelModel__CoveragePanelModel_L_LONG").val("100.000000");
        }

    }

    function getMooBan() {

        $.ajax({
            type: "GET",
            url: "/CheckCoverage/GetMuban",
            dataType: "json",
            data: {
                "province": $('#COVERAGE_L_PROVINCE').val(), "amphur": $('#COVERAGE_L_AMPHUR').val(), "tumbon": $("#COVERAGE_L_TUMBOL").val()
                , "langFlag": $("#LanguagePage").val(), "sso": "@ViewBag.Vas"
            },
            success: function (data) {
                var s = "";
                var chkTemp = false;
                $("#Mooban1").empty();
                var temp = "<option value ='' disabled selected>@L_MOOBAN</option>";
                if (data.length > 0) {
                    $.each(data, function (i, e) {
                        if (e.LOV_NAME == $("#tMooban").val()) {
                            s = "selected";
                            chkTemp = true;
                        }
                        var str = "<option value ='" + e.LOV_NAME + "' " + s + ">" + e.LOV_NAME + "</option>";
                        temp += str;
                    });
                }
                if ($("#COVERAGE_L_TUMBOL").val() != "") {
                    if ($("#LanguagePage").val() == "1") {
                        temp += "<option value = '0'>อื่น ๆ โปรดระบุ</option>";
                    }
                    else {
                        temp += "<option value = '0'>Other</option>";
                    }
                }
                $("#Mooban1").append(temp);
                if (!chkTemp && $("#tMooban").val() != "") {
                    $("#Mooban1").val("0");
                    $("#divMooban1").hide();
                    $("#Mooban2").show();
                    $("#Mooban2").val($("#tMooban").val());
                }

            }
        });
    }

    function checkSWiFi(cvrid, cvrType) {
        try {
            var floor = "";
            var lat = "";
            var lng = "";

            if ($("#RD_L_LAT_LONG").is(":checked")) {
                lat = $('#CoveragePanelModel__CoveragePanelModel_L_LAT').val();
                lng = $('#CoveragePanelModel__CoveragePanelModel_L_LONG').val();
            }
            else if ($("#L_SPECIFIC_LOC222").is(":checked")) {
                lat = $('#CoveragePanelModel__CoveragePanelModel_L_LAT2').val();
                lng = $('#CoveragePanelModel__CoveragePanelModel_L_LONG2').val();
            }

            if (cvrType == "CONDOMINIUM")
                floor = $("#CoveragePanelModel_Address_L_FLOOR").val();

            var response = $.ajax({
                type: "GET",
                url: "/CheckCoverage/CheckAirnetWirelessCoverage",
                dataType: "json",
                data: {
                    'cvrid': cvrid,
                    'coverageType': cvrType,
                    'floor': floor,
                    'latitude': lat,
                    'longitude': lng,
                    "sso": "@ViewBag.Vas"
                },
                async: false,
            }).responseText;

            var data = JSON.parse(response);

            if (data.available) {
                $('#HdFunctionCoverageResult').val('Y');
                $('#HdFunctionSubProduct').val('SWiFi');
                $('#HdFunctionSubProducts').val('SWiFi');
                $('#HdFunctionProduct').val('AIR');
                $("#HdFunctionOwner").val("SWiFi");
            } else {
                $('#HdFunctionCoverageResult').val('N');
                $('#HdFunctionSubProduct').val('');
                $('#HdFunctionSubProducts').val('');
                $('#HdFunctionProduct').val('');
                $("#HdFunctionOwner").val("");
            }
        } catch (e) {
            alert(e.message);
        }
    }

    function checkFTTx() {
        var serviceType = "";

        if ($("#R_BUILD").is(":checked"))
            serviceType = "BUILDING";
        else if ($("#R_MOOBAN").is(":checked"))
            serviceType = "VILLAGE";
        else if ($("#R_OTHER").is(":checked"))
            serviceType = $("#R_OTHER").val();

        if ($("#Mooban1").val() == "0" || $('#L_BUILD_NAME').val() == "0")
            serviceType = "OTHER";

        try {
            var response = $.ajax({
                type: "GET",
                url: "/CheckCoverage/CheckCoverageRegion",
                dataType: "json",
                data: {
                    "province": $('#COVERAGE_L_PROVINCE').val(), "amphur": $('#COVERAGE_L_AMPHUR').val(), "tambon": $("#COVERAGE_L_TUMBOL").val(),
                    "language": $("#LanguagePage").val(), "sso": "@ViewBag.Vas", "serviceType": serviceType
                },
                async: false,
            }).responseText;

            var data = JSON.parse(response);
            if (data.available) {
                $('#HdFunctionCoverageResult').val('Y');
                $('#HdFunctionSubProduct').val('FTTx');
                $('#HdFunctionSubProducts').val('FTTx');
                $('#HdFunctionProduct').val('FBB');
                $("#HdFunctionOwner").val(data.OWNER_PRODUCT);

            } else {
                $('#HdFunctionCoverageResult').val('N');
                $('#HdFunctionSubProduct').val('');
                $('#HdFunctionSubProducts').val('');
                $('#HdFunctionProduct').val('');
                $("#HdFunctionOwner").val("");
            }

        } catch (e) {
            alert(e.message);
        }
    }


    function checkPortAvailable(cvrid) {

        try {
            var onlineFlag = $('input[name=L_HAVE_FIXED_LINE]:checked').val();

            if (!onlineFlag)
                onlineFlag = "N";

            var cvrIdParam = 0;
            if (!cvrid) {
                cvrIdParam = 0;
            }
            else
                cvrIdParam = cvrid;

            var response = $.ajax({
                type: "GET",
                url: "/CheckCoverage/CheckPortAvailable",
                data: {
                    'cvrid': cvrIdParam, 'flagOnlineNo': onlineFlag, 'buildname': $('#DIV_D_L_BUILD_NO :selected').text()
                },

                async: false,
            }).responseText;

            var data = JSON.parse(response);

            if (data.available) {
                $('#HdFunctionCoverageResult').val('Y');
                $('#HdFunctionSubProduct').val('WireBB');
                $('#HdFunctionSubProducts').val('WireBB');
                $('#HdFunctionProduct').val('FBB');
                $("#HdFunctionOwner").val("WireBB");
            } else {
                $('#HdFunctionCoverageResult').val('N');
                $('#HdFunctionSubProduct').val('');
                $('#HdFunctionSubProducts').val('');
                $('#HdFunctionProduct').val('');
                $("#HdFunctionOwner").val("");

            }
        } catch (e) {

            $('#HdFunctionCoverageResult').val('N');
            $('#HdFunctionSubProduct').val('');
            $('#HdFunctionSubProducts').val('');
            $('#HdFunctionProduct').val('');
            $("#HdFunctionOwner").val("");
        }
    }

    function onChangeID_CARD_NAMEs(idCardName) {
        $("#L_CARD_NOs").val("");

        $.ajax({
            type: "GET",
            url: "/CustomerRegister/GetCustomerSubCat",
            data: { 'idCardName': idCardName.value },
            dataType: "json",
            async: false,
            success: function (data) {
            },
        });

        setCardMaxlength();
    }


    function setCardMaxlength() {

        if ($("#ID_CARD_NAMEs :selected").val() == "TAX_ID")
            $("#L_CARD_NOs").attr("maxlength", "@FBB_Con_Length_ID_Card_Number_TAX_ID");

        else if ($("#ID_CARD_NAMEs :selected").val() == "MONK_CERT")
            $("#L_CARD_NOs").attr("maxlength", "@FBB_Con_LengthIDCardNumberMONK_CERT");

        else if ($("#ID_CARD_NAMEs :selected").val() == "GOV_LET")
            $("#L_CARD_NOs").attr("maxlength", "@FBB_Con_Length_ID_Card_Number_GOV_LET");

        else if ($("#ID_CARD_NAMEs :selected").val() == "PASSPORT")
            $("#L_CARD_NOs").attr("maxlength", "@FBB_Con_Length_ID_Card_Number_PASSPORT");

        else if ($("#ID_CARD_NAMEs :selected").val() == "EMB_LET")
            $("#L_CARD_NOs").attr("maxlength", "@FBB_Con_Length_ID_Card_Number_EMB_LET");

        else if ($("#ID_CARD_NAMEs :selected").val() == "IMM_CARD")
            $("#L_CARD_NOs").attr("maxlength", "@FBB_Con_LengthIDCardNumberIMM_CARD");

        else if ($("#ID_CARD_NAMEs :selected").val() == "STA_LET")
            $("#L_CARD_NOs").attr("maxlength", "@FBB_Con_Length_ID_Card_Number_STA_LET");

        else if ($("#ID_CARD_NAMEs :selected").val() == "HILL_CARD")
            $("#L_CARD_NOs").attr("maxlength", "@FBB_Con_LengthIDCardNumberHILL_CARD");

        else if ($("#ID_CARD_NAMEs :selected").val() == "CERT_FOUND")
            $("#L_CARD_NOs").attr("maxlength", "@FBB_Con_Length_ID_Card_Number_CERT_FOUND");

        else if ($("#ID_CARD_NAMEs :selected").val() == "ID_CARD")
            $("#L_CARD_NOs").attr("maxlength", "@FBB_Con_LengthIDCardNumberID_CARD");

        else if ($("#ID_CARD_NAMEs :selected").val() == "ROY_LET")
            $("#L_CARD_NOs").attr("maxlength", "@FBB_Con_Length_ID_Card_Number_ROY_LET");

    }


    function getCustomerCardTypes() {
        $('#ID_CARD_NAMEs').empty();
        $.ajax({
            type: "GET",
            url: "/MasterData/GetCustomerCardType",
            data: { 'customerType': "All" },
            dataType: "json",
            async: false,
            success: function (data) {
                var strBuilder = "";
                var flagSelect = false;
                var firstStr = "<option value='' disabled>" + "@lCARD_TYPE" + "</option>";
                $.each(data, function (i, e) {
                    if (e.DefaultValue != undefined)
                        strBuilder += '<option value="' + e.Value + '" selected>' + e.Text + '</option>';
                    else
                        strBuilder += '<option value="' + e.Value + '">' + e.Text + '</option>';
                });
                strBuilder = firstStr + strBuilder;

                $('#ID_CARD_NAMEs').append(strBuilder);
                $('#ID_CARD_NAMEs').select2();
            }
        });
        setCardMaxlength();
    }

    function CheckPostPaid() {
        var chkPostPaid = false;
        $.ajax({
            url: "/CheckCoverage/CheckPrePostPaid",
            data: { msisdn: $("#AisAirNumber").val(), orderRef: $.trim($("#L_CARD_NOs").val()), cond: "" },
            dataType: "json",
            type: 'POST',
            async: false,
            success: function (response) {

                if (response) {
                    chkPostPaid = true;
                    $("#CoveragePanelModel_MobileSegment").val("POSTPAID");
                } else {
                    chkPostPaid = false;
                    $("#CoveragePanelModel_MobileSegment").val("PREPAID");
                }
            }
        });
        return chkPostPaid;
    }

    function checkProcessAisAirnet() {

        $("#chkTypePass").val("");
        $("#tAisAirNumber").val("");
        $("#tL_CARD_NOs").val("");
        $("#tID_CARD_NAMEs").val("");
        $("#tMooban").val("");
        $("#SffProfileLogID").val("");

        sessionStorage.setItem("AisAirNumber", $("#AisAirNumber").val());
        sessionStorage.setItem("L_CARD_NOs", $("#L_CARD_NOs").val());
        sessionStorage.setItem("ID_CARD_NAMEs", $("#ID_CARD_NAMEs").val());


        var chk = false;
        var a = [];
        a.push({ id: "AisAirNumber", condition: "Number" });
        a.push({ id: "L_CARD_NOs" });
        a.push({ id: "ID_CARD_NAMEs" });

        chk = ValidationProcessing(a, "err001_2");

        if ($("#AisAirNumber").val().length < '@FBB_Con_MobileLength') {
            $("#AisAirNumber").addClass("form-control errorinput");
            toastrErrorMessage("@L_NEW_CUST_NOT_FOUND");
            chk = false;
        }

        if (($("#ID_CARD_NAMEs :selected").val() == "ID_CARD") && ($("#L_CARD_NOs").val().length < '@FBB_Con_LengthIDCardNumberID_CARD')) {
            $("#L_CARD_NOs").addClass("form-control errorinput");
            toastrErrorMessage("@L_NEW_CUST_NOT_FOUND");
            chk = false;
        }

        if (chk) {
            if (($.trim($("#AisAirNumber").val().substring(0, 3)) == "007")) {
                toastrErrorMessage("@L_NEW_CUST_NOT_FOUND11");
            }
            else {
                $.ajax({
                    url: "/CheckCoverage/CheckPrePostPaids",
                    data: { msisdn: $("#AisAirNumber").val(), orderRef: $.trim($("#L_CARD_NOs").val()), cond: "" },
                    dataType: "json",
                    type: 'POST',
                    async: false,
                    success: function (data1) {

                        if (data1.IsSuccess == "True" && data1.Chm == "0" && data1.State == "1") {//Postpaid
                            $.ajax({
                                url: '/CheckCoverage/evESeServiceQueryMassCommonAccountInfo',
                                data: { mobileNo: codefbb.fbbMessage($("#AisAirNumber").val()), cardNo: $.trim($("#L_CARD_NOs").val()), cardType: $("#ID_CARD_NAMEs").val(), line: "", SubNetworkType: "POSTPAID" },
                                dataType: "json",
                                type: 'POST',
                                async: false,
                                success: function (response) {
                                    var data = response.data;

                                    $("#dataSFF").val(data.errorMessage + " ,Full Error: " + data.outErrorMessage);
                                    if ($.trim(data.errorMessage) == "EB0001" || $.trim(data.errorMessage) == "EB0574") {

                                        toastrErrorMessage("@L_NEW_CUST_NOT_FOUND.");
                                    }
                                    else if (data.errorMessage == "") {
                                        $.ajax({
                                            url: '/CheckCoverage/GetProcessAisAirnet',
                                            data: { key: data.GUIDKEY, },
                                            dataType: "json",
                                            type: 'POST',
                                            async: false,
                                            success: function (data) {
                                                var data = response.data;

                                                //found data
                                                var chk3G_postpaid = true;
                                                var v_add_triple = "N"; //Check สิทธิ์ Tripple Play
                                                var chk_Serenade_Flag = ""; // Check สิทธิ์ส่วนลด Bundling
                                                if (data.outProductName == "3G" || data.outProductName == "4G") {

                                                    // Add กรณีเป็นเบอร์ 88 หรือ 89 ให้ผ่านตลอด ไม่ต้อง เรียก CheckPostPaid
                                                    if (($.trim($("#AisAirNumber").val().substring(0, 2)) == "88") || ($.trim($("#AisAirNumber").val().substring(0, 2)) == "89")) {
                                                        chk3G_postpaid = true;
                                                        v_add_triple = "N";
                                                    } else {
                                                        //if (chkpostpaid) {
                                                        if (data1.IsSuccess == "True" && data1.Chm == "0" && data1.State == "1") {
                                                            $("#CoveragePanelModel_ChargeType").val("POSTPAID");

                                                            var chkDubTipple = false;
                                                            v_add_triple = data.vataddTripleplay;

                                                            if (v_add_triple == "Y") {
                                                                var myCheckSerenadeArray = [];
                                                                @foreach (var CheckSerenadeItem in CheckSerenadeArray)
                                                                {
                                                    @:myCheckSerenadeArray.push("@CheckSerenadeItem");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                if (myCheckSerenadeArray.indexOf(data.outMobileSegment) >= 0) {
                                                                    chk_Serenade_Flag = 'Y';//ลูกค้าเก่าที่เป็นserenade
                                                                }
                                                                else {
                                                                    chk_Serenade_Flag = 'N';//ลูกค้าเก่าที่ไม่ใช่serenade
                                                                }
                                                            }
                                                            else {
                                                                chk_Serenade_Flag = "";
                                                            }
                                                        }
                                                        else if (data1.IsSuccess == "True" && data1.Chm == "1" && data1.State == "1") {
                                                            $("#CoveragePanelModel_ChargeType").val("PREPAID");

                                                            chk3G_postpaid = false;
                                                            v_add_triple = "N";  //Prepaid
                                                            chk_Serenade_Flag = 'N';//ลูกค้าเก่าที่ไม่ใช่serenade
                                                        }
                                                    }
                                                }
                                                else {
                                                    v_add_triple = "N";
                                                }

                                                $("#HdchkSerenade_Flag").val(chk_Serenade_Flag);
                                                $("#HdAddTriple").val(v_add_triple);
                                                if ("@ViewBag.Vas" == "6") { /// stafff มองไม่เห็น tripleplay
                                                    $("#HdAddTriple").val('N');
                                                }
                                                if (chk3G_postpaid) {
                                                    //Tab New Cus
                                                    getProvince(data.outProvince);
                                                    onProvinceChangeNew(data.outAmphur, data.outProvince);
                                                    onAmphurChangeNew(data.outAmphur, data.outTumbol, data.outProvince);

                                                    var twName = "";
                                                    var bdName = "";

                                                    if ((data.outMooban != undefined && data.outMooban != null && data.outMooban != "")
                                                            || data.outBuildingName == undefined
                                                            || data.outBuildingName == null
                                                            || data.outBuildingName == "") {
                                                        $("#R_OTHER").prop("checked", false);
                                                        $("#R_BUILD").prop("checked", true);
                                                        $("#R_MOOBAN").prop("checked", false);
                                                        $("#divTower").hide();
                                                        $("#divBaan").show();
                                                        $("#tMooban").val(data.outMooban);
                                                        $("#Mooban1").val("0");
                                                        $("#Mooban2").typeahead("val", data.outMooban);
                                                        selected_building_obj.building_name = data.outMooban;

                                                        getZipCode(undefined, bdName, data.outProvince, data.outAmphur, data.outTumbol, data.outMooban, data.outBuildingName);
                                                        getProvince(data.outProvince);
                                                        onProvinceChangeNew(data.outAmphur, data.outProvince);
                                                        onAmphurChangeNew(data.outAmphur, data.outTumbol, data.outProvince);
                                                        $("#RD_L_LAT_LONG").removeAttr("disabled");
                                                        $("#L_SPECIFIC_LOC222").removeAttr("disabled");
                                                    }
                                                    else {

                                                        if (data.outBuildingName != undefined && data.outBuildingName != null && data.outBuildingName != "") {
                                                        }
                                                        else {
                                                            data.outBuildingName = "";
                                                        }
                                                        var twSp = data.outBuildingName.split(' ');
                                                        bdName = twSp[twSp.length - 1];
                                                        twName = data.outBuildingName.replace(" " + bdName, "");
                                                        if (bdName.length > 3) {
                                                            twName += " " + bdName;
                                                            bdName = "";
                                                        }

                                                        $("#R_MOOBAN").prop("checked", false);
                                                        $("#R_OTHER").prop("checked", false);
                                                        $("#R_BUILD").prop("checked", true);

                                                        getProvince(data.outProvince);
                                                        onProvinceChangeNew(data.outAmphur, data.outProvince);
                                                        onAmphurChangeNew(data.outAmphur, data.outTumbol, data.outProvince);

                                                        getZipCode(twName, bdName, data.outProvince, data.outAmphur, data.outTumbol);
                                                        $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").typeahead("val", twName);

                                                        selected_building_obj.building_name = twName;
                                                        $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val(bdName);

                                                    }
                                                    $("#CoveragePanelModel_Address_L_FLOOR").val(data.outFloor);
                                                    $("#CoveragePanelModel_Address_L_HOME_NUMBER_1").val(data.outHouseNumber);
                                                    $("#CoveragePanelModel_Address_L_MOO").val(data.outMoo);
                                                    $("#CoveragePanelModel_Address_L_SOI").val(data.outSoi);
                                                    $("#CoveragePanelModel_Address_L_ROAD").val(data.outStreetName);

                                                    $("#L_EMAIL").val(data.outEmail);
                                                    $("#chkTypePass").val("1");


                                                    if ($("#chkTypePass").val() != "1") {
                                                        resetBody();
                                                    }
                                                    $("#cvrbody").show();
                                                    $("#cvrbodybtn").show();
                                                    $("#cvrbodyno").hide();
                                                    $("#cvrbodynobtn").hide();

                                                    $("#tAisAirNumber").val($("#AisAirNumber").val());
                                                    $("#tL_CARD_NOs").val($("#L_CARD_NOs").val());
                                                    $("#tID_CARD_NAMEs").val($("#ID_CARD_NAMEs").val());
                                                    $("#L_CARD_NO").val($("#tL_CARD_NOs").val());
                                                    $("#tCardType").val(data.cardType);
                                                    $("#CoveragePanelModel_BA_ID").val(data.outBillingAccountNumber);
                                                    $("#CoveragePanelModel_CA_ID").val(data.outAccountNumber);
                                                    $("#CoveragePanelModel_SA_ID").val(data.outServiceAccountNumber);
                                                    $("#CoveragePanelModel_P_MOBILE").val($("#AisAirNumber").val());
                                                    $("#CoveragePanelModel_SffProductName").val(data.outProductName);
                                                    $("#CoveragePanelModel_MobileSegment").val(data.outMobileSegment);
                                                    $("#CoveragePanelModel_SffServiceYear").val(data.outDayOfServiceYear);
                                                    $("#tTitle").val(data.outTitle);
                                                    $("#CoveragePanelModel_BillingSystem").val(data.outBillingSystem);

                                                    var nst = $("#tAisAirNumber").val().substr(0, 1);
                                                    if (nst == "0")
                                                        $("#L_MOBILE").val($("#tAisAirNumber").val());
                                                    //sessionStorage.setItem("L_MOBILE", $("#tAisAirNumber").val());
                                                    $("#tDD").val("");
                                                    $("#tMM").val("");
                                                    $("#tYY").val("");

                                                    $("#SffProfileLogID").val(data.SffProfileLogID);
                                                    $("#IsAWNProduct").val(data.IsAWNProduct);
                                                    //Tab New Cus
                                                }
                                            }
                                        });
                                    }
                                    else { //error service
                                        toastrErrorMessage("@L_NEW_CUST_NOT_FOUND");
                                    }
                                }
                                //, error: function (err) { }
                            });
                        }
                        else if (data1.IsSuccess == "True" && data1.Chm == "1" && data1.State == "1") {//Prepaid
                            $("#CoveragePanelModel_ChargeType").val("PREPAID");
                            chk3G_postpaid = false;
                            v_add_triple = "N";  //Prepaid
                            chk_Serenade_Flag = 'N';//ลูกค้าเก่าที่ไม่ใช่serenade
                            $("#tAisAirNumber").val($("#AisAirNumber").val());
                            var nst = $("#tAisAirNumber").val().substr(0, 1);
                            if (nst == "0") {

                                $("#L_MOBILE").val($("#tAisAirNumber").val());
                                $("#CoveragePanelModel_P_MOBILE").val($("#tAisAirNumber").val());
                            }

                            sessionStorage.setItem("type", "AIS");
                            $("#HdchkSerenade_Flag").val(chk_Serenade_Flag);

                            if ($("#chkTypePass").val() != "1") {
                                resetBody();
                            }
                            $("#cvrbody").show();
                            $("#cvrbodybtn").show();
                            $("#cvrbodyno").hide();
                            $("#cvrbodynobtn").hide();
                            $("#btnCusAis").removeClass('btn-success').addClass('btn-default');
                            $("#btnCusNew").addClass('btn-success');

                        }
                        else {
                            $("#AisAirNumber").addClass("form-control errorinput");
                            $("#L_CARD_NOs").addClass("form-control errorinput");
                            toastrErrorMessage("@L_NEW_CUS_NON_AIS");
                        }
                    }
                });

            }
        }
    }

    function onMoobanChang() {
        //console.log("onMoobanChange");
        hideMap();
        $("#CoveragePanelModel__CoveragePanelModel_L_LAT").val("");
        $("#CoveragePanelModel__CoveragePanelModel_L_LONG").val("");
        if ($("#Mooban1").val() != "0" && $("#Mooban1").val() != "" && $("#Mooban1").val() != null) {
            $('#CoveragePanelModel_Address_L_ZIPCODE').val($("#Mooban1").val());
            onZipCodeChange();
            $("#CoveragePanelModel_Address_L_ZIPCODE").attr("disabled", "disabled");
        }
        else { //อื่น ๆ
            $("#RD_L_LAT_LONG").prop("checked", false);
            $("#h_L_HOW_LAT_LONG22").hide();
            onZipCodeChange();
            if ($("#Mooban1").val() == "0") {
                $("#divMooban1").hide();
                $("#Mooban2").show();
            }
        }
    }

    function getBuildingBatch(sffProvince, sffAmphur, sffTumbol, sffMb, sffTw, sffBb) {
        //console.log("getBuildingBatch");
        var addrType = $('input[name=R_BUILD]:checked').val();
        var lang = "T";
        var temp = "";

        var province = $("#COVERAGE_L_PROVINCE").val();
        var amphur = $("#COVERAGE_L_AMPHUR").val();
        var tumbol = $("#COVERAGE_L_TUMBOL").val();

        var loc_code = $("#CustomerRegisterPanelModel_L_LOC_CODE").val();

        var valueMatch = "";
        var pC = "";
        var bN = "";

        if (sffProvince != undefined) province = sffProvince;
        if (sffAmphur != undefined) amphur = sffAmphur;
        if (sffTumbol != undefined) tumbol = sffTumbol;

        if ($("#LanguagePage").val() == "2")
            lang = "E";

        if (addrType == "CONDOMINIUM") {
            addrType = "B";
            valueMatch = sffTw;
            temp = "<option value='' disabled selected>@L_BUILD_NAME</option>";
            showTypeaheadLoading("#CoveragePanelModel_Address_L_BUILD_NAME_Hied");
        }
        else if (addrType == "VILLAGE") {
            addrType = "V";
            valueMatch = sffMb;
            temp = "<option value='' disabled selected>@L_MOOBAN</option>";
            showTypeaheadLoading("#Mooban2");
        }
        else
            addrType = "O";

        $.ajax({
            type: "GET",
            url: "/CheckCoverage/GetBuildingChange",
            data: {
                "province": province, "aumphur": amphur, "tumbon": tumbol,
                "type": addrType, "language": lang, "loc_code": loc_code
            },
            dataType: "json",
            //async: false,
            success: function (data) {

                var chkMatch = false;

                buildings = [];
                states = [];
                zipcodes = [];
                addressIds = [];
                provincess = [];
                amphurss = [];
                tumbonss = [];
                zipcode5 = [];
                sitecodess = [];
                latitudes = [];
                longtitudes = [];

                $('pre').html('');

                destroyTypeahead('#CoveragePanelModel_Address_L_BUILD_NAME_Hied');
                $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").hide();
                $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val("");

                $.each(data, function (i, e) {
                    var s = "";
                    if (valueMatch === e.Text) {
                        s = "selected";
                        pC = e.Value;
                        bN = e.Text;
                        temp = temp.replace("selected", " ");
                        chkMatch = true;
                    }

                    var str = "<option value='" + e.Value + "' " + s + ">" + e.Text + "</option>";
                    temp += str;

                    if (e.Value && e.Value !== '0') {
                        var building_json = JSON.parse(e.Value);
                        buildings.push(building_json);
                        states.push(building_json.building_name_for_srh);
                        zipcodes.push(building_json.zipcode_rowid);
                        addressIds.push(building_json.address_id);
                        provincess.push(building_json.province);
                        amphurss.push(building_json.amphur);
                        tumbonss.push(building_json.tumbon);
                        zipcode5.push(building_json.zipcode);
                        sitecodess.push(building_json.sitecode);
                        latitudes.push(building_json.latitude);
                        longtitudes.push(building_json.longtitude);

                        if (building_json.AccessMode) {
                            console.log("building_json.AccessMode: ", building_json.AccessMode);
                        }
                    }
                });

                if (addrType == "B") {
                    if (!chkMatch && sffTw != "" && sffTw != undefined) {
                        resetMainAddress2();
                        $("#DIV_L_BUILD_NAME").hide();
                        $("#DIV_D_L_BUILD_NO").hide();

                        destroyTypeahead('#CoveragePanelModel_Address_L_BUILD_NAME_Hied');
                        $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").val("");
                        clear_building_ogj();


                        createTypeahead('#CoveragePanelModel_Address_L_BUILD_NAME_Hied', states);

                        $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").show();
                        $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").removeAttr("disabled");
                        $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").typeahead('val', sffTw.toUpperCase());
                        selected_building_obj.building_name = sffTw.toUpperCase();

                        $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").show();
                        $("#L_BUILD_NAME").val("0");
                    }
                    else {
                        $("#DIV_L_BUILD_NAME").hide();
                        $("#DIV_D_L_BUILD_NO").hide();
                        $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").show();
                        $("#L_BUILD_NAME").val("0");

                        if (chkMatch)
                            $("#CoveragePanelModel_Address_L_ZIPCODE").attr("disabled", "disabled");

                        destroyTypeahead('#CoveragePanelModel_Address_L_BUILD_NAME_Hied');
                        createTypeahead('#CoveragePanelModel_Address_L_BUILD_NAME_Hied', states);

                    }


                    if (!chkMatch && sffBb !== undefined && sffBb !== '') {
                        typeaheadoncomplete(selected_building_obj.building_name);
                    };

                    if (chkMatch && sffBb !== undefined && sffBb !== '') {
                        typeaheadoncomplete(sffTw, undefined, sffBb);
                    };
                }
                else if (addrType == "V") {
                    if (!chkMatch && sffMb != "" && sffMb != undefined) {
                        $("#Mooban1").append(temp);
                        $("#Mooban1").val("0");
                        $("#divMooban1").hide();
                        $("#Mooban2").show();
                        $("#Mooban2").typeahead("val", sffMb);
                        selected_building_obj.building_name = sffTw;
                    }
                    else {
                        $("#Mooban1").empty();
                        $("#Mooban1").append(temp);
                        $("#Mooban1").val("0");
                        createTypeahead('#Mooban2', states);
                        if (chkMatch && sffMb != "" && sffMb != undefined) {
                            $("#Mooban2").typeahead("val", sffMb);
                            selected_building_obj.building_name = sffTw;
                            typeaheadoncomplete(sffMb);
                        };
                    }
                }
                $("input:text.tt-hint").remove();

                //17.7 Member get member
                if ($('#MemberGetMemberFlag').val() == 'Y') {
                    if (sessionStorage.getItem('firstloadbuildingcount') != null && sessionStorage.getItem('firstloadbuildingcount') > 0) {
                        sessionStorage.setItem('firstloadbuildingcount', Number(sessionStorage.getItem('firstloadbuildingcount')) + 1);
                    } else {
                        sessionStorage.setItem('firstloadbuildingcount', 1);

                        $('#CoveragePanelModel_Address_L_BUILD_NAME_Hied').val($('#CoverageMemberGetMember_BuildingName').val());
                        //$('#CoveragePanelModel_Address_L_BUILD_NAME_Hied').trigger('typeahead:change', $('#CoverageMemberGetMember_BuildingName').val());
                        // $('#CoveragePanelModel_Address_L_BUILD_NAME_Hied').trigger('typeahead:select', $('#CoverageMemberGetMember_BuildingName').val());
                        typeaheadoncompleteMembergetmember($('#CoverageMemberGetMember_BuildingName').val());
                        if (!CheckShowBuildNo) $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").show();
                        BindValue_ForIMOrder();
                    }
                }
            }
        });
    }

    function BindValue_ForIMOrder() {
        var rawData = '@Html.Raw(ViewBag.IMData)';
        if (rawData != '') {
            var imData = JSON.parse(rawData);
            //console.log(imData);
            var buildingData = null;
            var zipCodeRowID = null;
            $.each(buildings, function (i, e) {
                if (e.building_name == imData.BuildingName) {
                    buildingData  = e;
                }
                if (e.zipcode == imData.PostCode && e.tumbon == imData.SubDistrict && e.amphur == imData.Distrinct && e.province == imData.Province) {
                    zipCodeRowID = e.zipcode_rowid;
                }
                if (buildingData  != null && zipCodeRowID != null) {
                    return true;
                }
            });
            if (buildingData  != null) {
                $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").typeahead('val', buildingData .building_name);
                $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").trigger('typeahead:select', [buildingData.building_name_for_srh]);
            }
            //if ($("#COVERAGE_L_PROVINCE").val() != imData.Province || $("#COVERAGE_L_AMPHUR").val() != imData.Distrinct || $("#COVERAGE_L_TUMBOL").val() != imData.SubDistrict) {
            //    $("#COVERAGE_L_PROVINCE").val(imData.Province);
            //    $("#COVERAGE_L_PROVINCE").trigger('change');
            //    $("#COVERAGE_L_AMPHUR").val(imData.Distrinct);
            //    $("#COVERAGE_L_AMPHUR").trigger('change');
            //    $("#COVERAGE_L_TUMBOL").val(imData.SubDistrict);
            //    $("#COVERAGE_L_TUMBOL").trigger('change');
            //}
            //$("#CoveragePanelModel_Address_L_ZIPCODE").val(zipCodeRowID);
            //$("#CoveragePanelModel_Address_L_ZIPCODE").trigger('change');
            //if ($("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").val() == "") {
            //    $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").typeahead('val',imData.VillageName);
            //}
            //$("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val(imData.BuildingName);
            //$("#CoveragePanelModel_Address_L_HOME_NUMBER_1").val(imData.HouseNo);
            //$("#CoveragePanelModel_Address_L_SOI").val(imData.Soi);
            //$("#CoveragePanelModel_Address_L_ROAD").val(imData.Road);
        }
    }

    function getBuildingNoBatch(pC, bN, b) {

        buildnos = [];

        $("#L_BUILD_NO").empty();
        var lang = "T";
        var temp = "";
        var postCode = $("#L_BUILD_NAME").val();
        var buildName = $("#L_BUILD_NAME option:selected").text();
        if (pC != undefined && bN != undefined) {
            postCode = pC;
            buildName = bN;
        }
        if (bN != undefined) {
            buildName = bN;
        }
        if ($("#LanguagePage").val() == "2")
            lang = "E";

        $.ajax({
            type: "GET",
            url: "/CheckCoverage/GetBuildingNo",
            data: {
                "postcode": postCode, "build_name": buildName, "language": lang
            },
            dataType: "json",
            async: false,
            success: function (data) {
                temp += "<option value='' disabled selected>@L_BUILD_NO</option>";
                var s = "";

                if (data.length == 1) {
                    s = "selected";
                    temp = temp.replace("selected", " ");
                }

                $.each(data, function (i, e) {

                    if (b == e.Value && data.length > 1) {
                        s = "selected";
                        temp = temp.replace("selected", " ");
                    }

                    var str = '<option value="' + e.Value + '"' + s + '>' + e.Text + '</option>';
                    temp += str;
                    s = '';

                    if (e.Value !== '0') {
                        buildnos.push(e.Text);
                    }
                });

                $("#L_BUILD_NO").append(temp);

                if ((buildName !== undefined && buildName !== '') && data.length === 0) {
                    $("#DIV_D_L_BUILD_NO").hide();
                    $("#DIV_BUILD_NO_OUTER").hide();
                } else {
                    $("#DIV_D_L_BUILD_NO").show();
                    $("#DIV_BUILD_NO_OUTER").show();
                };

            }
        });
    }

    function FBSSAccessModeInfo() {
        AccessMode: "";
        InserviceDate: null;
        ResourceList: [];
    }

    function ResourceInfo() {
        ResourceName: "";
    }

    function ImageModelInfo() {
        transaction_id: "";
        user: "";
        language: "";
        site_code: "";
        sub_district: "";
        zip_code: "";
    }

    function OrderDupModeInfo() {
        CAN_DELETE: "";
        ID_CARD_NO: "";
        ORDER_CREATED_DTM: null;
        CUSTOMER_ADDRESS: "";
        INSTALL_DATE: null;
        ORDER_STATUS: "";
        PACKAGE_NAME: "";
        ORDER_NO: "";
    }

    function GetP_Region() {
        $.ajax({
            url: '/CheckCoverage/GetP_Region',
            data: { rowid: $("#CoveragePanelModel_Address_L_ZIPCODE").val() },
            dataType: "json",
            type: 'POST',
            async: false,
            success: function (data) {
                $("#P_Region").val(data);
            }
        });
    }

    function Get_Region() {
        $.ajax({
            url: '/CheckCoverage/Get_Region',
            data: { rowid: $("#CoveragePanelModel_Address_L_ZIPCODE").val() },
            dataType: "json",
            type: 'POST',
            async: false,
            success: function (data) {
                $("#CoveragePanelModel_Address_AreaRegion").val(data);
            }
        });
    }

    function bindTriple() {

        var mobile = codefbb.fbbMessage($("#CoveragePanelModel_P_MOBILE").val());
        var cardno = "@Model.CustomerRegisterPanelModel.L_CARD_NO";
        var cardtype = "@Model.CustomerRegisterPanelModel.L_CARD_TYPE";

        var chk = true;
        var chk3G_postpaid = true;

        if (chk) {

            $.ajax({
                url: '/CheckCoverage/evESeServiceQueryMassCommonAccountInfo',
                data: { mobileNo: mobile, cardNo: cardno, cardType: cardtype, SubNetworkType: "" },
                dataType: "json",
                type: 'POST',
                async: false,
                success: function (response) {
                    var data = response.data;

                    //found data
                    $("#dataSFF").val(data.errorMessage + " ,Full Error: " + data.outErrorMessage);
                    if ($.trim(data.errorMessage) == "EB0001" || $.trim(data.errorMessage) == "EB0574") {
                        toastrErrorMessage("@L_NEW_CUST_NOT_FOUND");
                    }
                    else if (data.errorMessage == "") { //found data

                        $.ajax({
                            url: '/CheckCoverage/GetBindTriple',
                            data: { key: data.GUIDKEY, },
                            dataType: "json",
                            type: 'POST',
                            async: false,
                            success: function (data) {
                                var data = response.data;


                                if (chk3G_postpaid) {

                                    getProvince(data.outProvince);
                                    onProvinceChange(data.outAmphur, data.outProvince);
                                    onAmphurChange(data.outAmphur, data.outTumbol, data.outProvince);

                                    var twName = "";
                                    var bdName = "";

                                    if ((data.outMooban != undefined && data.outMooban != null && data.outMooban != "")
                                        || data.outBuildingName == undefined || data.outBuildingName == null || data.outBuildingName == "") {
                                        $("input[name=R_BUILD]").prop("checked", false);
                                        //$("#R_MOOBAN").prop("checked", true);
                                        $("#R_OTHER").prop("checked", true);
                                        $("#divTower").hide();
                                        $("#divBaan").show();
                                        $("#tMooban").val(data.outMooban);
                                        getZipCode(undefined, bdName, data.outProvince, data.outAmphur, data.outTumbol, data.outMooban, data.outBuildingName);
                                        $("#Mooban2").typeahead("val", data.outMooban);
                                        selected_building_obj.building_name = data.outMooban;

                                        $("#RD_L_LAT_LONG").removeAttr("disabled");
                                        $("#L_SPECIFIC_LOC222").removeAttr("disabled");
                                    }
                                    else {

                                        if (data.outBuildingName != undefined && data.outBuildingName != null && data.outBuildingName != "") {
                                        }
                                        else {
                                            data.outBuildingName = "";
                                        }
                                        var twSp = data.outBuildingName.split(' ');
                                        bdName = twSp[twSp.length - 1];
                                        twName = data.outBuildingName.replace(" " + bdName, "");
                                        if (bdName.length > 3) {
                                            twName += " " + bdName;
                                            bdName = "";
                                        }

                                        $("#tBuilding").val(bdName);
                                        $("#L_BUILD_NAME").val(twName);
                                        getZipCode(twName, bdName, data.outProvince, data.outAmphur, data.outTumbol);
                                        $("#CoveragePanelModel_Address_L_BUILD_NAME_Hied").typeahead("val", twName);
                                        selected_building_obj.building_name = twname;
                                    }

                                    $("#CoveragePanelModel_Address_L_FLOOR").val(data.outFloor);
                                    $("#CoveragePanelModel_Address_L_HOME_NUMBER_1").val(data.outHouseNumber);
                                    $("#CoveragePanelModel_Address_L_MOO").val(data.outMoo);
                                    $("#CoveragePanelModel_Address_L_SOI").val(data.outSoi);
                                    $("#CoveragePanelModel_Address_L_ROAD").val(data.outStreetName);

                                    $("#L_EMAIL").val(data.outEmail);
                                    $("#chkTypePass").val("1");
                                    // $("#btnCusNew").click();


                                    if ($("#chkTypePass").val() != "1") {
                                        resetBody();
                                    }
                                    $("#cvrbody").show();
                                    $("#cvrbodybtn").show();
                                    $("#cvrbodyno").hide();
                                    $("#cvrbodynobtn").hide();

                                    $("#tAisAirNumber").val($("#AisAirNumber").val());
                                    $("#tL_CARD_NOs").val($("#L_CARD_NOs").val());
                                    $("#tID_CARD_NAMEs").val($("#ID_CARD_NAMEs").val());
                                    $("#L_CARD_NO").val($("#tL_CARD_NOs").val());
                                    $("#tCardType").val(data.cardType);
                                    $("#CoveragePanelModel_BA_ID").val(data.outBillingAccountNumber);
                                    $("#CoveragePanelModel_CA_ID").val(data.outAccountNumber);
                                    $("#CoveragePanelModel_SA_ID").val(data.outServiceAccountNumber);
                                    $("#CoveragePanelModel_SffProductName").val(data.outProductName);
                                    $("#CoveragePanelModel_MobileSegment").val(data.outMobileSegment);
                                    $("#CoveragePanelModel_SffServiceYear").val(data.outDayOfServiceYear);
                                    $("#tTitle").val(data.outTitle);
                                    $("#CoveragePanelModel_BillingSystem").val(data.outBillingSystem);

                                    var nst = $("#tAisAirNumber").val().substr(0, 1);
                                    if (nst == "0")
                                        $("#L_MOBILE").val($("#tAisAirNumber").val());

                                    $("#tDD").val("");
                                    $("#tMM").val("");
                                    $("#tYY").val("");

                                    if (data.cardType == "R") { //personal

                                        if (data.outBirthDate != "" && data.outBirthDate != null) {
                                            var dSplit = data.outBirthDate.split('/');
                                            $("#tDD").val(parseFloat(dSplit[0]));
                                            $("#tMM").val(parseFloat(dSplit[1]));
                                            if ($("#LanguagePage").val() == "1")
                                                $("#tYY").val((parseFloat(dSplit[2]) + 543));
                                            else
                                                $("#tYY").val(dSplit[2]);
                                        }

                                        var spAN = data.outAccountName.trim().split(' ');
                                        if (spAN.length > 0) {
                                            if (spAN.length > 2) { //อาจมีคำนำหน้าชื่อติดมา หรือนามสกุลมีเคาะวรรค
                                                $("#L_FIRST_NAME").val(spAN[0]);
                                                $("#L_LAST_NAME").val(data.outAccountName.trim().replace(spAN[0], ""));
                                            }
                                            else if (spAN.length == 2) { //ชื่อ นามสกุล
                                                $("#L_FIRST_NAME").val(spAN[0]);
                                                $("#L_LAST_NAME").val(spAN[1]);
                                            }
                                            else if (spAN.length == 1) {
                                                $("#L_FIRST_NAME").val(spAN[0]);
                                            }
                                        }
                                    }
                                    else if (data.cardType == "G" || data.cardType == "B") {
                                        $("#L_GOVERNMENT_NAME").val(data.outAccountName);
                                        var cFirst = data.outPrimaryContactFirstName != undefined ? data.outPrimaryContactFirstName : "";
                                        var cLast = data.outContactLastName != undefined ? data.outContactLastName : "";
                                        $("#L_CONTACT_PERSON").val(cFirst + " " + cLast);
                                    }

                                    $("#SffProfileLogID").val(data.SffProfileLogID);
                                    $("#IsAWNProduct").val(data.IsAWNProduct);
                                    //found data
                                }
                            }
                        });
                    }
                    else { //error service
                        toastrErrorMessage("@L_NEW_CUST_NOT_FOUND.");
                    }
                }
            , error: function (err) {

            }
            });
        }
    }

    function postCheckcoverage(path, params, method, target) {

        method = method || "post";

        var form = document.createElement("form");
        form.setAttribute("method", method);
        form.setAttribute("action", path);
        form.setAttribute("target", target);

        for (var key in params) {
            if (params.hasOwnProperty(key)) {
                var hiddenField = document.createElement("input");
                hiddenField.setAttribute("type", "hidden");
                hiddenField.setAttribute("name", key);
                hiddenField.setAttribute("value", params[key]);

                form.appendChild(hiddenField);
            }
        }

        document.body.appendChild(form);
        form.submit();
    }

    function clearAddressDropdown() {
        getProvince();
        onProvinceChangeNew();
        onAmphurChangeNew();
        $('#CoveragePanelModel_Address_L_ZIPCODE').empty();
        $('#CoveragePanelModel_Address_L_ZIPCODE').append("<option value='' disabled selected>" + "@L_ZIPCODE" + "</option>");
        $('#CoveragePanelModel_Address_L_ZIPCODE').select2();
    }

    function clearaddressPanel() {
        $("#CoveragePanelModel_Address_L_FLOOR").val("");
        $("#CoveragePanelModel_Address_L_HOME_NUMBER_1").val("");
        $("#CoveragePanelModel_Address_L_MOO").val("");
        $("#CoveragePanelModel_Address_L_SOI").val("");
        $("#CoveragePanelModel_Address_L_ROAD").val("");

        $('#CoveragePanelModel_Address_L_ZIPCODE').empty();
        $('#CoveragePanelModel_Address_L_ZIPCODE').append("<option value='' disabled selected>" + "@L_ZIPCODE" + "</option>");
        $('#CoveragePanelModel_Address_L_ZIPCODE').select2();
    }

    function PopupMessage() {

        var swifi = '@productSubType';
        var language_ = '@languagePage';
        var ProSubType = "";
        if (swifi == "SWiFi") {
            ProSubType = "L_POP_UP_WIRELESS";
        }
        else {
            ProSubType = "L_POP_UP_WIRE";
        }
        var strBuilder = '';
        $.ajax({
            type: "GET",
            url: "/MasterData/GetLastPopupMessage?LovName=" + ProSubType + "&dataType=1",
            dataType: "json",
            async: false,
            success: function (data) {

                $.each(data, function (i, e) {
                    if (language_ == "2") {
                        strBuilder += e.LovValue2 + "<br>";
                    }
                    else {
                        strBuilder += e.LovValue1 + "<br>";
                    }
                });
                setTimeout(function () {
                    $("#basic-modal-content").find("#LastPopupMessage").html("");
                    $("#basic-modal-content").find("#LastPopupMessage").html("<h3 class='text-center'>" + strBuilder + "</h3>");
                }, 100);
            }
        });

        $.get("/Process/Submit", function (result) { });
    }

    function DownloadPDF() {

        window.location.href = "/Process/download";
        setTimeout(function () { Reload() }, 3000);
    }

    function Reload() {
        if ('@vas_flag' == "0" && $('#TopUp').val() != "7")
            window.location.href = "/Process/Index";
        else if ($('#TopUp').val() == "7" && '@vas_flag' == "0")
            window.location.href = "/Process/Engineer";
        else if ('@vas_flag' == "3")
            window.location.href = "/Process/TriplePlay";
        else if ('@vas_flag' == "6")
            get('/Process/staff', { EmpName: '@Model.CustomerRegisterPanelModel.L_FIRST_NAME', EmpLastName: '@Model.CustomerRegisterPanelModel.L_LAST_NAME', EmpID: '@Model.CustomerRegisterPanelModel.L_STAFF_ID', TransactionID: '@Model.TransactionID' });
        else if ('@officer' != "") {

            $.ajax({
                type: "POST",
                url: "/Process/CheckOfficerTimeOut",
                dataType: "json",
                async: false,
                success: function (data) {
                    if (data) {
                        window.location.href = "/Process/Index";
                    }
                    else {
                        window.location.href = "/Officer/Index";
                    }
                }
            });

        }
        else
            window.location.href = "/Process/Index";
    }

    function InCoveragePopUp(latitude, longitude) {
        $('#modal001txt').text('@Html.Raw(L_CHK_INCOVERAGE)');
        $('#modal001').modal();
        $(".simplemodal-container").addClass("modelStyleFix");
        $('#modal001btn').text('@B_CHK_REGISTER');
        $('#modal001btn').removeClass('btn-default').addClass('btn-success');
        $('#modal001btn').click(function () {
            //window.location.href = "/"; //process/CheckCoverage
            //window.open('/', '_self')
            $('#iForm').attr('action', '@Url.Action("BypassCheckCoverage", "Process")');
            $('#iForm').submit();
        });

        $('#modal002btn').text('@B_LEAVE_CONTACT');
        $('#modal002btn').removeClass('btn-default').addClass('btn-success');
        $('#modal002btn').click(function () {

            if (latitude == undefined && longitude == undefined) {
                if ('@isChannelIM' == 'True') {
                    var buildingName = $('#CoveragePanelModel_Address_L_BUILD_NAME_Hied').val();
                    var houseNo = $('#CoveragePanelModel_Address_L_HOME_NUMBER_1').val();
                    var soi = $('#CoveragePanelModel_Address_L_SOI').val();
                    var road = $('#CoveragePanelModel_Address_L_ROAD').val();
                    var province = $('#COVERAGE_L_PROVINCE').val();
                    var district = $('#COVERAGE_L_AMPHUR').val();
                    var subDistrict = $('#COVERAGE_L_TUMBOL').val();
                    var postcode = $('#CoveragePanelModel_Address_L_ZIPCODE option:selected').text();
                    var floor = $("#CoveragePanelModel_Address_L_FLOOR").val();
                    var buildNo = $('#L_BUILD_NO option:selected').val();
                    if (buildNo == ""){
                        buildNo = $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val();
                    }
                    var moo = $("#CoveragePanelModel_Address_L_MOO").val();
                    window.location.href = '/Leavemessage/IndexIM?AssetNumber=' + '@AssetNumber' + '&ServiceCaseId=' + '@ServiceCaseId' + "&buildingName=" + buildingName + '&houseNo=' + houseNo + '&soi=' + soi + '&road=' + road + '&province=' + province + '&district=' + district + '&subDistrict=' + subDistrict + '&postcode=' + postcode + '&buildNo=' + buildNo + '&floor=' + floor + '&moo=' + moo;
                }
                else {
                    window.location.href = "/Leavemessage/Index";
                }
            }
            else {
                if ('@isChannelIM' == 'True') {
                    window.location.href = "/Leavemessage/IndexIM/?locationData=" + latitude + "," + longitude + '&AssetNumber=' + '@AssetNumber' + '&ServiceCaseId=' + '@ServiceCaseId';
                }
                else {
                    window.location.href = "/Leavemessage/Index/?locationData=" + latitude + "," + longitude;
                }
            }
        });

        $("#detail001").show();
    }

    function NoCoverageLeaveContactPopUp(latitude, longitude) {
        $('#modal001txt').text('@Html.Raw(L_CHK_NOCOVERAGE_3BB)');
        $('#modal001').modal();
        $(".simplemodal-container").addClass("modelStyleFix");
        $('#modal001btn').text('@Html.Raw(B_LEAVE_CONTACT)');
        $('#modal001btn').removeClass('btn-default').addClass('btn-success');
        $('#modal001btn').click(function () {
            window.location.href = "/Leavemessage/ADN4/?locationData=" + latitude + "," + longitude;
        });
        $('#modal001btn').show();

        $('#modal003btn').click(function () {
            Reload();
        });
        $('#modal003btn').show();

        $("#detail001").show();
    }

    //setTimeout(function () {
    //    TestFromMap()
    //},5000)
    function TestFromMap() {
        var TransactionID = "2023062609405345128";
        var language = "1";
        var siteCode = "KRNTH";
        var buildingName = "";
        var houseNo = "8787";
        var moo = "";
        var soi = "ซอยหมู่บ้านกรองทอง";
        var road = "";
        var subDistrict = "วังทองหลาง";
        var district = "วังทองหลาง";
        var province = "กรุงเทพมหานคร";
        var postCode = "10310";
        var latitude = "13.78615647";
        var longitude = "100.59281495";
        var phoneFlag = "N";
        var coverage = "Y";
        var addressFlag = "1";
        var TriplePlayFlag = "";
        var SplitterList = "%3CSplitterList%3E%3CSplitter%3E%3CName%3EOB_LP62M_ZZ_01HW_KRNTH_P02_SP02_04_18%3C%2FName%3E%3CDistance%3E25.76%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3CSplitter%3E%3CName%3EOB_LP62M_ZZ_01HW_KRNTH_P02_SP02_05_18%3C%2FName%3E%3CDistance%3E32.72%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3CSplitter%3E%3CName%3EOB_LP62M_ZZ_01HW_KRNTH_P02_SP02_03_18%3C%2FName%3E%3CDistance%3E81.61%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3C%2FSplitterList%3E";
        var AddressID = "15386593";
        var FlowFlag = "0";

        $.ajax({
            type: "POST",
            url: "/process/processregister",
            data: { TransactionID: TransactionID, language: language, siteCode: siteCode, buildingName: buildingName, houseNo: houseNo, moo: moo, soi: soi, road: road, subDistrict: subDistrict, district: district, province: province, postCode: postCode, latitude: latitude, longitude: longitude, phoneFlag: phoneFlag, coverage: coverage, addressFlag: addressFlag, TriplePlayFlag: TriplePlayFlag, SplitterList: SplitterList, AddressID: AddressID, FlowFlag: FlowFlag },
            dataType: "json",
            async: false,
            success: function (data) {
            }
        });
    }

    function TestFromMapCoverageN() {
        var TransactionID = "2019101709554690090";
        var language = "1";
        var siteCode = "PYT02";
        var buildingName = "";
        var houseNo = "8787";
        var moo = "";
        var soi = "";
        var road = "";
        var subDistrict = "สามเสนใน";
        var district = "พญาไท";
        var province = "กรุงเทพมหานคร";
        var postCode = "10400";
        var latitude = "13.78542720";
        var longitude = "100.54649900";
        var phoneFlag = "N";
        var coverage = "N";
        var addressFlag = "1";
        var TriplePlayFlag = "EOS" + "|" + "@PromotionCodeFBBxEOS" + "|" + $("#EOS_AccountTitle").val() + "|" + $("#EOS_CustomerName").val() + "|" + $("#EOS_OfficeTelNo").val() + "|" + "@CARD_NOsFBBxEOS" + "|" + "@LanguageEOS";
        var SplitterList = "";
        var AddressID = "20625549";
        var FlowFlag = "0";

        $.ajax({
            type: "POST",
            url: "/process/processregister",
            data: { TransactionID: TransactionID, language: language, siteCode: siteCode, buildingName: buildingName, houseNo: houseNo, moo: moo, soi: soi, road: road, subDistrict: subDistrict, district: district, province: province, postCode: postCode, latitude: latitude, longitude: longitude, phoneFlag: phoneFlag, coverage: coverage, addressFlag: addressFlag, TriplePlayFlag: TriplePlayFlag, SplitterList: SplitterList, AddressID: AddressID, FlowFlag: FlowFlag },
            dataType: "json",
            async: false,
            success: function (data) {
            }
        });
    }

    //setTimeout(function () {
    //    TestFromMapAddCheckbox()
    //},5000)
    //function TestFromMapAddCheckbox() {
    //    var TransactionID = "2019060611415884803";
    //    var language = "1";
    //    var siteCode = "KRT32";
    //    var buildingName = "";
    //    var houseNo = "12345";
    //    var moo = "";
    //    var soi = "";
    //    var road = "";
    //    var subDistrict = "สวนหลวง";
    //    var district = "สวนหลวง";
    //    var province = "กรุงเทพมหานคร";
    //    var postCode = "10250";
    //    var latitude = "13.73208000";
    //    var longitude = "100.62334986";
    //    var phoneFlag = "N";
    //    var coverage = "Y";
    //    var addressFlag = "1";
    //    var TriplePlayFlag = "";
    //    var SplitterList = "";
    //    var AddressID = "20629698";
    //    var FlowFlag = "0";

    //    $.ajax({
    //        type: "POST",
    //        url: "/process/processregister",
    //        data: { TransactionID: TransactionID, language: language, siteCode: siteCode, buildingName: buildingName, houseNo: houseNo, moo: moo, soi: soi, road: road, subDistrict: subDistrict, district: district, province: province, postCode: postCode, latitude: latitude, longitude: longitude, phoneFlag: phoneFlag, coverage: coverage, addressFlag: addressFlag, TriplePlayFlag: TriplePlayFlag, SplitterList: SplitterList, AddressID: AddressID, FlowFlag: FlowFlag },
    //        dataType: "json",
    //        async: false,
    //        success: function (data) {
    //        }
    //    });
    //}
    function TestFromMapStg() {
        var TransactionID = "4161975";
        //var TransactionID = "2017032011565867881"; //STG

        var language = "1";
        var siteCode = "Z7B7P";
        var buildingName = "";
        var houseNo = "1";
        var moo = "หมู่เทพ (2-1)_3.2,3/4";
        var soi = "ซอยเทพ (2-1)_3.2,3/4";
        var road = "ถนนเทพ (2-1)_3.2,3/4";
        var subDistrict = "ทุ่งครุ";
        var district = "ทุ่งครุ";
        var province = "กรุงเทพมหานคร";
        var postCode = "10140";
        var latitude = "13.61944006";
        var longitude = "100.51016922";
        var phoneFlag = "N";
        var coverage = "Y";
        var addressFlag = "1";
        var TriplePlayFlag = "";
        var SplitterList = "%3CSplitterList%3E%3CSplitter%3E%3CName%3EOB_P105M_ZZ_01HW_Z7B7P_P03_SP02_02_116%3C%2FName%3E%3CDistance%3E73.42%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3CSplitter%3E%3CName%3EOB_P105M_ZZ_01HW_Z7B7P_P03_SP02_08_18%3C%2FName%3E%3CDistance%3E121.05%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3CSplitter%3E%3CName%3EOB_P105M_ZZ_01HW_Z7B7P_P03_SP02_03_18%3C%2FName%3E%3CDistance%3E270.07%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3CSplitter%3E%3CName%3EOB_P105M_ZZ_01HW_Z7B7P_P03_SP02_01_116%3C%2FName%3E%3CDistance%3E346.46%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3CSplitter%3E%3CName%3EOB_P105M_ZZ_01HW_Z7B7P_P03_SP02_06_18%3C%2FName%3E%3CDistance%3E376.67%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3C%2FSplitterList%3E";
        var AddressID = "20645982";
        var FlowFlag = "0";
        //var SplitterList = ""
        //var AddressID = ""
        //var FlowFlag = "2";

        $.ajax({
            type: "POST",
            url: "/process/processregister",
            data: { TransactionID: TransactionID, language: language, siteCode: siteCode, buildingName: buildingName, houseNo: houseNo, moo: moo, soi: soi, road: road, subDistrict: subDistrict, district: district, province: province, postCode: postCode, latitude: latitude, longitude: longitude, phoneFlag: phoneFlag, coverage: coverage, addressFlag: addressFlag, TriplePlayFlag: TriplePlayFlag, SplitterList: SplitterList, AddressID: AddressID, FlowFlag: FlowFlag },
            dataType: "json",
            async: false,
            success: function (data) {
            }
        });
    }

    function TestFromMapPremium() {
        var TransactionID = "2018020717584075232";
        var language = "1";
        var siteCode = "RUMK5";
        var buildingName = "1";
        var houseNo = "2";
        var moo = "";
        var soi = "ซอยออมทรัพย์";
        var road = "ถนนสุวินทวงศ์";
        var subDistrict = "แสนแสบ";
        var district = "มีนบุรี";
        var province = "กรุงเทพมหานคร";
        var postCode = "10510";
        var latitude = "13.79405200";
        var longitude = "100.75168600";
        var phoneFlag = "N";
        var coverage = "Y";
        var addressFlag = "1";
        var TriplePlayFlag = "";
        var SplitterList = "%3CSplitterList%3E%3CSplitter%3E%3CName%3EOB_RMK1M_ZZ_01ZT_RUMK5_P03_SP02_01_18%3C%2FName%3E%3CDistance%3E301.77%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3CSplitter%3E%3CName%3EOB_RMK1M_ZZ_01ZT_RUMK5_P03_SP02_03_18%3C%2FName%3E%3CDistance%3E377.91%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3CSplitter%3E%3CName%3EOB_RMK1M_ZZ_01ZT_RUMK5_P03_SP02_02_18%3C%2FName%3E%3CDistance%3E0.000031340424088723016%3C%2FDistance%3E%3CDistanceType%3E1%3C%2FDistanceType%3E%3C%2FSplitter%3E%3C%2FSplitterList%3E";
        var AddressID = "999999";
        var FlowFlag = "0";
        //var SplitterList = ""
        //var AddressID = ""
        //var FlowFlag = "2";

        $.ajax({
            type: "POST",
            url: "/process/processregister",
            data: { TransactionID: TransactionID, language: language, siteCode: siteCode, buildingName: buildingName, houseNo: houseNo, moo: moo, soi: soi, road: road, subDistrict: subDistrict, district: district, province: province, postCode: postCode, latitude: latitude, longitude: longitude, phoneFlag: phoneFlag, coverage: coverage, addressFlag: addressFlag, TriplePlayFlag: TriplePlayFlag, SplitterList: SplitterList, AddressID: AddressID, FlowFlag: FlowFlag },
            dataType: "json",
            async: false,
            success: function (data) {
            }
        });
    }

    function TestFromMapPremium2() {
        //var TransactionID = "2020030611304897538";
        var TransactionID = "2020030611025997532";
        var language = "1";
        //var siteCode = "WTTX";
        var siteCode = "A5177";
        //var siteCode = "KRT32";
        var buildingName = "";
        var houseNo = "1";
        var moo = "";
        var soi = "";
        var road = "";
        var subDistrict = "บางพระครู";
        var district = "นครหลวง";
        var province = "พระนครศรีอยุธยา";
        var postCode = "13260";
        var latitude = "14.47454500";
        var longitude = "100.61492200";
        var phoneFlag = "N";
        var coverage = "Y";
        var addressFlag = "1";
        var TriplePlayFlag = "";
        var SplitterList = "%3CSplitterList%3E%3CSplitter%3E%3CName%3EOC_NLG1M_ZZ_01HW_A5177_P05_SP02_01_18%3C%2FName%3E%3CDistance%3E418.15%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3CSplitter%3E%3CName%3EOC_NLG1M_ZZ_01HW_A5177_P05_SP02_02_18%3C%2FName%3E%3CDistance%3E631.83%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3CSplitter%3E%3CName%3EOC_NLG1M_ZZ_01HW_A5177_P05_SP02_03_18%3C%2FName%3E%3CDistance%3E1007.25%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3CSplitter%3E%3CName%3EOC_NLG1M_ZZ_01HW_A5177_P05_SP02_04_18%3C%2FName%3E%3CDistance%3E1199.09%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3C%2FSplitterList%3E";
        var AddressID = "20660821";
        var FlowFlag = "0";

        $.ajax({
            type: "POST",
            url: "/process/processregister",
            data: { TransactionID: TransactionID, language: language, siteCode: siteCode, buildingName: buildingName, houseNo: houseNo, moo: moo, soi: soi, road: road, subDistrict: subDistrict, district: district, province: province, postCode: postCode, latitude: latitude, longitude: longitude, phoneFlag: phoneFlag, coverage: coverage, addressFlag: addressFlag, TriplePlayFlag: TriplePlayFlag, SplitterList: SplitterList, AddressID: AddressID, FlowFlag: FlowFlag },
            dataType: "json",
            async: false,
            success: function (data) {
            }
        });
    }

    function TestFromMap2() {
        var TransactionID = "2021031909204766563";
        var language = "1";
        var siteCode = "CCLOG";
        var buildingName = "";
        var houseNo = "1";
        var moo = "";
        var soi = "สิงหเสนี 8/2";
        var road = "สุข(84)";
        var subDistrict = "บางจาก";
        var district = "พระโขนง";
        var province = "กรุงเทพมหานคร";
        var postCode = "10260";
        var latitude = "13.69448501";
        var longitude = "100.59603078";
        var phoneFlag = "N";
        var coverage = "Y";
        var addressFlag = "1";
        var TriplePlayFlag = "";
        var SplitterList = "%3CSplitterList%3E%3CSplitter%3E%3CName%3EOB_ES62M_ZZ_01ZT_CCLOG_P02_SP02_03_18%3C%2FName%3E%3CDistance%3E67.52%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3CSplitter%3E%3CName%3EOB_ES62M_ZZ_01ZT_CCLOG_P02_SP02_02_18%3C%2FName%3E%3CDistance%3E85.68%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3CSplitter%3E%3CName%3EOB_ES62M_ZZ_01ZT_CCLOG_P02_SP02_01_18%3C%2FName%3E%3CDistance%3E104.63%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3C%2FSplitterList%3E";
        var AddressID = "20624398";
        var FlowFlag = "0";
        //var SplitterList = ""
        //var AddressID = ""
        //var FlowFlag = "2";

        $.ajax({
            type: "POST",
            url: "/process/processregister",
            data: { TransactionID: TransactionID, language: language, siteCode: siteCode, buildingName: buildingName, houseNo: houseNo, moo: moo, soi: soi, road: road, subDistrict: subDistrict, district: district, province: province, postCode: postCode, latitude: latitude, longitude: longitude, phoneFlag: phoneFlag, coverage: coverage, addressFlag: addressFlag, TriplePlayFlag: TriplePlayFlag, SplitterList: SplitterList, AddressID: AddressID, FlowFlag: FlowFlag },
            dataType: "json",
            async: false,
            success: function (data) {
            }
        });
    }

    function TestFromMapMOU() {
        var TransactionID = "2021101513540723481";
        var language = "1";
        var siteCode = "KRNTH";
        var buildingName = "";
        var houseNo = "123";
        var moo = "";
        var soi = "ซอยหมู่บ้านกรองทอง";
        var road = "";
        var subDistrict = "วังทองหลาง";
        var district = "วังทองหลาง";
        var province = "กรุงเทพมหานคร";
        var postCode = "10310";
        var latitude = "13.78615647";
        var longitude = "100.59281495";
        var phoneFlag = "N";
        var coverage = "Y";
        var addressFlag = "1";
        var TriplePlayFlag = "";
        var SplitterList = "%3CSplitterList%3E%3CSplitter%3E%3CName%3EOB_LP62M_ZZ_01HW_KRNTH_P02_SP02_04_18%3C%2FName%3E%3CDistance%3E18.72%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3CSplitter%3E%3CName%3EOB_LP62M_ZZ_01HW_KRNTH_P02_SP02_05_18%3C%2FName%3E%3CDistance%3E28.77%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3CSplitter%3E%3CName%3EOB_LP62M_ZZ_01HW_KRNTH_P02_SP02_03_18%3C%2FName%3E%3CDistance%3E76.71%3C%2FDistance%3E%3CDistanceType%3E0%3C%2FDistanceType%3E%3C%2FSplitter%3E%3C%2FSplitterList%3E";
        var AddressID = "15386593";
        var FlowFlag = "0";

        $.ajax({
            type: "POST",
            url: "/process/processregister",
            data: { TransactionID: TransactionID, language: language, siteCode: siteCode, buildingName: buildingName, houseNo: houseNo, moo: moo, soi: soi, road: road, subDistrict: subDistrict, district: district, province: province, postCode: postCode, latitude: latitude, longitude: longitude, phoneFlag: phoneFlag, coverage: coverage, addressFlag: addressFlag, TriplePlayFlag: TriplePlayFlag, SplitterList: SplitterList, AddressID: AddressID, FlowFlag: FlowFlag },
            dataType: "json",
            async: false,
            success: function (data) {
            }
        });
    }

    function TestFromMapWTTX() {
        var TransactionID = "2021102809595523974";
        var language = "1";
        var siteCode = "WTTX";
        var buildingName = "";
        var houseNo = "55";
        var moo = "";
        var soi = "ซอยพหลโยธิน+9";
        var road = "";
        var subDistrict = "พญาไท";
        var district = "พญาไท";
        var province = "กรุงเทพมหานคร";
        var postCode = "10400";
        var latitude = "13.78637984";
        var longitude = "100.54655827";
        var phoneFlag = "N";
        var coverage = "Y";
        var addressFlag = "1";
        var TriplePlayFlag = "";
        var SplitterList = "";
        var AddressID = "9999999";
        var FlowFlag = "0";

        $.ajax({
            type: "POST",
            url: "/process/processregister",
            data: { TransactionID: TransactionID, language: language, siteCode: siteCode, buildingName: buildingName, houseNo: houseNo, moo: moo, soi: soi, road: road, subDistrict: subDistrict, district: district, province: province, postCode: postCode, latitude: latitude, longitude: longitude, phoneFlag: phoneFlag, coverage: coverage, addressFlag: addressFlag, TriplePlayFlag: TriplePlayFlag, SplitterList: SplitterList, AddressID: AddressID, FlowFlag: FlowFlag },
            dataType: "json",
            async: false,
            success: function (data) {
            }
        });
    }

    function TestFromMap3bb() {
        var TransactionID = "2022111419030939387";
        var language = "1";
        var siteCode = "3BB";
        var buildingName = "";
        var houseNo = "67";
        var moo = "";
        var soi = "ซอยหมู่บ้านเอื้ออาทรปทุมธานี+(บ้านฉาง)+5";
        var road = "";
        var subDistrict = "บางปรอก";
        var district = "เมืองปทุมธานี";
        var province = "ปทุมธานี";
        var postCode = "12000";
        var latitude = "14.01873500";
        var longitude = "100.52021100";
        var phoneFlag = "N";
        var coverage = "Y";
        var addressFlag = "1";
        var TriplePlayFlag = "";
        var SplitterList = "C4ECC937AAA37179BF322CDFC2482280ECA98FA066A5F7947E7519AED246161C14BEE35426AC6D1C6122EA84036FC577CC5067A69BF62D07DC4B62F6E603BA671B3F7A46ECFA771EF4125E8720093DED89C70739060E82E8D36A630E406AFD91D1AAB82F70A8BD1421D456BF01327770F45216CB76D9345F05C1A34EA5F4A9149675DD72C1A1393F1CF85D379C760B0875111A42933CCD1E737D862863AEE3923CEB0DF9A0B99FA941B837F26AF09F589AC5B18913BDF01FB191284E170EA96EA1A4149D3B26E1462718ED381596548BB308D5CCE910E1F1CD80A8B2D13C03CF7CE9D8311EB3BB7F824DDB4B700B2AC053BF89B4177A57B9A17B17CA8858150CE020A995C149C49915CE728A0D1A274B9D924A5C345075E99F7432D5C8235EF627C2AF636B087C3A6CCC6636E97F30EF4D10863C2EA07E73AFE1E1490F403C5897250E8B4B82E7D9BFCC8B6A870A1D9BE5C1AF21BEC8C5A4878C6EC813B86515F3813444A27574662293106FA3C490F277C5B4F6D0209939375215C5F143288FED6C0904E533E72AE3FD67AD0FDF0D8DF43548EB34F795A566FF1C21B330346DC225B7B4F4DC4D7FDDE2B5746C85AC6B518819588227B6A0CDA537B08CA460914ED79FB5FC6EA314037136AD7EAE53A792F34F2F7961A3027BB3E3AC125BD1658A146778644C3286CBAF752F444EC88D1444633E3E33D38B271F419AAB602C80C58003CF3478C9B0F1304EFAE15D209B5940405CD8DE3ABD1106880BF6515B102A4F9129F154D0FBBF36DB2D03E000DCAB6A6F4931A9E3433A026BA83882EC230697301CDC995B8134A21BA810812751E020A995C149C49915CE728A0D1A274B9D924A5C345075E99F7432D5C8235EF666884124BCDE211EC748C8035E1D4D034D10863C2EA07E73AFE1E1490F403C58D87803C0D66F8D11DA483CE1F05F7998EC31357BBEBBBF78293F19CDC5D91439FB2EC4653864F9796DB6FAED87A878851AEF67B900F44EB0A22299C2ACC64AD86D4AE0698D5F62DC3234AF1D1F59192B795D6E6013B6FCDDAD00A9B7983D9F10EAABFC1BCC2660C852422B0745FB98598127BE13522D31DFC3F8469836AAC2E0E3B476752C54BC95369185C853AFC54357B94A9AAEA004EC338EBD051210B6F13E17EADDBED483782CD75B55FC6CB74277EEF0E69B6B04FC90C79C237027B2AD6658DABD1DBB310A5A4EAF041D10F3C87B7C3D21FBDA2A1EEFB3B1BF2281D88A753FCB20D4D83D34E535997576D139B79C94E3B2C6627B6EE260409D6F453443794A733C663EA40557E0A3076F39384AF05675DB4334FCEC6399FB5411225C499A0C7FD4AD191835637B7CF237FCEB5EDD8EA71707B3330B2ABAC270F130748BE09FBF488DDD54AB8F724CDE692C7046BF97820FCBEA6409994D69B79D4AF39CEC31357BBEBBBF78293F19CDC5D91439B763C50A746099C131F3A56210830EE41AEF67B900F44EB0A22299C2ACC64AD8BC47A4F0193B05F7423903DCEC8A9E9C74105768CFB9A0834FEBB67E12C684AAEAABFC1BCC2660C852422B0745FB98598127BE13522D31DFC3F8469836AAC2E0EC12706B17816E4ABCA9F76274D2E98C57B94A9AAEA004EC338EBD051210B6F193FBC192A6B986656798AF47E78D069A77EEF0E69B6B04FC90C79C237027B2ADF170F3F4988356B55CC5512AEEA5036A7B7C3D21FBDA2A1EEFB3B1BF2281D88A753FCB20D4D83D34E535997576D139B7FEA768CB6AE13BEF31C245965926FFAF00E6A2A5809E07006E2AB9BA38F825D9F05675DB4334FCEC6399FB5411225C499A0C7FD4AD191835637B7CF237FCEB5E68173D4A248EFE6D6F6EFBE1C3018E88E09FBF488DDD54AB8F724CDE692C704644EC9F6DF02FA2FE11C4610A425A6087";
        var AddressID = "";
        var FlowFlag = "0";

        $.ajax({
            type: "POST",
            url: "/process/processregister",
            data: { TransactionID: TransactionID, language: language, siteCode: siteCode, buildingName: buildingName, houseNo: houseNo, moo: moo, soi: soi, road: road, subDistrict: subDistrict, district: district, province: province, postCode: postCode, latitude: latitude, longitude: longitude, phoneFlag: phoneFlag, coverage: coverage, addressFlag: addressFlag, TriplePlayFlag: TriplePlayFlag, SplitterList: SplitterList, AddressID: AddressID, FlowFlag: FlowFlag },
            dataType: "json",
            async: false,
            success: function (data) {
            }
        });
    }

    //setTimeout(function () {
    //    TestFromMapWTTX()
    //},1000)
    //function TestFromMapWTTX() {
    //    var TransactionID = "2019101709554690090";
    //    var language = "1";
    //    var siteCode = "WTTX";
    //    var buildingName = "";
    //    var houseNo = "8787";
    //    var moo = "";
    //    var soi = "";
    //    var road = "";
    //    var subDistrict = "สามเสนใน";
    //    var district = "พญาไท";
    //    var province = "กรุงเทพมหานคร";
    //    var postCode = "10400";
    //    var latitude = "16.76767875";
    //    var longitude = "98.54034075";
    //    var phoneFlag = "N";
    //    var coverage = "Y";
    //    var addressFlag = "1";
    //    var TriplePlayFlag = "";
    //    var SplitterList = "";
    //    var AddressID = "9999999";
    //    var FlowFlag = "0";

    //    $.ajax({
    //        type: "POST",
    //        url: "/process/processregister",
    //        data: { TransactionID: TransactionID, language: language, siteCode: siteCode, buildingName: buildingName, houseNo: houseNo, moo: moo, soi: soi, road: road, subDistrict: subDistrict, district: district, province: province, postCode: postCode, latitude: latitude, longitude: longitude, phoneFlag: phoneFlag, coverage: coverage, addressFlag: addressFlag, TriplePlayFlag: TriplePlayFlag, SplitterList: SplitterList, AddressID: AddressID, FlowFlag: FlowFlag },
    //        dataType: "json",
    //        async: false,
    //        success: function (data) {
    //        }
    //    });
    //}

    function CheckCondo(address_id, AccessMode) {
        $("#L_REMARK_BUILDING_IN_LIST").hide();
        $("#L_REMARK_PLUG_AND_PLAY").hide();
        $("#L_REMARK_TIMESLOT_FULL").hide();

        $.ajax({
            type: "POST",
            url: "/process/CheckCondoPlugAndPlay",
            data: { address_id: address_id },
            dataType: "json",
            async: false,
            success: function (data) {
                if (data) {
                    getAppointmentPlugAndPlay(address_id, AccessMode);
                    checkcondoFlag = true;
                }
                else {
                    $("#PLUG_AND_PLAY_FLOW").removeAttr("checked");

                    $("#NORMAL_FLOW").attr("checked", "");
                    $("#PLUG_AND_PLAY_FLOW").attr("disabled", "");

                    $("#L_REMARK_BUILDING_IN_LIST").show();
                    $("#PlugAndPlayFlow").val("N");
                    checkcondoFlag = false;
                }
            }
        });
    }

    function getAppointmentPlugAndPlay(address_id, AccessMode) {

        $("#divResponsiveTimeSLot").hide();

        $("#L_INSTALL_DATE").val("");

        var isThai = $("#LanguagePage").val() == "1" ? true : false;

        var defaultDate = new Date(parseInt(@DateTime.Now.Year), parseInt(@DateTime.Now.Month) - 1, parseInt(@DateTime.Now.Day));
        var month = defaultDate.getMonth() + 1;
        var day = defaultDate.getDate();

        var currentDateTH = (day < 10 ? '0' : '') + day + '/' +
          (month < 10 ? '0' : '') + month + '/' +
          (defaultDate.getFullYear() + 543);

        var currentDateEN = (day < 10 ? '0' : '') + day + '/' +
            (month < 10 ? '0' : '') + month + '/' +
            defaultDate.getFullYear();

        $.ajax({
            type: "GET",
            url: "/CheckCoverage/GetAppointmentPlugAndPlay",
            data: {
                'installation_Date': isThai ? currentDateTH : currentDateEN,
                "access_Mode": AccessMode,
                "productSpecCode": "@ProductSpecCode",
                "address_Id": address_id,
                "days": 6,
                "isThai": isThai,
                "serviceCode": AccessMode,
                "district": $('#COVERAGE_L_AMPHUR :selected').text(),
                "subDistrict": $('#COVERAGE_L_TUMBOL :selected').text(),
                "province": $('#COVERAGE_L_PROVINCE :selected').text(),
                "postalCode": $("#CoveragePanelModel_Address_L_ZIPCODE :selected").text(),
                "lineSelect": 1,
                "AisAirNumber": sessionStorage.getItem("AisAirNumber")
            },
            dataType: "json",
            async: false,
            success: function (data) {

                if (data) {
                    if (data.isPlugandPlay) {
                        $("#NORMAL_FLOW").removeAttr("checked");
                        $("#PLUG_AND_PLAY_FLOW").removeAttr("disabled");

                        //$("#PLUG_AND_PLAY_FLOW").attr("checked", "");

                        //$("#L_REMARK_PLUG_AND_PLAY").show();
                        //$("#PlugAndPlayFlow").val("Y");

                        appointmentFlag = true;

                        var JsonDateParsed = parseJsonDate(data.AppointmentDate.AppointmentDate);

                        var DateParsedForAppointment = JsonDateParsed.split('/')[2] + "/" + JsonDateParsed.split('/')[1] + "/" + JsonDateParsed.split('/')[0];

                        $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val(DateParsedForAppointment);
                        $('#CustomerRegisterPanelModel_FBSSTimeSlot_InstallationCapacity').val(data.AppointmentDate.InstallationCapacity);
                        $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlot').val(data.AppointmentDate.TimeSlot);
                        $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlotId').val(data.AppointmentDate.TimeSlotId);
                        $('#L_INSTALL_DATE').val(JsonDateParsed);
                    }
                    else {
                        $("#PLUG_AND_PLAY_FLOW").removeAttr("checked");

                        $("#NORMAL_FLOW").attr("checked", "");
                        $("#PLUG_AND_PLAY_FLOW").attr("disabled", "");

                        $("#L_REMARK_TIMESLOT_FULL").show();
                        $("#PlugAndPlayFlow").val("N");

                        appointmentFlag = false;
                    }
                }
            },
        });
    }
    function parseJsonDate(jsonDateString) {
        var newdate = new Date(parseInt(jsonDateString.replace('/Date(', '')));

        var day = newdate.getDate();
        var month = newdate.getMonth() + 1;

        var formatDate = (day < 10 ? '0' : '') + day + "/" + (month < 10 ? '0' : '') + month + "/" + newdate.getFullYear();
        return formatDate;
    }

    function setValueToAisMap() {
        //17.09 checked บ้านของตนเอง/อาศัย
        $('#R_OWNER').prop("checked", true);

        $.ajax({
            type: "POST",
            url: "/Process/used_type_flag",
            data: { 'status': 'Loaddata' },
            dataType: "json",
            success: function (data) {

            }
        });


        $('#modal_cardreader').modal('hide');

        $('#R_OTHER').attr("checked", "checked");


        $("#PicPOI").hide();
        $("#DIV_ADDRESS").hide();
        disabledMooBan();
        $("#divBaan").hide();
        disabledTower();
        $("#divTower").hide();
        onZipCodeChange();
        clearaddressPanel();

        $("#DIViframeMap").show();
        var iframe = $("#iframeMap");
        iframe.attr("src", iframe.data("src"));

        postCheckcoverage('@FBB_Con_WEB_CONFIG',
            {
                role: UserMap,
                langFlag: $("#LanguagePage").val(),
                postcode: '',
                province: sessionStorage.getItem('Card_province'),
                district: sessionStorage.getItem('Card_district'),
                subDistrict: sessionStorage.getItem('Card_subDistrict'),
                moo: sessionStorage.getItem('Card_moo'),
                soi: sessionStorage.getItem('Card_soi'),
                road: sessionStorage.getItem('Card_road'),
                houseNo: sessionStorage.getItem('Card_houseNo'),
                buildingName: '',
                TriplePlayFlag: $("#HdAddTriple").val(),
                locationCode: $("#CustomerRegisterPanelModel_L_LOC_CODE").val(),
                ascCode: $("#CustomerRegisterPanelModel_L_ASC_CODE").val(),
                employeeID: $("#CustomerRegisterPanelModel_L_STAFF_ID").val(),
                saleFirstname: $("#THFirstName").val(),
                saleLastname: $("#THLastName").val(),
                locationName: $("#CustomerRegisterPanelModel_PartnerName").val(),
                subRegion: $("#outLocationSubRegion").val(),
                region: $("#outLocationRegion").val(),
                ascName: $("#outASCPartnerName").val(),
                channelName: $("#CustomerRegisterPanelModel_PartnerName").val(),
                saleChannel: $("#outChnSales").val(),
                mobileNo: $("#CoveragePanelModel_P_MOBILE").val()
            }, "post", "my-iframe");
        $('#checkProcess').hide();
        $("#div_l_build_no").hide();
        $("#div_l_floor").hide();
        $("#div_condo_carousel").hide();

        $.ajax({
            type: "POST",
            url: "/Process/usedData_flag",
            data: { 'status': 'YY' },
            dataType: "json",
            success: function (data) {

            }
        });
    }

    function getValidateShowSellRouter() {
        var result = "";
        $.ajax({
            type: "GET",
            url: "/SelectPackage/GetValidateShowSellRouter",
            data: {
                "topUp": $('#TopUp').val(),
                "line": "@Model.SummaryPanelModel.VAS_FLAG",
                "aisAirNumber": sessionStorage.getItem("AisAirNumber"),
                "partnerName": $("#ZTEPartnerName").val(),
                "accessMode": $("#ZTEAccessModeSerializer").val()
            },
            dataType: "json",
            async: false,
            success: function (data) {
                if (data) {
                    result = data;
                }
            },
        });
        return result;
    }



    </text>)
</script>

<script type="text/javascript">
    function QueryDBDProfile() {
        var HaveData = false;
        $.ajax({
            url: "/FBBxEOS/QueryDBDProfile",
            data: { TAX_ID: "@CARD_NOsFBBxEOS" },
            dataType: "json",
            type: 'POST',
            async: false,
            success: function (response) {
                //console.log("QueryDBDProfile :", response)
                if (response) {
                    if (response.ResultCode == "0000") {
                        HaveData = true;
                        //BindValue
                        $("#EOS_CustomerName").val(response.DbdProfile.REGIST_NAME);
                        $("#EOS_OfficeTelNo").val(response.DbdProfile.MAIN_PHONE);
                    }
                    else {
                        $("#EOS_CustomerName").val("");
                        $("#EOS_OfficeTelNo").val("");
                    }
                }
                else {
                    $("#EOS_CustomerName").val("");
                    $("#EOS_OfficeTelNo").val("");
                }
            }
        });
        return HaveData;
    }

    function evAMQueryCustomerProfileByTaxId() {
        var HaveData = false;
        $.ajax({
            url: "/FBBxEOS/evAMQueryCustomerProfileByTaxId",
            data: { TAX_ID: "@CARD_NOsFBBxEOS"},
            dataType: "json",
            type: 'POST',
            async: false,
            success: function (response) {
                if (response) {
                    if (response.errorCode == "") {
                        HaveData = true;
                        //BindValue
                        $("#EOS_AccountTitle").val(response.AccountTitle);
                        $("#EOS_CustomerName").val(response.customerName);
                        $("#EOS_OfficeTelNo").val(response.officeTelNo);
                        $("#EOS_AccountCat").val(response.accountCat);
                        $("#EOS_AccountSubCat").val(response.accountSubCat);
                        $("#EOS_AccountHouseNo").val(response.AccountHouseNo);
                        $("#EOS_AccountSoi").val(response.AccountSoi);
                        $("#EOS_AccountMoo").val(response.AccountMoo);
                        $("#EOS_AccountMooban").val(response.AccountMooban);
                        $("#EOS_AccountBuildingName").val(response.AccountBuildingName);
                        $("#EOS_AccountFloor").val(response.AccountFloor);
                        $("#EOS_AccountRoom").val(response.AccountRoom);
                        $("#EOS_AccountStreetName").val(response.AccountStreetName);
                        $("#EOS_AccountTumbol").val(response.AccountTumbol);
                        $("#EOS_AccountAmphur").val(response.AccountAmphur);
                        $("#EOS_AccountProvince").val(response.AccountProvince);
                        $("#EOS_AccountZipCode").val(response.AccountZipCode);
                        if ($("#EOS_AccountMooban").val() == "") {
                            if ($("#EOS_AccountBuildingName").val() != "") {
                                $("#EOS_CheckIsCondo").val(true);
                            }
                        }
                    }
                } else {
                    $("#EOS_AccountTitle").val("");
                    $("#EOS_CustomerName").val("");
                    $("#EOS_OfficeTelNo").val("");
                    $("#EOS_AccountCat").val("");
                    $("#EOS_AccountSubCat").val("");
                    $("#EOS_AccountHouseNo").val("");
                    $("#EOS_AccountSoi").val("");
                    $("#EOS_AccountMoo").val("");
                    $("#EOS_AccountMooban").val("");
                    $("#EOS_AccountBuildingName").val("");
                    $("#EOS_AccountFloor").val("");
                    $("#EOS_AccountRoom").val("");
                    $("#EOS_AccountStreetName").val("");
                    $("#EOS_AccountTumbol").val("");
                    $("#EOS_AccountAmphur").val("");
                    $("#EOS_AccountProvince").val("");
                    $("#EOS_AccountZipCode").val("");
                }
            }
        });
        return HaveData;
    }

    //R2308_3BBWebCoverageFTTR
    function CheckCoverageFTTR3BB(callback) {
        
        try {
            //$("#AisAirNumber").val("");
            //L_EXISTING_MOBILE_NO
            $.ajax({
                type: "GET",
                url: "/CheckCoverage/GetcheckCoverageFTTR3BB",
                data: {
                    "latitude": tmpLatitude3bb,
                    "longitude": tmpongtitude3bb,
                    "mobileno": $("#CoveragePanelModel_P_MOBILE").val()
                },
                dataType: "json",
                async: false,
                error: function (data) {

                    //not_coverage
                    $("#CoveragePanelModel_CoverageResult").val("NO");
                    if (callback) {
                        callback();
                    }

                },
                success: function (data) {

                    if (data != null && data != undefined) {
                            //success
                            //console.log(data);
                            //if (data.Return_Code == "1")
                            $("#CoverageAreaResultModel_SPLITTER_3BB_JSON").val(data);
                            $("#L_SplitterListStr").val(data);
                            $("#CoverageAreaResultModel_IS_3BB_COVERAGE").val(true);
                            $("#CoveragePanelModel_L_FLOWFLAG").val("0");
                            $("#CoveragePanelModel_CoverageResult").val("YES");
                            //$('#CoveragePanelModel_L_SITECODE').val(selected_building_obj.sitecode);
                            $('#CoveragePanelModel_L_SITECODE').val(selected_building_obj.partner);
                            //Set
                            $("#ZTEPartnerName").val("AWN");
                            $('#Is3bbCoverage').val("Y");
                        
                            //SetAccessMode
                            var modelAcessESRI = [];
                            var accessModeModel = new FBSSAccessModeInfo();
                            accessModeModel.AccessMode = 'FTTH';
                            accessModeModel.InserviceDate = '';
                            modelAcessESRI.push(accessModeModel);
                            $("#ZTEAccessModeSerializer").val(JSON.stringify(modelAcessESRI));
                            //SetRegion
                            GetP_Region();
                    }
                    else{
                            //not_coverage
                            $("#CoveragePanelModel_CoverageResult").val("NO");
                    }

                    if (callback) {
                            callback();
                    }
                },
            });

        }
        catch (error) {
            console.error(error);
        }
    }
</script>

@*R18.11 IdCard Reader on PC*@
<script type="text/javascript">
    var _ws = null;
    var _readloop = 1;

    function getIdCARDInfoBySocketPc() {
        try {
            if ("WebSocket" in window) {

                _ws = new WebSocket("wss://localhost:8088/ReadIDCard");

                _ws.onopen = function () {
                    console.log("WebSocket: onopen() event called.");
                };

                _ws.onmessage = function (evt) {

                    console.log("WebSocket: onmessage() event called.");
                    onGetMessageCard(evt.data);

                }

                _ws.onclose = function () {
                    // websocket is closed.
                    console.log("WebSocket: onclose() event called.");
                };

                _ws.onerror = function (evt) {
                    console.log("WebSocket: Error(" + evt + ")");
                    //alert(evt);
                };

            } else {
                console.log("WebSocket: Error(The browser doesn't support WebSocket)");
            }
        } catch (err) {
            console.log("WebSocket: Error(" + err + ")");
        }
    }

    function onGetMessageCard(jsonString) {
        var objData = JSON.parse(jsonString);
        if (objData.Event == "OnCardLoadCompleted") {
            var base64StrData = objData.CardImage;
            var strPhotoImage = objData.PhotoImage;
            var strData = decodeURIComponent(escape(window.atob(objData.Data)));
            var jsonData = JSON.parse(strData);

            var NATIONALID = jsonData.NationalID;
            var TITLE_TH = jsonData.ThaiTitleName;
            var FIRSTNAME_TH = jsonData.ThaiFirstName;
            var LASTNAME_TH = jsonData.ThaiLastName;
            var TITLE_EN = jsonData.EnglishTitleName;
            var FIRSTNAME_EN = jsonData.EnglishFirstName;
            var LASTNAME_EN = jsonData.EnglishLastName;
            //var BIRTHDATE = jsonData.Birthdate.substring(6, 8) + "-" + jsonData.Birthdate.substring(4, 6) + "-" + jsonData.Birthdate.substring(0, 4);
            var BIRTHDATE = jsonData.Birthdate;
            var SEX = jsonData.Sex; //1=M ,2=F
            var ADDRESS = jsonData.Address;
            var LASERID = jsonData.LaserID;

            var MOO = jsonData.Moo;

            var ALLEY = jsonData.Trok;

            var SOI = jsonData.Soi;

            var STREET = jsonData.Thanon;

            var isBangkok = (jsonData.Province == "กรุงเทพมหานคร");

            var SUBDISTRICT = jsonData.Tumbol;

            var DISTRICT = jsonData.Amphur;

            var PROVINCE = jsonData.Province;

            var PICTURE = strPhotoImage;
            var ISSUEPLACE = jsonData.IssuePlace;
            var ISSUEDATE = jsonData.IssueDate.substring(6, 8) + "-" + jsonData.IssueDate.substring(4, 6) + "-" + jsonData.IssueDate.substring(0, 4);
            var EXPIREDATE = jsonData.ExpireDate.substring(6, 8) + "-" + jsonData.ExpireDate.substring(4, 6) + "-" + jsonData.ExpireDate.substring(0, 4);

            sessionStorage.setItem('Card_is_Active', "Y");
            sessionStorage.setItem('Card_l_TITLE_TH', TITLE_TH);
            sessionStorage.setItem('Card_f_name', FIRSTNAME_TH);
            sessionStorage.setItem('Card_l_name', LASTNAME_TH);
            sessionStorage.setItem('Card_l_TITLE_EN', TITLE_EN);
            sessionStorage.setItem('Card_f_name_en', FIRSTNAME_EN);
            sessionStorage.setItem('Card_l_name_en', LASTNAME_EN);
            sessionStorage.setItem('Card_sex', SEX);

            //sessionStorage.setItem('Card_id_card', NATIONALID);
            sessionStorage.setItem('Card_id_card_usb', NATIONALID);
            sessionStorage.setItem('Card_province', PROVINCE);
            sessionStorage.setItem('Card_district', DISTRICT);
            sessionStorage.setItem('Card_subDistrict', SUBDISTRICT);
            sessionStorage.setItem('Card_moo', MOO);
            sessionStorage.setItem('Card_soi', SOI);
            sessionStorage.setItem('Card_road', STREET);
            sessionStorage.setItem('Card_houseNo', ADDRESS);
            sessionStorage.setItem('chk_open', "Y");
            sessionStorage.setItem('Card_BIRTHDATE', BIRTHDATE);
            sessionStorage.setItem('Card_laser_id', LASERID);
            sessionStorage.setItem('Use_Data_Card', "Y");
            if (base64StrData != null) {
                sessionStorage.setItem('Card_id_card_PICTURE_Pc', base64StrData);
            }

            //sessionStorage.setItem('Card_id_card_DATA_Pc', strData);
            //sessionStorage.setItem('Card_id_card_PICTURE_Pc', base64StrData);

            $('#divIdCardReaderPc').hide();
            setTimeout(function () {

                if (!$("#page1").is(":hidden")) //หน้าแรก
                {
                    $('#modal_cardreader').modal('show');
                }

                if (!$("#page3").is(":hidden") && !$("#divRegisterInfo").is(":hidden")) //หน้าสอง
                {
                    //ถ้ามีการโหลดข้อมูลจาก card แล้วไม่ได้เลือกเป็นบุคคลธรรมดา จะไม่ขึ้นหน้าโหลด card
                    if ($('input[name=typeselect]:checked').val() == "R") showLoadIdCardReaderPC();
                }

            }, 1100);

        } else {

            if (objData.Event == "OnCardInserted") {
                $('#divIdCardReaderPc').show();
                $("#barIdCardReaderPc.progress-bar").css("width", "0%");
            } else if (objData.Event == "OnCardRemoved") {
                $("#barIdCardReaderPc.progress-bar").css("width", "0%");
            } else if (objData.Event == "OnCardLoadProgress") {
                var value = objData.Progress;
                $("#barIdCardReaderPc.progress-bar").css("width", value + "%");
            } else if (objData.Event == "OnCardLoadError") {
                $("#barIdCardReaderPc.progress-bar").css("width", "0%");
                $('#divIdCardReaderPc').hide();

                console.log("WebSocket: _readloop > " + _readloop);

                if (_readloop < 2) {

                    _readloop = _readloop + 1;
                    console.log("WebSocket: onunload() event called.");
                    onPageUnloadIdCARDInfoBySocketPc();
                    console.log("WebSocket: oninit() event called.");
                    getIdCARDInfoBySocketPc();

                } else {
                    _readloop = 1;
                    setTimeout(function () {
                        if (!$("#page1").is(":hidden")) //หน้าแรก
                        {
                            var _L_ERROR_LOAD_CARD = "@L_ERROR_LOAD_CARD";
                            toastrErrorMessage(_L_ERROR_LOAD_CARD);
                        }
                        if (!$("#page3").is(":hidden") && !$("#divRegisterInfo").is(":hidden")) //หน้าสอง
                        {
                            var _L_ERROR_LOAD_CARD = "@L_ERROR_LOAD_CARD";
                            toastrErrorMessage(_L_ERROR_LOAD_CARD);
                        }

                    }, 1100);

                }

            }
            sessionStorage.setItem('Card_is_Active', null);
            sessionStorage.setItem('Card_l_TITLE_TH', null);
            sessionStorage.setItem('Card_f_name', null);
            sessionStorage.setItem('Card_l_name', null);
            sessionStorage.setItem('Card_l_TITLE_EN', null);
            sessionStorage.setItem('Card_f_name_en', null);
            sessionStorage.setItem('Card_l_name_en', null);
            sessionStorage.setItem('Card_id_card', null);
            sessionStorage.setItem('Card_id_card_usb', null);
            sessionStorage.setItem('Card_sex', null);
            sessionStorage.setItem('Card_province', null);
            sessionStorage.setItem('Card_district', null);
            sessionStorage.setItem('Card_subDistrict', null);
            sessionStorage.setItem('Card_moo', null);
            sessionStorage.setItem('Card_soi', null);
            sessionStorage.setItem('Card_road', null);
            sessionStorage.setItem('Card_houseNo', null);
            sessionStorage.setItem('chk_open', null);
            sessionStorage.setItem('Card_BIRTHDATE', null);
            sessionStorage.setItem('Card_PICTURE', null);
            sessionStorage.setItem('Card_laser_id', null);
            sessionStorage.setItem('Card_id_card_PICTURE_Pc', null);


        }
    }

    function onPageUnloadIdCARDInfoBySocketPc() {
        if (_ws != null)
            _ws.close();
    }

</script>
