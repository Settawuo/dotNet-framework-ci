@model WBBEntity.PanelModels.QuickWinPanelModel
@using WBBEntity.PanelModels;
@using WBBEntity.Extensions;
@using WBBWeb.Controllers;
@using System.Collections.Generic;
@using WBBWeb.Extension;

@{
    string language = Session[WebConstants.SessionKeys.CurrentUICulture] != null ? Session[WebConstants.SessionKeys.CurrentUICulture].ToString() : "";

    string PreprintPackage = "";
    string PreprintMonthlyFee = ""; // RePlace {RecurringCharge}
    string PreprintFreeInstallation = "";
    string PreprintPayInstallation = "";
    string PreprintRemark = ""; // REMARK
    string PreprintEntryFee = ""; // ENTRY_FEE RePlace Name {EntryFee}
    string PreprintPayEntryFee = ""; // PAY_ENTRY_FEE RePlace Name {EntryFee}
    string PreprintPayEntryFeeInAdvance = ""; // PAY_IN_ADVANCE
    string PreprintExceptEntryFee = ""; // EXCEPT_ENTRY_FEE
    string PreprintPlayboxRouter = "";  // PLAYBOX_ROUTER
    string PreprintContenPlaybox = "";  // CONTENT_PLAYBOX {ContentPlaybox}
    string PreprintContenPlayboxFee = ""; // CONTENT_PLAYBOX_FEE {CPRecurringCharge}
    string PreprintFixlineService = ""; // FIXEDLINE_SERVICE
    string PreprintFreeManageWTTX = ""; //20.2
    string PreprintPayManageWTTX = "";//20.2
    string PreprintMeshRouter = "";  // MESH_ROUTER
    string PreprintDeviceContractPB = "";//21.11 ATV // DEVICE_CONTRACT_PB {PenaltyChargePB}
    string PreprintDeviceContractMesh = "";//21.11 ATV // DEVICE_CONTRACT_MESH {PenaltyChargeMesh}
    string PreprintForWTTx = "";
    string GetlovCusregisIPcamera = "";
    string DeviceContactipcamera = "";
    string PlayboxCondition = "";
    string PlayboxConditionPoint = "";

    var controllerPrePrint = DependencyResolver.Current.GetService<PrePrintController>();
    List<LovScreenValueModel> PrePrintFormLovScreen = controllerPrePrint.GetPrePrintFormLovScreen();
    List<LovScreenValueModel> GetlovCusregister = controllerPrePrint.GetlovCusregister();
    if (GetlovCusregister != null && GetlovCusregister.Count > 0)
    {
        GetlovCusregisIPcamera = GetlovCusregister.FirstOrDefault(t => t.Name == "IPCamera_MonthlyFee_Point").DisplayValue != null ? GetlovCusregister.FirstOrDefault(t => t.Name == "IPCamera_MonthlyFee_Point").DisplayValue : "";
    }
    if (PrePrintFormLovScreen != null && PrePrintFormLovScreen.Count > 0)
    {
        PreprintPackage = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PACKAGE") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PACKAGE").DisplayValue : "";
        PreprintMonthlyFee = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "MONTHLY_FEE") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "MONTHLY_FEE").DisplayValue : "";
        PreprintFreeInstallation = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "FREE_INSTALLATION") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "FREE_INSTALLATION").DisplayValue : "";
        PreprintPayInstallation = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PAY_INSTALLATION") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PAY_INSTALLATION").DisplayValue : "";
        //PreprintRemark = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "REMARK") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "REMARK").DisplayValue : "";
        PreprintEntryFee = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "ENTRY_FEE") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "ENTRY_FEE").DisplayValue : "";
        //PreprintPayEntryFee = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PAY_ENTRY_FEE") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PAY_ENTRY_FEE").DisplayValue : "";
        PreprintPayEntryFeeInAdvance = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PAY_IN_ADVANCE") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PAY_IN_ADVANCE").DisplayValue : "";
        PreprintExceptEntryFee = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "EXCEPT_ENTRY_FEE") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "EXCEPT_ENTRY_FEE").DisplayValue : "";
        PreprintPlayboxRouter = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PLAYBOX_ROUTER") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PLAYBOX_ROUTER").DisplayValue : "";
        PreprintContenPlaybox = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "CONTENT_PLAYBOX") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "CONTENT_PLAYBOX").DisplayValue : "";
        PreprintContenPlayboxFee = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "CONTENT_PLAYBOX_FEE") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "CONTENT_PLAYBOX_FEE").DisplayValue : "";
        PreprintFixlineService = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "FIXEDLINE_SERVICE") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "FIXEDLINE_SERVICE").DisplayValue : "";
        PreprintFreeManageWTTX = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "FREE_MANAGE_WTTX") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "FREE_MANAGE_WTTX").DisplayValue : "";
        PreprintPayManageWTTX = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PAY_MANAGE_WTTX") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PAY_MANAGE_WTTX").DisplayValue : "";
        PreprintMeshRouter = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "MESH_ROUTER") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "MESH_ROUTER").DisplayValue : "";
        PreprintDeviceContractPB = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "DEVICE_CONTRACT_PB") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "DEVICE_CONTRACT_PB").DisplayValue : "";
        PreprintDeviceContractMesh = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "DEVICE_CONTRACT_MESH") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "DEVICE_CONTRACT_MESH").DisplayValue : "";
        PreprintForWTTx = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "FOR_WTTX") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "FOR_WTTX").DisplayValue : "";
        DeviceContactipcamera = PrePrintFormLovScreen.FirstOrDefault(t=>t.Name == "DEVICE_CONTRACT_IP_CAMERA") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "DEVICE_CONTRACT_IP_CAMERA").DisplayValue : "";
        PlayboxCondition = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PLAYBOX_CODITION") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PLAYBOX_CODITION").DisplayValue : "";
        PlayboxConditionPoint = PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PlayboxConditionPoint") != null ? PrePrintFormLovScreen.FirstOrDefault(t => t.Name == "PlayboxConditionPoint").DisplayValue : "";
    }

    List<string> LIST_PRE_SURVEY_LOCATION = null;
    List<string> LIST_PRE_SURVEY_PROVINCE = null;

    string lGOVERNMENT = "";
    string lBUSINESS = "";
    string lTITLE = "";
    string lCARD_TYPE = "";
    string lGENDER = "";
    string lDATE_OF_BIRTH = "";
    string lMONTH_OF_BIRTH = "";
    string lYEAR_OF_BIRTH = "";
    string lSPECIFIC_TIME = "";
    string lZIPCODE = "";
    string lPROVINCE = "";
    string lTUMBOL = "";
    string lAMPHUR = "";

    string L_ERROR_LOAD_CARD = "";
    string L_ERROR_SMART_CARD = "";

    string L_ERROR_AGE = "";

    string L_SMS_AND_MYAIS = "";
    string L_SMS_AND_EMAIL = "";
    string L_SMS_NON_SELECT = "";

    string L_ONTOP_PLAYBOX_PRE_INITIATION = "";

    string FBB_Con_CharNotonName = "";
    string FBB_Con_CharNotOnNameLastName = "";
    string FBB_InputCompanyName = "";
    string FBB_Con_MobileLength = "";
    var FBB_Input_MobileNo = "";
    string FBB_Con_YearLimitHigh = "";
    string FBB_Con_YearLimitLow = "";
    string FBB_Exc_1 = "";
    string FBB_Exc_D = "";
    string FBB_Exc_F = "";
    string FBB_Exc_I = "";
    string FBB_Exc_S = "";

    string FBB_Con_Input_CERT_FOUND = "";
    string FBB_Con_Input_EMB_LET = "";
    string FBB_Con_Input_HILL_CARD = "";
    string FBB_Con_Input_ID_CARD = "";
    string FBB_Con_Input_IMM_CARD = "";
    string FBB_Con_Input_MONK_CERT = "";
    string FBB_Con_Input_PASSPORT = "";
    string FBB_Con_Input_ROY_LET = "";
    string FBB_Con_Input_STA_LET = "";
    string FBB_Con_Input_TAX_ID = "";
    string FBB_Con_Input_GOV_LET = "";

    string FBB_Con_Input_Home_Number = "";
    string FBB_Con_Input_Moo = "";
    string FBB_Con_Input_Mooban = "";
    string FBB_Con_Input_Building = "";
    string FBB_Con_Input_Floor = "";
    string FBB_Con_Input_Room = "";
    string FBB_Con_Input_Soi = "";
    string FBB_Con_Input_Road = "";
    string FBB_Con_Input_HomePhone = "";
    string FBB_Con_Input_ExtNumber = "";
    string FBB_Con_Input_NameSpecialAccount = "";
    string FBB_Con_Input_NoSpecialAccount = "";

    string FBB_Con_Length_ID_Card_Number_STA_LET = "";
    string FBB_Con_Length_ID_Card_Number_ROY_LET = "";
    string FBB_Con_Length_ID_Card_Number_EMB_LET = "";
    string FBB_Con_Length_ID_Card_Number_CERT_FOUND = "";
    string FBB_Con_Length_ID_Card_Number_TAX_ID = "";
    string FBB_Con_Length_ID_Card_Number_PASSPORT = "";
    string FBB_Con_Length_ID_Card_Number_GOV_LET = "";

    string FBB_Con_LengthIDCardNumberHILL_CARD = "";
    string FBB_Con_LengthIDCardNumberID_CARD = "";
    string FBB_Con_LengthIDCardNumberIMM_CARD = "";
    string FBB_Con_LengthIDCardNumberMONK_CERT = "";

    string FBB_Con_Validate_Length_Address = "";

    List<FbbConstantModel> SHOW_TIME_SLOT_LIST = new List<FbbConstantModel>();
    string SHOW_TIME_SLOT = "";

    //R18.11 Warning Verify Card
    string L_WARNING_VERIFY = "";

    string SHOW_POPUP_BLACKLIST = "";

    string L_ONTOP_PLAYBOX_BPL = "";

    string L_SPECIAL_BUNDLING_DISCOUNT = "";
    string L_SPECIAL_DISCOUNT = "";

    string lFILE_SIZE = "";
    string lFILE_TYPE = "";
    string lERR_FILE_SIZE = "";
    string lERR_FILE_TYPE = "";

    //R18.11 FaceRecog
    string L_RESULT_FACE_RECOGNITION = "";
    string L_PASS_FACE_RECOGNITION = "";
    string L_FAIL_FACE_RECOGNITION = "";
    string L_APPROVE_FACE_RECOGNITION = "";
    string PASS_FACE_RECOGNITION = "";
    string L_FAIL_NO_FACE_DETECTED = "";

    string FILE_SIZE = "";
    string FILE_TYPE = "";

    string L_BUTTON_DUP = "";

    string lBILL_BRAND = "";

    //R19.4 Redcap
    List<DropdownModel> LIST_PRE_SURVEY_RECURRING_CHARGE = null;
    string PRE_SURVEY_RECURRING_CHARGE_START = "";
    string PRE_SURVEY_RECURRING_CHARGE_END = "";

    string[] ATTACHED;
    string[] PREPAID_Package_Group;
    string[] PREPAID_Package_Group_VAL2;

    string L_VALIDATE_VAT_ADDR_L1 = "";
    string L_VALIDATE_VAT_ADDR_L2 = "";
    string L_VALIDATE_VAT_ADDR_L3 = "";

    var controller = DependencyResolver.Current.GetService<ProcessController>();

    //19.6
    string PRE_SURVEY_DOWNLOAD_SPEED = "";

    //20.5 Service Level
    string EVENT_RULE = "";

    //18.3 deverloper
    string L_DEVERLOPER = "";

    var labelDeverloper = controller.GetScreenConfig("DEVELOPER");
    L_DEVERLOPER = labelDeverloper.Any(c => c.Name == "L_DEVELOPER") ? labelDeverloper.FirstOrDefault(c => c.Name == "L_DEVELOPER").DisplayValue : "";

    //var LovCampaignProjectNameMGM = controller.GetLovCampaignProjectNameMGM("CAMPAIGN_PROJECT_NAME");//R22.06 Member get Member

    var labelspecialaccount = controller.GetLovConfigBytype("SPECIAL_ACCOUNT_BY_SUBTYPE");
    var flagspecialaccountresult = "";
    bool div_special_account = false;
    if (labelspecialaccount.Any())
    {
        if (!string.IsNullOrEmpty(Model.CustomerRegisterPanelModel.outSubType))
        {
            var flagspecialaccountresult_ = labelspecialaccount.FirstOrDefault(c => c.Name == Model.CustomerRegisterPanelModel.outSubType);
            flagspecialaccountresult = flagspecialaccountresult_ == null ? "N" : flagspecialaccountresult_.DisplayValue;
            div_special_account = flagspecialaccountresult != "Y" ? false : true;
        }
    }

    //R19.4 Redcap
    var controllerCustRigis = DependencyResolver.Current.GetService<CustomerRegisterController>();
    LIST_PRE_SURVEY_RECURRING_CHARGE = controllerCustRigis.GetConfigPreSurveyRecurringCharge("PRE_SURVEY_RECURRING_CHARGE");
    if (LIST_PRE_SURVEY_RECURRING_CHARGE.Any())
    {
        PRE_SURVEY_RECURRING_CHARGE_START = LIST_PRE_SURVEY_RECURRING_CHARGE.FirstOrDefault().Value.ToSafeString();
        PRE_SURVEY_RECURRING_CHARGE_END = LIST_PRE_SURVEY_RECURRING_CHARGE.FirstOrDefault().Value2.ToSafeString();
    }

    string L_MOO = "";
    string L_SOI = "";
    string L_ROAD = "";

    if (ViewBag.LabelFBBTR000 != null)
    {
        var labelFBBTR000 = (List<LovScreenValueModel>)ViewBag.LabelFBBTR000;

        lZIPCODE = labelFBBTR000.Any(c => c.Name == "L_ZIPCODE") ? labelFBBTR000.First(c => c.Name == "L_ZIPCODE").DisplayValue : "";
        lPROVINCE = labelFBBTR000.Any(c => c.Name == "L_PROVINCE") ? labelFBBTR000.First(c => c.Name == "L_PROVINCE").DisplayValue : "";
        lTUMBOL = labelFBBTR000.Any(c => c.Name == "L_TUMBOL") ? labelFBBTR000.First(c => c.Name == "L_TUMBOL").DisplayValue : "";
        lAMPHUR = labelFBBTR000.Any(c => c.Name == "L_AMPHUR") ? labelFBBTR000.First(c => c.Name == "L_AMPHUR").DisplayValue : "";
        L_MOO = labelFBBTR000.Any(c => c.Name == "L_MOO") ? labelFBBTR000.FirstOrDefault(c => c.Name == "L_MOO").DisplayValue : "";
        L_SOI = labelFBBTR000.Any(c => c.Name == "L_SOI") ? labelFBBTR000.FirstOrDefault(c => c.Name == "L_SOI").DisplayValue : "";
        L_ROAD = labelFBBTR000.Any(c => c.Name == "L_ROAD") ? labelFBBTR000.FirstOrDefault(c => c.Name == "L_ROAD").DisplayValue : "";

    }

    string L_SUMM_DETAIL6 = "";
    string L_CHARGE_ON_INSTALL_DATE = "";
    string L_BAHT = "";
    string L_SUMM_DETAIL1 = "";
    string L_SUMM_DETAIL5 = "";
    string L_SUMM_DETAIL8 = "";
    string L_SUMM_DETAIL9 = "";

    if (ViewBag.LabelFBBTR002 != null)
    {
        var labelFBBTR002 = (List<LovScreenValueModel>)ViewBag.LabelFBBTR002;
        L_ONTOP_PLAYBOX_BPL = labelFBBTR002.Any(c => c.Name == "L_ONTOP_PLAYBOX_BPL") ? labelFBBTR002.FirstOrDefault(c => c.Name == "L_ONTOP_PLAYBOX_BPL").DisplayValue : "";
        L_SUMM_DETAIL6 = labelFBBTR002.Any(c => c.Name == "L_SUMM_DETAIL6") ? labelFBBTR002.FirstOrDefault(c => c.Name == "L_SUMM_DETAIL6").DisplayValue : "";
        L_CHARGE_ON_INSTALL_DATE = labelFBBTR002.Any(c => c.Name == "L_CHARGE_ON_INSTALL_DATE") ? labelFBBTR002.FirstOrDefault(c => c.Name == "L_CHARGE_ON_INSTALL_DATE").DisplayValue : "";
        L_BAHT = labelFBBTR002.Any(c => c.Name == "L_BAHT") ? labelFBBTR002.FirstOrDefault(c => c.Name == "L_BAHT").DisplayValue : "";
        L_SUMM_DETAIL1 = labelFBBTR002.Any(c => c.Name == "L_SUMM_DETAIL1") ? labelFBBTR002.FirstOrDefault(c => c.Name == "L_SUMM_DETAIL1").DisplayValue : "";
        L_SUMM_DETAIL5 = labelFBBTR002.Any(c => c.Name == "L_SUMM_DETAIL5") ? labelFBBTR002.FirstOrDefault(c => c.Name == "L_SUMM_DETAIL5").DisplayValue : "";
        L_SUMM_DETAIL8 = labelFBBTR002.Any(c => c.Name == "L_SUMM_DETAIL8") ? labelFBBTR002.FirstOrDefault(c => c.Name == "L_SUMM_DETAIL8").DisplayValue : "";
        L_SUMM_DETAIL9 = labelFBBTR002.Any(c => c.Name == "L_SUMM_DETAIL9") ? labelFBBTR002.FirstOrDefault(c => c.Name == "L_SUMM_DETAIL9").DisplayValue : "";
    }

    string lONTOP_PACK = "";
    string L_FIXEDLINE = "";
    string L_ONTOP_PLAYBOX_FREE = "";
    string L_YOUR_PACK = "";
    string L_MAIN_PACK = "";
    string L_REMARK_GREETING = "";
    string DISPLAY_TIMESLOT = "";
    //R21.12PP ATV
    string WORDIND_MESH = "";

    //IP Camera
    string CHK_IPCAMERA_ACTIVESTATUS = "";

    if (ViewBag.IpCameraConfig != null)
    {
        var IpCameraConfig = (List<LovScreenValueModel>)ViewBag.IpCameraConfig;

        CHK_IPCAMERA_ACTIVESTATUS = IpCameraConfig.Any(c => c.Name == "IPCamera_ActiveStatus") ? IpCameraConfig.FirstOrDefault(c => c.Name == "IPCamera_ActiveStatus").DisplayValue : "";
    }

    if (ViewBag.LabelFBBTR003 != null)
    {
        var labelFBBTR003 = (List<LovScreenValueModel>)ViewBag.LabelFBBTR003;

        LIST_PRE_SURVEY_LOCATION = labelFBBTR003.Where(c => c.Name == "PRE_SURVEY_LOCATION").Select(c => c.DisplayValue).ToList();
        LIST_PRE_SURVEY_PROVINCE = labelFBBTR003.Where(c => c.Name == "PRE_SURVEY_PROVINCE").Select(c => c.DisplayValue).ToList();

        lGOVERNMENT = labelFBBTR003.Any(c => c.Name == "L_GOVERNMENT") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_GOVERNMENT").DisplayValue : "";
        lBUSINESS = labelFBBTR003.Any(c => c.Name == "L_BUSINESS") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_BUSINESS").DisplayValue : "";

        L_ERROR_LOAD_CARD = labelFBBTR003.Any(c => c.Name == "L_ERROR_LOAD_CARD") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_ERROR_LOAD_CARD").DisplayValue : "";
        L_ERROR_SMART_CARD = labelFBBTR003.Any(c => c.Name == "L_ERROR_SMART_CARD") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_ERROR_SMART_CARD").DisplayValue : "";
        lTITLE = labelFBBTR003.Any(c => c.Name == "L_TITLE") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_TITLE").DisplayValue : "";
        lCARD_TYPE = labelFBBTR003.Any(c => c.Name == "L_CARD_TYPE") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_CARD_TYPE").DisplayValue : "";
        lGENDER = labelFBBTR003.Any(c => c.Name == "L_GENDER") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_GENDER").DisplayValue : "";
        lDATE_OF_BIRTH = labelFBBTR003.Any(c => c.Name == "L_DATE_OF_BIRTH") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_DATE_OF_BIRTH").DisplayValue : "";
        lMONTH_OF_BIRTH = labelFBBTR003.Any(c => c.Name == "L_MONTH_OF_BIRTH") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_MONTH_OF_BIRTH").DisplayValue : "";
        lYEAR_OF_BIRTH = labelFBBTR003.Any(c => c.Name == "L_YEAR_OF_BIRTH") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_YEAR_OF_BIRTH").DisplayValue : "";
        lSPECIFIC_TIME = labelFBBTR003.Any(c => c.Name == "L_SPECIFIC_TIME") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_SPECIFIC_TIME").DisplayValue : "";

        L_ERROR_AGE = labelFBBTR003.Any(c => c.Name == "L_ERROR_AGE") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_ERROR_AGE").DisplayValue : "";

        L_SMS_AND_MYAIS = labelFBBTR003.Any(c => c.Name == "L_SMS_AND_MYAIS") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_SMS_AND_MYAIS").DisplayValue : "";
        L_SMS_AND_EMAIL = labelFBBTR003.Any(c => c.Name == "L_SMS_AND_EMAIL") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_SMS_AND_EMAIL").DisplayValue : "";
        L_SMS_NON_SELECT = labelFBBTR003.Any(c => c.Name == "L_SMS_NON_SELECT") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_SMS_NON_SELECT").DisplayValue : "";

        L_ONTOP_PLAYBOX_PRE_INITIATION = labelFBBTR003.Any(c => c.Name == "L_ONTOP_PLAYBOX_PRE_INITIATION") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_ONTOP_PLAYBOX_PRE_INITIATION").DisplayValue : "";

        L_SPECIAL_BUNDLING_DISCOUNT = labelFBBTR003.Any(c => c.Name == "L_SPECIAL_BUNDLING_DISCOUNT") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_SPECIAL_BUNDLING_DISCOUNT").DisplayValue : "";
        L_SPECIAL_DISCOUNT = labelFBBTR003.Any(c => c.Name == "L_SPECIAL_DISCOUNT") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_SPECIAL_DISCOUNT").DisplayValue : "";

        lFILE_SIZE = labelFBBTR003.Any(c => c.Name == "L_FILE_SIZE") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_FILE_SIZE").DisplayValue : "";
        lFILE_TYPE = labelFBBTR003.Any(c => c.Name == "L_FILE_TYPE") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_FILE_TYPE").DisplayValue : "";
        lERR_FILE_SIZE = labelFBBTR003.Any(c => c.Name == "L_ERR_FILE_SIZE") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_ERR_FILE_SIZE").DisplayValue : "";
        lERR_FILE_TYPE = labelFBBTR003.Any(c => c.Name == "L_ERR_FILE_TYPE") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_ERR_FILE_TYPE").DisplayValue : "";

        //R18.11 Warning Verify Card
        L_WARNING_VERIFY = labelFBBTR003.Any(c => c.Name == "L_WARNING_VERIFY") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_WARNING_VERIFY").DisplayValue : "";

        SHOW_POPUP_BLACKLIST = labelFBBTR003.Any(c => c.Name == "SHOW_POPUP_BLACKLIST") ? labelFBBTR003.FirstOrDefault(c => c.Name == "SHOW_POPUP_BLACKLIST").DisplayValue : "";

        FILE_TYPE = labelFBBTR003.Any(c => c.Name == "FILE_TYPE") ? labelFBBTR003.FirstOrDefault(c => c.Name == "FILE_TYPE").DisplayValue : "";
        FILE_SIZE = labelFBBTR003.Any(c => c.Name == "FILE_SIZE") ? labelFBBTR003.FirstOrDefault(c => c.Name == "FILE_SIZE").DisplayValue : "";

        //R18.11 FaceRecog
        L_RESULT_FACE_RECOGNITION = labelFBBTR003.Any(c => c.Name == "L_RESULT_FACE_RECOGNITION") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_RESULT_FACE_RECOGNITION").DisplayValue : "";
        L_PASS_FACE_RECOGNITION = labelFBBTR003.Any(c => c.Name == "L_PASS_FACE_RECOGNITION") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_PASS_FACE_RECOGNITION").DisplayValue : "";
        L_FAIL_FACE_RECOGNITION = labelFBBTR003.Any(c => c.Name == "L_FAIL_FACE_RECOGNITION") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_FAIL_FACE_RECOGNITION").DisplayValue : "";
        L_APPROVE_FACE_RECOGNITION = labelFBBTR003.Any(c => c.Name == "L_APPROVE_FACE_RECOGNITION") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_APPROVE_FACE_RECOGNITION").DisplayValue : "";
        PASS_FACE_RECOGNITION = labelFBBTR003.Any(c => c.Name == "PASS_FACE_RECOGNITION") ? labelFBBTR003.FirstOrDefault(c => c.Name == "PASS_FACE_RECOGNITION").DisplayValue : "";
        L_FAIL_NO_FACE_DETECTED = labelFBBTR003.Any(c => c.Name == "L_FAIL_NO_FACE_DETECTED") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_FAIL_NO_FACE_DETECTED").DisplayValue : "";

        L_BUTTON_DUP = labelFBBTR003.Any(c => c.Name == "L_BUTTON_DUP") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_BUTTON_DUP").DisplayValue : "";

        lBILL_BRAND = labelFBBTR003.Any(c => c.Name == "L_OLD_ISP") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_OLD_ISP").DisplayValue : "";

        L_VALIDATE_VAT_ADDR_L1 = labelFBBTR003.Any(c => c.Name == "L_VALIDATE_VAT_ADDR_L1") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_VALIDATE_VAT_ADDR_L1").DisplayValue : "";
        L_VALIDATE_VAT_ADDR_L2 = labelFBBTR003.Any(c => c.Name == "L_VALIDATE_VAT_ADDR_L2") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_VALIDATE_VAT_ADDR_L2").DisplayValue : "";
        L_VALIDATE_VAT_ADDR_L3 = labelFBBTR003.Any(c => c.Name == "L_VALIDATE_VAT_ADDR_L3") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_VALIDATE_VAT_ADDR_L3").DisplayValue : "";
        //19.6 Redcap
        PRE_SURVEY_DOWNLOAD_SPEED = labelFBBTR003.Any(c => c.Name == "PRE_SURVEY_DOWNLOAD_SPEED") ? labelFBBTR003.FirstOrDefault(c => c.Name == "PRE_SURVEY_DOWNLOAD_SPEED").DisplayValue : "";

        lONTOP_PACK = labelFBBTR003.Any(c => c.Name == "L_ONTOP_PACK") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_ONTOP_PACK").DisplayValue : "";
        L_FIXEDLINE = labelFBBTR003.Any(c => c.Name == "L_FIXEDLINE") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_FIXEDLINE").DisplayValue : "";
        L_ONTOP_PLAYBOX_FREE = labelFBBTR003.Any(c => c.Name == "L_ONTOP_PLAYBOX_FREE") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_ONTOP_PLAYBOX_FREE").DisplayValue : "";
        L_YOUR_PACK = labelFBBTR003.Any(c => c.Name == "L_YOUR_PACK") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_YOUR_PACK").DisplayValue : "";
        L_MAIN_PACK = labelFBBTR003.Any(c => c.Name == "L_MAIN_PACK") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_MAIN_PACK").DisplayValue : "";
        L_REMARK_GREETING = labelFBBTR003.Any(c => c.Name == "L_REMARK_GREETING") ? labelFBBTR003.FirstOrDefault(c => c.Name == "L_REMARK_GREETING").DisplayValue : "";

        DISPLAY_TIMESLOT = labelFBBTR003.Any(c => c.Name == "DISPLAY_TIMESLOT") ? labelFBBTR003.FirstOrDefault(c => c.Name == "DISPLAY_TIMESLOT").DisplayValue : "";
        //R21.12PP ATV
        WORDIND_MESH = labelFBBTR003.Any(c => c.Name == "WORDIND_MESH") ? labelFBBTR003.FirstOrDefault(c => c.Name == "WORDIND_MESH").DisplayValue : "";
    }

    string L_RECEIVING_CHANNEL_EBILL = "";
    string L_BILLING_ADDRESS = "";
    string L_SCAN_QR_LINE = "";

    if (ViewBag.LabelFBBTR004 != null)
    {
        var labelFBBTR004 = (List<LovScreenValueModel>)ViewBag.labelFBBTR004;
        L_RECEIVING_CHANNEL_EBILL = labelFBBTR004.Any(c => c.Name == "L_RECEIVING_CHANNEL_EBILL") ? labelFBBTR004.FirstOrDefault(c => c.Name == "L_RECEIVING_CHANNEL_EBILL").DisplayValue : "";
        L_BILLING_ADDRESS = labelFBBTR004.Any(c => c.Name == "L_BILLING_ADDRESS") ? labelFBBTR004.FirstOrDefault(c => c.Name == "L_BILLING_ADDRESS").DisplayValue : "";
        L_SCAN_QR_LINE = labelFBBTR004.Any(c => c.Name == "L_SCAN_QR_LINE") ? labelFBBTR004.FirstOrDefault(c => c.Name == "L_SCAN_QR_LINE").DisplayValue != null ? labelFBBTR004.FirstOrDefault(c => c.Name == "L_SCAN_QR_LINE").DisplayValue : "" : "";
    }

    string[] LOCATION_CHECK_BOX;

    if (ViewBag.FbbConstant != null)
    {
        var FbbConstant = (List<FbbConstantModel>)ViewBag.FbbConstant;

        FBB_Con_Input_CERT_FOUND = FbbConstant.Any(f => f.Field == "Input CERT_FOUND") ? FbbConstant.First(f => f.Field == "Input CERT_FOUND").Validation : "";
        FBB_Con_Input_EMB_LET = FbbConstant.Any(f => f.Field == "Input EMB_LET") ? FbbConstant.First(f => f.Field == "Input EMB_LET").Validation : "";
        FBB_Con_Input_HILL_CARD = FbbConstant.Any(f => f.Field == "Input HILL_CARD") ? FbbConstant.First(f => f.Field == "Input HILL_CARD").Validation : "";
        FBB_Con_Input_ID_CARD = FbbConstant.Any(f => f.Field == "Input ID_CARD") ? FbbConstant.First(f => f.Field == "Input ID_CARD").Validation : "";
        FBB_Con_Input_IMM_CARD = FbbConstant.Any(f => f.Field == "Input IMM_CARD") ? FbbConstant.First(f => f.Field == "Input IMM_CARD").Validation : "";
        FBB_Con_Input_MONK_CERT = FbbConstant.Any(f => f.Field == "Input MONK_CERT") ? FbbConstant.First(f => f.Field == "Input MONK_CERT").Validation : "";
        FBB_Con_Input_PASSPORT = FbbConstant.Any(f => f.Field == "Input PASSPORT") ? FbbConstant.First(f => f.Field == "Input PASSPORT").Validation : "";
        FBB_Con_Input_ROY_LET = FbbConstant.Any(f => f.Field == "Input ROY_LET") ? FbbConstant.First(f => f.Field == "Input ROY_LET").Validation : "";
        FBB_Con_Input_STA_LET = FbbConstant.Any(f => f.Field == "Input STA_LET") ? FbbConstant.First(f => f.Field == "Input STA_LET").Validation : "";
        FBB_Con_Input_TAX_ID = FbbConstant.Any(f => f.Field == "Input TAX_ID") ? FbbConstant.First(f => f.Field == "Input TAX_ID").Validation : "";
        FBB_Con_Input_GOV_LET = FbbConstant.Any(f => f.Field == "Input GOV_LET") ? FbbConstant.First(f => f.Field == "Input GOV_LET").Validation : "";

        FBB_Con_Input_Home_Number = FbbConstant.Any(f => f.Field == "Input_Home_Number") ? FbbConstant.First(f => f.Field == "Input_Home_Number").Validation : "";
        FBB_Con_Input_Moo = FbbConstant.Any(f => f.Field == "Input_Moo") ? FbbConstant.First(f => f.Field == "Input_Moo").Validation : "";
        FBB_Con_Input_Mooban = FbbConstant.Any(f => f.Field == "Input_Mooban") ? FbbConstant.First(f => f.Field == "Input_Mooban").Validation : "";
        FBB_Con_Input_Building = FbbConstant.Any(f => f.Field == "Input_Building") ? FbbConstant.First(f => f.Field == "Input_Building").Validation : "";
        FBB_Con_Input_Floor = FbbConstant.Any(f => f.Field == "Input_Floor") ? FbbConstant.First(f => f.Field == "Input_Floor").Validation : "";
        FBB_Con_Input_Room = FbbConstant.Any(f => f.Field == "Input_Room") ? FbbConstant.First(f => f.Field == "Input_Room").Validation : "";
        FBB_Con_Input_Soi = FbbConstant.Any(f => f.Field == "Input_Soi") ? FbbConstant.First(f => f.Field == "Input_Soi").Validation : "";
        FBB_Con_Input_Road = FbbConstant.Any(f => f.Field == "Input_Road") ? FbbConstant.First(f => f.Field == "Input_Road").Validation : "";
        FBB_Con_Input_HomePhone = FbbConstant.Any(f => f.Field == "Input_HomePhone") ? FbbConstant.First(f => f.Field == "Input_HomePhone").Validation : "";
        FBB_Con_Input_ExtNumber = FbbConstant.Any(f => f.Field == "Input_ExtNumber") ? FbbConstant.First(f => f.Field == "Input_ExtNumber").Validation : "";
        FBB_Con_Input_NameSpecialAccount = FbbConstant.Any(f => f.Field == "Input_NameSpecialAccount") ? FbbConstant.First(f => f.Field == "Input_NameSpecialAccount").Validation : "";
        FBB_Con_Input_NoSpecialAccount = FbbConstant.Any(f => f.Field == "Input_NoSpecialAccount") ? FbbConstant.First(f => f.Field == "Input_NoSpecialAccount").Validation : "";

        FBB_Con_CharNotonName = FbbConstant.Any(f => f.Field == "Char Not on Name") ? FbbConstant.First(f => f.Field == "Char Not on Name").Validation : "";
        FBB_Con_CharNotOnNameLastName = FbbConstant.Any(f => f.Field == "Char Not on Name LastName") ? FbbConstant.First(f => f.Field == "Char Not on Name LastName").Validation : "";
        FBB_InputCompanyName = FbbConstant.Any(f => f.Field == "Input_Company_Name") ? FbbConstant.First(f => f.Field == "Input_Company_Name").Validation : "";

        FBB_Con_MobileLength = FbbConstant.Any(f => f.Field == "Mobile Length") ? FbbConstant.First(f => f.Field == "Mobile Length").Validation : "";
        FBB_Input_MobileNo = FbbConstant.Any(f => f.Field == "Input_MobileNo") ? FbbConstant.First(f => f.Field == "Input_MobileNo").Validation : "";
        FBB_Con_YearLimitHigh = FbbConstant.Any(f => f.Field == "Year Limit High") ? FbbConstant.First(f => f.Field == "Year Limit High").Validation : "";
        FBB_Con_YearLimitLow = FbbConstant.Any(f => f.Field == "Year Limit Low") ? FbbConstant.First(f => f.Field == "Year Limit Low").Validation : "";

        FBB_Con_Length_ID_Card_Number_STA_LET = FbbConstant.Any(f => f.Field == "Length ID Card Number STA_LET") ? FbbConstant.First(f => f.Field == "Length ID Card Number STA_LET").Validation : "";
        FBB_Con_Length_ID_Card_Number_ROY_LET = FbbConstant.Any(f => f.Field == "Length ID Card Number ROY_LET") ? FbbConstant.First(f => f.Field == "Length ID Card Number ROY_LET").Validation : "";
        FBB_Con_Length_ID_Card_Number_EMB_LET = FbbConstant.Any(f => f.Field == "Length ID Card Number EMB_LET") ? FbbConstant.First(f => f.Field == "Length ID Card Number EMB_LET").Validation : "";
        FBB_Con_Length_ID_Card_Number_CERT_FOUND = FbbConstant.Any(f => f.Field == "Length ID Card Number CERT_FOUND") ? FbbConstant.First(f => f.Field == "Length ID Card Number CERT_FOUND").Validation : "";
        FBB_Con_Length_ID_Card_Number_TAX_ID = FbbConstant.Any(f => f.Field == "Length ID Card Number TAX_ID") ? FbbConstant.First(f => f.Field == "Length ID Card Number TAX_ID").Validation : "";
        FBB_Con_Length_ID_Card_Number_PASSPORT = FbbConstant.Any(f => f.Field == "Length ID Card Number PASSPORT") ? FbbConstant.First(f => f.Field == "Length ID Card Number PASSPORT").Validation : "";
        FBB_Con_Length_ID_Card_Number_GOV_LET = FbbConstant.Any(f => f.Field == "Length ID Card Number GOV LET") ? FbbConstant.First(f => f.Field == "Length ID Card Number GOV LET").Validation : "";

        FBB_Con_LengthIDCardNumberHILL_CARD = FbbConstant.Any(f => f.Field == "Length ID Card Number HILL_CARD") ? FbbConstant.First(f => f.Field == "Length ID Card Number HILL_CARD").Validation : "";
        FBB_Con_LengthIDCardNumberID_CARD = FbbConstant.Any(f => f.Field == "Length ID Card Number ID_CARD") ? FbbConstant.First(f => f.Field == "Length ID Card Number ID_CARD").Validation : "";
        FBB_Con_LengthIDCardNumberIMM_CARD = FbbConstant.Any(f => f.Field == "Length ID Card Number IMM_CARD") ? FbbConstant.First(f => f.Field == "Length ID Card Number IMM_CARD").Validation : "";
        FBB_Con_LengthIDCardNumberMONK_CERT = FbbConstant.Any(f => f.Field == "Length ID Card Number MONK_CERT") ? FbbConstant.First(f => f.Field == "Length ID Card Number MONK_CERT").Validation : "";

        SHOW_TIME_SLOT_LIST = FbbConstant.Where(f => f.Field == "TIMESLOT_BY_FLOWFLAG").ToList();
        SHOW_TIME_SLOT = FbbConstant.Any(f => f.Field == "TIMESLOT_BY_FLOWFLAG" && f.Validation == Model.FlowFlag) ? FbbConstant.First(f => f.Field == "TIMESLOT_BY_FLOWFLAG" && f.Validation == Model.FlowFlag).SubValidation : "";

        ATTACHED = FbbConstant.Where(p => p.Field == "ATTACHED_FILE_BY_PACKAGE_GROUP").Select(p => p.Validation.ToUpperInvariant()).ToArray();

        PREPAID_Package_Group = FbbConstant.Where(p => p.Field == "PREPAID_PACKAGE_GROUP").Select(p => p.Validation).ToArray();
        PREPAID_Package_Group_VAL2 = FbbConstant.Where(p => p.Field == "PREPAID_PACKAGE_GROUP").Select(p => p.SubValidation).ToArray();
        EVENT_RULE = FbbConstant.Any(f => f.Field == "EVENT_RULE_APPOINTMENT") ? FbbConstant.First(f => f.Field == "EVENT_RULE_APPOINTMENT").Validation : "";

        FBB_Con_Validate_Length_Address = FbbConstant.Any(f => f.Field == "VALIDATE_LENGTH_ADDRESS") ? FbbConstant.First(f => f.Field == "VALIDATE_LENGTH_ADDRESS").Validation : "";
        LOCATION_CHECK_BOX = FbbConstant.Where(p => p.Field == "LOCATION_CHECK_BOX" && p.SubValidation == "Y").Select(p => p.Validation.ToUpperInvariant()).ToArray();
    }
    else
    {
        PREPAID_Package_Group = null;
        PREPAID_Package_Group_VAL2 = null;
        ATTACHED = null;
        LOCATION_CHECK_BOX = null;
    }

    if (ViewBag.FbbException != null)
    {
        var FbbException = (List<FbbConstantModel>)ViewBag.FbbException;
        FBB_Exc_1 = FbbException.Any(f => f.Field == "1") ? FbbException.First(f => f.Field == "1").Validation : "";
        FBB_Exc_D = FbbException.Any(f => f.Field == "D") ? FbbException.First(f => f.Field == "D").Validation : "";
        FBB_Exc_F = FbbException.Any(f => f.Field == "F") ? FbbException.First(f => f.Field == "F").Validation : "";
        FBB_Exc_I = FbbException.Any(f => f.Field == "I") ? FbbException.First(f => f.Field == "I").Validation : "";
        FBB_Exc_S = FbbException.Any(f => f.Field == "S") ? FbbException.First(f => f.Field == "S").Validation : "";
    }

    var userAuthType = "";
    if (ViewBag.User != null)
    {
        var currentUser = ViewBag.User as WBBEntity.PanelModels.Account.UserModel;
        if (null != currentUser)
        {
            userAuthType = currentUser.AuthenticateType.ToSafeString();
        }
    }

    string LC = "";

    if (ViewBag.LC != null)
    {
        LC = ViewBag.LC as string;
    }

    string ESRIflag = "false";
    if (null != ViewBag.ESRIflag)
    {
        ESRIflag = ViewBag.ESRIflag;
    }

    string BypassESRIflag = "false";
    if (null != ViewBag.BypassESRIflag)
    {
        BypassESRIflag = ViewBag.BypassESRIflag;
    }

    string FromFBBxEOS = "";
    if (ViewBag.FromFBBxEOS != null)
    {
        FromFBBxEOS = ViewBag.FromFBBxEOS;
    }

    string CARD_NOsFBBxEOS = "";
    if (ViewBag.CARD_NOsFBBxEOS != null)
    {
        CARD_NOsFBBxEOS = ViewBag.CARD_NOsFBBxEOS;
    }

    string EOS_AccountTitle = "";
    if (ViewBag.EOS_AccountTitle != null)
    {
        EOS_AccountTitle = ViewBag.EOS_AccountTitle;
    }

    string EOS_CustomerName = "";
    if (ViewBag.EOS_CustomerName != null)
    {
        EOS_CustomerName = ViewBag.EOS_CustomerName;
    }

    string EOS_OfficeTelNo = "";
    if (ViewBag.EOS_OfficeTelNo != null)
    {
        EOS_OfficeTelNo = ViewBag.EOS_OfficeTelNo;
    }

    string FromCoverageFBBxEOS = "N";
    if (ViewBag.FromCoverageFBBxEOS != null)
    {
        FromCoverageFBBxEOS = ViewBag.FromCoverageFBBxEOS;
    }
    string meshArpu_Month_Flag = "";
    if (ViewBag.MeshArpuFlag != null)
    {
        var MeshArpuFlag = (List<LovScreenValueModel>)ViewBag.MeshArpuFlag;
        meshArpu_Month_Flag = MeshArpuFlag.Any(c => c.Name == "SCREEN_PRICE_MONTH_FLAG") ? MeshArpuFlag.FirstOrDefault(c => c.Name == "SCREEN_PRICE_MONTH_FLAG").DisplayValue : "";
    }
}


<script type="text/javascript">
@Html.JsMinify(
    @<text>

    var validateModel003R = new Array();
    var validateModel003GB = new Array();
    var validateModel003Setup = new Array();
    var validateModel003SendDoc = new Array();
    var validateModel003SendDocIDCard = new Array();
    var validateModel003Vat = new Array();
    var validateInstallDate = new Array();
    var vGroup = new Array();
    var dayTimeslot = 7;
    var chk_loadcard = false;
    var checkDateTimeSlot = false;
    var validateHomePhone = false;
    var unvalidateHomePhone = false;
    //Update 20.2 Product WTTx
    //Fix test product WTTx
    //$("#WTTX_COVERAGE_RESULT").val("YES")
    //var isWTTx = $("#WTTX_COVERAGE_RESULT").val() == "YES" ? true : false;
    //console.log("isWTTx Customer :", isWTTx)

    var listPreSurveyLocation = @Html.Raw(Json.Encode(LIST_PRE_SURVEY_LOCATION))
    var listPreSurveyProvince = @Html.Raw(Json.Encode(LIST_PRE_SURVEY_PROVINCE))


    $("#FromCoverageFBBxEOS").val("@FromCoverageFBBxEOS");

    $('input[type="radio"]').keydown(function (e) {
        var arrowKeys = [37, 38, 39, 40];
        if (arrowKeys.indexOf(e.which) !== -1) {
            return false;
        }
    });

    $('#btnBackPageCustomerRegister').click(function () {

        // Update 17.4 Script Adobe Analytic
        digitalData.customLinkName = "info:cancel-button";
        console.log("custom-link-click : button back page CustomerRegister-info");
        

        $('#showMessageVerify').hide();
        $('#message').empty();
        $('#FLAG_CHECK_VERIFY').val("");
        $("#faceRecogCheckedFlag").val("N");

        $("#showResultRecog").hide();
        $("#btnRemove").show();
        $("#btnRemoveDisabled").hide();

        // check pc/mobile
        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
            $("#btnbrowse").show();
            $("#btnbrowseDisabled").hide();
        }
        else {
            if (signatureShowFlag) {
                $("#filesignature").show();
                $("#filesignatureDisabled").hide();
            }
        }

        if ($("#CustomerRegisterPanelModel_FlagTakePhoto").val() == "Y" && navigator.userAgent.indexOf("SamsungBrowser") == -1 && !iOSSafari && !iOS && !signatureShowFlag) {
            $("#fileTakePhoto").show();
            $("#fileTakePhotoDisabled").hide();
        }
        $("#btnOrigin").show();
        $("#btnFromCamera").show();
        $("#btnOriginTake").hide();
        $("#btnFromCameraTake").hide();
        $("#btnValidateFace").hide();
        $("#btnValidateFaceDisabled").show();

        if (videoOpen != "") {
            $("#" + videoOpen).hide();
            $("#" + btnVideoID + "Take").hide();
            $("#" + btnVideoID).show();
            window[videoOpen].pause();
            localstream.getTracks()[0].stop();
            videoOpen = "";
        }

        $("#verifyIdentity").hide();
        $("#btnVerifyFace").hide();
        $("#imgPreviewOrigin").hide();
        $("#imgPreviewFromCamera").hide();
        $('input[id^="file"]').val("");
        $('input[id^="textImage"]').val("");
        $('label[id^="btnPreview"]').addClass('disabled');
        $('label[id^="btnPreview"]').attr('src', "");

        sessionStorage.setItem('Use_Data_Card', null);

        backPageToContentDetail();
        //backPage();
    });

    $('#btnNextPageCustomerRegister').click(function () {
        // Update 17.4 Script Adobe Analytic
        digitalData.customLinkName = "info:next-button";
        console.log("custom-link-click : button next page CustomerRegister-info");
        
        //$('#showMessageVerify').hide();
        //$('#message').empty();
        ChkInputAndRequiredField();
        //onChkCardType();

    });



    $('#btnBackToRegisterfromAddessSetdup').click(function () {

        // Update 17.4 Script Adobe Analytic
        digitalData.customLinkName = "installation:cancel-button";
        console.log("custom-link-click : button back page CustomerRegister-install");
        
        backToRegisterfromAddessSetdup();
        ChkImagefile();
    });

    $('#btnNextToAddressSendDoc').click(function () {
        clearBillingAddressATN(); //R23.11 Clear Billing Address BA_NO
        //R23.08 Call ATN
        if ($('input[name="typeselect"]:checked').val() == 'R') {
            if ($('#ID_CARD_NAME :selected').val() == "ID_CARD" || $('#ID_CARD_NAME :selected').val() == "PASSPORT" || $('#ID_CARD_NAME :selected').val() == "IMM_CARD") {
                funcCallBillingAddress();
            }
            else {
                isRelated = false;
                billAddressData = [];
            }
        }
        else {
            isRelated = false;
            billAddressData = [];
        }

        // Update 17.4 Script Adobe Analytic
        digitalData.customLinkName = "installation:next-button";
        console.log("custom-link-click : button next page CustomerRegister-install");
        
        //onChkCardType();
        nextToAddressSendDoc();
    });

    ///CustomerInsight
    function UseSubAnswer(questionID, answerID) {
        $('.SubAnswer' + questionID).each(function (i, obj) {
            $('#' + obj.id).hide();
        });
        if (answerID != "") {
            $('#divDll' + answerID).show();
        }
    }

    function QuestionHide(questionThis, questionHide) {
        if (questionHide == "END") {
            var checkHide = false;
            if (QuestionList != undefined && QuestionList.length > 0) {
                $.each(QuestionList, function (i, e) {
                    if (checkHide) {
                        $('#QuestionAIS' + e.QUESTION_ID).hide();
                    }
                    if (e.QUESTION_ID == questionThis) {
                        checkHide = true;
                    }
                });
            }
        }
        else {
            $('#QuestionAIS' + questionHide).hide();
        }
    }

    function QuestionShow(questionThis, questionShow) {
        if (questionShow == "END") {
            var checkShow = false;
            if (QuestionList != undefined && QuestionList.length > 0) {
                $.each(QuestionList, function (i, e) {
                    if (checkShow) {
                        $('#QuestionAIS' + e.QUESTION_ID).show();
                    }
                    if (e.QUESTION_ID == questionThis) {
                        checkShow = true;
                    }
                });
            }
        }
        else {
            $('#QuestionAIS' + questionShow).show();
        }
    }

    var QuestionList = [];
    var AnswerList = [];
    var SubAnswerList = [];
    function GenQuestion(mobileNo, technology) {
        $.ajax({
            type: "POST",
            url: "/Process/GenQuestion",
            data: { 'MobileNo': mobileNo, 'Technology': technology },
            dataType: "json",
            async: false,
            success: function (data) {
                $("#divCustomerInsight").html(data.resultHtml);
                $('#divShowCustomerInsight').css("cursor", "pointer");
                $('#divShowCustomerInsight').click(function () {
                    $("#divCustomerInsight").slideToggle("fast");
                    $('i.fa.cus-insight.fa-plus').toggleClass('fa-minus');
                });
                //AnswerIDs Dll
                $.each(data.AnswerIDs, function (indexdata, AnswerID) {
                    $('#' + AnswerID).select2();
                });
                //SubAnswerIDs Dll
                $.each(data.SubAnswerIDs, function (indexdata, SubAnswerID) {
                    $('#' + SubAnswerID).select2();
                });
                QuestionList = data.QuestionList.questionDatas;
                AnswerList = data.QuestionList.answerDatas;
                SubAnswerList = data.QuestionList.subAnswerDatas;
            }
        });
        $('#divShowCustomerInsight').show();
        $('#divCustomerInsight').show();
    }

    function ValidateQuestion() {
        var checkValidate = true;
        var msgValidate = [];
        var questionSkip = [];
        $("#listCustomerInsight").html("");
        if (QuestionList != undefined && QuestionList.length > 0) {
            $.each(QuestionList, function (iq, eq) {
                if (eq.REQUIRE_ANSWER_FLAG == "Y" && questionSkip.indexOf(eq.QUESTION_ID) == -1) {
                    var AnswerListFilter = AnswerList.filter(function (elem) {
                        return elem.QUESTION_ID.indexOf(eq.QUESTION_ID) !== -1
                            && elem.PARENT_ANSWER_ID.indexOf('') !== -1;
                    });
                    if (AnswerListFilter != undefined && AnswerListFilter.length > 0) {
                        var typeRadioInQuestion = false;
                        var typeDropDownInQuestion = false;
                        var typeCheckBoxInQuestion = false;
                        var typeTextboxInQuestion = false;
                        $.each(AnswerListFilter, function (ia, ea) {
                            if (ea.DISPLAY_TYPE == "Radio Button") {
                                typeRadioInQuestion = true;
                                var RadioSelectValue = $("#QuestionAIS" + eq.QUESTION_ID + " input[type='radio']:checked").val();
                                if (RadioSelectValue != undefined) {
                                    if (ea.ANSWER_ID == RadioSelectValue) {
                                        if (ea.ACTION == "SKIP") {
                                            questionSkip.push(ea.VALUE);
                                        }
                                        else if (ea.ACTION == "END") {
                                            var startPush = false;
                                            $.each(QuestionList, function (iq1, eq1) {
                                                if (startPush) {
                                                    questionSkip.push(eq1.QUESTION_ID);
                                                }
                                                if (eq1.QUESTION_ID == eq.QUESTION_ID) {
                                                    startPush = true;
                                                }
                                            });
                                        }
                                    }
                                }
                            }
                            else if (ea.DISPLAY_TYPE == "Drop Down List") {
                                typeDropDownInQuestion = true;
                            }
                            else if (ea.DISPLAY_TYPE == "Check Box") {
                                typeCheckBoxInQuestion = true;
                            }
                            else if (ea.DISPLAY_TYPE == "Textbox") {
                                typeTextboxInQuestion = true;
                            }
                        });
                        if (typeRadioInQuestion) {
                            var RadioSelectValue = $("#QuestionAIS" + eq.QUESTION_ID + " input[type='radio']:checked").val();
                            if (RadioSelectValue == undefined) {
                                msgValidate.push("#QuestionAIS" + eq.QUESTION_ID);
                            }
                        }
                    }
                }
            });
            $('.QuestionAIS').each(function (i, obj) {
                $('#' + obj.id).removeClass("errorinput");
            });
            if (msgValidate != undefined && msgValidate.length > 0) {
                checkValidate = false;
                $.each(msgValidate, function (ivd, vd) {
                    $(vd).addClass("errorinput");
                });
            }

            var strBuilderValue = "";
            if (checkValidate) {
                var indexVal = 0;
                var tmpAnswerList = [];
                // get value to model
                $('.QuestionAIS:visible').each(function (i, obj) {

                    /// radio
                    $("#" + obj.id + " input[type='radio']:checked").each(function (is, objs) {
                        tmpAnswerList.push(objs.value);
                    });

                    //$('.SubAnswer' + obj.id).each(function (is, objs) {
                    //    console.log(objs);
                    //});
                });

                $.each(tmpAnswerList, function (ial, alv) {
                    var AnswerListFilter = AnswerList.filter(function (elem) {
                        return elem.ANSWER_ID.indexOf(alv) !== -1;
                    });
                    $.each(AnswerListFilter, function (ialf, alfv) {
                        var QuestionListFilter = QuestionList.filter(function (elem) {
                            return elem.QUESTION_ID.indexOf(alfv.QUESTION_ID) !== -1;
                        });
                        if (QuestionListFilter != undefined) {
                            strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].GROUP_ID' value='" + QuestionListFilter[0].GROUP_ID + "' />";
                            strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].GROUP_NAME_TH' value='" + QuestionListFilter[0].GROUP_NAME_TH + "' />";
                            strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].GROUP_NAME_EN' value='" + QuestionListFilter[0].GROUP_NAME_EN + "' />";
                            strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].QUESTION_TH' value='" + QuestionListFilter[0].QUESTION_TH + "' />";
                            strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].QUESTION_EN' value='" + QuestionListFilter[0].QUESTION_EN + "' />";
                            strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].QUESTION_ID' value='" + alfv.QUESTION_ID + "' />";
                            strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].ANSWER_ID' value='" + alfv.ANSWER_ID + "' />";
                            strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].ANSWER_TH' value='" + alfv.ANSWER_TH + "' />";
                            strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].ANSWER_EN' value='" + alfv.ANSWER_EN + "' />";
                            strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].PARENT_ANSWER_ID' value='" + alfv.PARENT_ANSWER_ID + "' />";
                            strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].ACTION_WFM' value='" + alfv.ACTION_WFM + "' />";
                            strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].ACTION_FOA' value='" + alfv.ACTION_FOA + "' />";
                            strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].ANSWER_VALUE_TH' value='' />";
                            strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].ANSWER_VALUE_EN' value='' />";
                            indexVal++;
                        }
                        // Check Have PARENT
                        var AnswerParentListFilter = AnswerList.filter(function (elem) {
                            return elem.PARENT_ANSWER_ID.indexOf(alfv.ANSWER_ID) !== -1;
                        });
                        $.each(AnswerParentListFilter, function (iaplf, aplfv) {
                            //SubAnswerList
                            var SubAnswerIdSelect = "";
                            var SubAnswerText = "";
                            if (aplfv.DISPLAY_TYPE == "Drop Down List") {
                                SubAnswerIdSelect = $("#dll_" + alfv.ANSWER_ID).val();
                                SubAnswerText = $("#dll_" + alfv.ANSWER_ID + " option:selected").text();
                                var SubAnswerListFilter = SubAnswerList.filter(function (elem) {
                                    if ($("#LanguagePage").val() == "1")
                                        return elem.ANSWER_ID.indexOf(SubAnswerIdSelect) !== -1 && elem.ANSWER_VALUE_TH.indexOf(SubAnswerText) !== -1;
                                    else
                                        return elem.ANSWER_ID.indexOf(SubAnswerIdSelect) !== -1 && elem.ANSWER_VALUE_EN.indexOf(SubAnswerText) !== -1;
                                });
                                if (SubAnswerListFilter[0] != undefined) {
                                    strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].GROUP_ID' value='" + QuestionListFilter[0].GROUP_ID + "' />";
                                    strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].GROUP_NAME_TH' value='" + QuestionListFilter[0].GROUP_NAME_TH + "' />";
                                    strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].GROUP_NAME_EN' value='" + QuestionListFilter[0].GROUP_NAME_EN + "' />";
                                    strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].QUESTION_TH' value='" + QuestionListFilter[0].QUESTION_TH + "' />";
                                    strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].QUESTION_EN' value='" + QuestionListFilter[0].QUESTION_EN + "' />";
                                    strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].QUESTION_ID' value='" + aplfv.QUESTION_ID + "' />";
                                    strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].ANSWER_ID' value='" + aplfv.ANSWER_ID + "' />";
                                    strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].ANSWER_TH' value='" + aplfv.ANSWER_TH + "' />";
                                    strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].ANSWER_EN' value='" + aplfv.ANSWER_EN + "' />";
                                    strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].PARENT_ANSWER_ID' value='" + aplfv.PARENT_ANSWER_ID + "' />";
                                    strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].ACTION_WFM' value='" + aplfv.ACTION_WFM + "' />";
                                    strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].ACTION_FOA' value='" + aplfv.ACTION_FOA + "' />";
                                    strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].ANSWER_VALUE_TH' value='" + SubAnswerListFilter[0].ANSWER_VALUE_TH + "' />";
                                    strBuilderValue += "<input type='hidden' name='CustomerRegisterPanelModel.ListCustomerInsight[" + indexVal + "].ANSWER_VALUE_EN' value='" + SubAnswerListFilter[0].ANSWER_VALUE_EN + "' />";
                                    indexVal++;
                                }
                            }
                        });
                    });
                });
                if (strBuilderValue != "") {
                    $("#listCustomerInsight").html(strBuilderValue);
                }
            }
        }
        return checkValidate;
    }

    function onLoad003() {
        openModalIDCard();//R17.1 26Jan2017 Updated by PatthamawadeeH.
        chk_BrowserType();
        chk_RegisterDevice();
        setInstallDate();
        Get_Radio_CustomerType();//R16.5
        //onCheckType(document.getElementById("CustomerRegisterPanelModel_L_RESIDENTIAL"));
        if ($('input[name="typeselect"]:checked').val() == 'R') {
            pushRequireFieldAddressIdCard();
        }
        pushRequireFieldAddress();

        setPackage();
        GetdataCard();//R17.1 17Jan2017 Updated by PatthamawadeeH.
        setBirthDate();
        setDefaultYearBirthDate();//R18.7 Set Default Year => Line Register , Officer
        setSpecialExpireDate(); //R19.1 Special Account => Line Officer
        setDefaultRedcap(); //R19.4 Redcap => Line Officer

        //start edit 20170116
        $('#L_LOC_CODE').attr('readonly', false).css("background-color", "#FFF");
        $('#L_ASC_CODE').attr('readonly', false).css("background-color", "#FFF");
        $('#L_STAFF_ID').attr('readonly', false).css("background-color", "#FFF");
        $('#L_SALE_REP').attr('readonly', false).css("background-color", "#FFF");

        $('#L_LOC_CODE_FaceRecog').attr('readonly', false).css("background-color", "#FFF");
        $('#L_STAFF_ID_FaceRecog').attr('readonly', false).css("background-color", "#FFF");
        $('#L_ASC_CODE_FaceRecog').attr('readonly', false).css("background-color", "#FFF");

        if ($('#L_LOC_CODE').val() != "") {
            $('#L_LOC_CODE').attr('readonly', true).css("background-color", "#F0F0F0");
        }
        if ($('#L_LOC_CODE_FaceRecog').val() != "") {
            $('#L_LOC_CODE_FaceRecog').attr('readonly', true).css("background-color", "#F0F0F0");
        }

        if ($('#L_ASC_CODE').val() != "") {
            if (!canEdit) {
                $('#L_ASC_CODE').attr('readonly', true).css("background-color", "#F0F0F0");
            }
            $('#L_STAFF_ID').attr('readonly', true).css("background-color", "#F0F0F0");
        }

        if ($('#L_ASC_CODE_FaceRecog').val() != "") {
            $('#L_ASC_CODE_FaceRecog').attr('readonly', true).css("background-color", "#F0F0F0");
            $('#L_STAFF_ID_FaceRecog').attr('readonly', true).css("background-color", "#F0F0F0");
            $('#L_STAFF_ID_FaceRecog').val("");
        }

        if ($('#L_STAFF_ID').val() != "") {
            if (!canEdit) {
                $('#L_STAFF_ID').attr('readonly', true).css("background-color", "#F0F0F0");
            }
            $('#L_ASC_CODE').attr('readonly', true).css("background-color", "#F0F0F0");
        }

        if ($('#L_STAFF_ID_FaceRecog').val() != "") {
            $('#L_STAFF_ID_FaceRecog').attr('readonly', true).css("background-color", "#F0F0F0");
            $('#L_ASC_CODE_FaceRecog').attr('readonly', true).css("background-color", "#F0F0F0");
            $('#L_ASC_CODE_FaceRecog').val("");
        }

        if ($('#L_SALE_REP').val() != "") {
            $('#L_SALE_REP').attr('readonly', true).css("background-color", "#F0F0F0");
        }

        //end edit

        $("#CustomerRegisterPanelModel_ASSIGN_RULE").val("PUSH");

        if ($('#L_EVENT_CODE').val() == "") {
            $('#divPeriodDate').hide();
        }
        //$('#L_EVENT_CODE').val("");
        //$('#CPE_Serial').val("");
        //$('#PlayBox_Serial').val("");


        var isPlaybox = $('#hdGetPlayBox').val();
        if (isPlaybox == "1") {
            $('#PlayBox_Serial').show();
        } else {
            $('#PlayBox_Serial').hide();
            $('#PlayBox_Serial').val("");
        }

        $("#iconBarcode_CPE").hide();
        $("#iconBarcode_PB").hide();

        if (isOnMobileDevice()) {
            $("#iconBarcode_CPE").show();
            if (isPlaybox == "1") {
                $('#iconBarcode_PB').show();
            }
        }

        $("#CPE_Serial").removeClass("form-control errorinput ").addClass("form-control");
        $("#PlayBox_Serial").removeClass("form-control errorinput ").addClass("form-control");

        $("#interactive").hide();
        //$('#L_LOC_CODE').attr('readonly', true).css("background-color", "#F0F0F0");
        //$('#L_ASC_CODE').attr('readonly', true).css("background-color", "#F0F0F0");
        //$('#L_STAFF_ID').attr('readonly', true).css("background-color", "#F0F0F0");
        $('#divHouseSection').hide();
        $('#divCondoSection').hide();

        var typeUser = $('#HdFunctionSubProduct').val(); //FBB,AIR
        var typeHabitat = $('input[name="R_BUILD"]:checked').val(); //Condominium, Village
        if (typeUser == "SWiFi") {
            if (typeHabitat == "CONDOMINIUM") {
                $('#divCondoSection').show();
            }
            else if (typeHabitat == "VILLAGE") {
                $('#divHouseSection').show();
            }
            else {
                $('#divHouseSection').show();
            }
        }

        // for default value
        if ('@userAuthType' === 'SSOPartner') {
            $("#L_LOC_CODE").val("@LC");
            $("#L_LOC_CODE_FaceRecog").val("@LC");
            $("#divStaffSection").show();
            $('#expand').text("-");
        }
        if ($("#PlugAndPlayFlow").val() != "Y")
            setTimeSlotConfigSelectDate();
        setCustomerRegisterWaterMark();

        $('#ID_CARD_NAME').trigger('change');
        $('#CustomerRegisterPanelModel_L_NATIONALITY').val('THAI');
        $('#CustomerRegisterPanelModel_L_CARD_TYPE').val($('#ID_CARD_NAME :selected').text());
        $("#CustomerRegisterPanelModel_GIFT_VOUCHER").val($("#GiftVoucher").val());

        @*R18.11 IdCard Reader on PC*@
        if ($("#hdIdCardNoUserAis").val() != "" && $("#hdIdCardNoUserAis").val() != "undefined") {
            $("#L_CARD_NOs").val($("#hdIdCardNoUserAis").val());
        }
        else {
            $("#L_CARD_NOs").val("");
        }

        if ($("#L_CARD_NO").val() == "" && ($("#L_CARD_NOs").val() != "" && $("#L_CARD_NOs").val() != "null")) {
            $("#ID_CARD_NAME").val($("#ID_CARD_NAMEs").val());
            $("#ID_CARD_NAME").select2();
            $('#ID_CARD_NAME').trigger('change');
            $("#L_CARD_NO").val($("#L_CARD_NOs").val());

            //R23.08 IP Camera block textbox change
            if (($("#ID_CARD_NAMEs").val() == "ID_CARD") && (($("#L_CARD_NOs").val() != "") && ($("#L_CARD_NOs").val() != null))) {
                $("#ID_CARD_NAME").attr("disabled", true);
                $("#L_CARD_NO").attr("disabled", true);
            }
            else if (($("#ID_CARD_NAMEs").val() == "PASSPORT") && (($("#L_CARD_NOs").val() != "") && ($("#L_CARD_NOs").val() != null))) {
                $("#ID_CARD_NAME").attr("disabled", true);
                $("#L_CARD_NO").attr("disabled", true);
            }
            else if (($("#ID_CARD_NAMEs").val() == "IMM_CARD") && (($("#L_CARD_NOs").val() != "") && ($("#L_CARD_NOs").val() != null))) {
                $("#ID_CARD_NAME").attr("disabled", true);
                $("#L_CARD_NO").attr("disabled", true);
            }
        }

        if (sessionStorage.getItem('Card_id_card')
            && sessionStorage.getItem('Card_id_card') != "null"
            && sessionStorage.getItem('Card_id_card') != "undefined") {
            $("#L_CARD_NO").val(sessionStorage.getItem('Card_id_card'));
        }

        if ('@Model.SummaryPanelModel.VAS_FLAG' != "6") {
            if (($("#CoveragePanelModel_BUNDLINGMAINFLAG").val() == "Y" || $("#CoveragePanelModel_BUNDLINGSPECIALFLAG").val() == "Y") && $("#CoveragePanelModel_ChargeType").val() == "POSTPAID") {
                //if ($("#L_FIRST_NAME").val() != "") $("#L_FIRST_NAME").attr('readonly', true);
                //if ($("#L_LAST_NAME").val() != "") $("#L_LAST_NAME").attr('readonly', true);
                //if ($("#L_GOVERNMENT_NAME").val() != "") $("#L_GOVERNMENT_NAME").attr('readonly', true);
                if ($("#L_CARD_NO").val() != "") $("#L_CARD_NO").attr('readonly', true);
                //$("#ID_CARD_NAME").attr('disabled', true);
                //$("#CustomerRegisterPanelModel_L_RESIDENTIAL").attr('disabled', true);
                //$("#CustomerRegisterPanelModel_L_GOVERNMENT").attr('disabled', true);
                //$("#CustomerRegisterPanelModel_L_BUSINESS").attr('disabled', true);
            }
            else {
                $("#L_FIRST_NAME").attr('readonly', false);
                $("#L_LAST_NAME").attr('readonly', false);
                $("#L_GOVERNMENT_NAME").attr('readonly', false);
                $("#L_CARD_NO").attr('readonly', false);
                $("#CustomerRegisterPanelModel_L_RESIDENTIAL").attr('disabled', false);
                $("#CustomerRegisterPanelModel_L_GOVERNMENT").attr('disabled', false);
                $("#CustomerRegisterPanelModel_L_BUSINESS").attr('disabled', false);

                //R23.08 IP Camera block textbox change
                if (($("#ID_CARD_NAMEs").val() == "ID_CARD") && (($("#L_CARD_NOs").val() != "") && ($("#L_CARD_NOs").val() != null))) {
                    $("#ID_CARD_NAME").attr("disabled", true);
                }
                else if (($("#ID_CARD_NAMEs").val() == "PASSPORT") && (($("#L_CARD_NOs").val() != "") && ($("#L_CARD_NOs").val() != null))) {
                    $("#ID_CARD_NAME").attr("disabled", true);
                }
                else if (($("#ID_CARD_NAMEs").val() == "IMM_CARD") && (($("#L_CARD_NOs").val() != "") && ($("#L_CARD_NOs").val() != null))) {
                    $("#ID_CARD_NAME").attr("disabled", true);
                }
                else {
                    $("#ID_CARD_NAME").attr('disabled', false);
                }
            }
        }

        if ($('#TopUp').val() == "5") {
            // officer line
            //for Member get member 17.7
            if ($('#MemberGetMemberFlag').val() == 'Y') {
                $('#L_FIRST_NAME').val($('#CoverageMemberGetMember_CustomerName').val());
                $('#L_LAST_NAME').val($('#CoverageMemberGetMember_CustomerSurname').val());
                $('#L_MOBILE').val($('#CoverageMemberGetMember_CustomerMobileNo').val());
                $('#L_EMAIL').val($('#CoverageMemberGetMember_CustomerEmail').val());
                $('#L_VOUCHER_PIN').val($('#CoverageMemberGetMember_VoucherPin').val());
                $('#L_EMAIL').val($('#CoverageMemberGetMember_CustomerEmail').val());
            }

            //R22.06 Member get Member
            $('#L_VOUCHER_PIN').attr("readonly", true);

            $("label[id^='btnPreview']").show();
            $("label[id^='btnAddUpload']").show();
            if ($("#hdnAddUploadR").val() == "Y") {
                $('#btnAddUploadR').addClass('disabled');
            } else {
                $('#btnAddUploadR').removeClass('disabled');
            }

            if ($("#hdnAddUploadG").val() == "Y") {
                $('#btnAddUploadG').addClass('disabled');
            } else {
                $('#btnAddUploadG').removeClass('disabled');
            }

            if ($("#hdnAddUploadB").val() == "Y") {
                $('#btnAddUploadB').addClass('disabled');
            } else {
                $('#btnAddUploadB').removeClass('disabled');
            }
            $(".officer-upload").show();

            $("#divShowStaffSection").show();
            $("#divStaffSection").show();
            if (myLocationShowChk.indexOf($("#outChnSales").val().toUpperCase()) > -1) {
                $("#divChkOnline").show();
            }

            var selectPackageResult = $("input[name=SelectPackage]:checked").val();
            var accessModeResult = $("#ACCESS_MODE" + selectPackageResult).val();
            var productSubtypeResult = $("#PRODUCT_SUBTYPE_" + selectPackageResult).val();

            if ($("#PlugAndPlayFlow").val() == "Y") {
                $("#divInstallDate").hide();
                $("#divResponsiveTimeSLot").hide();
                if (!$("input[name*='CustomerRegisterPanelModel_L_CHECK_EVENT_CODE']:checked").val())
                    $("#chkEventCode").click();
                $("#chkEventCode").attr("disabled", "");

                $("#L_EVENT_CODE").attr("disabled", "");
            }
            else {
                //TODO: Splitter Management Change
                if (($("#L_SplitterFlagFirstTime").val() == "6" && accessModeResult != "FTTH") || ($("#L_SplitterFlagFirstTime").val() == "3" && accessModeResult != "FTTH") || ($("#L_SplitterFlagFirstTime").val() == "2" && accessModeResult != "FTTH")) {
                    $("#divInstallDate").hide();
                    $("#divResponsiveTimeSLot").hide();
                    if ($("#fromVDSL").val() == "true" || accessModeResult == "VDSL") {
                        if ($("#WTTX_COVERAGE_RESULT").val() != "YES" ) {
                            if ($("#checkShowtimeslotCaseDslam").val() == "Y") {
                                $('#divResponsiveTimeSLotMessage').html("");
                            }
                            else {
                                $('#divResponsiveTimeSLotMessage').html($("#messageNotShowtimeslot").val());
                            }
                        }
                    }
                    return;
                } else {
                    // case WTTx
                    if ($("#WTTX_COVERAGE_RESULT").val() == "YES" ) {
                        $("#divInstallDate").hide();
                        $("#divResponsiveTimeSLot").hide();
                    }
                    else {
                        $("#divInstallDate").show();
                        $("#divResponsiveTimeSLot").show();
                    }
                    if ($("#L_SplitterFlagFirstTime").val() == "6" || $("#L_SplitterFlagFirstTime").val() == "3" || $("#L_SplitterFlagFirstTime").val() == "2")
                    {
                        if ($("#fromVDSL").val() == "true" || accessModeResult == "VDSL") {
                            if ($("#WTTX_COVERAGE_RESULT").val() != "YES" ) {
                                if ($("#checkShowtimeslotCaseDslam").val() == "Y") {
                                    $('#divResponsiveTimeSLotMessage').html("");
                                }
                                else {
                                    $('#divResponsiveTimeSLotMessage').html($("#messageNotShowtimeslot").val());
                                }
                            }
                        }
                    }
                }
                $("#chkEventCode").removeAttr("disabled");
                $("#L_EVENT_CODE").removeAttr("disabled");
            }

            /// CustomerInsight
            GenQuestion($('#L_MOBILE').val(), productSubtypeResult);

            //TODO: R18.1 FTTB Sell Router
            //if ($("#ActiveSellRouterFlag").val() == "Y" && $('#TopUp').val() == "5" && $('#SelectFlagCheckPlugAndPlayFlow').val() == "N") {
            //    if ($('#CustomerRegisterPanelModel_RouterFlag').val() == "B") {
            //        $("#chkEventCode").removeAttr("disabled");
            //    }
            //    else {
            //        $("#L_EVENT_CODE").removeClass("errorinput");
            //        $("#L_EVENT_CODE").val("");
            //        $("#L_EVENT_CODE").attr("disabled", "");
            //    }
            //}

        } else {
            $("label[id^='btnPreview']").hide();
            $(".officer-upload").hide();
        }

        var selectPackageValue = $("input[name=SelectPackage]:checked").val();
        var accessModeValue = $("#ACCESS_MODE" + selectPackageValue).val();

        if ($("#fromVDSL").val() == "true" || accessModeValue == "VDSL") {
            if ($("#checkShowtimeslotCaseDslam").val() == "Y" && ($('#SelectFlagCheckPlugAndPlayFlow').val() == "N" || $('#SelectFlagCheckPlugAndPlayFlow').val() == "")) {
                // case WTTx
                if ($("#WTTX_COVERAGE_RESULT").val() == "YES" ) {
                    $("#divInstallDate").hide();
                    $("#divResponsiveTimeSLot").hide();
                }
                else {
                    $("#divInstallDate").show();
                    $("#divResponsiveTimeSLot").show();
                    $('#divResponsiveTimeSLotMessage').html('');
                }
                //$("#divInstallDate").show();
                //$("#divResponsiveTimeSLot").show();
                //$('#divResponsiveTimeSLotMessage').html('');
            } else {
                $("#divInstallDate").hide();
                $("#divResponsiveTimeSLot").hide();
                if ($("#WTTX_COVERAGE_RESULT").val() != "YES" ) {
                    $('#divResponsiveTimeSLotMessage').html($("#messageNotShowtimeslot").val());
                }
            }
        }
    }

    var myLocationShowChk = [];
    function onLoad003V2() {

        @foreach (var LocationShowChk in LOCATION_CHECK_BOX)
        {
         @:myLocationShowChk.push("@LocationShowChk");
        }
        openModalIDCard();//R17.1 26Jan2017 Updated by PatthamawadeeH.
        chk_BrowserType();
        chk_RegisterDevice();
        setInstallDate();
        Get_Radio_CustomerType();//R16.5
        if ($('input[name="typeselect"]:checked').val() == 'R') {
            pushRequireFieldAddressIdCard();
        }
        pushRequireFieldAddress();
        setPackageV2();
        GetdataCard();//R17.1 17Jan2017 Updated by PatthamawadeeH.
        setBirthDate();
        setDefaultYearBirthDate();//R18.7 Set Default Year => Line Register , Officer
        setSpecialExpireDate(); //R19.1 Special Account => Line Officer
        setDefaultRedcap(); //R19.4 Redcap => Line Officer

        //start edit 20170116
        $('#L_LOC_CODE').attr('readonly', false).css("background-color", "#FFF");
        $('#L_ASC_CODE').attr('readonly', false).css("background-color", "#FFF");
        $('#L_STAFF_ID').attr('readonly', false).css("background-color", "#FFF");
        $('#L_SALE_REP').attr('readonly', false).css("background-color", "#FFF");

        $('#L_LOC_CODE_FaceRecog').attr('readonly', false).css("background-color", "#FFF");
        $('#L_STAFF_ID_FaceRecog').attr('readonly', false).css("background-color", "#FFF");
        $('#L_ASC_CODE_FaceRecog').attr('readonly', false).css("background-color", "#FFF");

        if ($('#L_LOC_CODE').val() != "") {
            $('#L_LOC_CODE').attr('readonly', true).css("background-color", "#F0F0F0");
        }
        if ($('#L_LOC_CODE_FaceRecog').val() != "") {
            $('#L_LOC_CODE_FaceRecog').attr('readonly', true).css("background-color", "#F0F0F0");
        }

        if ($('#L_ASC_CODE').val() != "") {
            if (!canEdit) {
                $('#L_ASC_CODE').attr('readonly', true).css("background-color", "#F0F0F0");
            }
            $('#L_STAFF_ID').attr('readonly', true).css("background-color", "#F0F0F0");
        }
        if ($('#L_ASC_CODE_FaceRecog').val() != "") {
            $('#L_ASC_CODE_FaceRecog').attr('readonly', true).css("background-color", "#F0F0F0");
            $('#L_STAFF_ID_FaceRecog').attr('readonly', true).css("background-color", "#F0F0F0");
        }

        if ($('#L_STAFF_ID').val() != "") {
            if (!canEdit) {
                $('#L_STAFF_ID').attr('readonly', true).css("background-color", "#F0F0F0");
            }
            $('#L_ASC_CODE').attr('readonly', true).css("background-color", "#F0F0F0");
        }
        if ($('#L_STAFF_ID_FaceRecog').val() != "") {
            $('#L_STAFF_ID_FaceRecog').attr('readonly', true).css("background-color", "#F0F0F0");
            $('#L_ASC_CODE_FaceRecog').attr('readonly', true).css("background-color", "#F0F0F0");
        }

        if ($('#L_SALE_REP').val() != "") {
            $('#L_SALE_REP').attr('readonly', true).css("background-color", "#F0F0F0");

        }

        //end edit

        $("#CustomerRegisterPanelModel_ASSIGN_RULE").val("PUSH");

        if ($('#L_EVENT_CODE').val() == "") {
            $('#divPeriodDate').hide();
        }

        var isPlaybox = $('#hdGetPlayBox').val();
        if (isPlaybox == "1") {
            $('#PlayBox_Serial').show();
        } else {
            $('#PlayBox_Serial').hide();
            $('#PlayBox_Serial').val("");
        }

        $("#iconBarcode_CPE").hide();
        $("#iconBarcode_PB").hide();

        if (isOnMobileDevice()) {
            $("#iconBarcode_CPE").show();
            if (isPlaybox == "1") {
                $('#iconBarcode_PB').show();
            }
        }

        $("#CPE_Serial").removeClass("form-control errorinput ").addClass("form-control");
        $("#PlayBox_Serial").removeClass("form-control errorinput ").addClass("form-control");

        $("#interactive").hide();
        $('#divHouseSection').hide();
        $('#divCondoSection').hide();

        var typeUser = $('#HdFunctionSubProduct').val(); //FBB,AIR
        var typeHabitat = $('input[name="R_BUILD"]:checked').val(); //Condominium, Village
        if (typeUser == "SWiFi") {
            if (typeHabitat == "CONDOMINIUM") {
                $('#divCondoSection').show();
            }
            else if (typeHabitat == "VILLAGE") {
                $('#divHouseSection').show();
            }
            else {
                $('#divHouseSection').show();
            }
        }

        // for default value
        if ('@userAuthType' === 'SSOPartner') {
            $("#L_LOC_CODE").val("@LC");
            $("#L_LOC_CODE_FaceRecog").val("@LC");
            $("#divStaffSection").show();
            $('#expand').text("-");
        }
        //20.2
        if ($("#WTTX_COVERAGE_RESULT").val() != "YES" ) {
            setTimeSlotConfigSelectDate();
        }
        setCustomerRegisterWaterMark();

        $('#ID_CARD_NAME').trigger('change');
        $('#CustomerRegisterPanelModel_L_NATIONALITY').val('THAI');
        $('#CustomerRegisterPanelModel_L_CARD_TYPE').val($('#ID_CARD_NAME :selected').text());
        $("#CustomerRegisterPanelModel_GIFT_VOUCHER").val($("#GiftVoucher").val());

        @*R18.11 IdCard Reader on PC*@
        if ($("#hdIdCardNoUserAis").val() != "" && $("#hdIdCardNoUserAis").val() != "undefined") {
            $("#L_CARD_NOs").val($("#hdIdCardNoUserAis").val());
        }
        else if ($("#L_CARD_NOs").val() != "" && $("#L_CARD_NOs").val() != "null" && $("#L_CARD_NOs").val() != "undefined") { //R23.09 Edit Map disable idcard
        }
        else {
            $("#L_CARD_NOs").val("");
        }

        if (($("#L_CARD_NO").val() == "" || $("#L_CARD_NO").val() != "") && ($("#L_CARD_NOs").val() != "" && $("#L_CARD_NOs").val() != "null")) {
            $("#ID_CARD_NAME").val($("#ID_CARD_NAMEs").val());
            $("#ID_CARD_NAME").select2();
            $('#ID_CARD_NAME').trigger('change');
            $("#L_CARD_NO").val($("#L_CARD_NOs").val());

            //R23.08 IP Camera block textbox change
            if (($("#ID_CARD_NAMEs").val() == "ID_CARD") && (($("#L_CARD_NOs").val() != "") && ($("#L_CARD_NOs").val() != null))) {
                $("#ID_CARD_NAME").attr("disabled", true);
                $("#L_CARD_NO").attr("disabled", true);
            }
            else if (($("#ID_CARD_NAMEs").val() == "PASSPORT") && (($("#L_CARD_NOs").val() != "") && ($("#L_CARD_NOs").val() != null))) {
                $("#ID_CARD_NAME").attr("disabled", true);
                $("#L_CARD_NO").attr("disabled", true);
            }
            else if (($("#ID_CARD_NAMEs").val() == "IMM_CARD") && (($("#L_CARD_NOs").val() != "") && ($("#L_CARD_NOs").val() != null))) {
                $("#ID_CARD_NAME").attr("disabled", true);
                $("#L_CARD_NO").attr("disabled", true);
            }
        }

        if (sessionStorage.getItem('Card_id_card')
            && sessionStorage.getItem('Card_id_card') != "null"
            && sessionStorage.getItem('Card_id_card') != "undefined") {
            $("#L_CARD_NO").val(sessionStorage.getItem('Card_id_card'));
        }

        if ('@Model.SummaryPanelModel.VAS_FLAG' != "6") {
            if (($("#CoveragePanelModel_BUNDLINGMAINFLAG").val() == "Y" || $("#CoveragePanelModel_BUNDLINGSPECIALFLAG").val() == "Y") && $("#CoveragePanelModel_ChargeType").val() == "POSTPAID") {
                if ($("#L_CARD_NO").val() != "") $("#L_CARD_NO").attr('readonly', true);
            }
            else {
                $("#L_FIRST_NAME").attr('readonly', false);
                $("#L_LAST_NAME").attr('readonly', false);
                $("#L_GOVERNMENT_NAME").attr('readonly', false);
                $("#L_CARD_NO").attr('readonly', false);
                $("#CustomerRegisterPanelModel_L_RESIDENTIAL").attr('disabled', false);
                $("#CustomerRegisterPanelModel_L_GOVERNMENT").attr('disabled', false);
                $("#CustomerRegisterPanelModel_L_BUSINESS").attr('disabled', false);

                //R23.08 IP Camera block textbox change
                if (($("#ID_CARD_NAMEs").val() == "ID_CARD") && (($("#L_CARD_NOs").val() != "") && ($("#L_CARD_NOs").val() != null))) {
                    $("#ID_CARD_NAME").attr("disabled", true);
                }
                else if (($("#ID_CARD_NAMEs").val() == "PASSPORT") && (($("#L_CARD_NOs").val() != "") && ($("#L_CARD_NOs").val() != null))) {
                    $("#ID_CARD_NAME").attr("disabled", true);
                }
                else if (($("#ID_CARD_NAMEs").val() == "IMM_CARD") && (($("#L_CARD_NOs").val() != "") && ($("#L_CARD_NOs").val() != null))) {
                    $("#ID_CARD_NAME").attr("disabled", true);
                }
                else {
                    $("#ID_CARD_NAME").attr('disabled', false);
                }
            }
        }

        if ($('#TopUp').val() == "5") {
            // officer line
            //for Member get member 17.7
            if ($('#MemberGetMemberFlag').val() == 'Y') {
                $('#L_FIRST_NAME').val($('#CoverageMemberGetMember_CustomerName').val());
                $('#L_LAST_NAME').val($('#CoverageMemberGetMember_CustomerSurname').val());
                $('#L_MOBILE').val($('#CoverageMemberGetMember_CustomerMobileNo').val());
                $('#L_EMAIL').val($('#CoverageMemberGetMember_CustomerEmail').val());
                $('#L_VOUCHER_PIN').val($('#CoverageMemberGetMember_VoucherPin').val());
                $('#L_EMAIL').val($('#CoverageMemberGetMember_CustomerEmail').val());
            }

            //R22.06 Member get Member
            $('#L_VOUCHER_PIN').attr("readonly", true);

            $("label[id^='btnPreview']").show();
            $("label[id^='btnAddUpload']").show();
            if ($("#hdnAddUploadR").val() == "Y") {
                $('#btnAddUploadR').addClass('disabled');
            } else {
                $('#btnAddUploadR').removeClass('disabled');
            }

            if ($("#hdnAddUploadG").val() == "Y") {
                $('#btnAddUploadG').addClass('disabled');
            } else {
                $('#btnAddUploadG').removeClass('disabled');
            }

            if ($("#hdnAddUploadB").val() == "Y") {
                $('#btnAddUploadB').addClass('disabled');
            } else {
                $('#btnAddUploadB').removeClass('disabled');
            }
            $(".officer-upload").show();

            $("#divShowStaffSection").show();
            $("#divStaffSection").show();
            if (myLocationShowChk.indexOf($("#outChnSales").val().toUpperCase()) > -1) {
                $("#divChkOnline").show();
            }

            var selectPackageResult = $("input[name=SelectPackage]:checked").val();
            var accessModeResult = $("#ACCESS_MODE" + selectPackageResult).val();
            var productSubtypeResult = $("#PRODUCT_SUBTYPE_" + selectPackageResult).val();
            //TODO: Splitter Management Change
            if (($("#L_SplitterFlagFirstTime").val() == "3" && accessModeResult != "FTTH") || ($("#L_SplitterFlagFirstTime").val() == "2" && accessModeResult != "FTTH")) {
                $("#divInstallDate").hide();
                $("#divResponsiveTimeSLot").hide();
                if ($("#fromVDSL").val() == "true" || accessModeResult == "VDSL") {
                    if ($("#WTTX_COVERAGE_RESULT").val() != "YES" ) {
                        if ($("#checkShowtimeslotCaseDslam").val() == "Y") {
                            $('#divResponsiveTimeSLotMessage').html("");
                        }
                        else {
                            $('#divResponsiveTimeSLotMessage').html($("#messageNotShowtimeslot").val());
                        }
                    }
                }
                return;
            } else {
                // case WTTx
                if ($("#WTTX_COVERAGE_RESULT").val() == "YES" ) {
                    $("#divInstallDate").hide();
                    $("#divResponsiveTimeSLot").hide();
                }
                else {
                    $("#divInstallDate").show();
                    $("#divResponsiveTimeSLot").show();
                }
                //$("#divInstallDate").show();
                //$("#divResponsiveTimeSLot").show();
                if ($("#L_SplitterFlagFirstTime").val() == "3" || $("#L_SplitterFlagFirstTime").val() == "2") {
                    if ($("#fromVDSL").val() == "true" || accessModeResult == "VDSL") {
                        if ($("#WTTX_COVERAGE_RESULT").val() != "YES" ) {
                            if ($("#checkShowtimeslotCaseDslam").val() == "Y") {
                                $('#divResponsiveTimeSLotMessage').html("");
                            }
                            else {
                                $('#divResponsiveTimeSLotMessage').html($("#messageNotShowtimeslot").val());
                            }
                        }
                    }
                }
            }
            $("#chkEventCode").removeAttr("disabled");
            $("#L_EVENT_CODE").removeAttr("disabled");

            /// CustomerInsight
            GenQuestion($('#L_MOBILE').val(), productSubtypeResult);

        } else {
            $("label[id^='btnPreview']").hide();
            $(".officer-upload").hide();
        }

        var selectPackageValue = $("input[name=SelectPackage]:checked").val();
        var accessModeValue = $("#ACCESS_MODE" + selectPackageValue).val();

        if ($("#fromVDSL").val() == "true" || accessModeValue == "VDSL") {
            if ($("#checkShowtimeslotCaseDslam").val() == "Y" && ($('#SelectFlagCheckPlugAndPlayFlow').val() == "N" || $('#SelectFlagCheckPlugAndPlayFlow').val() == "")) {
                 // case WTTx
                if ($("#WTTX_COVERAGE_RESULT").val() == "YES" ) {
                    $("#divInstallDate").hide();
                    $("#divResponsiveTimeSLot").hide();
                    $("#divResponsiveTimeSLotMessage").hide();
                }
                else {
                    $("#divInstallDate").show();
                    $("#divResponsiveTimeSLot").show();
                    $('#divResponsiveTimeSLotMessage').html('');
                }
                //$("#divInstallDate").show();
                //$("#divResponsiveTimeSLot").show();
                //$('#divResponsiveTimeSLotMessage').html('');
            } else {
                $("#divInstallDate").hide();
                $("#divResponsiveTimeSLot").hide();
                if ($("#WTTX_COVERAGE_RESULT").val() != "YES" ) {
                    $('#divResponsiveTimeSLotMessage').html($("#messageNotShowtimeslot").val());
                }
            }
        }
        else if ($("#fromVDSL").val() == "false" && window.getComputedStyle(document.getElementById("divInstallDate")).display === "none") {
            $("#divInstallDate").show();
            $("#divResponsiveTimeSLot").show();
            $('#divResponsiveTimeSLotMessage').html('');
        }

        if ($("#WTTX_COVERAGE_RESULT").val() == "YES") {
            $("#divInstallDate").hide();
            $("#divResponsiveTimeSLot").hide();
        }

        if ('@Model.StaffPrivilegeBypass_Flag' == 'Y') {
            $("#ID_CARD_NAME").attr('disabled', true);
            $("#L_CARD_NO").attr('readonly', true);
        }

    }

    function InsertdataCard() {
        var _L_ERROR_LOAD_CARD = "@L_ERROR_LOAD_CARD";
        var result = aisNative.sendIccCommand(0, 2, "");
        if (result == "Presented") {
            var fieldValues = aisNative.sendIccCommand(0, 4, "").split("#");
            var PICTURE = aisNative.sendIccCommand(0, 5, "");

            var NATIONALID = fieldValues[2];

            var TITLE_TH = fieldValues[3];

            var FIRSTNAME_TH = fieldValues[4];
            var LASTNAME_TH = fieldValues[6];

            var TITLE_EN = fieldValues[7];
            var FIRSTNAME_EN = fieldValues[8];
            var LASTNAME_EN = fieldValues[10];

            var SEX = fieldValues[12];

            var ADDRESS = fieldValues[13];

            var MOO = "";
            if (!isEmpty(fieldValues[14])) {
                MOO = "หมู่ " + fieldValues[14];
            }

            var ALLEY = "";
            if (!isEmpty(fieldValues[15])) {
                ALLEY = fieldValues[15];
            }

            var SOI = "";
            if (!isEmpty(fieldValues[16])) {
                SOI = "ซอย" + fieldValues[16];
            }

            var STREET = "";
            if (!isEmpty(fieldValues[17])) {
                STREET = "ถนน" + fieldValues[17];
            }

            var SUBDISTRICT = "";
            var DISTRICT = "";
            var PROVINCE = (fieldValues[20] == "กรุงเทพมหานคร");

            if (PROVINCE) {
                SUBDISTRICT = "แขวง" + fieldValues[18];
            } else {
                SUBDISTRICT = "ต." + fieldValues[18];
            }

            if (PROVINCE) {
                DISTRICT = "เขต" + fieldValues[19];
            } else {
                DISTRICT = "อ." + fieldValues[19];
            }

            if (PROVINCE) {
                PROVINCE = " " + fieldValues[20];
            } else {
                PROVINCE = "จ." + fieldValues[20];
            }

            var day = fieldValues[11].substring(0, 2);
            var month = fieldValues[11].substring(3, 5);
            var year = fieldValues[11].substring(6, 10);
            var BIRTHDATE = day + "-" + month + "-" + year;

            var ISSUEPLACE = fieldValues[21];

            var day_open = fieldValues[22].substring(0, 2);
            var month_open = fieldValues[22].substring(3, 5);
            var year_open = fieldValues[22].substring(6, 10);
            var ISSUEDATE = day_open + "-" + month_open + "-" + year_open;

            var day_exp = fieldValues[23].substring(0, 2);
            var month_exp = fieldValues[23].substring(3, 5);
            var year_exp = fieldValues[23].substring(6, 10);
            var EXPIREDATE = day_exp + "-" + month_exp + "-" + year_exp;

            sessionStorage.setItem('Card_l_TITLE_TH', TITLE_TH);
            sessionStorage.setItem('Card_f_name', FIRSTNAME_TH);
            sessionStorage.setItem('Card_l_name', LASTNAME_TH);
            sessionStorage.setItem('Card_l_TITLE_EN', TITLE_EN);
            sessionStorage.setItem('Card_f_name_en', FIRSTNAME_EN);
            sessionStorage.setItem('Card_l_name_en', LASTNAME_EN);
            sessionStorage.setItem('Card_id_card', NATIONALID);
            sessionStorage.setItem('Card_province', PROVINCE);
            sessionStorage.setItem('Card_district', DISTRICT);
            sessionStorage.setItem('Card_subDistrict', SUBDISTRICT);
            sessionStorage.setItem('Card_moo', MOO);
            sessionStorage.setItem('Card_soi', SOI);
            sessionStorage.setItem('Card_road', STREET);
            sessionStorage.setItem('Card_houseNo', ADDRESS);
            sessionStorage.setItem('chk_open', "Y");
            sessionStorage.setItem('Card_BIRTHDATE', BIRTHDATE);
            sessionStorage.setItem('Card_PICTURE', PICTURE);


            $('#hdnCard_province').val(fieldValues[20]);
            $('#hdnCard_district').val(fieldValues[19]);
            $('#hdnCard_subDistrict').val(fieldValues[18]);
            $('#hdnCard_moo').val(fieldValues[14]);
            $('#hdnCard_soi').val(fieldValues[16]);
            $('#hdnCard_road').val(fieldValues[17]);
            $('#hdnCard_houseNo').val(fieldValues[13]);

            $.ajax({
                url: '/Process/SaveSessionCardReader',
                data: {
                    NATIONALID: NATIONALID,
                    TITLE_TH: TITLE_TH,
                    FIRSTNAME_TH: FIRSTNAME_TH,
                    LASTNAME_TH: LASTNAME_TH,
                    TITLE_EN: TITLE_EN,
                    FIRSTNAME_EN: FIRSTNAME_EN,
                    LASTNAME_EN: LASTNAME_EN,
                    BIRTHDATE: BIRTHDATE,
                    SEX: SEX,
                    ADDRESS: ADDRESS,
                    MOO: MOO,
                    ALLEY: ALLEY,
                    SOI: SOI,
                    STREET: STREET,
                    SUBDISTRICT: SUBDISTRICT,
                    DISTRICT: DISTRICT,
                    PROVINCE: PROVINCE,
                    PICTURE: PICTURE,
                    ISSUEPLACE: ISSUEPLACE,
                    ISSUEDATE: ISSUEDATE,
                    EXPIREDATE: EXPIREDATE
                },
                dataType: "json",
                type: 'POST',
                async: false,
                success: function (data) {
                    var iframe = document.getElementById('iframeCard');
                    iframe.src = iframe.src;
                }
            });

        }
    }

    var baste64strFromSignature = "";

    function Load_cardreader() {
        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {

            @*R18.11 IdCard Reader on PC*@
            if ($("#hdIdCardReaderOnPcFlag").val() == "Y") {

                sessionStorage.setItem('Use_Data_Card', "Y");

                var cardIsActive = sessionStorage.getItem('Card_is_Active');
                var _L_ERROR_LOAD_CARD = "@L_ERROR_LOAD_CARD";
                if (cardIsActive == "Y") {

                    $('#Modal-used-idcard-Pc').modal('hide');


                    var base64str = sessionStorage.getItem('Card_id_card_PICTURE_Pc');
                    if (base64str && base64str.length > 0) {
                        $('#textImage').val('IDCardImage.jpeg');
                        $("#hdtextImagename").val($("#textImage").val());

                        var canvas = document.getElementById('canTempImageTakePhoto')
                        var ctx = canvas.getContext('2d');
                        var preloadImage = new Image()
                        preloadImage.src = 'data:image/jpeg;base64,' + base64str;
                        preloadImage.onload = function () {
                            canvas.width = preloadImage.width;
                            canvas.height = preloadImage.height;
                            ctx.drawImage(preloadImage, 0, 0);

                            $("#canTempImageTakePhoto").show();
                            $("#imgPreviewOrigin").show();
                            // $("#imgPreviewOrigin").src = "data:image/jpeg;base64," + base64str
                            $("#imgPreviewOrigin").attr('src', "data:image/jpeg;base64," + base64str);

                            $("#btnOrigin").hide();
                            $("#btnOriginTake").hide();

                            $("#verifyIdentity").hide();
                            $("#btnVerifyFace").hide();

                            canMake1 = true;
                            fromTake1 = false;
                            signatureShowFlag = true;
                            if (canMake1 && canMake2) {
                                $("#btnValidateFaceDisabled").hide();
                                $("#btnValidateFace").show();
                            }

                            if (videoOpen != "") {
                                $("#" + videoOpen).hide();
                                $("#" + btnVideoID + "Take").hide();
                                $("#" + btnVideoID).show();

                                window[videoOpen].pause();
                                localstream.getTracks()[0].stop();
                                videoOpen = "";
                            }

                            renderImageBase64('data:image/jpeg;base64,' + base64str, "textImage", "1");

                            //R18.11 IdCard Reader on PC
                            var sizeFileText = calculateSizeFileByBase64('data:image/jpeg;base64,' + base64str, "IDCardImage.jpeg");
                            if (sizeFileText) {
                                $("#textImage").val(sizeFileText);
                                $("#hdtextImagename").val($("#textImage").val());
                            }
                        }

                        // เปิดปุ่ม Preview รูป
                        $('#btnPreviewR1').removeClass('disabled');
                    }

                    var NATIONALID = sessionStorage.getItem('Card_id_card_usb');
                    var FIRSTNAME_TH = sessionStorage.getItem('Card_f_name');
                    var LASTNAME_TH = sessionStorage.getItem('Card_l_name');
                    var LASER_ID = sessionStorage.getItem('Card_laser_id');

                    var birthdate = sessionStorage.getItem('Card_BIRTHDATE');

                    var birthdateDay = birthdate.substring(6, 8);
                    var birthdateMonth = birthdate.substring(4, 6);
                    var birthdateYear = birthdate.substring(0, 4);
                    var SEX = sessionStorage.getItem('Card_sex'); //1=M ,2=F
                    if (SEX == "1") {
                        SEX = "MALE"
                    }
                    else if (SEX == "2") {
                        SEX = "FEMALE"
                    }
                    else {
                        SEX = "@lGENDER"
                    }

                    if ($("#LanguagePage").val() != "1") //อังกฤษ
                    {
                        var newBirthdateYear = parseInt(birthdateYear, 10) - 543;
                        birthdateYear = newBirthdateYear.toString();
                    }

                    var BIRTHDATE = birthdateDay + "-" + birthdateMonth + "-" + birthdateYear;

                    $('#hdnCard_province').val(sessionStorage.getItem('Card_province'));
                    $('#hdnCard_district').val(sessionStorage.getItem('Card_district'));
                    $('#hdnCard_subDistrict').val(sessionStorage.getItem('Card_subDistrict'));
                    $('#hdnCard_moo').val(sessionStorage.getItem('Card_moo'));
                    $('#hdnCard_soi').val(sessionStorage.getItem('Card_soi'));
                    $('#hdnCard_road').val(sessionStorage.getItem('Card_road'));
                    $('#hdnCard_houseNo').val(sessionStorage.getItem('Card_houseNo'));

                    if (NATIONALID != "" && NATIONALID != null && NATIONALID != "undefined") {

                        $("#L_FIRST_NAME").val(FIRSTNAME_TH);
                        $("#L_LAST_NAME").val(LASTNAME_TH);
                        $("#L_CARD_NO").val(NATIONALID);
                        $("#L_ID_CARD_LASER").val(LASER_ID);

                        var str_birthday = BIRTHDATE;
                        var day = str_birthday.substring(0, 2);
                        var month = str_birthday.substring(3, 5);
                        var year = str_birthday.substring(6, 10);

                        $('#dayBirthdate').val(day);
                        $('#dayBirthMonth').val(month);
                        $('#dayBirthdyear').val(year);
                        setBirthDate();

                        //GetCustomerGender
                        $('#ddlGender').empty();
                        $.ajax({
                            type: "GET",
                            url: "/MasterData/GetCustomerGender",
                            dataType: "json",
                            success: function (data) {
                                var strBuilder = "";
                                if (SEX == "@lGENDER") {
                                    strBuilder = "<option value='' selected >" + "@lGENDER" + "</option>";
                                }
                                else {
                                    strBuilder = "<option value='' >" + "@lGENDER" + "</option>";
                                }
                                $.each(data, function (i, e) {
                                    var str = "";

                                    if (e.Value == SEX)
                                        str = '<option value="' + e.Value + '" selected >' + e.Text + '</option>';
                                    else
                                        str = '<option value="' + e.Value + '">' + e.Text + '</option>';

                                    strBuilder += str;
                                });
                                $('#ddlGender').append(strBuilder);
                                $('#ddlGender').select2();
                                $('#CustomerRegisterPanelModel_L_GENDER').val($('#ddlGender :selected').text());
                            }
                        });

                        if ($('#L_FIRST_NAME').val() != "") $('#L_FIRST_NAME').removeClass('errorinput');
                        if ($('#L_LAST_NAME').val() != "") $('#L_LAST_NAME').removeClass('errorinput');
                        if ($('#L_CARD_NO').val() != "") $('#L_CARD_NO').removeClass('errorinput');
                        if ($('#L_ID_CARD_LASER').val() != "") $('#L_ID_CARD_LASER').removeClass('errorinput');
                        //Set Disable
                        $('#TITLE_CODE').prop('disabled', true);
                        $('#L_FIRST_NAME').prop('readonly', true);
                        $('#L_LAST_NAME').prop('readonly', true);
                        $('#ID_CARD_NAME').prop('disabled', true);
                        $('#L_CARD_NO').prop('readonly', true);
                        $('#ddlGender').prop('disabled', true);
                        $('#ddlDay').prop('disabled', true);
                        $('#ddlMonth').prop('disabled', true);
                        $('#ddlYear').prop('disabled', true);

                        if ($('#CustomerRegisterPanelModel_FlagDopa').val() == "Y") {
                            $('#divIdCardVerify').show();
                            $('#idCardVerify').show();
                        }
                        if ($("#CustomerRegisterPanelModel_FlagFaceRecognition").val() == "Y") {
                            $("#faceRecog").show()
                        }

                        if ($('#L_ID_CARD_LASER').val() != "") {
                            $('#L_ID_CARD_LASER').prop('readonly', true);
                        }

                        if ($('#textImage').val() != "") {
                            $('#textImage').removeClass('errorinput');

                            // check pc/mobile
                            if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
                                $('#btnbrowse').hide();
                                $('#btnbrowseDisabled').show();

                            }
                            else {
                                if (signatureShowFlag) {
                                    $("#filesignature").hide();
                                    $("#filesignatureDisabled").show();
                                }
                            }

                            if ($("#CustomerRegisterPanelModel_FlagTakePhoto").val() == "Y" && navigator.userAgent.indexOf("SamsungBrowser") == -1 && !iOSSafari && !iOS && !signatureShowFlag) {
                                $("#fileTakePhoto").hide();
                                $("#fileTakePhotoDisabled").show();
                            }

                            $('#btnRemove').hide();
                            $('#btnRemoveDisabled').show();
                        }
                    }
                }
                else {
                    toastrErrorMessage(_L_ERROR_LOAD_CARD);
                }

            }
        }
        else {
            var _L_ERROR_LOAD_CARD = "@L_ERROR_LOAD_CARD";
            sessionStorage.setItem('Use_Data_Card_Tablet', "");

            $.ajax({
                type: "POST",
                url: "/Process/used_type_flag",
                data: { 'status': 'Loaddata' },
                dataType: "json",
                success: function (data) {

                    $('#Modal-used-idcard').modal('hide');

                    var result = aisNative.sendIccCommand(0, 2, "");
                    if (result == "Presented") {

                        var base64str = aisNative.sendIccCommand(0, 5, "");
                        if (base64str && base64str.length > 0) {
                            var img = document.getElementById("imgPhoto");
                            img.setAttribute("src", 'data:image/jpg;base64,' + base64str + '');
                            sessionStorage.setItem('Card_PICTURE', base64str);
                            signatureShowFlag = true;

                            //////////////////////////////////////
                            baste64strFromSignature = base64str;
                            //$("#imgPreviewOrigin").show();
                            //// $("#imgPreviewOrigin").src = "data:image/jpeg;base64," + base64str
                            //$("#imgPreviewOrigin").attr('src', "data:image/jpeg;base64," + base64str);

                            //$("#btnOrigin").hide();
                            //$("#btnOriginTake").hide();

                            //$("#verifyIdentity").hide();
                            //$("#btnVerifyFace").hide();

                            //signatureShowFlag = true;
                            //canMake1 = true;
                            //fromTake1 = false;
                            //if (canMake1 && canMake2) {
                            //    $("#btnValidateFaceDisabled").hide();
                            //    $("#btnValidateFace").show();
                            //}
                        }

                        sessionStorage.setItem('Use_Data_Card_Tablet', "Y");

                        var fieldValues = aisNative.sendIccCommand(0, 4, "").split("#");
                        var NATIONALID = fieldValues[2];
                        var FIRSTNAME_TH = fieldValues[4];
                        var LASTNAME_TH = fieldValues[6];
                        var day = fieldValues[11].substring(0, 2);
                        var month = fieldValues[11].substring(3, 5);
                        var year = fieldValues[11].substring(6, 10);
                        var BIRTHDATE = day + "-" + month + "-" + year;
                        var SEX = fieldValues[12];
                        if (SEX == "1") {
                            SEX = "MALE"
                        }
                        else if (SEX == "2") {
                            SEX = "FEMALE"
                        }
                        else {
                            SEX = "@lGENDER"
                        }

                        $('#hdnCard_province').val(fieldValues[20]);
                        $('#hdnCard_district').val(fieldValues[19]);
                        $('#hdnCard_subDistrict').val(fieldValues[18]);
                        $('#hdnCard_moo').val(fieldValues[14]);
                        $('#hdnCard_soi').val(fieldValues[16]);
                        $('#hdnCard_road').val(fieldValues[17]);
                        $('#hdnCard_houseNo').val(fieldValues[13]);

                        if (NATIONALID != "" && NATIONALID != null && NATIONALID != "undefined") {
                            $("#L_FIRST_NAME").val(FIRSTNAME_TH);
                            $("#L_LAST_NAME").val(LASTNAME_TH);
                            $("#L_CARD_NO").val(NATIONALID);

                            var str_birthday = BIRTHDATE;
                            var day = str_birthday.substring(0, 2);
                            var month = str_birthday.substring(3, 5);
                            var year = str_birthday.substring(6, 10);

                            if ($("#LanguagePage").val() != "1") //อังกฤษ
                            {
                                var newBirthYear = parseInt(year, 10) - 543;
                                year = newBirthYear.toString();
                            }

                            $('#dayBirthdate').val(day);
                            $('#dayBirthMonth').val(month);
                            $('#dayBirthdyear').val(year);
                            setBirthDate();

                            // Add by Atipon
                            //GetCustomerGender
                            $('#ddlGender').empty();
                            $.ajax({
                                type: "GET",
                                url: "/MasterData/GetCustomerGender",
                                dataType: "json",
                                success: function (data) {
                                    var strBuilder = "";
                                    if (SEX == "@lGENDER") {
                                        strBuilder = "<option value='' selected >" + "@lGENDER" + "</option>";
                                    }
                                    else {
                                        strBuilder = "<option value='' >" + "@lGENDER" + "</option>";
                                    }
                                    $.each(data, function (i, e) {
                                        var str = "";

                                        if (e.Value == SEX)
                                            str = '<option value="' + e.Value + '" selected >' + e.Text + '</option>';
                                        else
                                            str = '<option value="' + e.Value + '">' + e.Text + '</option>';

                                        strBuilder += str;
                                    });
                                    $('#ddlGender').append(strBuilder);
                                    $('#ddlGender').select2();
                                    $('#CustomerRegisterPanelModel_L_GENDER').val($('#ddlGender :selected').text());
                                }
                            });

                            //Set Disable
                            $('#TITLE_CODE').prop('disabled', true);
                            $('#L_FIRST_NAME').prop('readonly', true);
                            $('#L_LAST_NAME').prop('readonly', true);
                            $('#ID_CARD_NAME').prop('disabled', true);
                            $('#L_CARD_NO').prop('readonly', true);
                            //$('#ddlGender').prop('disabled', true);
                            $('#ddlDay').prop('disabled', true);
                            $('#ddlMonth').prop('disabled', true);
                            $('#ddlYear').prop('disabled', true);

                            //$('#btnPreviewR1').removeClass('disabled');
                        }



                        //show btn signature hide btn takephoto
                        $("label[for='fileTakePhoto']").hide();
                        $("label[for='filesignature']").show();
                        //show btn
                        $("label[for='fileR2TakePhoto']").show();
                        $("label[for='fileR3TakePhoto']").show();
                        $("label[for='fileR4TakePhoto']").show();
                        $("label[for='fileBillTakePhoto']").show();
                        $("label[for='fileG1TakePhoto']").show();
                        $("label[for='fileG2TakePhoto']").show();
                        $("label[for='fileG3TakePhoto']").show();
                        $("label[for='fileG4TakePhoto']").show();
                        $("label[for='fileG5TakePhoto']").show();
                        $("label[for='fileG6TakePhoto']").show();
                        $("label[for='fileB1TakePhoto']").show();
                        $("label[for='fileB2TakePhoto']").show();
                        $("label[for='fileB3TakePhoto']").show();
                        $("label[for='fileB4TakePhoto']").show();
                        $("label[for='fileB5TakePhoto']").show();
                        $("label[for='fileB6TakePhoto']").show();
                        $("label[for='fileB7TakePhoto']").show();
                        //hide btn
                        $("label[for='file']").hide();
                        $("label[for='fileR2']").hide();
                        $("label[for='fileR3']").hide();
                        $("label[for='fileR4']").hide();
                        $("label[for='fileBill']").hide();
                        $("label[for='fileG1']").hide();
                        $("label[for='fileG2']").hide();
                        $("label[for='fileG3']").hide();
                        $("label[for='fileG4']").hide();
                        $("label[for='fileG5']").hide();
                        $("label[for='fileG6']").hide();
                        $("label[for='fileB1']").hide();
                        $("label[for='fileB2']").hide();
                        $("label[for='fileB3']").hide();
                        $("label[for='fileB4']").hide();
                        $("label[for='fileB5']").hide();
                        $("label[for='fileB6']").hide();
                        $("label[for='fileB7']").hide();

                    }
                    else if (aisNative.sendIccCommand(0, 1, "") == "undefined" || aisNative.sendIccCommand(0, 1, "") == "" || aisNative.sendIccCommand(0, 1, "") == null) {
                        toastrErrorMessage(_L_ERROR_LOAD_CARD);
                    }
                    else if (aisNative.sendIccCommand(0, 2, "") == "undefined" || aisNative.sendIccCommand(0, 2, "") == "" || aisNative.sendIccCommand(0, 2, "") == null) {
                        toastrErrorMessage(_L_ERROR_LOAD_CARD);
                    }
                    else if (aisNative.sendIccCommand(0, 3, "") == "undefined" || aisNative.sendIccCommand(0, 3, "") == "" || aisNative.sendIccCommand(0, 3, "") == null) {
                        toastrErrorMessage(_L_ERROR_LOAD_CARD);
                    }
                    else if (aisNative.sendIccCommand(0, 4, "") == "undefined" || aisNative.sendIccCommand(0, 4, "") == "" || aisNative.sendIccCommand(0, 4, "") == null) {
                        toastrErrorMessage(_L_ERROR_LOAD_CARD);
                    }
                    else if (aisNative.sendIccCommand(0, 5, "") == "undefined" || aisNative.sendIccCommand(0, 5, "") == "" || aisNative.sendIccCommand(0, 5, "") == null) {
                        toastrErrorMessage(_L_ERROR_LOAD_CARD);
                    }
                }
            });

        }

    }

    function openModalIDCard() {

        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
            //R18.11 IdCard Reader on PC
            if ($("#hdIdCardReaderOnPcFlag").val() == "Y") {

                var CardIsActive = sessionStorage.getItem('Card_is_Active');
                if (CardIsActive == "Y") {
                    showLoadIdCardReaderPC();
                }
            }
        }
        else {
            $.ajax({
                type: "GET",
                url: "/Process/get_usedData_flag",
                dataType: "json",
                success: function (data) {
                    if (data.result == 'YY') {
                        $('#Modal-used-idcard').modal('show');
                    }
                    else {
                        //to do //data.result = 'N'
                        $('#Modal-used-idcard').modal('show');

                    }
                }
            });
        }


    }

    function takephoto_forModal() {
        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {

        } else {
            sessionStorage.setItem('Use_Data_Card_Tablet', "");
            $.ajax({
                type: "POST",
                url: "/Process/used_type_flag",
                data: { 'status': 'Takephoto' },
                dataType: "json",
                success: function (data) {
                    $('#Modal-used-idcard').modal('hide');//close modal
                    $("label[for='fileTakePhoto']").show();
                    $("label[for='filesignature']").hide();

                    $("#L_FIRST_NAME").val('');
                    $("#L_LAST_NAME").val('');

                    $('#dayBirthdate').val('');
                    $('#dayBirthMonth').val('');
                    $('#dayBirthdyear').val('');

                    if ($("#tL_CARD_NOs").val() != "") {
                        $("#L_CARD_NO").val($("#tL_CARD_NOs").val());
                    }

                    $('#ddlGender').empty();
                    $.ajax({
                        type: "GET",
                        url: "/MasterData/GetCustomerGender",
                        dataType: "json",
                        success: function (data) {
                            var strBuilder = "<option value='' selected >" + "@lGENDER" + "</option>";

                            $.each(data, function (i, e) {
                                var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                                strBuilder += str;
                            });
                            $('#ddlGender').append(strBuilder);
                            $('#ddlGender').select2();
                            $('#CustomerRegisterPanelModel_L_GENDER').val($('#ddlGender :selected').text());
                        }
                    });

                    $('#dayBirthdate').val("");
                    $('#dayBirthMonth').val("");
                    $('#dayBirthdyear').val("");
                    $('#ddlDay :selected').val("");
                    $('#ddlMonth :selected').val("");
                    $('#ddlYear :selected').val("");
                    setBirthDate();

                    if ('@Model.SummaryPanelModel.VAS_FLAG' != "6") {
                        if (($("#CoveragePanelModel_BUNDLINGMAINFLAG").val() == "Y" || $("#CoveragePanelModel_BUNDLINGSPECIALFLAG").val() == "Y") && $("#CoveragePanelModel_ChargeType").val() == "POSTPAID") {
                        }
                        else {
                            $("#L_CARD_NO").val("");
                        }
                    }

                    $("#tL_CARD_NOs").val("");
                    $("#L_ID_CARD_LASER").val("");
                }
            });
        }
    }

    function isEmpty(str) {
        return (!str || 0 === str.length);
    }

    function GetdataCard() {

        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
            //to do mode web

        }
        else {
            $.ajax({
                type: "GET",
                url: "/Process/get_used_type_flag",
                dataType: "json",
                async: false,
                success: function (data) {

                    if (data.result == 'Loaddata') {
                        _L_ERROR_LOAD_CARD = "@L_ERROR_LOAD_CARD";
                        var result = aisNative.sendIccCommand(0, 2, "");
                        if (result == "Presented") {
                            var fieldValues = aisNative.sendIccCommand(0, 4, "").split("#");

                            var NATIONALID = fieldValues[2];
                            var FIRSTNAME_TH = fieldValues[4];
                            var LASTNAME_TH = fieldValues[6];
                            var day = fieldValues[11].substring(0, 2);
                            var month = fieldValues[11].substring(3, 5);
                            var year = fieldValues[11].substring(6, 10);
                            var BIRTHDATE = day + "-" + month + "-" + year;

                            if (null != FIRSTNAME_TH || FIRSTNAME_TH != '' || null != LASTNAME_TH || LASTNAME_TH != '' ||
                                null != NATIONALID || NATIONALID != '' || null != BIRTHDATE || BIRTHDATE != '') {
                                $("#L_FIRST_NAME").val(FIRSTNAME_TH);
                                $("#L_LAST_NAME").val(LASTNAME_TH);
                                $("#L_CARD_NO").val(NATIONALID);

                                var str_birthday = BIRTHDATE;
                                var day = str_birthday.substring(0, 2);
                                var month = str_birthday.substring(3, 5);
                                var year = str_birthday.substring(6, 10);

                                $('#dayBirthdate').val(day);
                                $('#dayBirthMonth').val(month);
                                $('#dayBirthdyear').val(year);
                            }

                        }
                    }
                }, error: function () {
                    toastrErrorMessage(_L_ERROR_LOAD_CARD);
                }
            });
        }
    }

    function chkBeforeSignature() {
        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {

        }
        else {
            var progressRead = aisNative.sendIccCommand(0, 3, "");
            var progressInt = parseInt(progressRead, 10);
            var chkflagProgress = false;
            if (progressInt >= 100)
            { chkflagProgress = true; }

            if ($('#L_FIRST_NAME').val() != null && $('#L_FIRST_NAME').val() != "" &&
                $('#L_LAST_NAME').val() != null && $('#L_LAST_NAME').val() != "" &&
                $('#L_CARD_NO').val() != null && $('#L_CARD_NO').val() != "" &&
                $('#ddlDay').val() != null && $('#ddlDay').val() != "" &&
                $('#ddlMonth').val() != null && $('#ddlMonth').val() != "" &&
                $('#ddlYear').val() != null && $('#ddlYear').val() != "" &&
                chkflagProgress
                ) {

                sessionStorage.setItem('Use_Data_Card_Tablet', "Y");
                CreateSignature();
            }
            else {
                var _L_ERROR_SMART_CARD = "@L_ERROR_SMART_CARD";
                toastrErrorMessage(_L_ERROR_SMART_CARD);
            }
        }
    }

    function CreateSignature() {
        //InsertdataCard();
        var iframe = document.getElementById('iframeCard');
        iframe.src = iframe.src;

        $("#btnSaveSignature").show();

        $('.modal-dialog').addClass('modal-md');
        $('#modal_Signature').modal({ backdrop: 'static' });

        $('#modal_Signature').find('.modal-title').text('Create Signature');
        $('#modal_Signature').modal('show');

        $("#btnPreviewR1").addClass("disabled");

        $("#imgPreviewOrigin").show();
        $("#imgPreviewOrigin").attr('src', "data:image/jpeg;base64," + baste64strFromSignature);

        $("#btnOrigin").hide();
        $("#btnOriginTake").hide();

        $("#verifyIdentity").hide();
        $("#btnVerifyFace").hide();

        signatureShowFlag = true;
        canMake1 = true;
        fromTake1 = false;
        if (canMake1 && canMake2) {
            $("#btnValidateFaceDisabled").hide();
            $("#btnValidateFace").show();
        }
    }

    function chk_BrowserType() {
        if ((navigator.userAgent.indexOf("Opera") || navigator.userAgent.indexOf('OPR')) != -1) {
            $("#Browser_type").val('Opera');
        }
        else if (navigator.userAgent.indexOf("Chrome") != -1) {
            $("#Browser_type").val('Chrome');
        }
        else if (navigator.userAgent.indexOf("Safari") != -1) {
            $("#Browser_type").val('Safari');
        }
        else if (navigator.userAgent.indexOf("Firefox") != -1) {
            $("#Browser_type").val('Firefox');
        }
        else if ((navigator.userAgent.indexOf("MSIE") != -1) || (!!document.documentMode == true)) //IF IE > 10
        {
            $("#Browser_type").val('IE');
        }
        else {
            $("#Browser_type").val('unknown');
        }
    }

    function chk_RegisterDevice() {
        if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
            $("#Register_device").val("MOBILE WEB");
        }
        else {
            $("#Register_device").val("WEB BROWSER");
        }

        if (typeof aisNative != "undefined" && typeof aisNative != "" && typeof aisNative != null) {
            $("#Register_device").val("MOBILE APP");
            $("#Browser_type").val('');
        }
    }

    function setTimeSlotConfigSelectDate() {
        var dateTime = new Date();

        var i = $("input[name=SelectPackage]:checked").val();

        $.ajax({
            type: "GET",
            url: "/CustomerRegister/GetTimeSlotConfigSelectDate?timeStamp=" + dateTime.getTime(),
            data: {
                'technology': $("#ACCESS_MODE" + i).val()
                , 'subtype': $("#CustomerRegisterPanelModel_outSubType").val()
                , 'flowflag': $("#CoveragePanelModel_L_FLOWFLAG").val()
                , 'splitterflagFirst': $("#L_SplitterFlagFirstTime").val()
                , 'splitterflag': $("#L_SplitterFlag").val()
                , 'aisAirNumber': sessionStorage.getItem("AisAirNumber")
                , 'subAccessMode': $('#CustomerRegisterPanelModel_SUB_ACCESS_MODE').val()
                , 'timeSlotRegisterFlag': "Y"
            },
            dataType: "json",
            async: false,
            success: function (data) {

                var minDate = "";
                var maxDate = "";
                var currentDate = "";
                var currentDateTH = "";
                var tempSubtype = $("#CustomerRegisterPanelModel_outSubType").val();

                if (data != "" && data != null && data != undefined) {

                    //TODO: Splitter Management Change
                    var selectPackageResult = $("input[name=SelectPackage]:checked").val();
                    var accessModeResult = $("#ACCESS_MODE" + selectPackageResult).val();
                    if (($("#L_SplitterFlagFirstTime").val() == "3" && accessModeResult != "FTTH") || ($("#L_SplitterFlagFirstTime").val() == "2" && accessModeResult != "FTTH")) {
                        $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val("");
                        $("#divInstallDate").hide();
                        $("#divResponsiveTimeSLot").hide();
                        return;
                    }

                    dayTimeslot = data.LovValue2;

                    if (tempSubtype != "" && tempSubtype != null) {
                        if (data.LovValue5 == "PULL" || data.LovValue5 == "PUSH")
                            $("#CustomerRegisterPanelModel_ASSIGN_RULE").val(data.LovValue5);
                        else
                            // R19.8 Change Default ASSIGN RULE from PULL to PUSH
                            $("#CustomerRegisterPanelModel_ASSIGN_RULE").val("PUSH");
                    }
                    else
                    {
                        if (data.LovValue5 == "PULL" || data.LovValue5 == "PUSH")
                            $("#CustomerRegisterPanelModel_ASSIGN_RULE").val(data.LovValue5);
                        else
                            // R19.8 Change Default ASSIGN RULE from PULL to PUSH
                            $("#CustomerRegisterPanelModel_ASSIGN_RULE").val("PUSH");
                    }

                    var minDayPlus = parseInt(data.LovValue1, 10) * 24;
                    var maxDayPlus = parseInt(data.DefaultValue, 10) * 24;

                    //var defaultDate = new Date(new Date().getTime() + minDayPlus * 60 * 60 * 1000);
                    var defaultDate = new Date(parseInt(@DateTime.Now.Year), parseInt(@DateTime.Now.Month) - 1, parseInt(@DateTime.Now.Day) + parseInt(data.LovValue1, 10));
                    var month = defaultDate.getMonth() + 1;
                    var day = defaultDate.getDate();

                    //18.6
                    sessionStorage.setItem('DefaultDateCompare', defaultDate.getDate().toString() + '/' + (defaultDate.getMonth() + 1).toString() + '/' + defaultDate.getFullYear().toString());

                    var minDateTH = (defaultDate.getFullYear() + 543) + '/' +
                        (month < 10 ? '0' : '') + month + '/' +
                        (day < 10 ? '0' : '') + day;

                    var minDateEN = defaultDate.getFullYear() + '/' +
                        (month < 10 ? '0' : '') + month + '/' +
                        (day < 10 ? '0' : '') + day;

                    currentDateTH = (day < 10 ? '0' : '') + day + '/' +
                        (month < 10 ? '0' : '') + month + '/' +
                        (defaultDate.getFullYear() + 543);

                    var currentDateEN = (day < 10 ? '0' : '') + day + '/' +
                        (month < 10 ? '0' : '') + month + '/' +
                        defaultDate.getFullYear();

                    //var defaultDateMax = new Date(new Date().getTime() + maxDayPlus * 60 * 60 * 1000);
                    var defaultDateMax = new Date(parseInt(@DateTime.Now.Year), parseInt(@DateTime.Now.Month) - 1, parseInt(@DateTime.Now.Day) + parseInt(data.DefaultValue, 10));
                    var monthMax = defaultDateMax.getMonth() + 1;
                    var dayMax = defaultDateMax.getDate();

                    var maxDateTH = (defaultDateMax.getFullYear() + 543) + '/' +
                       (monthMax < 10 ? '0' : '') + monthMax + '/' +
                       (dayMax < 10 ? '0' : '') + dayMax;

                    var maxDateEN = defaultDateMax.getFullYear() + '/' +
                        (monthMax < 10 ? '0' : '') + monthMax + '/' +
                        (dayMax < 10 ? '0' : '') + dayMax;


                    minDate = minDateEN;
                    maxDate = maxDateEN;
                    currentDate = currentDateEN;

                    if (data.Type == "TIME_SLOT_BY_SUBTYPE_HR")
                    {
                        $("#hdTimeSlotRegisterHR").val(data.LovValue3);
                        $("#hdTimeSlotRegisterFlowActionNo").val(data.LovValue4);

                        if ($("#LanguagePage").val() == "1") {
                            $("#hdCurrentDateTime").val(currentDateTH);
                        }
                        else {
                            $("#hdCurrentDateTime").val(currentDateEN);
                        }
                    }
                }
                else {
                    $("#CustomerRegisterPanelModel_ASSIGN_RULE").val("PUSH");
                    //var defaultDate = new Date();
                    var defaultDate = new Date(parseInt(@DateTime.Now.Year), parseInt(@DateTime.Now.Month) - 1, parseInt(@DateTime.Now.Day));
                    var month = defaultDate.getMonth() + 1;
                    var day = defaultDate.getDate();

                    var minDateTH = (defaultDate.getFullYear() + 543) + '/' +
                        (month < 10 ? '0' : '') + month + '/' +
                        (day < 10 ? '0' : '') + day;

                    var minDateEN = defaultDate.getFullYear() + '/' +
                        (month < 10 ? '0' : '') + month + '/' +
                        (day < 10 ? '0' : '') + day;

                    currentDateTH = (day < 10 ? '0' : '') + day + '/' +
                      (month < 10 ? '0' : '') + month + '/' +
                      (defaultDate.getFullYear() + 543);

                    var currentDateEN = (day < 10 ? '0' : '') + day + '/' +
                        (month < 10 ? '0' : '') + month + '/' +
                        defaultDate.getFullYear();

                    //var defaultDateMax = new Date(new Date().getTime() + 1200 * 60 * 60 * 1000);
                    var defaultDateMax = new Date(parseInt(@DateTime.Now.Year), parseInt(@DateTime.Now.Month) - 1, parseInt(@DateTime.Now.Day) + 50);
                    var monthMax = defaultDateMax.getMonth() + 1;
                    var dayMax = defaultDateMax.getDate();

                    var maxDateTH = (defaultDateMax.getFullYear() + 543) + '/' +
                       (monthMax < 10 ? '0' : '') + monthMax + '/' +
                       (dayMax < 10 ? '0' : '') + dayMax;

                    var maxDateEN = defaultDateMax.getFullYear() + '/' +
                        (monthMax < 10 ? '0' : '') + monthMax + '/' +
                        (dayMax < 10 ? '0' : '') + dayMax;


                    minDate = minDateEN;
                    maxDate = maxDateEN;
                    currentDate = currentDateEN;
                }

                $('#dtpInstallDateTH').datetimepicker({
                    onGenerate: function (ct) {
                        jQuery(this).find('.xdsoft_disabled')
                          .toggleClass('xdsoft_date');
                    },
                    onSelectDate: function (ct, $i) {
                        var ctTh = convertToThaiDate($('#dtpInstallDateTH').val());
                        $("#dtpInstallDateTH_text").val(ctTh);
                        getAppointment(ctTh, true, "divTimeSlot", "N");
                    },
                    minDate: minDate,
                    maxDate: maxDate,
                    value: currentDate
                });

                $("#dtpInstallDateTH_text").val(convertToThaiDate($('#dtpInstallDateTH').val()));
                $("#dtpInstallDateTH_text").click(function () {
                    $("#dtpInstallDateTH").trigger('open.xdsoft');
                });

                $('#dtpInstallDateEN').datetimepicker({
                    onGenerate: function (ct) {
                        jQuery(this).find('.xdsoft_disabled')
                          .toggleClass('xdsoft_date');
                    },
                    onSelectDate: function (ct, $i) {
                        var ctEN = $('#dtpInstallDateEN').val();
                        getAppointment(ctEN, false, "divTimeSlot", "N");
                    },
                    minDate: minDate,
                    maxDate: maxDate,
                    value: currentDate
                });

                if ($("#LanguagePage").val() == "1") {
                    getAppointment(currentDateTH, true, "divTimeSlot", "Y");
                }
                else {
                    getAppointment(currentDateEN, false, "divTimeSlot", "Y");
                }
            },
        });

    }

    function convertToThaiDate(englishDate) {
        var dd = englishDate.substring('0', '2');
        var MM = englishDate.substring('3', '5');
        var yyyy = englishDate.substring('6', '10');
        var year = parseInt(yyyy, 10) + 543;
        return dd + "/" + MM + "/" + year;
    }

    function pushRequireFieldAddress() {
        //R23.04
        // if($('input[name="CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_"]:checked').val() == '1' )
        //  {
        //     validateModel003SendDoc.push({ id: "BillingAddrOptionValue" });
        //  }
        if ($('input[name="CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_"]:checked').val() == '2') {
            validateModel003SendDoc.push({ id: "BillingAddrOptionValue" });
            validateModel003SendDoc.push({ id: "AddressPanelModelSendDoc_L_HOME_NUMBER_2" });
            validateModel003SendDoc.push({ id: "TumbonSendDoc" });
            validateModel003SendDoc.push({ id: "AmphurSendDoc" });
            validateModel003SendDoc.push({ id: "ProvinceSendDoc" });
            validateModel003SendDoc.push({ id: "ZipCodeSendDoc" });
        }
        if ($('input[name="CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_"]:checked').val() == undefined) {
            validateModel003SendDoc.push({ id: "AddressPanelModelSendDoc_L_HOME_NUMBER_2" });
            validateModel003SendDoc.push({ id: "TumbonSendDoc" });
            validateModel003SendDoc.push({ id: "AmphurSendDoc" });
            validateModel003SendDoc.push({ id: "ProvinceSendDoc" });
            validateModel003SendDoc.push({ id: "ZipCodeSendDoc" });
        }

        validateModel003Vat.push({ id: "AddressPanelModelVat_L_HOME_NUMBER_2" });
        validateModel003Vat.push({ id: "TumbonVat" });
        validateModel003Vat.push({ id: "AmphurVat" });
        validateModel003Vat.push({ id: "ProvinceVat" });
        validateModel003Vat.push({ id: "ZipCodeVat" });

    }

    function pushRequireFieldAddressIdCard() {
        validateModel003SendDocIDCard.push({ id: "AddressPanelModelSendDocIDCard_L_HOME_NUMBER_2" });
        validateModel003SendDocIDCard.push({ id: "TumbonSendDocIDCard" });
        validateModel003SendDocIDCard.push({ id: "AmphurSendDocIDCard" });
        validateModel003SendDocIDCard.push({ id: "ProvinceSendDocIDCard" });
        validateModel003SendDocIDCard.push({ id: "ZipCodeSendDocIDCard" });

    }

    function pushRequireFieldR() {
        validateModel003R.push({ id: "L_FIRST_NAME" });
        validateModel003R.push({ id: "L_LAST_NAME" });
        validateModel003R.push({ id: "ID_CARD_NAME" });
        validateModel003R.push({ id: "L_CARD_NO", condition: "IDCard" });
        validateModel003R.push({ id: "L_MOBILE", condition: "MobileNumber" });

        //R18.11 IdCard Reader on PC
        if (!$("#divIdCardVerify").is(":hidden")) {
            validateModel003R.push({ id: "L_ID_CARD_LASER" });
        }

        var result = $("input[name=SelectPackage]:checked").val();

        if ($("#PRODUCT_SUBTYPE_" + result).val() != "SWiFi") {
            validateModel003R.push({ id: "textImage" });
            // GREETING
            var myCheckATTACHED = [];

            @foreach (var CheckATTACHED in ATTACHED)
            {
                @:myCheckATTACHED.push("@CheckATTACHED");
                                                                         }

            var tmpPackageGroupMain = $("#PACKAGE_GROUP" + $("input[name=SelectPackage]:checked").val()).val().toUpperCase();
            var tmpATTACHED = false;

            $.each(myCheckATTACHED, function (index, item) {
                if (tmpPackageGroupMain.indexOf(item) > -1) {
                    tmpATTACHED = true;
                }
            });
            if (!tmpATTACHED) {
                // Discount objDiscountArry tmpPackageDataV2.packageDiscountList
                if (objDiscountArry != undefined && objDiscountArry.length > 0) {
                    var SelectPackageIndex = $("input[name=SelectPackage]:checked").val();
                    var mappingCode = $("#MAPPING_CODE" + SelectPackageIndex).val();
                    $.each(objDiscountArry, function (indexData, PackageData) {
                        if (tmpPackageDataV2 != undefined && tmpPackageDataV2.packageDiscountList.length > 0) {
                            var tmpPackage = tmpPackageDataV2.packageDiscountList.filter(function (elem) {
                                return elem.SFF_PROMOTION_CODE.indexOf(PackageData.SffPromotionCode) !== -1
                                    && elem.MAPPING_CODE.indexOf(mappingCode) !== -1;
                            });
                            if (tmpPackage != undefined && tmpPackage.length > 0) {
                                $.each(tmpPackage, function (indexTmpData, TmpPackageData) {
                                    var tmpPackageGroupDiscount = TmpPackageData.PACKAGE_GROUP.toUpperCase();
                                    $.each(myCheckATTACHED, function (index, item) {
                                        if (tmpPackageGroupDiscount.indexOf(item) > -1) {
                                            tmpATTACHED = true;
                                        }
                                    });
                                });
                            }
                        }
                    });
                }
            }

            if (tmpATTACHED) {
                validateModel003R.push({ id: "textImageBill" })
                if (isp != "") { $('#ddlBillBrand').val(isp); }
                validateModel003R.push({ id: "ddlBillBrand" });
            }
        }

        validateModel003R.push({ id: "ddlGender" });

        if ($('input[name=L_HAVE_FIXED_LINE]:checked').val() == "Y" || validateHomePhone) {
            validateModel003R.push({ id: "txtHomePhone", condition: "HomePhone" });
        }
        else {
            $("#txtHomePhone").removeClass("textFieldFalse").removeClass("form-control errorinput ").addClass("form-control");
            if (unvalidateHomePhone)
                validateModel003R.pop({ id: "txtHomePhone" , condition: "HomePhone" });
        }

        //if ($("#L_EMAIL").val() != "") {
        //    validateModel003R.push({ id: "L_EMAIL", condition: "Email" });
        //}
        //else {
        //    $("#L_EMAIL").removeClass("textFieldFalse").removeClass("form-control errorinput ").addClass("form-control");
        //}

        validateModel003R.push({ id: "ddlDay" });
        validateModel003R.push({ id: "ddlMonth" });
        validateModel003R.push({ id: "ddlYear" });

        //R19.1
        if ($('#TopUp').val() == "5" && "@flagspecialaccountresult" == "Y") {
            validateModel003R.push({ id: "L_NAME_SPECIAL_ACCOUNT" });
            validateModel003R.push({ id: "L_NO_SPECIAL_ACCOUNT" });
            validateModel003R.push({ id: "dtpSpecialExpireDateTH_text" });
            validateModel003R.push({ id: "ddlGroupMailSpecialAccount" });
        }

    }

    function pushRequireFieldGB() {
        validateModel003GB.push({ id: "L_GOVERNMENT_NAME" });
        validateModel003GB.push({ id: "ID_CARD_NAME" });
        validateModel003GB.push({ id: "L_CARD_NO", condition: "IDCard" });
        validateModel003GB.push({ id: "L_CONTACT_PERSON" });
        validateModel003GB.push({ id: "L_MOBILE", condition: "MobileNumber" });//Update add condition 16.12

        //R19.1
        if ($('#TopUp').val() == "5" && "@flagspecialaccountresult" == "Y") {
            validateModel003R.push({ id: "L_NAME_SPECIAL_ACCOUNT" });
            validateModel003R.push({ id: "L_NO_SPECIAL_ACCOUNT" });
            validateModel003R.push({ id: "dtpSpecialExpireDateTH_text" });
            validateModel003R.push({ id: "ddlGroupMailSpecialAccount" });
        }

        if ($('input[name=L_HAVE_FIXED_LINE]:checked').val() == "Y" || validateHomePhone) {
            validateModel003GB.push({ id: "txtHomePhone", condition: "HomePhone" });
        }
        else {
            $("#txtHomePhone").removeClass("form-control errorinput ").addClass("form-control");
            if (unvalidateHomePhone)
                validateModel003R.pop({ id: "txtHomePhone" , condition: "HomePhone" });
        }

        if ($("#L_EMAIL").val() != "") {
            validateModel003GB.push({ id: "L_EMAIL", condition: "Email" });
        }
        else {
            $("#L_EMAIL").removeClass("form-control errorinput ").addClass("form-control");
        }
        var result = $("input[name=SelectPackage]:checked").val();
        if ($("#PRODUCT_SUBTYPE_" + result).val() != "SWiFi") {
            if ($('input[name="typeselect"]:checked').val() == 'G') {
                validateModel003GB.push({ id: "textImageG1" });
                validateModel003GB.push({ id: "textImageG2" });
            }
            else if ($('input[name="typeselect"]:checked').val() == 'B') {
                validateModel003GB.push({ id: "textImageB1" });
                validateModel003GB.push({ id: "textImageB2" });
                validateModel003GB.push({ id: "textImageB3" });
            }
        }
    }

    function pushRequireFieldVerify() {
        validateModel003R.push({ id: "L_FIRST_NAME" });
        validateModel003R.push({ id: "L_LAST_NAME" });
        validateModel003R.push({ id: "ID_CARD_NAME" });
        validateModel003R.push({ id: "L_CARD_NO", condition: "IDCard" });
        validateModel003R.push({ id: "L_ID_CARD_LASER" });
        validateModel003R.push({ id: "ddlGender" });
        validateModel003R.push({ id: "ddlDay" });
        validateModel003R.push({ id: "ddlMonth" });
        validateModel003R.push({ id: "ddlYear" });
    }

    function popRequireFieldR() {
        validateModel003R.pop({ id: "L_FIRST_NAME" });
        validateModel003R.pop({ id: "L_LAST_NAME" });
        validateModel003R.pop({ id: "ID_CARD_NAME" });
        validateModel003R.pop({ id: "L_CARD_NO" });
        validateModel003R.pop({ id: "L_MOBILE" });
        validateModel003R.pop({ id: "textImage" });
        validateModel003R.pop({ id: "textImageBill" });
        validateModel003R.pop({ id: "L_EMAIL" });
        validateModel003R.pop({ id: "ddlGender" });

        validateModel003R.pop({ id: "ddlDay" });
        validateModel003R.pop({ id: "ddlMonth" });
        validateModel003R.pop({ id: "ddlYear" });


        validateModel003R.pop({ id: "ddlBillBrand" });

        if ($('input[name=L_HAVE_FIXED_LINE]:checked').val() == "Y" || unvalidateHomePhone) {
            validateModel003R.pop({ id: "txtHomePhone" , condition: "HomePhone" });
        }
    }

    function popRequireFieldGB() {
        validateModel003GB.pop({ id: "L_GOVERNMENT_NAME" });
        validateModel003GB.pop({ id: "ID_CARD_NAME" });
        validateModel003GB.pop({ id: "L_CARD_NO" });
        validateModel003GB.pop({ id: "L_CONTACT_PERSON" });
        validateModel003GB.pop({ id: "L_EMAIL" });
        validateModel003GB.pop({ id: "L_MOBILE" });
        validateModel003GB.pop({ id: "textImageG1" });
        validateModel003GB.pop({ id: "textImageG2" });
        validateModel003GB.pop({ id: "textImageB1" });
        validateModel003GB.pop({ id: "textImageB2" });
        validateModel003GB.pop({ id: "textImageB3" });

        if ($('input[name=L_HAVE_FIXED_LINE]:checked').val() == "Y" || unvalidateHomePhone) {
            validateModel003GB.pop({ id: "txtHomePhone" , condition: "HomePhone" });
        }
    }

    function pushRequireFieldInstallDate() {
        validateInstallDate.push({ id: "ddlDayInstall" });
        validateInstallDate.push({ id: "ddlMonthInstall" });
        validateInstallDate.push({ id: "ddlYearInstall" });
    }

    function popRequireFieldInstallDate() {
        validateInstallDate.pop({ id: "ddlDayInstall" });
        validateInstallDate.pop({ id: "ddlMonthInstall" });
        validateInstallDate.pop({ id: "ddlYearInstall" });
    }

    function onClickSameAsAddrSetUp(value) {
        if ($('#chkSameAsAddrSetUp').is(':checked') && value != '1' && value != '2') {
            $('#chkSameAsIdCardAddr').prop("checked", false);
            copyAddressSetUpTo("SendDoc");

            //R23.04    
            validateModel003SendDoc = new Array();
            pushRequireFieldAddress();
        }
        else {
            SetDefaultAddressPage("SendDoc");
        }
        
        //R23.04
        $('#CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL').val(value);
        $('input:radio[name=CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_]').val(value);
        onChangeOption();

        //R23.08
        if (value == '1' && document.getElementById("select2-BillingAddrOptionValue-container")) {
            document.getElementById("BillingAddrOptionValue").options.selectedIndex = 0;
            $("#CustomerRegisterPanelModel_CONDITION_NEW_DOC").val('');
            document.getElementById("select2-BillingAddrOptionValue-container").textContent = document.getElementById("BillingAddrOptionValue").options[0].textContent;
        }

        //R23.08 Billing eBill
        if ($('#TopUp').val() == "5") {
            if ($('input[name="CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_"]:checked').val() == '1') {
                $("#chkEbillType").hide();
            }
            else {
                $("#chkEbillType").show();
            }
        }
        else {
            $("#chkEbillType").hide();
        }
    }

    function onChangeOption(option) {

        if ($('input[name="CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_"]:checked').val() == '2') {
            //R23.08 Bill enable dropdownlist
            $("#BillingAddrOptionValue").attr("disabled", false);

            //show input more
            $('#bill_address_new_hide').css("display", "inline-block");
            $("#CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL").val("2");
            //R23.08 Issue when back page
            if ($("#CustomerRegisterPanelModel_CONDITION_NEW_DOC").val() !== '' && $("#BillingAddrOptionValue :selected").val() === '') {
                $("#BillingAddrOptionValue").val($("#CustomerRegisterPanelModel_CONDITION_NEW_DOC").val());
            }
            else {
                $("#CustomerRegisterPanelModel_CONDITION_NEW_DOC").val($("#BillingAddrOptionValue :selected").val());
            }

            //R23.04
            validateModel003SendDoc = new Array();

            pushRequireFieldAddress();
            $('#select_Bill_address').prop('disabled', true);
            //clear value

            $("#CustomerRegisterPanelModel_BILL_MOBILE_NO").val('');
            $("#CustomerRegisterPanelModel_BILL_CYCLE_INFO").val('');
            $("#CustomerRegisterPanelModel_BILL_CHANNEL_INFO").val('');
            $('#TumbonSendDoc').prop('disabled', false);
            $('#AmphurSendDoc').prop('disabled', false);
            $('#ProvinceSendDoc').prop('disabled', false);
            $('#ZipCodeSendDoc').prop('disabled', false);

            //R23.08 Billing eBill
            if ($('#TopUp').val() == "5") {
                $("#chkEbillType").show();
            }
            else {
                $("#chkEbillType").hide();
            }
        }
        else if ($('input[name="CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_"]:checked').val() == '1') {
            //R23.08 Bill disable dropdownlist
            $("#BillingAddrOptionValue").attr("disabled", true);

            //hide input more
            $('#bill_address_new_hide').css("display", "none");
            $("#CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL").val("1");

            //R23.04
            validateModel003SendDoc = new Array();
            pushRequireFieldAddress();
            $("#CustomerRegisterPanelModel_BILL_MOBILE_NO").val($("#MobileNo").val());
            $("#CustomerRegisterPanelModel_BILL_CYCLE_INFO").val($("#bill_address_merge_cycle").text());
            $("#CustomerRegisterPanelModel_BILL_CHANNEL_INFO").val($("#bill_address_get_channel_merge").text());
            SetDefaultAddressPage("SendDoc");
            $('#select_Bill_address').prop('disabled', false);
            //clear value
            $("#CustomerRegisterPanelModel_CONDITION_NEW_DOC").val('');
            $('#TumbonSendDoc').prop('disabled', true);
            $('#AmphurSendDoc').prop('disabled', true);
            $('#ProvinceSendDoc').prop('disabled', true);
            $('#ZipCodeSendDoc').prop('disabled', true);

            //R23.08 Billing eBill
            $("#chkEbillType").hide();
        }
        else {
            //R23.08 Bill enable dropdownlist
            $("#BillingAddrOptionValue").attr("disabled", false);
            //show input more
            $('#bill_address_new_hide').css("display", "inline-block");
            $("#CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL").val("");
            $("#CustomerRegisterPanelModel_CONDITION_NEW_DOC").val('');
            $("#CustomerRegisterPanelModel_BILL_MOBILE_NO").val('');
            $("#CustomerRegisterPanelModel_BILL_CYCLE_INFO").val('');
            $("#CustomerRegisterPanelModel_BILL_CHANNEL_INFO").val('');
            $('#TumbonSendDoc').prop('disabled', false);
            $('#AmphurSendDoc').prop('disabled', false);
            $('#ProvinceSendDoc').prop('disabled', false);
            $('#ZipCodeSendDoc').prop('disabled', false);
        }

    }

    function onClickSameAsIdCardAddr() {
        if ($('#chkSameAsIdCardAddr').is(':checked')) {
            $('#chkSameAsAddrSetUp').prop("checked", false);
            copyAddressSetUpIdCardTo("SendDoc");

            //R23.04    
            validateModel003SendDoc = new Array();
            pushRequireFieldAddress();
        }
        else {
            SetDefaultAddressPage("SendDoc");
        }

        //R23.08 Billing eBill
        if ($('#TopUp').val() == "5") {
            if ($('input[name="CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_"]:checked').val() == '1') {
                $("#chkEbillType").hide();
            }
            else {
                $("#chkEbillType").show();
            }
        }
        else {
            $("#chkEbillType").hide();
        }
    }

    function onClickSameAsAddrSetUpIdCard() {

        if ($('#chkSameAsAddrSetUpIdCard').is(':checked')) {
            copyAddressSetUpTo("SendDocIDCard");
        }
        else {
            if ($('#hdnCard_province').val() != "" && $('#hdnCard_province').val() != null) { //ถ้ามีค่าใน smart card ให้ใช้ smart card
                copyAddressIdCardSmartCardTo("SendDocIDCard");
            } else {
                SetDefaultAddressPage("SendDocIDCard");
            }
        }
    }

    function onClickSameAsAddrSendDoc() {
        if ($('#chkSameAsAddrSendDoc').is(':checked')) {
            copyAddressSetUpTo("Vat");
        }
        else {
            SetDefaultAddressPage("Vat");
        }
    }

    function onChangeContactTime() {
        $('#CustomerRegisterPanelModel_L_SPECIFIC_TIME').val($('#ContactTime :selected').text());
    }

    function onChangeddlGender() {
        $('#CustomerRegisterPanelModel_L_GENDER').val($('#ddlGender :selected').text());
    }

    function onChangeDeverloper() {
        $('#CustomerRegisterPanelModel_DEVELOPER').val($('#ddlDeverloper :selected').val());
    }

    function onChangeID_CARD_NAME(idCardName) {
        $('#CustomerRegisterPanelModel_FlagDopaSubmit').val("N");
        $('#CustomerRegisterPanelModel_FlagFaceRecognitionSubmit').val("N");
        $('#CustomerRegisterPanelModel_L_CARD_TYPE').val($('#ID_CARD_NAME :selected').text());

        $.ajax({
            type: "GET",
            url: "/CustomerRegister/GetCustomerSubCat",
            data: { 'idCardName': idCardName.value },
            dataType: "json",
            async: false,
            success: function (data) {
                $('#cust_subcat').val(data.LovValue4);
                $('#CustomerRegisterPanelModel_SubCateType').val(data.LovValue5);
            },
        });
        set_idcardno_validation();

        //R18.11 IdCard Reader on PC
        $("#divIdCardVerify").hide();
        $('#idCardVerify').hide();
        $('#showMessageVerify').hide();
        $('#FLAG_CHECK_VERIFY').val("");
        $("#faceRecog").hide()
        $("#faceRecogCheckedFlag").val("N");

        $("#showResultRecog").hide();
        $("#btnRemove").show();
        $("#btnRemoveDisabled").hide();

        // check pc/mobile
        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
            $("#btnbrowse").show();
            $("#btnbrowseDisabled").hide();
        }
        else {
            if (signatureShowFlag) {
                $("#filesignature").show();
                $("#filesignatureDisabled").hide();
            }
        }

        if ($("#CustomerRegisterPanelModel_FlagTakePhoto").val() == "Y" && navigator.userAgent.indexOf("SamsungBrowser") == -1 && !iOSSafari && !iOS && !signatureShowFlag) {

            $("#fileTakePhoto").show();
            $("#fileTakePhotoDisabled").hide();
        }

        $("#btnOrigin").show();
        $("#btnFromCamera").show();
        $("#btnOriginTake").hide();
        $("#btnFromCameraTake").hide();
        $("#btnValidateFace").hide();
        $("#btnValidateFaceDisabled").show();
        $("#verifyIdentity").hide();
        $("#btnVerifyFace").hide();
        $("#imgPreviewOrigin").hide();
        $("#imgPreviewFromCamera").hide();

        // กรณีที่เลือกเป็นบุคคลธรรมดา
        if ($('input[name="typeselect"]:checked').val() == 'R') {
            $('#file').val("");
            $('#textImage').val("");
            $("#btnPreviewR1").addClass("disabled");
        }

        canMake1 = false;
        canMake2 = false;
        if (videoOpen != "") {
            $("#" + videoOpen).hide();
            $("#" + btnVideoID + "Take").hide();
            $("#" + btnVideoID).show();

            window[videoOpen].pause();
            localstream.getTracks()[0].stop();
            videoOpen = "";
        }

        if ($('#ID_CARD_NAME :selected').val() == "TAX_ID") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_Length_ID_Card_Number_TAX_ID");
        }
        else if ($('#ID_CARD_NAME :selected').val() == "MONK_CERT") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_LengthIDCardNumberMONK_CERT");
        }
        else if ($('#ID_CARD_NAME :selected').val() == "GOV_LET") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_Length_ID_Card_Number_GOV_LET");
        }
        else if ($('#ID_CARD_NAME :selected').val() == "PASSPORT") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_Length_ID_Card_Number_PASSPORT");
        }
        else if ($('#ID_CARD_NAME :selected').val() == "EMB_LET") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_Length_ID_Card_Number_EMB_LET");
        }
        else if ($('#ID_CARD_NAME :selected').val() == "IMM_CARD") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_LengthIDCardNumberIMM_CARD");
        }
        else if ($('#ID_CARD_NAME :selected').val() == "STA_LET") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_Length_ID_Card_Number_STA_LET");
        }
        else if ($('#ID_CARD_NAME :selected').val() == "HILL_CARD") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_LengthIDCardNumberHILL_CARD");
        }
        else if ($('#ID_CARD_NAME :selected').val() == "CERT_FOUND") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_Length_ID_Card_Number_CERT_FOUND");
        }
        else if ($('#ID_CARD_NAME :selected').val() == "ID_CARD") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_LengthIDCardNumberID_CARD");
            //R18.11 IdCard Reader on PC
            if ($('#CustomerRegisterPanelModel_FlagDopa').val() == "Y") {
                $("#divIdCardVerify").show();
                $('#idCardVerify').show();
            }
            if ($("#CustomerRegisterPanelModel_FlagFaceRecognition").val() == "Y") {
                $("#faceRecog").show()
            }
        }
        else if ($('#ID_CARD_NAME :selected').val() == "ROY_LET") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_Length_ID_Card_Number_ROY_LET");
        }
    }

    function onChangeTITLE_CODE() {
        $("#CustomerRegisterPanelModel_L_TITLE").val($("#TITLE_CODE :selected").text());
        $("#CustomerRegisterPanelModel_L_TITLE_CODE").val($("#TITLE_CODE :selected").val());
    }

    function onChangeTumbon(tumbon) {
        var page = tumbon.id.toString().replace("Tumbon", "");

        $('#ZipCode' + page).empty();

        var strBuilder = "<option value='' disabled selected >" + "@lZIPCODE" + "</option>";

        //GetZipCode
        $.ajax({
            type: "GET",
            url: "/MasterData/GetZipCode",
            data: { 'provinceFilter': $("#Province" + page + " :selected").text(), 'amphurFilter': $("#Amphur" + page + " :selected").text(), 'tumbonFilter': tumbon.value },
            dataType: "json",
            success: function (data) {
                $.each(data, function (i, e) {
                    var str = "";
                    if (data.length == 1) {
                        str = '<option value="' + e.Value + '" selected>' + e.Text + '</option>';
                        strBuilder = strBuilder.replace("selected", "");
                    }
                    else {
                        str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                    }
                    strBuilder += str;
                });
                $('#ZipCode' + page).append(strBuilder);
                $('#ZipCode' + page).select2();
            },
        });
    }

    function onChangeAmphur(amphur) {
        var page = amphur.id.toString().replace("Amphur", "");

        $('#Tumbon' + page).empty();
        $('#ZipCode' + page).empty();

        $('#ZipCode' + page).append("<option value='' disabled selected >" + "@lZIPCODE" + "</option>");

        //GetTumbon
        var strBuilder = "<option value='' disabled selected >" + "@lTUMBOL" + "</option>";
        $.ajax({
            type: "GET",
            url: "/MasterData/GetTumbon",
            data: { 'provinceFilter': $("#Province" + page + " :selected").text(), 'amphurFilter': amphur.value },
            dataType: "json",
            success: function (data) {
                $.each(data, function (i, e) {
                    var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                    strBuilder += str;
                });
                $('#Tumbon' + page).append(strBuilder);
                $('#Tumbon' + page).select2();
            }
        });
    }

    function onChangeProvince(province) {
        var page = province.id.toString().replace("Province", "");

        $('#ZipCode' + page).empty();
        $('#Tumbon' + page).empty();
        $('#Amphur' + page).empty();

        $('#ZipCode' + page).append("<option value='' disabled selected >" + "@lZIPCODE" + "</option>");
        $('#Tumbon' + page).append("<option value='' disabled selected >" + "@lTUMBOL" + "</option>");


        //R23.04
        if ($("#ProvinceSendDoc").hasClass("errorinput"))
            $("#ProvinceSendDoc").removeClass("form-control errorinput").addClass("form-control");

        var strBuilder = "<option value='' disabled selected >" + "@lAMPHUR" + "</option>";
        $.ajax({
            type: "GET",
            url: "/MasterData/GetAmphur",
            data: { 'provinceFilter': province.value },
            dataType: "json",
            success: function (data) {
                $.each(data, function (i, e) {
                    var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                    strBuilder += str;
                });
                $('#Amphur' + page).append(strBuilder);
                $('#Amphur' + page).select2();
            }
        });
    }

    function onChangeZipCode(zip) {
        if (zip.id.toString() == "ZipCodeSetup") {
        }
        else if (zip.id.toString() == "ZipCodeSendDoc") {
            $("#CustomerRegisterPanelModel_AddressPanelModelSendDoc_ZIPCODE_ID").val($("#ZipCodeSendDoc :selected").val());
        }
        else if (zip.id.toString() == "ZipCodeVat") {
            $("#CustomerRegisterPanelModel_AddressPanelModelVat_ZIPCODE_ID").val($("#ZipCodeVat :selected").val());
        }
    }

    function Get_Radio_CustomerType() {
        var indexSelectPackage = $("input[name=SelectPackage]:checked").val();
        var customerType = $("#CUSTOMER_TYPE" + indexSelectPackage).val();

        if ($("#CoveragePanelModel_ChargeType").val() == "POSTPAID" && $('#CustomerRegisterPanelModel_AccountCategory').val() != "") {
            //nattag49 02.08.67  

            //$('input[name="typeselect"]:checked').val($('#HdchkAC_Category').val());

            if ($('#HdchkAC_Category').val() == "R") {
                $("#lbl_GOVERNMENT").hide();
                $("#CustomerRegisterPanelModel_L_GOVERNMENT").hide();
                $("#lbl_BUSINESS").hide();
                $("#CustomerRegisterPanelModel_L_BUSINESS").hide();
            }
            else if ($('#HdchkAC_Category').val() == "G") {
                $("#lbl_RESIDENTIAL").hide();
                $("#CustomerRegisterPanelModel_L_RESIDENTIAL").hide();
                $("#lbl_BUSINESS").hide();
                $("#CustomerRegisterPanelModel_L_BUSINESS").hide();
            }
            else {
                $("#lbl_RESIDENTIAL").hide();
                $("#CustomerRegisterPanelModel_L_RESIDENTIAL").hide();
                $("#lbl_GOVERNMENT").hide();
                $("#CustomerRegisterPanelModel_L_GOVERNMENT").hide();
            } 
            //nattag49 01.08.67           
            if (sessionStorage.getItem("Customer_CardType") == "R") {
                onCheckType(document.getElementById("CustomerRegisterPanelModel_L_RESIDENTIAL"));
            } else if (sessionStorage.getItem("Customer_CardType") == "B") {
                onCheckType(document.getElementById("CustomerRegisterPanelModel_L_BUSINESS"));
          
            } 
      
        }
        else {
            //ถ้าเป็น prepaid หรือ non-ais
            //PREPAID_Package_Group_VAL2
            //var myCheckPREPAID_Package_Group = [];
            //var myCheckPREPAID_Package_Group_Type = [];
            //var myCheckPREPAID_Package_Group_Type_Temp = [];
            //var i = 0;
            @*var PackageName = $('#HdPackage_Group_Name').val();
            @foreach (var CheckPREPAID_Package_Group in PREPAID_Package_Group)
            {
                @:myCheckPREPAID_Package_Group.push("@CheckPREPAID_Package_Group");
                                                                                                                                                                                                            }
            @foreach (var CheckPREPAID_Package_Group_Type in PREPAID_Package_Group_VAL2)
            {
                @:myCheckPREPAID_Package_Group_Type_Temp.push("@CheckPREPAID_Package_Group_Type");
                                                                                                            }*@
            if ("@FromFBBxEOS" == "Y") {

                if ($("#FromCoverageFBBxEOS").val() == "Y") {
                    $("#EOS_AccountTitle").val('@EOS_AccountTitle');
                    $("#EOS_CustomerName").val('@EOS_CustomerName');
                    $("#EOS_OfficeTelNo").val('@EOS_OfficeTelNo');
                }

                if (customerType.indexOf('B') > -1) {
                    onCheckType(document.getElementById("CustomerRegisterPanelModel_L_BUSINESS"));
                    $("#lbl_RESIDENTIAL").hide();
                    $("#lbl_GOVERNMENT").hide();
                    $("#ID_CARD_NAME").val("TAX_ID").trigger('change');
                    $("#L_CARD_NO").val("@CARD_NOsFBBxEOS");
                    $("#L_GOVERNMENT_NAME").val($("#EOS_CustomerName").val());
                    $("#L_MOBILE").val($("#EOS_OfficeTelNo").val());
                }
            }
            //else if (myCheckPREPAID_Package_Group.indexOf(PackageName) >= 0) {
            else if (customerType != "") {
                //Initialize Group Type
                //for (var i = 0; i < myCheckPREPAID_Package_Group.length; i++) {
                //    if (myCheckPREPAID_Package_Group[i] == PackageName)
                //        myCheckPREPAID_Package_Group_Type.push(myCheckPREPAID_Package_Group_Type_Temp[i]);
                //}
                //Initialize Hide all button
                $("#lbl_RESIDENTIAL").hide();
                $("#CustomerRegisterPanelModel_L_RESIDENTIAL").hide();
                $("#lbl_GOVERNMENT").hide();
                $("#CustomerRegisterPanelModel_L_GOVERNMENT").hide();
                $("#lbl_BUSINESS").hide();
                $("#CustomerRegisterPanelModel_L_BUSINESS").hide();

                var chk_rad = false;

                if (customerType.indexOf('R') > -1) {
                    $("#lbl_RESIDENTIAL").show();
                    $("#CustomerRegisterPanelModel_L_RESIDENTIAL").show();
                    if (!chk_rad)
                        onCheckType(document.getElementById("CustomerRegisterPanelModel_L_RESIDENTIAL"));
                    chk_rad = true;
                }

                if (customerType.indexOf('G') > -1) {
                    $("#lbl_GOVERNMENT").show();
                    $("#CustomerRegisterPanelModel_L_GOVERNMENT").show();
                    if (!chk_rad)
                        onCheckType(document.getElementById("CustomerRegisterPanelModel_L_GOVERNMENT"));
                    chk_rad = true;
                }

                if (customerType.indexOf('B') > -1) {
                    $("#lbl_BUSINESS").show();
                    $("#CustomerRegisterPanelModel_L_BUSINESS").show();
                    if (!chk_rad)
                        onCheckType(document.getElementById("CustomerRegisterPanelModel_L_BUSINESS"));
                    chk_rad = true;
                }

                if (customerType.indexOf('I') > -1) {
                    $("#lbl_BUSINESS").show();
                    $("#CustomerRegisterPanelModel_L_BUSINESS").show();
                    if (!chk_rad)
                        onCheckType(document.getElementById("CustomerRegisterPanelModel_L_BUSINESS"));
                    chk_rad = true;
                }

                //for (var i = 0 ; i < myCheckPREPAID_Package_Group_Type.length; i++) {
                    //console.log("Type",myCheckPREPAID_Package_Group_Type[i]);

                    //if (myCheckPREPAID_Package_Group_Type[i] == "R") {
                    //    $("#lbl_RESIDENTIAL").show();
                    //    $("#CustomerRegisterPanelModel_L_RESIDENTIAL").show();
                    //    onCheckType(document.getElementById("CustomerRegisterPanelModel_L_RESIDENTIAL"));
                    //    chk_rad = true;
                    //}
                    //if (myCheckPREPAID_Package_Group_Type[i] == "G") {
                    //    $("#lbl_GOVERNMENT").show();
                    //    $("#CustomerRegisterPanelModel_L_GOVERNMENT").show();

                    //    if (!chk_rad)
                    //        onCheckType(document.getElementById("CustomerRegisterPanelModel_L_GOVERNMENT"));
                    //    chk_rad = true;
                    //}
                    //if (myCheckPREPAID_Package_Group_Type[i] == "B") {
                    //    $("#lbl_BUSINESS").show();
                    //    $("#CustomerRegisterPanelModel_L_BUSINESS").show();
                    //    if (!chk_rad)
                    //        onCheckType(document.getElementById("CustomerRegisterPanelModel_L_BUSINESS"));
                    //}

                //}
            }
            else {
                // ถ้าไม่เลือก power home แสดง Radio ทั้ง3อัน
                $("#lbl_RESIDENTIAL").show();
                $("#CustomerRegisterPanelModel_L_RESIDENTIAL").show();
                $("#lbl_GOVERNMENT").show();
                $("#CustomerRegisterPanelModel_L_GOVERNMENT").show();
                $("#lbl_BUSINESS").show();
                $("#CustomerRegisterPanelModel_L_BUSINESS").show();
                onCheckType(document.getElementById("CustomerRegisterPanelModel_L_RESIDENTIAL"));
            }
        }
    }

    function onCheckType(rb, ev) {
        var type = rb.value;
        if ($("#tCardType").val()) {
            type = $("#tCardType").val();
            $("#tCardType").val("");
        }

        $('#CustomerRegisterPanelModel_FlagDopaSubmit').val("N");
        $('#CustomerRegisterPanelModel_FlagFaceRecognitionSubmit').val("N");

        $('#CustomerRegisterPanelModel_CateType').val(type);
        if (type == 'R') {
            $("#CustomerRegisterPanelModel_L_RESIDENTIAL").prop("checked", true);
            if ('@Model.SummaryPanelModel.VAS_FLAG' == "6") {
                $('#TITLE_CODE').prop('disabled', true);
            }

            $("#divGovermentName").hide();
            $("#divFill_Vat").hide();
            $("#divFill_Vat_B").hide();
            $("#divContactPerson").hide();
            $("#divFirstName").show();
            $("#divLastName").show();
            $("#divBirthday").show();
            $('#divReceiptEbillChannel').show();
            //R20.5 Default eBill
            $("#chkReceiptEbill").prop("checked", true);
            onCkEbillChange();
            //R20.6 Default eBill Hide Line Customer
            if ($('#TopUp').val() == "5")
                $("#chkEbillType").show();
            else
                $("#chkEbillType").hide();

            if ($('#CustomerRegisterPanelModel_FlagDopa').val() == "Y") {
                $('#divIdCardVerify').show();
                $('#idCardVerify').show();
                $('#idCardVerifyDisable').hide();
                $("#btnExLaser").show();
            }
            if ($("#CustomerRegisterPanelModel_FlagFaceRecognition").val() == "Y") {
                $("#faceRecog").show();
            }

            $("#divUploadpicR").show();
            if ($("#hdndivUploadpicR2").val() == "") {
                $("#divUploadpicR2").show();
            }
            if ($("#hdndivUploadpicR3").val() == "") {
                $("#divUploadpicR3").show();
            }
            if ($("#hdndivUploadpicR4").val() == "") {
                $("#divUploadpicR4").show();
            }

            if ($('div[id^=divUploadpicR]:visible').length == 4 || $('#hdnAddUploadR').val() == "Y") {
                $('#hdnAddUploadR').val('Y');
                $('#btnAddUploadR').addClass('disabled');
            } else {
                $('#hdnAddUploadR').val('');
                $('#btnAddUploadR').removeClass('disabled');
            }
            // GREETING
            var myCheckATTACHED = [];

            @foreach (var CheckATTACHED in ATTACHED)
            {
                @:myCheckATTACHED.push("@CheckATTACHED");
                                                                         }

            var tmpPackageGroup = $("#PACKAGE_GROUP" + $("input[name=SelectPackage]:checked").val()).val().toUpperCase();
            var tmpATTACHED = false;

            $.each(myCheckATTACHED, function (index, item) {
                if (tmpPackageGroup.indexOf(item) > -1) {
                    tmpATTACHED = true;
                }
            });

            if (tmpATTACHED) {
                $("#divUploadpicBill").show();
                $("#RemarkGreeting").show();
            } else {
                $("#divUploadpicBill").hide();
                $("#RemarkGreeting").hide();
            }

            $("#divUploadpicG1").hide();
            $("#divUploadpicG2").hide();
            $("#divUploadpicG3").hide();
            $("#divUploadpicG4").hide();
            $("#divUploadpicG5").hide();
            $("#divUploadpicG6").hide();
            $("#divUploadpicB1").hide();
            $("#divUploadpicB2").hide();
            $("#divUploadpicB3").hide();
            $("#divUploadpicB4").hide();
            $("#divUploadpicB5").hide();
            $("#divUploadpicB6").hide();
            $("#divUploadpicB7").hide();

            $("#textImage").val("");
            $("#textImageR2").val("");
            $("#textImageR3").val("");
            $("#textImageR4").val("");
            $("#textImageBill").val("");

            $("#btnPreviewR1").addClass("disabled");
            $("#btnPreviewR2").addClass("disabled");
            $("#btnPreviewR3").addClass("disabled");
            $("#btnPreviewR4").addClass("disabled");
            $("#btnPreviewBill").addClass("disabled");


            popRequireFieldR();
            pushRequireFieldR();


            $.ajax({
                type: "POST",
                url: "/Process/RemovePhotoAll",
                data: { type: 'R' },
                dataType: "json",
                success: function (data) {

                }
            });
        }
        else if (type == 'G') {
            $("#CustomerRegisterPanelModel_L_GOVERNMENT").prop("checked", true);
            var cardActive = sessionStorage.getItem('Card_is_Active');
            if ('@Model.SummaryPanelModel.VAS_FLAG' == "6" || cardActive == "Y") {
                $('#TITLE_CODE').prop('disabled', false);
            }

            $("#divGovermentName").show();
            $("#divFill_Vat").show();
            $("#divFill_Vat_B").hide();
            $("#divContactPerson").show();
            $("#divFirstName").hide();
            $("#divLastName").hide();
            $('#ID_CARD_NAME').prop('disabled', false);
            $('#L_CARD_NO').prop('readonly', false);
            $('#btnExLaser').hide();
            $('#divIdCardVerify').hide();
            $('#idCardVerify').hide();
            $('#idCardVerifyDisable').hide();
            $('#showMessageVerify').hide();
            $('#FLAG_CHECK_VERIFY').val("");
            $("#faceRecog").hide();
            $("#faceRecogCheckedFlag").val("N");

            $("#showResultRecog").hide();
            $("#btnRemove").show();
            $("#btnRemoveDisabled").hide();

            // check pc/mobile
            if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
                $("#btnbrowse").show();
                $("#btnbrowseDisabled").hide();

            }
            else {

                if (signatureShowFlag) {
                    $("#filesignature").show();
                    $("#filesignatureDisabled").hide();
                }
            }

            if ($("#CustomerRegisterPanelModel_FlagTakePhoto").val() == "Y" && navigator.userAgent.indexOf("SamsungBrowser") == -1 && !iOSSafari && !iOS && !signatureShowFlag) {

                $("#fileTakePhoto").show();
                $("#fileTakePhotoDisabled").hide();
            }

            $("#btnOrigin").show();
            $("#btnFromCamera").show();
            $("#btnOriginTake").hide();
            $("#btnFromCameraTake").hide();
            $("#btnValidateFace").hide();
            $("#btnValidateFaceDisabled").show();
            $("#verifyIdentity").hide();
            $("#btnVerifyFace").hide();
            $("#imgPreviewOrigin").hide();
            $("#imgPreviewFromCamera").hide();
            //$('#textImage').val("");
            canMake1 = false;
            canMake2 = false;
            if (videoOpen != "") {
                $("#" + videoOpen).hide();
                $("#" + btnVideoID + "Take").hide();
                $("#" + btnVideoID).show();

                window[videoOpen].pause();
                localstream.getTracks()[0].stop();
                videoOpen = "";
            }

            $("#divUploadpicR").hide();
            $("#divUploadpicR2").hide();
            $("#divUploadpicR3").hide();
            $("#divUploadpicR4").hide();
            $("#divUploadpicBill").hide();
            $("#divUploadpicG1").show();
            $("#divUploadpicG2").show();
            $("#divUploadpicG3").show();

            $('#divReceiptEbillChannel').hide();
            $("#chkReceiptEbill").prop("checked", false);
            onCkEbillChange();

            if ($("#hdndivUploadpicG4").val() == "") {
                $("#divUploadpicG4").show();
            }
            if ($("#hdndivUploadpicG5").val() == "") {
                $("#divUploadpicG5").show();
            }
            if ($("#hdndivUploadpicG6").val() == "") {
                $("#divUploadpicG6").show();
            }

            if ($('div[id^=divUploadpicG]:visible').length == 6 || $('#hdnAddUploadG').val() == "Y") {
                $('#hdnAddUploadG').val('Y');
                $('#btnAddUploadG').addClass('disabled');
            } else {
                $('#hdnAddUploadG').val('');
                $('#btnAddUploadG').removeClass('disabled');
            }

            $("#divUploadpicB1").hide();
            $("#divUploadpicB2").hide();
            $("#divUploadpicB3").hide();
            $("#divUploadpicB4").hide();
            $("#divUploadpicB5").hide();
            $("#divUploadpicB6").hide();
            $("#divUploadpicB7").hide();

            $("#textImageG1").val("");
            $("#textImageG2").val("");
            $("#textImageG3").val("");
            $("#textImageG4").val("");
            $("#textImageG5").val("");
            $("#textImageG6").val("");

            $("#btnPreviewG1").addClass("disabled");
            $("#btnPreviewG2").addClass("disabled");
            $("#btnPreviewG3").addClass("disabled");
            $("#btnPreviewG4").addClass("disabled");
            $("#btnPreviewG5").addClass("disabled");
            $("#btnPreviewG6").addClass("disabled");

            $("#divBirthday").hide();
            popRequireFieldGB();
            pushRequireFieldGB();
            $("#L_GOVERNMENT_NAME").attr("placeholder", "@lGOVERNMENT");
            $.ajax({
                type: "POST",
                url: "/Process/RemovePhotoAll",
                data: { type: 'G' },
                dataType: "json",
                success: function (data) {

                }
            });
        }
        else {
            $("#CustomerRegisterPanelModel_L_BUSINESS").prop("checked", true);
            var cardActive = sessionStorage.getItem('Card_is_Active');
            if ('@Model.SummaryPanelModel.VAS_FLAG' == "6" || cardActive == "Y") {
                $('#TITLE_CODE').prop('disabled', false);
            }

            $("#divGovermentName").show();
            $("#divFill_Vat_B").show();
            $("#divFill_Vat").hide();
            $("#divContactPerson").show();
            $("#divFirstName").hide();
            $("#divLastName").hide();
            $('#ID_CARD_NAME').prop('disabled', false);
            $('#L_CARD_NO').prop('readonly', false);
            $('#btnExLaser').hide();
            $('#divIdCardVerify').hide();
            $('#idCardVerify').hide();
            $('#idCardVerifyDisable').hide();
            $('#showMessageVerify').hide();
            $('#FLAG_CHECK_VERIFY').val("");
            $("#faceRecog").hide();
            $("#faceRecogCheckedFlag").val("N");

            $("#showResultRecog").hide();
            $("#btnRemove").show();
            $("#btnRemoveDisabled").hide();

            // check pc/mobile
            if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
                $("#btnbrowse").show();
                $("#btnbrowseDisabled").hide();

            }
            else {

                if (signatureShowFlag) {
                    $("#filesignature").show();
                    $("#filesignatureDisabled").hide();
                }
            }

            if ($("#CustomerRegisterPanelModel_FlagTakePhoto").val() == "Y" && navigator.userAgent.indexOf("SamsungBrowser") == -1 && !iOSSafari && !iOS && !signatureShowFlag) {

                $("#fileTakePhoto").show();
                $("#fileTakePhotoDisabled").hide();
            }

            $("#btnOrigin").show();
            $("#btnFromCamera").show();
            $("#btnOriginTake").hide();
            $("#btnFromCameraTake").hide();
            $("#btnValidateFace").hide();
            $("#btnValidateFaceDisabled").show();
            $("#verifyIdentity").hide();
            $("#btnVerifyFace").hide();
            $("#imgPreviewOrigin").hide();
            $("#imgPreviewFromCamera").hide();
            //$('#textImage').val("");
            canMake1 = false;
            canMake2 = false;
            if (videoOpen != "") {
                $("#" + videoOpen).hide();
                $("#" + btnVideoID + "Take").hide();
                $("#" + btnVideoID).show();

                window[videoOpen].pause();
                localstream.getTracks()[0].stop();
                videoOpen = "";
            }

            $("#divUploadpicR").hide();
            $("#divUploadpicR2").hide();
            $("#divUploadpicR3").hide();
            $("#divUploadpicR4").hide();
            $("#divUploadpicBill").hide();
            $("#divUploadpicG1").hide();
            $("#divUploadpicG2").hide();
            $("#divUploadpicG3").hide();
            $("#divUploadpicG4").hide();
            $("#divUploadpicG5").hide();
            $("#divUploadpicG6").hide();

            $('#divReceiptEbillChannel').hide();
            $("#chkReceiptEbill").prop("checked", false);
            onCkEbillChange();

            $("#divUploadpicB1").show();
            $("#divUploadpicB2").show();
            $("#divUploadpicB3").show();
            $("#divUploadpicB4").show();
            if ($("#hdndivUploadpicB5").val() == "") {
                $("#divUploadpicB5").show();
            }
            if ($("#hdndivUploadpicB6").val() == "") {
                $("#divUploadpicB6").show();
            }
            if ($("#hdndivUploadpicB7").val() == "") {
                $("#divUploadpicB7").show();
            }

            if ($('div[id^=divUploadpicB]:visible').length == 7 || $('#hdnAddUploadB').val() == "Y") {
                $('#hdnAddUploadB').val('Y');
                $('#btnAddUploadB').addClass('disabled');
            } else {
                $('#hdnAddUploadB').val('');
                $('#btnAddUploadB').removeClass('disabled');
            }

            $("#textImageB1").val("");
            $("#textImageB2").val("");
            $("#textImageB3").val("");
            $("#textImageB4").val("");
            $("#textImageB5").val("");
            $("#textImageB6").val("");
            $("#textImageB7").val("");

            $("#btnPreviewB1").addClass("disabled");
            $("#btnPreviewB2").addClass("disabled");
            $("#btnPreviewB3").addClass("disabled");
            $("#btnPreviewB4").addClass("disabled");
            $("#btnPreviewB5").addClass("disabled");
            $("#btnPreviewB6").addClass("disabled");
            $("#btnPreviewB7").addClass("disabled");

            $("#divBirthday").hide();
            popRequireFieldGB();
            pushRequireFieldGB();
            $("#L_GOVERNMENT_NAME").attr("placeholder", "@lBUSINESS");

            $.ajax({
                type: "POST",
                url: "/Process/RemovePhotoAll",
                data: { type: 'B' },
                dataType: "json",
                success: function (data) {

                }
            });
        }

        getCustomerTitle(type);
        getCustomerCardType(type);

        //สำหรับ case card reader
        if (type == 'R') {
            if ($("#hdIdCardReaderOnPcFlag").val() == "Y") {

                if ((sessionStorage.getItem('Card_is_Active') == "Y") && ev == 'click') {
                    showLoadIdCardReaderPC();
                }

                if (sessionStorage.getItem('Use_Data_Card') == "Y") {
                    $('#TITLE_CODE').prop('disabled', true);
                    $('#L_FIRST_NAME').prop('readonly', true);
                    $('#L_LAST_NAME').prop('readonly', true);
                    $('#ddlGender').prop('disabled', true);
                    $('#ddlDay').prop('disabled', true);
                    $('#ddlMonth').prop('disabled', true);
                    $('#ddlYear').prop('disabled', true);
                    $('#ID_CARD_NAME').prop('disabled', true);
                    $('#L_CARD_NO').prop('readonly', true);
                    $("#L_ID_CARD_LASER").prop('readonly', true);

                    if ($('#textImage').val() != "") {

                        // check pc/mobile
                        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
                            $('#btnbrowse').hide();
                            $('#btnbrowseDisabled').show();

                        }
                        else {

                            if (signatureShowFlag) {
                                $("#filesignature").hide();
                                $("#filesignatureDisabled").show();
                            }
                        }

                        if ($("#CustomerRegisterPanelModel_FlagTakePhoto").val() == "Y" && navigator.userAgent.indexOf("SamsungBrowser") == -1 && !iOSSafari && !iOS && !signatureShowFlag) {

                            $("#fileTakePhoto").hide();
                            $("#fileTakePhotoDisabled").show();
                        }

                        $('#btnRemove').hide();
                        $('#btnRemoveDisabled').show();
                    }
                }
                else {
                    $('#TITLE_CODE').prop('disabled', false);
                    $('#L_FIRST_NAME').prop('readonly', false);
                    $('#L_LAST_NAME').prop('readonly', false);
                    $('#ddlGender').prop('disabled', false);
                    $('#ddlDay').prop('disabled', false);
                    $('#ddlMonth').prop('disabled', false);
                    $('#ddlYear').prop('disabled', false);
                    $('#ID_CARD_NAME').prop('disabled', false);
                    $('#L_CARD_NO').prop('readonly', false);
                    $("#L_ID_CARD_LASER").prop('readonly', false);

                    if ($('#textImage').val() != "") {

                        // check pc/mobile
                        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
                            $("#btnbrowse").show();
                            $("#btnbrowseDisabled").hide();
                        }
                        else {

                            if (signatureShowFlag) {
                                $("#filesignature").show();
                                $("#filesignatureDisabled").hide();
                            }
                        }

                        if ($("#CustomerRegisterPanelModel_FlagTakePhoto").val() == "Y" && navigator.userAgent.indexOf("SamsungBrowser") == -1 && !iOSSafari && !iOS && !signatureShowFlag) {

                            $("#fileTakePhoto").show();
                            $("#fileTakePhotoDisabled").hide();
                        }

                        $('#btnRemove').show();
                        $('#btnRemoveDisabled').hide();
                    }
                }
            }
        }

        if ($('#LanguagePage').val() == "2") {
            if (type == "G" || type == "B") {
                $('#TITLE_CODE').attr("disabled", "disabled");
            }
            else {
                $('#TITLE_CODE').removeAttr("disabled");
            }
        }

        if (document.getElementById("ID_CARD_NAME").value != "") {
            onChangeID_CARD_NAME(document.getElementById("ID_CARD_NAME"));
        }

        if ('@Model.StaffPrivilegeBypass_Flag' == 'Y') {
            var cardTypeValue = "";
            var selectionIndex = 0;
            var docCardType = document.getElementById("ID_CARD_NAME");
            for (var i = 0; i < docCardType.length; i++) {
                if (docCardType.options[i].value == '@Model.IDCardType') {
                    selectionIndex = i;
                }
            }
            if (selectionIndex > 0) {
                $("#lbl_GOVERNMENT").hide();
                $("#CustomerRegisterPanelModel_L_GOVERNMENT").hide();
                $("#lbl_BUSINESS").hide();
                $("#CustomerRegisterPanelModel_L_BUSINESS").hide();

                $('#ID_CARD_NAME option:eq(' + selectionIndex + ')').attr('selected', 'selected');
                $('#ID_CARD_NAME').trigger('change');
                $("#L_CARD_NO").val('@Model.IDCardNo');
                $("#ID_CARD_NAME").attr('disabled', true);
                $("#L_CARD_NO").attr('readonly', true);
            }
        }

    }
    function getCustomerTitle(type) {
        $('#TITLE_CODE').empty();

        $.ajax({
            type: "GET",
            url: "/MasterData/GetCustomerTitle",
            data: { 'customerCardType': type },
            dataType: "json",
            success: function (data) {
                var strBuilder = "";
                var flagSelect = false;
                var firstStr = "<option value='' disabled>" + "@lTITLE" + "</option>";
                var firstStrSelect = "<option value='' disabled selected>" + "@lTITLE" + "</option>";
                var flagT = false;
                var flagT2 = false;
                $.each(data, function (i, e) {

                    var str = "";

                    if (e.Text == $("#tTitle").val()) {
                        str = '<option value="' + e.Value + '" selected>' + e.Text + '</option>';
                        $("#CustomerRegisterPanelModel_L_TITLE").val(e.Text);
                        $("#CustomerRegisterPanelModel_L_TITLE_CODE").val(e.Value);
                        flagT = true;
                        strBuilder = strBuilder.replace("selected", "");
                    }

                    if (e.DefaultValue == type && !flagT) {
                        str = '<option value="' + e.Value + '" selected>' + e.Text + '</option>';
                        $("#CustomerRegisterPanelModel_L_TITLE").val(e.Text);
                        $("#CustomerRegisterPanelModel_L_TITLE_CODE").val(e.Value);
                        firstStrSelect = firstStrSelect.replace("selected", "");
                    }
                    else {
                        if (flagT && !flagT2)
                            flagT2 = true;
                        else if (flagT2)
                            str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                        else
                            str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                    }

                    strBuilder += str;
                });

                if ($("#LanguagePage").val() == '2') {
                    if (type == "R") {
                        if (flagSelect) {
                            strBuilder = firstStr + strBuilder;
                        }
                        else {
                            strBuilder = firstStrSelect + strBuilder;
                        }
                    }
                }
                else {
                    if (flagSelect) {
                        strBuilder = firstStr + strBuilder;
                    }
                    else {
                        strBuilder = firstStrSelect + strBuilder;
                    }
                }

                $('#TITLE_CODE').append(strBuilder);
                $('#TITLE_CODE').select2();

                if ($("#EOS_AccountTitle").val() != "") {
                    $("#TITLE_CODE").val($("#TITLE_CODE option").filter(function () {
                        return $(this)[0].text == $("#EOS_AccountTitle").val() ? $(this)[0].value : null;
                    }).val()).trigger('change')
                }
            }
        });
    }

    function getCustomerCardType(type) {

        $('#ID_CARD_NAME').empty();

        $.ajax({
            type: "GET",
            url: "/MasterData/GetCustomerCardType",
            data: { 'customerType': type },
            dataType: "json",
            async: false,
            success: function (data) {
                var strBuilder = "";
                var flagSelect = false;
                var firstStr = "<option value='' disabled>" + "@lCARD_TYPE" + "</option>";
                var firstStrSelect = "<option value='' disabled selected>" + "@lCARD_TYPE" + "</option>";

                $.each(data, function (i, e) {
                    var str = "";
                    if ($("#tID_CARD_NAMEs").val()) {
                        if ($("#tID_CARD_NAMEs").val() == e.Value) {
                            flagSelect = true;
                            str = '<option value="' + e.Value + '" selected>' + e.Text + '</option>';
                        }
                        else {
                            str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                        }
                    }
                    else {
                        if (e.DefaultValue == type) {
                            flagSelect = true;
                            str = '<option value="' + e.Value + '" selected>' + e.Text + '</option>';
                        }
                        else {
                            str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                        }
                    }
                    strBuilder += str;
                });

                if (flagSelect) {
                    strBuilder = firstStr + strBuilder;
                }
                else {
                    strBuilder = firstStrSelect + strBuilder;
                }

                $('#ID_CARD_NAME').append(strBuilder);
                $('#ID_CARD_NAME').select2();



                if ($("#hidden_id_card").val()) {
                    $("#L_CARD_NO").val($("#hidden_id_card").val());
                }
                else {
                    if ($("#tID_CARD_NAMEs").val()) {
                        $("#L_CARD_NO").val($("#tL_CARD_NOs").val());
                    }
                }



                $('#CustomerRegisterPanelModel_L_CARD_TYPE').val($('#ID_CARD_NAME :selected').text());

            }
        });


    }

    function backPage() {

        var i = $("input[name=SelectPackage]:checked").val();

        if ($("#PACKAGE_TYPE" + i).val() == "TRIPLE") {
            $("#page3").hide();
            $("#PackageDetailPage").show();
        }
        else {
            if ($('#hdSelectVas').val() == "1") {
                //Not Select VAS
                $('#hdGetVoip').val("0");
                $('#hdGetPlayBox').val("0");
                $("#page3").hide();
                $("#page2").show();
            }
            else {
                //Select VAS
                $("#page3").hide();
                $("#page2_2").show();
            }
        }

        //$('#chkEventCode').prop('checked', false);
        $("#CPE_Serial").removeClass("form-control errorinput ").addClass("form-control");
        $("#PlayBox_Serial").removeClass("form-control errorinput ").addClass("form-control");

        //R19.1
        $("#L_NAME_SPECIAL_ACCOUNT").removeClass("form-control errorinput ").addClass("form-control");
        $("#L_NO_SPECIAL_ACCOUNT").removeClass("form-control errorinput ").addClass("form-control");
        $("#dtpSpecialExpireDateTH_text").removeClass("form-control errorinput ").addClass("form-control");
    }

    function backPageToContentDetail() {
        $("#page3").hide();
        if (haveContentPackage) {
            isPageVOIP = false;
            isPagePlaybox = false;
            checkHavePlaybox = false;
            checkHaveVoip = false;
            $("#page2_1").show();
        }
        else {
            var SelectPackageIndex = $("input[name=SelectPackage]:checked").val();
            onBindingV2(SelectPackageIndex);
            $("#page2").show();
        }
        window.scrollTo(0, 0);
    }

    var chkRequireField = true;
    var chkInstallDate = true;

    function ChkInputAndRequiredField() {
        chkRequireField = true;
        chkInstallDate = true;
        if ($('input[name="typeselect"]:checked').val() == 'R') {
            popRequireFieldR();
            popRequireFieldGB();
            pushRequireFieldR();
            $('#divSameAddrIdCard').show();
            $('#divCbSameAddrIdCard').show();
        }
        else {
            popRequireFieldR();
            popRequireFieldGB();
            pushRequireFieldGB();

            //hide same addr idcard
            $('#divSameAddrIdCard').hide();
            $('#divCbSameAddrIdCard').hide();
        }

        $("#DIV_CPE_INFO").empty();//kes
        chkRequireField = $('input[name="typeselect"]:checked').val() == 'R' ? ValidationProcessing(validateModel003R, "err003") : ValidationProcessing(validateModel003GB, "err003");
        var chkor = validateMobileNumberOR("L_OR", "err003");

        if (!ValidateQuestion()) {
            if ($("#LanguagePage").val() == "1") {

                temp = "กรุณาระบุข้อมูลให้ถูกต้องและครบถ้วน"
                toastrErrorMessage(temp);
            }
            else {
                temp = "Please Fill In All Required Fields."
                toastrErrorMessage(temp);
            }
            return false;
        }

        var i = $("input[name=SelectPackage]:checked").val();

        if (($("#hdtechnology").val() != $("#ACCESS_MODE" + i).val()) && ($("#L_EVENT_CODE").val() != ""))//เช็ค Technology คอนโดและบ้าน
        {
            chkInstallDate = false;
            chkRequireField = false;
            $("#L_EVENT_CODE").removeClass("form-control").addClass("form-control errorinput");
            if ($("#LanguagePage").val() == "1") {

                temp = "กรุณาระบุข้อมูลให้ถูกต้องและครบถ้วน"
                toastrErrorMessage(temp);
            }
            else {
                temp = "Please Fill In All Required Fields."
                toastrErrorMessage(temp);
            }
            //toastrErrorMessage(temp);
            return false;
        }

        if ($("input[name*='CustomerRegisterPanelModel_L_CHECK_EVENT_CODE']:checked").val() && $("#PlugAndPlayFlow").val() == "N" && $("#L_EVENT_CODE").val() == "") {
            chkRequireField = false;
            $("#L_EVENT_CODE").removeClass("form-control").addClass("form-control errorinput");

            if ($("#LanguagePage").val() == "1") {

                temp = "กรุณาระบุข้อมูลให้ถูกต้องและครบถ้วน"
                toastrErrorMessage(temp);
            }
            else {
                temp = "Please Fill In All Required Fields."
                toastrErrorMessage(temp);
            }
            //toastrErrorMessage(temp);
            return false;
        }

        if ($('#checkEventCode').val() == "false") {
            chkRequireField = false;
            $("#L_EVENT_CODE").removeClass("form-control").addClass("form-control errorinput");

            if ($("#LanguagePage").val() == "1") {

                temp = "กรุณาระบุข้อมูลให้ถูกต้องและครบถ้วน"
                toastrErrorMessage(temp);
            }
            else {
                temp = "Please Fill In All Required Fields."
                toastrErrorMessage(temp);
            }
            //toastrErrorMessage(temp);
            return false;
        }
        else {

            if ($('#checkEventCode').val() == "true") {
                if ($("#L_EVENT_CODE").val() != "" && $('#CustomerRegisterPanelModel_Plug_and_play_flag').val() != "N") {
                    if ($('#hdGetPlayBox').val() == "1") {

                        var a = [];
                        a.push({ id: "CPE_Serial" });
                        a.push({ id: "PlayBox_Serial" });
                        chkInstallDate = ValidationProcessing(a, "err001_2");
                    }
                    else {
                        var b = [];
                        b.push({ id: "CPE_Serial" });
                        chkInstallDate = ValidationProcessing(b, "err001_2");
                    }
                }
            }
        }
        if ($("#PlugAndPlayFlow").val() == "Y") {
            if ($('#hdGetPlayBox').val() == "1") {
                var a = [];
                a.push({ id: "CPE_Serial" });
                a.push({ id: "PlayBox_Serial" });
                chkInstallDate = ValidationProcessing(a, "err001_2");
            }
            else {
                var b = [];
                b.push({ id: "CPE_Serial" });
                chkInstallDate = ValidationProcessing(b, "err001_2");
            }
        }

        if ($("#LanguagePage").val() == "1") {
            var dtpPeriodDateTH = $("#dtpPeriodDateTH").val();
            if (dtpPeriodDateTH != "" && $("#L_EVENT_CODE").val() != "") {
                var dd = dtpPeriodDateTH.substring('0', '2');
                var MM = dtpPeriodDateTH.substring('3', '5');
                var yyyy = dtpPeriodDateTH.substring('6', '10');
                var PeriodDateTH = dd + "/" + MM + "/" + yyyy;
                $('#L_INSTALL_DATE').val(PeriodDateTH);
            }
        }
        else {
            var dtpPeriodDateEN = $("#dtpPeriodDateEN").val();
            if (dtpPeriodDateEN != "" && $("#L_EVENT_CODE").val() != "") {
                var d = dtpPeriodDateEN.substring('0', '2');
                var M = dtpPeriodDateEN.substring('3', '5');
                var y = dtpPeriodDateEN.substring('6', '10');
                var PeriodDateEN = d + "/" + M + "/" + y;
                $('#L_INSTALL_DATE').val(PeriodDateEN);
            }
        }

        if (isLimitAge) {
            toastrErrorMessage('@L_ERROR_AGE');
            return;
        }


        //20.2
        if ($("#WTTX_COVERAGE_RESULT").val() != "YES" ) {
            //TODO: Splitter Management Change
            var selectPackageResult = $("input[name=SelectPackage]:checked").val();
            var accessModeResult = $("#ACCESS_MODE" + selectPackageResult).val();
            if (($("#L_INSTALL_DATE").val() == "" || $("#L_INSTALL_DATE").val() == undefined)
                && ('@SHOW_TIME_SLOT' != "N" || $("#PlugAndPlayFlow").val() == "Y")
                && $("#L_SplitterFlagFirstTime").val() != "6"
                && $("#L_SplitterFlagFirstTime").val() != "5"
                && ($("#L_SplitterFlagFirstTime").val() != "3" || ($("#L_SplitterFlagFirstTime").val() == "3" && accessModeResult == "FTTH"))
                && ($("#L_SplitterFlagFirstTime").val() != "2" || ($("#L_SplitterFlagFirstTime").val() == "2" && accessModeResult == "FTTH"))) {

                chkRequireField = false;
                chkInstallDate = false;
                if ($("#LanguagePage").val() == "1") {

                    temp = "กรุณาระบุข้อมูลให้ถูกต้องและครบถ้วน"
                }
                else {
                    temp = "Please Fill In All Required Fields."
                }

                toastrErrorMessage(temp);
                $("#dtpInstallDateTH").removeClass("form-control").addClass("form-control errorinput");
                $("#dtpInstallDateEN").removeClass("form-control").addClass("form-control errorinput");
                $("#CustomerRegisterPanelModel_SUB_LOCATION_ID").val("");
                $("#CustomerRegisterPanelModel_SUB_CONTRACT_NAME").val("");
                $("#CustomerRegisterPanelModel_INSTALL_STAFF_ID").val("");
                $("#CustomerRegisterPanelModel_INSTALL_STAFF_NAME").val("");
            }

        }
        //20.2
        if ($("#WTTX_COVERAGE_RESULT").val() != "YES" ) {
            //18.6
            if (sessionStorage.getItem('DefaultDateCompare') != null && checkDateTimeSlot && $("#L_EVENT_CODE").val() == "") {
                var array_defaultdateCompare = sessionStorage.getItem('DefaultDateCompare').toString().split('/');
                var defaultdateCompare = new Date(Date.UTC(parseInt(array_defaultdateCompare[2]), parseInt(array_defaultdateCompare[1]) - 1, parseInt(array_defaultdateCompare[0])));
                var array_L_INSTALL_DATE = $("#L_INSTALL_DATE").val().split('/');
                var tmp_L_INSTALL_DATE = new Date(Date.UTC(parseInt(array_L_INSTALL_DATE[2]), parseInt(array_L_INSTALL_DATE[1]) - 1, parseInt(array_L_INSTALL_DATE[0])));
                if (tmp_L_INSTALL_DATE < defaultdateCompare) {
                    var g = tmp_L_INSTALL_DATE < defaultdateCompare;
                    chkInstallDate = false;
                    temp = "กรุณาระบุข้อมูลให้ถูกต้องและครบถ้วน"
                    toastrErrorMessage(temp);
                }
            }
        }
        if ($('#L_CARD_NO').val() != "" && $('#L_CARD_NO').val().length < 4) {
            chkRequireField = false;
            if ($("#LanguagePage").val() == "1") {

                temp = "กรุณาระบุข้อมูลให้ถูกต้องและครบถ้วน"
            }
            else {
                temp = "Please Fill In All Required Fields."
            }

            toastrErrorMessage(temp);
            $("#L_CARD_NO").removeClass("form-control").addClass("form-control errorinput");
        }

        if (!chkRequireField || !chkor) return;

        // เช็คว่า Verify DOPA ผ่านหรือยัง
        if ($('#FLAG_CHECK_VERIFY').val() != "Y" && $('#ID_CARD_NAME').val() == "ID_CARD" && $('#CustomerRegisterPanelModel_FlagDopa').val() == "Y") {
            if ($('#FLAG_CHECK_VERIFY').val() == "N") {
                temp = '@L_WARNING_VERIFY'
            }
            else {
                temp = '@L_WARNING_VERIFY'
            }

            toastrErrorMessage(temp);
            return;
        }

        if ($("#CustomerRegisterPanelModel_FlagFaceRecognition").val() == "Y" && $("#faceRecogCheckedFlag").val() == "N" && $('#ID_CARD_NAME').val() == "ID_CARD") {
            if ($("#LanguagePage").val() == "1") {

                temp = "กรุณาตรวจสอบอัตลักษณ์บุคคล หรือ ยืนยันอัตลักษณ์บุคคล"
            }
            else {
                temp = "Please make Face Recognition or Verify your Identity"
            }

            toastrErrorMessage(temp);
            return;
        }

        //R19.1 Check Special Account
        if ($('#TopUp').val() == "5" && "@flagspecialaccountresult" == "Y") {
            if ($("#L_NAME_SPECIAL_ACCOUNT").val() == "" || $("#L_NO_SPECIAL_ACCOUNT").val() == ""
                || $("#dtpSpecialExpireDateTH_text").val() == "" || $("#ddlGroupMailSpecialAccount").val() == "" || $("#ddlGroupMailSpecialAccount").val() == null) {
                if ($("#LanguagePage").val() == "1") {
                    temp = "กรุณาระบุข้อมูล Special Account ให้ถูกต้องและครบถ้วน"
                    $("#dtpSpecialExpireDateTH").val("");
                }
                else {
                    temp = "Please Fill In All Required Fields."
                    $("#dtpSpecialExpireDateEN").val("");
                }

                if ($("#L_NAME_SPECIAL_ACCOUNT").val() == "") $("#L_NAME_SPECIAL_ACCOUNT").removeClass("form-control").addClass("form-control errorinput");
                if ($("#L_NO_SPECIAL_ACCOUNT").val() == "") $("#L_NO_SPECIAL_ACCOUNT").removeClass("form-control").addClass("form-control errorinput");
                if ($("#dtpSpecialExpireDateTH_text").val() == "") $("#dtpSpecialExpireDateTH_text").removeClass("form-control").addClass("form-control errorinput");

                toastrErrorMessage(temp);
                return;
            }
            else { SetValueSpecialAccount(); }
        }
        else { SetValueSpecialAccount(); }

        //R19.4 Redcap
        var chkPreSurvey = document.getElementById("chkPreSurvey");
        if (chkPreSurvey.checked == true && ($("#divPreSurveyTimeSlot").find(".color-green").length == 0
            && ($('#CustomerRegisterPanelModel_PreSurveyDate').val() == null || $('#CustomerRegisterPanelModel_PreSurveyDate').val() == "")
            && ($('#CustomerRegisterPanelModel_PreSurveyTimeslot').val() == null || $('#CustomerRegisterPanelModel_PreSurveyTimeslot').val() == "")))
        {
            temp = $("#LanguagePage").val() == "1" ? "กรุณาระบุข้อมูลให้ถูกต้องและครบถ้วน" : "Please Fill In All Required Fields.";
            toastrErrorMessage(temp);
            return;
        }

        ShowFastJobPopup();
    }

    function ShowFastJobPopup() {

        var selectPackageResult = $("input[name=SelectPackage]:checked").val();
        var accessModeResult = $("#ACCESS_MODE" + selectPackageResult).val();
        if ($("#L_EVENT_CODE").val() == ""
            && '@Model.FlowFlag' == 0
            && $("#PlugAndPlayFlow").val() != "Y"
            && $("#L_SplitterFlagFirstTime").val() != "6"
            && $("#L_SplitterFlagFirstTime").val() != "5"
            && ($("#L_SplitterFlagFirstTime").val() != "3" || ($("#L_SplitterFlagFirstTime").val() == "3" && accessModeResult == "FTTH"))
            && ($("#L_SplitterFlagFirstTime").val() != "2" || ($("#L_SplitterFlagFirstTime").val() == "2" && accessModeResult == "FTTH"))) {
            $.ajax({
                url: '/CustomerRegister/IsFastJob',
                data: {
                    AppointmentDate: $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val(),
                    AccessMode: $("#ACCESS_MODE" + $("input[name=SelectPackage]:checked").val()).val(),
                    RegisterFlag: "Y"
                },
                dataType: "json",
                async: false,
                type: 'POST',
                success: function (data) {
                    if (data.Popup == "TRUE") {
                        //L_FAST_JOB_CONTACT
                        $("#CustomerRegisterPanelModel_JOB_ORDER_TYPE").val("U");

                        // 18.8 Update Premium Install
                        // R19.8 Not show modal urgent job officer line same customer line
                        //if ($("#TopUp").val() == "5") {
                        //    $("#modalFastJob").modal();
                        //}
                        //else {
                        //    nextToAddressSetUp();
                        //}

                        nextToAddressSetUp();
                    }
                    else {
                        $("#CustomerRegisterPanelModel_JOB_ORDER_TYPE").val("N");
                        nextToAddressSetUp();
                    }
                }
            });
        }
        else {
            $("#CustomerRegisterPanelModel_JOB_ORDER_TYPE").val("N");
            nextToAddressSetUp();
        }
    }

    function nextToAddressSetUp() {
        if (($("#L_EVENT_CODE").val() != "")) {

            var dtpPeriodDateTH = $("#dtpPeriodDateTH").val();
            var dd = dtpPeriodDateTH.substring('0', '2');
            var MM = dtpPeriodDateTH.substring('3', '5');
            var yyyy = dtpPeriodDateTH.substring('6', '10');
            var year = parseInt(yyyy, 10) + 543;
            var PeriodDateTH = dd + "/" + MM + "/" + year;

            $.ajax({
                url: '/CustomerRegister/GetEventDetail',
                data: {
                    EventCode: $("#L_EVENT_CODE").val().toUpperCase(),
                    DatePeriodTH: PeriodDateTH,
                    DatePeriodEN: $("#dtpPeriodDateEN").val(),
                    IDCardNo: $("#L_CARD_NO").val(),
                    Technology: $("#hdtechnology").val()
                },
                dataType: "json",
                async: false,
                type: 'POST',
                success: function (data) {
                    if (data != null && data != undefined) {

                        if ($("#LanguagePage").val() == "1") {

                            var dtpPeriodDateTH = $("#dtpPeriodDateTH").val();
                            var dd = dtpPeriodDateTH.substring('0', '2');
                            var MM = dtpPeriodDateTH.substring('3', '5');
                            var yyyy = dtpPeriodDateTH.substring('6', '10');
                            var PeriodDateTH = yyyy + "/" + MM + "/" + dd;
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlot').val(data.TIME_SLOT.toString());
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val(PeriodDateTH);
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_InstallationCapacity').val("0/1");
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlotId').val("");
                            $("#CustomerRegisterPanelModel_SUB_LOCATION_ID").val(data.SUB_LOCATION_ID);
                            $("#CustomerRegisterPanelModel_SUB_CONTRACT_NAME").val(data.SUB_CONTRACT_NAME);
                            $("#CustomerRegisterPanelModel_INSTALL_STAFF_ID").val(data.INSTALL_STAFF_ID);
                            $("#CustomerRegisterPanelModel_INSTALL_STAFF_NAME").val(data.INSTALL_STAFF_NAME);
                        }
                        else {
                            var dtpPeriodDateEN = $("#dtpPeriodDateEN").val();
                            var d = dtpPeriodDateEN.substring('0', '2');
                            var M = dtpPeriodDateEN.substring('3', '5');
                            var y = dtpPeriodDateEN.substring('6', '10');
                            var PeriodDateEN = y + "/" + M + "/" + d;
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlot').val(data.TIME_SLOT.toString());
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val(PeriodDateEN);
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_InstallationCapacity').val("0/1");
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlotId').val("");
                            $("#CustomerRegisterPanelModel_SUB_LOCATION_ID").val(data.SUB_LOCATION_ID);
                            $("#CustomerRegisterPanelModel_SUB_CONTRACT_NAME").val(data.SUB_CONTRACT_NAME);
                            $("#CustomerRegisterPanelModel_INSTALL_STAFF_ID").val(data.INSTALL_STAFF_ID);
                            $("#CustomerRegisterPanelModel_INSTALL_STAFF_NAME").val(data.INSTALL_STAFF_NAME);

                        }
                    }
                }
            });
        }

        if ($('#CPE_Serial').val() != "") {
            var CPESerialNo = "";
            var CPEErrorDes = "";
            var CPEStatusDev = "";
            var PBSerialNo = "";
            var PBErrorDes = "";
            var PBStatusDev = "";
            $("#modal003_txtError").find("#txtCPEError").html("");
            $("#modal003_txtError").find("#txtPBError").html("");
            chkRequireField = true;
            var chkErrorCPE = "";
            var chkErrorPB = "";

            $.ajax({
                url: '/CustomerRegister/GetCheckCPE',
                data: {
                    CPECode: $("#CPE_Serial").val().trim(),
                    playbox: $("#PlayBox_Serial").val(),
                    idcardNo: $("#L_CARD_NO").val(),
                    AisAirNumber: sessionStorage.getItem("AisAirNumber")
                },
                dataType: "json",
                async: false,
                type: 'POST',
                success: function (data) {
                    if (data != null || data != undefined) {
                        $.each(data, function (i, e) {
                            //check cpe type error
                            if (e.CPE_TYPE_ERR != "") {
                                if (e.cpe_type == "CPE") {
                                    //toastrErrorMessage(e.CPE_TYPE_ERR);
                                    CPESerialNo = e.SN;
                                    CPEErrorDes = e.Check_Result_Desc;
                                    CPEStatusDev = e.STATUS_DESC;
                                    $("#CPE_Serial").removeClass("form-control").addClass("form-control errorinput");
                                    $("#modal003_txtError").find("#txtCPESerial").html(CPESerialNo);
                                    $("#modal003_txtError").find("#txtCPEError").html(e.CPE_TYPE_ERR);
                                    $("#modal003_txtError").find("#txtCPEStatusDes").html("");
                                    chkErrorCPE = "CPEError";
                                    if (chkErrorPB == "PBError") {
                                        $("#modal003_txtError").find("#PBError").show();
                                    }
                                    else {
                                        $("#modal003_txtError").find("#PBError").hide();
                                    }

                                    $("#modal003_txtError").find("#CPEError").show();

                                    $("#CPE_Serial").removeClass("form-control").addClass("form-control errorinput");


                                }
                                else if (e.cpe_type == "PLAYBOX") {
                                    //toastrErrorMessage(e.CPE_TYPE_ERR);
                                    PBSerialNo = e.SN;
                                    PBErrorDes = e.Check_Result_Desc;
                                    PBStatusDev = e.STATUS_DESC;
                                    $("#PlayBox_Serial").removeClass("form-control").addClass("form-control errorinput");
                                    $("#modal003_txtError").find("#txtPESerial").html(PBSerialNo);
                                    $("#modal003_txtError").find("#txtPBError").html(e.CPE_TYPE_ERR);
                                    $("#modal003_txtError").find("#txtPBStatusDes").html("");
                                    $("#modal003_txtError").find("#PlayBox_Serial").hide();
                                    chkErrorPB = "PBError";
                                    if (chkErrorCPE == "CPEError") {
                                        $("#modal003_txtError").find("#CPEError").show;
                                    }
                                    else {
                                        $("#modal003_txtError").find("#CPEError").hide();
                                    }

                                    $("#modal003_txtError").find("#PBError").show();

                                    $("#PlayBox_Serial").removeClass("form-control").addClass("form-control errorinput");
                                }
                                chkRequireField = false;
                                // chkInstallDate = false;
                                return;
                            }



                            if (e.Check_Result_Code == "0" && e.STATUS_DESC == "Available") {
                                //ให้เก็บค่า CPE type, serial no, MAC ADDRESS ไว้เพื่อส่งให้ workflow และให้ผ่านไปหน้าถัดไปได้
                                if (e.SN == $("#CPE_Serial").val().trim()) {
                                    if (e.CPE_MAC_ADDR == "" || e.CPE_MAC_ADDR == null) {
                                        toastrErrorMessage("ERROR : MAC ADDRESS Not Found");
                                        $("#CPE_Serial").removeClass("form-control").addClass("form-control errorinput");
                                        chkInstallDate = false;
                                    }
                                }

                            }

                            else if ((e.Check_Result_Code == "0" || e.Check_Result_Code == "1" || e.Check_Result_Code == "2") && e.STATUS_DESC != "Available") {
                                chkRequireField = false;

                                //ให้แสดง error เช่น CPE SERIAL NO. XXXXX Error: XXXX จะ config ที่ LOV ให้ แล้วเอาค่ามา replace


                                if (e.SN == $("#CPE_Serial").val().trim()) {
                                    CPESerialNo = e.SN;
                                    CPEErrorDes = e.Check_Result_Desc;
                                    CPEStatusDev = e.STATUS_DESC;
                                    $("#CPE_Serial").removeClass("form-control").addClass("form-control errorinput");
                                    $("#modal003_txtError").find("#txtCPESerial").html(CPESerialNo);
                                    $("#modal003_txtError").find("#txtCPEError").html(CPEErrorDes);
                                    $("#modal003_txtError").find("#txtCPEStatusDes").html(CPEStatusDev);
                                    chkErrorCPE = "CPEError";
                                    if (chkErrorPB == "PBError") {
                                        $("#modal003_txtError").find("#PBError").show();
                                    }
                                    else {
                                        $("#modal003_txtError").find("#PBError").hide();
                                    }

                                    $("#modal003_txtError").find("#CPEError").show();
                                }
                                else if (e.SN == $("#PlayBox_Serial").val().trim()) {
                                    PBSerialNo = e.SN;
                                    PBErrorDes = e.Check_Result_Desc;
                                    PBStatusDev = e.STATUS_DESC;
                                    $("#PlayBox_Serial").removeClass("form-control").addClass("form-control errorinput");
                                    $("#modal003_txtError").find("#txtPESerial").html(PBSerialNo);
                                    $("#modal003_txtError").find("#txtPBError").html(PBErrorDes);
                                    $("#modal003_txtError").find("#txtPBStatusDes").html(PBStatusDev);
                                    $("#modal003_txtError").find("#PlayBox_Serial").hide();
                                    chkErrorPB = "PBError";
                                    if (chkErrorCPE == "CPEError") {
                                        $("#modal003_txtError").find("#CPEError").show;
                                    }
                                    else {
                                        $("#modal003_txtError").find("#CPEError").hide();
                                    }

                                    $("#modal003_txtError").find("#PBError").show();
                                }

                            }
                        });

                        if (chkRequireField == false) {
                            $('#modal003_txtError').modal();
                        }
                        else if (chkInstallDate) {
                            if (data != null || data != undefined) {
                                var div = $("#DIV_CPE_INFO");
                                div.empty();

                                var strDataValue = "";
                                $.each(data, function (i, e) {
                                    div.append('<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].cpe_type" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__cpe_type" value="' + e.cpe_type + '" />');
                                    div.append('<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].SN" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__SN" value="' + e.SN + '" />');
                                    div.append('<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].CPE_MAC_ADDR" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__CPE_MAC_ADDR" value="' + e.CPE_MAC_ADDR + '" />');
                                    //strDataValue += '<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].cpe_type" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__cpe_type" value="' + e.cpe_type + '" />'
                                    //strDataValue += '<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].SN" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__SN" value="' + e.SN + '" />'
                                    //strDataValue += '<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].CPE_MAC_ADDR" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__CPE_MAC_ADDR" value="' + e.CPE_MAC_ADDR + '" />'

                                    //R20.4
                                    div.append('<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].STATUS_DESC" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__STATUS_DESC" value="' + e.STATUS_DESC + '" />');
                                    div.append('<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].CPE_MODEL_NAME" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__CPE_MODEL_NAME" value="' + e.CPE_MODEL_NAME + '" />');
                                    div.append('<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].CPE_COMPANY_CODE" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__CPE_COMPANY_CODE" value="' + e.CPE_COMPANY_CODE + '" />');
                                    div.append('<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].CPE_PLANT" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__CPE_PLANT" value="' + e.CPE_PLANT + '" />');
                                    div.append('<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].CPE_STORAGE_LOCATION" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__CPE_STORAGE_LOCATION" value="' + e.CPE_STORAGE_LOCATION + '" />');
                                    div.append('<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].CPE_MATERIAL_CODE" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__CPE_MATERIAL_CODE" value="' + e.CPE_MATERIAL_CODE + '" />');
                                    div.append('<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].REGISTER_DATE" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__REGISTER_DATE" value="' + e.REGISTER_DATE + '" />');
                                    div.append('<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].FIBRENET_ID" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__FIBRENET_ID" value="' + e.FIBRENET_ID + '" />');
                                    div.append('<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].SN_PATTERN" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__SN_PATTERN" value="' + e.SN_PATTERN + '" />');
                                    div.append('<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].SHIP_TO" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__SHIP_TO" value="' + e.SHIP_TO + '" />');
                                    div.append('<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].WARRANTY_START_DATE" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__WARRANTY_START_DATE" value="' + e.WARRANTY_START_DATE + '" />');
                                    div.append('<input type="hidden" name="CustomerRegisterPanelModel.CPE_Info[' + i + '].WARRANTY_END_DATE" id ="CustomerRegisterPanelModel_CPE_Info_' + i + '__WARRANTY_END_DATE" value="' + e.WARRANTY_END_DATE + '" />');

                                });

                                // $("#DIV_CPE_INFO").replaceWith(strDataValue);

                            }
                        }

                    }

                }
            });
        }

        if (chkRequireField && chkInstallDate) {
            var typeUser = $('#HdFunctionSubProduct').val(); //FBB,AIR
            var typeHabitat = $('input[name="R_BUILD"]:checked').val();

            if (typeUser == "SWiFi") {
                if (typeHabitat == "CONDOMINIUM") {
                    setCondoModel();
                }
                else if (typeHabitat == "VILLAGE") {
                    setHouseModel();
                }
                else {
                    setHouseModel();
                }
            }

            $('#CustomerRegisterPanelModel_L_CARD_NO').val($("#L_CARD_NO").val());
            $('#CustomerRegisterPanelModel_L_MOBILE').val($("#L_MOBILE").val());

            //BirthDate
            var day = $("#ddlDay :selected").val().length != 2 ? "0" + $("#ddlDay :selected").val() : $("#ddlDay :selected").val();
            var month = $("#ddlMonth :selected").val().length != 2 ? "0" + $("#ddlMonth :selected").val() : $("#ddlMonth :selected").val();
            $('#L_BIRTHDAY').val(day + "/" + month + "/" + $("#ddlYear :selected").val());

            copyAddressCoverageTo("Setup");
            setDocType();
            setHomePhone();
            reserveTimeSlot();

            var checkBlack = true;
            if ($('#ID_CARD_NAME :selected').val() == "ID_CARD") {
                $.ajax({
                    url: '/CustomerRegister/CheckBlackList',
                    data: { idcardNo: $("#L_CARD_NO").val() },
                    dataType: "json",
                    async: false,
                    type: 'POST',
                    success: function (response) {

                        if (response.ErrorMessage) {
                            if ('@SHOW_POPUP_BLACKLIST' == "Y") {
                                checkBlack = false;
                                $('#modalBlackList').modal();
                                $("#BlackListdetail").show();
                            }
                            //alert(response.ErrorMessage);
                            //alert("1" + response.returnFlag);
                        }
                        if (!response.ErrorMessage) {
                            if (response.returnFlag != "N" && response.returnFlag != "I" && response.returnFlag != "O") {
                                if ('@SHOW_POPUP_BLACKLIST' == "Y") {
                                    checkBlack = false;
                                    $('#modalBlackList').modal();
                                    $("#BlackListdetail").show();
                                    //alert(response.ErrorMessage);
                                    //alert("2" + response.returnFlag);
                                }
                            }
                            //else {/// not blacklist
                            //    alert(response.ErrorMessage);
                            //alert("3" + response.returnFlag);
                            //}
                        }
                    }
                });
            }

            if (checkBlack) {
                $('#CustomerRegisterPanelModel_L_LOC_CODE').val($('#L_LOC_CODE').val());
                nextToBeforeAddressSetUp();
                if ($("#hdFlagUploadImage").val() != "Y") {
                    UploadImage();
                }
            }

        }
    }

    function reserveTimeSlot() {

        var result = false;
        $.ajax({
            type: "GET",
            url: "/CustomerRegister/ReserveTimeSlot",
            data: { 'transactionGuid': $("#hdTransactionGuid").val(), 'timeSlotId': $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlotId').val() },
            dataType: "json",
            async: false,
            success: function (data) {
                if (data != null && data != undefined) {
                    if (data.Return_Code == "1")
                        result = true;
                }
            }
        });

        return result;
    }

    $('#L_EVENT_CODE').focusout(function (event) {

        if ($("#L_EVENT_CODE").val().trim() != "") {
            // 18.6 By value remove space
            $("#L_EVENT_CODE").val($("#L_EVENT_CODE").val().trim());
            getCheckEventCode();
        }
        else {
            var dataCount = $("#dataCount").val();
            var dataNull = $("#dataNull").val();
            var dataError = $("#dataError").val();
            //if (dataCount != "-1") {
            $('#chkEventCode').prop('disabled', false);


            if (dataCount != "-1" || dataNull != "-1" || dataError != "-1") {// no timeslot
                $("#divPeriodDate").hide();
                $('#chkEventCode').prop('checked', false);
                $('#CPE_Serial').prop('disabled', true);
                $('#PlayBox_Serial').prop('disabled', true);
                $('#CPE_Serial').val("");
                $('#PlayBox_Serial').val("");
                // $('#L_INSTALL_DATE').val() =
                if ($("#LanguagePage").val() == "1") {
                    var dtpInstallDateTH = $("#dtpInstallDateTH").val();
                    var dd = dtpInstallDateTH.substring('0', '2');
                    var MM = dtpInstallDateTH.substring('3', '5');
                    var yyyy = dtpInstallDateTH.substring('6', '10');
                    var year = parseInt(yyyy);
                    var PeriodDateTH = year + "/" + MM + "/" + dd;
                    var InstallDateTH = dd + "/" + MM + "/" + year;

                    $('#L_INSTALL_DATE').val(InstallDateTH);
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlot').val("08:00-10:00");
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val(PeriodDateTH);
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_InstallationCapacity').val("0/1");

                    $("#CustomerRegisterPanelModel_SUB_LOCATION_ID").val("");
                    $("#CustomerRegisterPanelModel_SUB_CONTRACT_NAME").val("");
                    $("#CustomerRegisterPanelModel_INSTALL_STAFF_ID").val("");
                    $("#CustomerRegisterPanelModel_INSTALL_STAFF_NAME").val("");
                    $('#checkEventCode').val("true");
                }
                else {

                    var dtpInstallDateEN = $("#dtpInstallDateEN").val();
                    var d = dtpInstallDateEN.substring('0', '2');
                    var M = dtpInstallDateEN.substring('3', '5');
                    var y = dtpInstallDateEN.substring('6', '10');
                    var PeriodDateEN = y + "/" + M + "/" + d;
                    var InstallDateEN = d + "/" + M + "/" + y;

                    $('#L_INSTALL_DATE').val(InstallDateEN);
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlot').val("08:00-10:00");
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val(PeriodDateEN);
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_InstallationCapacity').val("0/1");

                    $("#CustomerRegisterPanelModel_SUB_LOCATION_ID").val("");
                    $("#CustomerRegisterPanelModel_SUB_CONTRACT_NAME").val("");
                    $("#CustomerRegisterPanelModel_INSTALL_STAFF_ID").val("");
                    $("#CustomerRegisterPanelModel_INSTALL_STAFF_NAME").val("");
                }

            }
            else {
                $('#L_INSTALL_DATE').val("");
                $("#L_EVENT_CODE").val("");
                $("#divPeriodDate").hide();

                //$('#CPE_Serial').prop('disabled', true);
                //$('#PlayBox_Serial').prop('disabled', true);
                //$('#CPE_Serial').val("");
                //$('#PlayBox_Serial').val("");
                $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val("");
                $('#CustomerRegisterPanelModel_FBSSTimeSlot_InstallationCapacity').val("");
                $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlot').val("");
                $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlotId').val("");
                $("#CustomerRegisterPanelModel_SUB_LOCATION_ID").val("");
                $("#CustomerRegisterPanelModel_SUB_CONTRACT_NAME").val("");
                $("#CustomerRegisterPanelModel_INSTALL_STAFF_ID").val("");
                $("#CustomerRegisterPanelModel_INSTALL_STAFF_NAME").val("");
                $("#L_EVENT_CODE").removeClass("form-control errorinput").addClass("form-control");
                $('#checkEventCode').val("true");
                onDayItemClick(this, "divTimeSlot");
            }
        }
    });

    var plag_and_play = "";

    function getCheckEventCode() {
        $.ajax({
            type: "GET",
            url: "/CustomerRegister/GetCheckEventCode",
            data: { 'event_Code': $("#L_EVENT_CODE").val().toUpperCase() },
            dataType: "json",
            async: false,
            success: function (data) {
                $("#dtpPeriodDateTH").val("");
                $("#dtpPeriodDateEN").val("");
                if (data.eventCode == undefined || data.eventCode == "undefined") {
                    $("#L_EVENT_CODE").removeClass("form-control").addClass("form-control errorinput");
                    $('#checkEventCode').val("false");
                    $('#dtpPeriodDateTH').val("");
                    $('#dtpPeriodDateEN').val("");
                    $('#L_INSTALL_DATE').val("");
                    $('#divPeriodDate').hide();
                    onDayItemClick(this, "divTimeSlot");


                    //$('#chkEventCode').prop('disabled', true);
                    //$('#CPE_Serial').prop('disabled', true);
                    //$('#PlayBox_Serial').prop('disabled', true);
                    //$('#CPE_Serial').val("");
                    //$('#PlayBox_Serial').val("");

                    $("#iconBarcode_CPE").hide();
                    $("#iconBarcode_PB").hide();
                    $("#interactive").hide();

                    if ($("#LanguagePage").val() == "1") {

                        temp = "กรุณาระบุข้อมูลให้ถูกต้องและครบถ้วน";
                    }
                    else {
                        temp = "Please Fill In All Required Fields.";
                    }
                    toastrErrorMessage(temp);
                }
                else {
                    $('#divPeriodDate').show();
                    $("#L_EVENT_CODE").removeClass("form-control errorinput").addClass("form-control");
                    $("#CPE_Serial").removeClass("form-control errorinput ").addClass("form-control");
                    $("#PlayBox_Serial").removeClass("form-control errorinput ").addClass("form-control");
                    $('#checkEventCode').val("true");
                    var technology = data.technology;
                    $("#hdtechnology").val(technology);

                    var effective_dateEN = data.EFFECTIVE_DATE_EN1;
                    var expire_dateEN = data.EXPIRE_DATE_EN;
                    var effective_dateTH = data.EFFECTIVE_DATE_TH1;
                    var expire_dateTH = data.EXPIRE_DATE_TH;
                    var DefaultDateEN = data.EFFECTIVE_DATE_EN2;
                    var DefaultDateTH = data.EFFECTIVE_DATE_TH2;

                    if (expire_dateEN == '0001/01/01') {
                        if ($("#LanguagePage").val() == "1") {
                            $('#dtpPeriodDateTH').datetimepicker({
                                format: 'd/m/Y',
                                lang: "th",
                                timepicker: false,
                                closeOnDateSelect: true,
                                autoclose: true,
                                onSelectDate: function (ct, $i) {
                                    var ctEN = convertToThaiDate($('#dtpPeriodDateTH').val());
                                    $("#dtpPeriodDateTH_text").val(ctEN);
                                },
                                minDate: effective_dateEN,
                                value: DefaultDateEN
                            });
                            $("#dtpPeriodDateTH_text").val(convertToThaiDate($('#dtpPeriodDateTH').val()));
                            $("#dtpPeriodDateTH_text").click(function () {
                                $("#dtpPeriodDateTH").trigger('open.xdsoft');
                            });

                        }
                        else {
                            $('#dtpPeriodDateEN').datetimepicker({
                                format: 'd/m/Y',
                                yearOffset: 0,
                                lang: 'en',
                                timepicker: false,
                                closeOnDateSelect: true,
                                autoclose: true,
                                minDate: effective_dateEN,
                                value: DefaultDateEN
                            });
                        }
                    }
                    else {
                        if ($("#LanguagePage").val() == "1") {
                            $('#dtpPeriodDateTH').datetimepicker({
                                format: 'd/m/Y',
                                lang: "th",
                                timepicker: false,
                                autoclose: true,
                                closeOnDateSelect: true,
                                onSelectDate: function (ct, $i) {
                                    var ctEN = convertToThaiDate($('#dtpPeriodDateTH').val());
                                    $("#dtpPeriodDateTH_text").val(ctEN);
                                },
                                minDate: effective_dateEN,
                                maxDate: expire_dateEN,
                                value: DefaultDateEN
                            });
                            $("#dtpPeriodDateTH_text").val(convertToThaiDate($('#dtpPeriodDateTH').val()));
                            $("#dtpPeriodDateTH_text").click(function () {
                                $("#dtpPeriodDateTH").trigger('open.xdsoft');
                            });

                        }
                        else {
                            $('#dtpPeriodDateEN').datetimepicker({
                                format: 'd/m/Y',
                                yearOffset: 0,
                                lang: "en",
                                timepicker: false,
                                closeOnDateSelect: true,
                                autoclose: true,
                                minDate: effective_dateEN,
                                maxDate: expire_dateEN,
                                value: DefaultDateEN
                            });
                        }
                    }

                    //update 16.04
                    plag_and_play = data.plug_and_play_flag.toUpperCase();
                    $('#CustomerRegisterPanelModel_Plug_and_play_flag').val(plag_and_play);
                    var playbox = $('#hdGetPlayBox').val();
                    if (plag_and_play == "Y") {
                        $('#chkEventCode').prop('disabled', false);
                        if (playbox == "1") { //playbox = ‘Y’
                            //$('#CPE_Serial').show();
                            $('#PlayBox_Serial').show();

                            $("#iconBarcode_CPE").show();
                            $("#iconBarcode_PB").show();

                            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                                // some code..
                                $("#iconBarcode_CPE").show();
                                $("#iconBarcode_PB").show();
                            }
                            else {
                                $("#iconBarcode_CPE").hide();
                                $("#iconBarcode_PB").hide();

                            }


                            if (typeof aisNative != "undefined" && typeof aisNative != "" && typeof aisNative != null) {
                                //On Mobile
                                $("#iconBarcode_CPE").hide();
                                $("#iconBarcode_PB").hide();
                                $("#interactive").hide();
                            }
                        }
                        else if (playbox == "0") { //playbox = ‘N’
                            //$('#CPE_Serial').show();

                            $('#PlayBox_Serial').hide();

                            $("#iconBarcode_CPE").show();

                            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                                // some code..
                                $("#iconBarcode_CPE").show();
                                $("#iconBarcode_PB").hide();
                            }
                            else {
                                $("#iconBarcode_CPE").hide();
                                $("#iconBarcode_PB").hide();
                                $("#interactive").hide();

                            }


                            if (typeof aisNative != "undefined" && typeof aisNative != "" && typeof aisNative != null) {
                                //On Mobile
                                $("#iconBarcode_CPE").hide();
                                $("#interactive").hide();
                            }

                        }
                    }
                    else {

                        $('#chkEventCode').prop('disabled', true);
                        $('#chkEventCode').prop('checked', false);
                        $('#CPE_Serial').prop('disabled', true);
                        $('#PlayBox_Serial').prop('disabled', true);
                        $('#CPE_Serial').val("");
                        $('#PlayBox_Serial').val("");


                        $("#iconBarcode_CPE").hide();
                        $("#iconBarcode_PB").hide();
                        $("#interactive").hide();
                    }

                }

            }
        });
    }

    function ScanCPE() {
        if (isElementReadOnly("#CPE_Serial")) {
            return false;
        }

        isPB = false;
        isCPE = true;

        if (isAisNative()) {
            aisNative.scanBarcode();
        } else {
            ScanBarCode();
        }
    }

    function ScanPB() {
        if (isElementReadOnly("#PlayBox_Serial")) {
            return false;
        }

        isPB = true;
        isCPE = false;

        if (isAisNative()) {
            aisNative.scanBarcode();
        } else {
            ScanBarCode();
        }
    }

    var isPB = false;
    var isCPE = false;

    function ScanBarCode() {
        var CodeScan = Code_ScanBarcode();
        console.log(CodeScan);
        $("#interactive").show();

        if (!console) console = { log: function () { } };

        var BarCodeApp = {
            init: function () {
                console.log(this.state);
                Quagga.init(this.state, function (err) {
                    if (err) {
                        console.log(err);
                        return;
                    }
                    Quagga.start();
                });
            },

            state: JSON.parse(CodeScan),

            //state: {
            //    inputStream: {
            //    type:"LiveStream",
            //    constraints: {
            //        width: 200,
            //        height: 100,
            //        //facingMode: "environment"
            //    }
            //},
            //    locator: {
            //        Resolution: "1920px",
            //        patchSize: "x-large",
            //        halfSample: true
            //    },
            //    numOfWorkers: 1,
            //    decoder: { readers: ["code_128_reader"] },
            //    locate: true
            //}

            lastResult: null
        };

        BarCodeApp.init();

        Quagga.onProcessed(function (result) {
            var drawingCtx = Quagga.canvas.ctx.overlay,
                drawingCanvas = Quagga.canvas.dom.overlay;

            if (result) {
                if (result.boxes) {
                    drawingCtx.clearRect(0, 0, parseInt(drawingCanvas.getAttribute("width")), parseInt(drawingCanvas.getAttribute("height")));
                    result.boxes.filter(function (box) {
                        return box !== result.box;
                    }).forEach(function (box) {
                        Quagga.ImageDebug.drawPath(box, { x: 0, y: 1 }, drawingCtx, { color: "green", lineWidth: 2 });
                    });
                }

                if (result.box) {
                    Quagga.ImageDebug.drawPath(result.box, { x: 0, y: 1 }, drawingCtx, { color: "#00F", lineWidth: 2 });
                }

                if (result.codeResult && result.codeResult.code) {
                    Quagga.ImageDebug.drawPath(result.line, { x: 'x', y: 'y' }, drawingCtx, { color: 'red', lineWidth: 3 });
                }
            }
        });


        Quagga.onDetected(function (result) {
            var code = result.codeResult.code;

            if (BarCodeApp.lastResult !== code) {
                BarCodeApp.lastResult = code;
                var $node = null, canvas = Quagga.canvas.dom.image;

                //$node = $('<li><div class="thumbnail"><div class="imgWrapper"><img /></div><div class="caption"><h4 class="code"></h4></div></div></li>');
                //$node.find("img").attr("src", canvas.toDataURL());
                //$node.find("h4.code").html(code);
                //$("#result_strip ul.thumbnails").prepend($node);

                if (isCPE == true) {
                    $("#CPE_Serial").val(code);
                }
                else if (isPB == true) {
                    $("#PlayBox_Serial").val(code);
                }
            }
        });


    }

    function Code_ScanBarcode() {
        var CodeScan = "";
        $.ajax({
            type: "GET",
            url: "/CustomerRegister/Get_ScanBarcode",
            dataType: "json",
            async: false,
            success: function (data) {

                if (data != null && data != undefined) {
                    CodeScan = data;
                }
            }
        });

        return CodeScan;
    }

    function setHomePhone() {

        var phone = $("#txtHomePhone").val();
        var phoneTo = $("#txtHomePhoneTo").val();
        var result = "";

        if (phone != "" && phoneTo != "")
            result = phone + " Ext." + phoneTo;
        else if (phone != "" && phoneTo == "")
            result = phone;
        else if (phone == "" && phoneTo != "")
            result = "Ext." + phoneTo;

        $("#L_HOME_PHONE").val(result);
    }

    function validateMobilePhone(phone) {
        //var filter = /^[0-9]{10}$/;
        var filter = new RegExp("^[0-9]{" + "@FBB_Con_MobileLength" + "}$");
        if (filter.test(phone)) {
            return true;
        }
        else {
            return false;
        }
    }

    function isDate(txtDate) {
        var currVal = txtDate;
        if (currVal == '')
            return false;

        //Declare Regex
        var rxDatePattern = /^(\d{1,2})(\/|-)(\d{1,2})(\/|-)(\d{4})$/;
        var dtArray = currVal.match(rxDatePattern); // is format OK?

        if (dtArray == null)
            return false;

        //Checks for dd/mm/yyyy format.
        dtDay = dtArray[1];
        dtMonth = dtArray[3];
        dtYear = dtArray[5];

        if (dtMonth < 1 || dtMonth > 12)
            return false;
        else if (dtDay < 1 || dtDay > 31)
            return false;
        else if ((dtMonth == 4 || dtMonth == 6 || dtMonth == 9 || dtMonth == 11) && dtDay == 31)
            return false;
        else if (dtMonth == 2) {
            var isleap = (dtYear % 4 == 0 && (dtYear % 100 != 0 || dtYear % 400 == 0));
            if (dtDay > 29 || (dtDay == 29 && !isleap))
                return false;
        }
        return true;
    }

    function setInstallDate() {
        if ($("#LanguagePage").val() == "1") {
            $("#divEnDatePicker").hide();
            $("#divThDatePicker").show();

            $("#divEnDatePeriod").hide();
            $("#divThDatePeriod").show();
        }
        else {
            $("#divThDatePicker").hide();
            $("#divEnDatePicker").show();

            $("#divThDatePeriod").hide();
            $("#divEnDatePeriod").show();
        }
    }

    function setSpecialExpireDate() {
        if ($('#TopUp').val() == "5" && "@flagspecialaccountresult" == "Y")
        {
            if ($("#LanguagePage").val() == "1") {
                $("#divEnSpecialExpireDatePicker").hide();
                $("#divThSpecialExpireDatePicker").show();
            }
            else {
                $("#divThSpecialExpireDatePicker").hide();
                $("#divEnSpecialExpireDatePicker").show();
            }

            var defaultDateSpecialAcc = new Date(parseInt(@DateTime.Now.Year), parseInt(@DateTime.Now.Month) - 1, parseInt(@DateTime.Now.Day) + 1);
            var month = defaultDateSpecialAcc.getMonth() + 1;
            var day = defaultDateSpecialAcc.getDate();

            var minDateEN = defaultDateSpecialAcc.getFullYear() + '/' + (month < 10 ? '0' : '') + month + '/' + (day < 10 ? '0' : '') + day;

            var currentDateEN = (day < 10 ? '0' : '') + day + '/' + (month < 10 ? '0' : '') + month + '/' + defaultDateSpecialAcc.getFullYear();

            $('#dtpSpecialExpireDateTH').datetimepicker({
                onGenerate: function (ct) {
                    jQuery(this).find('.xdsoft_disabled')
                      .toggleClass('xdsoft_date');
                },
                onSelectDate: function (ct, $i) {
                    var ctTh = convertToThaiDate($('#dtpSpecialExpireDateTH').val());
                    $("#dtpSpecialExpireDateTH_text").val(ctTh);
                },
                minDate: minDateEN,
                currentDate: minDateEN
            });

            $("#dtpSpecialExpireDateTH_text").click(function () {
                $("#dtpSpecialExpireDateTH").trigger('open.xdsoft');
            });

            $('#dtpSpecialExpireDateEN').datetimepicker({
                onGenerate: function (ct) {
                    jQuery(this).find('.xdsoft_disabled')
                      .toggleClass('xdsoft_date');
                },
                onSelectDate: function (ct, $i) {
                    var ctEN = $('#dtpSpecialExpireDateEN').val();
                    $("#dtpSpecialExpireDateTH_text").val(ctEN);
                },
                minDate: minDateEN,
                currentDate: minDateEN
            });
        }
    }

    function SetValueSpecialAccount() {
        if ($('#TopUp').val() == "5" && "@flagspecialaccountresult" == "Y") {
            var SpecialExpireDate = "";
            if ($("#dtpSpecialExpireDateTH_text").val() != "") {
                var d = $("#dtpSpecialExpireDateTH_text").val().split('/');
                SpecialExpireDate = $("#LanguagePage").val() == "1" ? d[0].toString() + '/' + d[1].toString() + '/' + (parseInt(d[2]) - 543).toString() : $("#dtpSpecialExpireDateTH_text").val();
            }
            $("#CustomerRegisterPanelModel_SpecialAccountName").val($("#L_NAME_SPECIAL_ACCOUNT").val());
            $("#CustomerRegisterPanelModel_SpecialAccountNo").val($("#L_NO_SPECIAL_ACCOUNT").val());
            $("#CustomerRegisterPanelModel_SpecialAccountEnddate").val(SpecialExpireDate);
            $("#CustomerRegisterPanelModel_SpecialAccountGroupEmail").val($("#ddlGroupMailSpecialAccount").val());
            $("#CustomerRegisterPanelModel_SpecialAccountFlag").val("@flagspecialaccountresult");

            $("#L_NAME_SPECIAL_ACCOUNT").removeClass("form-control errorinput ").addClass("form-control");
            $("#L_NO_SPECIAL_ACCOUNT").removeClass("form-control errorinput ").addClass("form-control");
            $("#dtpSpecialExpireDateTH_text").removeClass("form-control errorinput ").addClass("form-control");
        }
        else {
            $("#CustomerRegisterPanelModel_SpecialAccountName").val("");
            $("#CustomerRegisterPanelModel_SpecialAccountNo").val("");
            $("#CustomerRegisterPanelModel_SpecialAccountEnddate").val("");
            $("#CustomerRegisterPanelModel_SpecialAccountGroupEmail").val("");
            $("#CustomerRegisterPanelModel_SpecialAccountFlag").val("@flagspecialaccountresult");
        }
    }

    var isLimitAge = false;
    var compoundYear = 0;
    var sameMonth = false;
    var sameYear = false;

    function setBirthDate() {
        var yearIsPS = false;
        var daySelect = $('#ddlDay :selected').val();
        var monthSelect = $('#ddlMonth :selected').val();
        var yearSelect = $('#ddlYear :selected').val();

        var yearvalue = parseInt(yearSelect);
        if (yearvalue > 2400) {
            yearvalue = yearvalue - 543;
        }

        var numOfDay = chkNumOfDay(daySelect, monthSelect, yearvalue);

        $('#ddlDay').empty();
        $('#ddlMonth').empty();
        $('#ddlYear').empty();

        $('#ddlMonth').append(getMonth(monthSelect, "@lMONTH_OF_BIRTH", 1, 12, true, true));
        $('#ddlYear').append(getYear(yearSelect, "@lYEAR_OF_BIRTH", parseInt("@FBB_Con_YearLimitHigh", 10), parseInt("@FBB_Con_YearLimitLow", 10), true, true));
        $('#ddlDay').append(getDay(daySelect, "@lDATE_OF_BIRTH", 1, numOfDay, true, true));

        //console.log("isLimitAge: ", isLimitAge);

        $('#ddlDay').select2();
        $('#ddlMonth').select2();
        $('#ddlYear').select2();
    }

    function setDefaultYearBirthDate() {
        var defaultdllYear = parseInt(@DateTime.Now.Year) - parseInt("@FBB_Con_YearLimitLow", 10);
        if ($("#LanguagePage").val() == "1") defaultdllYear += 543;
        //Line Register , Officer
        if ($('#TopUp').val() != "1") {
            if ($('#ddlYear').val() == "") $('#ddlYear').val(defaultdllYear.toString()).trigger('change');
        }
    }

    function chkNumOfDay(daySelect, monthSelect, yearSelect) {
        var numOfDay = 0;

        if (monthSelect == "2") {
            if (yearSelect != "" && yearSelect != undefined) {
                var isleap = (yearSelect % 4 == 0 && (yearSelect % 100 != 0 || yearSelect % 400 == 0));
                if (isleap == false) {
                    numOfDay = 28;
                }
                else {
                    numOfDay = 29;
                }
            }
            else {
                numOfDay = 29;
            }
        }
        else if (monthSelect == "4" || monthSelect == "6" || monthSelect == "9" || monthSelect == "11") {
            numOfDay = 30;
        }
        else {
            numOfDay = 31;
        }

        return numOfDay;
    }

    function getYear(yearSelect, label, yearLimitLow, yearLimitHigh, defaultFromSFF, disableFirstRow) {
        var currentYear = new Date(parseInt(@DateTime.Now.Year), parseInt(@DateTime.Now.Month) - 1, parseInt(@DateTime.Now.Day)).getFullYear();

        //console.log("currentYear: ", currentYear);
        //console.log("yearSelect:", yearSelect);

        if ($("#LanguagePage").val() == "1")
            currentYear += 543;

        if ($("#dayBirthdyear").val() != '') {
            yearSelect = $("#dayBirthdyear").val();
        }
        $("#dayBirthdyear").val('');

        isLimitAge = false;
        sameYear = false;
        if (currentYear - (parseInt(yearSelect) - compoundYear) < yearLimitHigh)
            isLimitAge = true;
        else if (currentYear - (parseInt(yearSelect) - compoundYear) == yearLimitHigh)
            sameYear = true;

        var limitLowYear = currentYear - yearLimitLow;
        var limitHighYear = currentYear - yearLimitHigh;

        var strBuilder = "";

        if (yearSelect == undefined || yearSelect == "") {
            if (disableFirstRow) {
                strBuilder = "<option value='' disabled selected >" + label + "</option>";
            }
            else {
                strBuilder = "<option value='' selected >" + label + "</option>";
            }
        }

        for (var i = limitLowYear; i <= limitHighYear ; i++) {
            if ((i == $("#tYY").val() && defaultFromSFF == true) || i == yearSelect)
                strBuilder += "<option value='" + i + "' selected>" + i + "</option>";
            else
                strBuilder += "<option value='" + i + "' >" + i + "</option>";
        }

        return strBuilder;
    }

    function getMonth(monthSelect, label, monthLimitLow, monthLimitHigh, defaultFromSFF, disableFirstRow) {

        var currentMonth = new Date(parseInt(@DateTime.Now.Year), parseInt(@DateTime.Now.Month) - 1, parseInt(@DateTime.Now.Day)).getMonth();

        var strBuilder = "";

        if ($("#dayBirthMonth").val() != '') {
            monthSelect = $("#dayBirthMonth").val();
        }
        $("#dayBirthMonth").val('');

        compoundYear = 0;
        sameMonth = false;
        currentMonth++;
        if (currentMonth - parseInt(monthSelect) < 0) {
            compoundYear--;
        }
        else if (currentMonth - parseInt(monthSelect) == 0)
            sameMonth = true;
        if (monthSelect == undefined || monthSelect == "") {
            if (disableFirstRow) {
                strBuilder = "<option value='' disabled selected >" + label + "</option>";
            }
            else {
                strBuilder = "<option value='' selected >" + label + "</option>";
            }
        }
        var arrayMonth;

        if ($("#LanguagePage").val() == "1") {

            arrayMonth = ["มกราคม", "กุมภาพันธ์", "มีนาคม", "เมษายน", "พฤษภาคม", "มิถุนายน", "กรกฎาคม", "สิงหาคม", "กันยายน", "ตุลาคม", "พฤศจิกายน", "ธันวาคม"];
        }
        else {
            arrayMonth = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
        }

        monthLimitLow--;
        monthLimitHigh--;

        for (var i = monthLimitLow; i <= monthLimitHigh; i++) {
            var value = i + 1;
            if (value == $("#tMM").val() && defaultFromSFF == true) {
                strBuilder += "<option value='" + value + "' selected>" + arrayMonth[i] + "</option>";
                $("#tMM").val("");
            }
            else if (value == monthSelect)
                strBuilder += "<option value='" + value + "' selected>" + arrayMonth[i] + "</option>";
            else
                strBuilder += "<option value='" + value + "' >" + arrayMonth[i] + "</option>";
        }

        return strBuilder;
    }

    function getDay(daySelect, label, dayLimitLow, dayLimitHigh, defaultFromSFF, disableFirstRow) {
        var strBuilder = "";

        var currentDay = new Date(parseInt(@DateTime.Now.Year), parseInt(@DateTime.Now.Month) - 1, parseInt(@DateTime.Now.Day)).getDate();


        if ($("#dayBirthdate").val() != '') {
            daySelect = $("#dayBirthdate").val();
        }
        $("#dayBirthdate").val('');

        if (sameYear && sameMonth) {
            isLimitAge = false;
            if (currentDay - parseInt(daySelect) < 0)
                isLimitAge = true;
        }

        if (daySelect == undefined || daySelect == "") {
            if (disableFirstRow) {
                strBuilder = "<option value='' disabled selected >" + label + "</option>";
            }
            else {
                strBuilder = "<option value='' selected >" + label + "</option>";
            }
        }

        for (var i = dayLimitLow; i <= dayLimitHigh; i++) {
            if ($("#tDD").val() == i && defaultFromSFF == true) {
                strBuilder += "<option value='" + i + "' selected>" + i + "</option>";
                $("#tDD").val("");
            }
            else if (daySelect == i)
                strBuilder += "<option value='" + i + "' selected>" + i + "</option>";
            else
                strBuilder += "<option value='" + i + "' >" + i + "</option>";
        }

        return strBuilder;
    }

    function validateBirthDay(date) {
        return true;
    }

    function validateIdCard(idCardNo) {
        var idcard = idCardNo;
        var firstIdCard = idcard.substr(0, 1);
        var flagResult = true;

        if (firstIdCard == "1") {
            if (idcard == "@FBB_Exc_1") {
                return true;
            }
        }
        else {
            if (firstIdCard.toUpperCase() == "@FBB_Exc_D".substr(0, 1).toUpperCase() || firstIdCard.toUpperCase() == "@FBB_Exc_F".substr(0, 1).toUpperCase() || firstIdCard.toUpperCase() == "@FBB_Exc_I".substr(0, 1).toUpperCase() || firstIdCard.toUpperCase() == "@FBB_Exc_S".substr(0, 1).toUpperCase()) {
                return true;
            }
        }

        if (flagResult == true) {
            if ($('#ID_CARD_NAME :selected').val() == "HILL_CARD") {
                if (idcard.length != parseInt("@FBB_Con_LengthIDCardNumberHILL_CARD", 10)) {
                    flagResult = false;
                }
                else {
                    flagResult = true;
                }
            }
            else if ($('#ID_CARD_NAME :selected').val() == "IMM_CARD") {
                if (idcard.length != parseInt("@FBB_Con_LengthIDCardNumberIMM_CARD", 10)) {
                    flagResult = false;
                }
                else {
                    flagResult = true;
                }
            }
            else if ($('#ID_CARD_NAME :selected').val() == "ID_CARD") {
                if (idcard.length != parseInt("@FBB_Con_LengthIDCardNumberID_CARD", 10)) {
                    flagResult = false;
                }
                else {
                    flagResult = checkIdCard(idcard);
                }
            }
                @*else if ($('#ID_CARD_NAME :selected').val() == "TAX_ID") {
                if (idcard.length != parseInt("@FBB_Con_Length_ID_Card_Number_TAX_ID", 10)) {
                    flagResult = false;
                }
                else {
                    flagResult = true;
                }
            }*@
            else if ($('#ID_CARD_NAME :selected').val() == "MONK_CERT") {
                if (idcard.length != parseInt("@FBB_Con_LengthIDCardNumberMONK_CERT", 10)) {
                    flagResult = false;
                }
                else {
                    flagResult = checkIdCard(idcard);
                }
            }
        }

        return flagResult;
    }

    function backToRegisterfromDUpOrder() {
        if (fromMakeFace) {
            $("#textImage").val($("#hdtextImagename").val());
        }
        ChkImagefile();
        if ($("#chk_count_order").val() != "0") {
            $("#divAddressSetUp").hide();
            $("#divOrderDup").hide();
            $("#divRegisterInfo").show();
        }
        else {

            $("#divAddressSetUp").hide();
            $("#divOrderDup").hide();
            $("#divRegisterInfo").show();
        }
        $("#CPE_Serial").removeClass("form-control errorinput ").addClass("form-control");
        $("#PlayBox_Serial").removeClass("form-control errorinput ").addClass("form-control");
    }

    function backToRegisterfromAddessSetdup() {
        if ($("#chk_count_order").val() != "0") {
            $("#divAddressSetUp").hide();
            $("#divOrderDup").show();
            $("#divRegisterInfo").hide();
        }
        else {

            if (fromMakeFace) {
                $("#textImage").val($("#hdtextImagename").val());
            }
            $("#divAddressSetUp").hide();
            $("#divOrderDup").hide();
            $("#divRegisterInfo").show();
        }
        $("#CPE_Serial").removeClass("form-control errorinput ").addClass("form-control");
        $("#PlayBox_Serial").removeClass("form-control errorinput ").addClass("form-control");
    }

    function clearUploadFile() {
        isUpload = [];
        $('label[id^="btnPreview"]').addClass('disabled');
        $('img[class^="imgPreview"]').attr('src', "");
        $('div[id^="atthF"]').hide();
        $('img[id^="imgAtth"]').hide();
        $('canvas[id^="canvasAtth"]').hide();
        $('img[id^="imgAtth"]').attr('src', '');
        $('input[id^="hdnAddUpload"]').attr('value', '');
        $('input[id^="hdndivUploadpic"]').attr('value', "Y");

    }

    function clearUploadFile_IDCard() {
        isUpload = [];
        $('label[id^="btnPreview"]').not('label[id="btnPreviewR1"]').addClass('disabled');
        $('img[class^="imgPreview"]').not('img[class="imgPreviewR1"]').attr('src', '');
        $('div[id^="atthF"]').not('div[id="atthF1"]').hide();
        $('img[id^="imgAtth"]').not('img[id="imgAtth1"]').hide();
        $('canvas[id^="canvasAtth"]').not('canvas[id="canvasAtth1"]').hide();
        $('img[id^="imgAtth"]').not('img[id="imgAtth1"]').attr('src', '');
        $('input[id^="hdnAddUpload"]').attr('value', '');
        $('input[id^="hdndivUploadpic"]').attr('value', "Y");
    }

    function nextToAddressSendDoc() {
        LockScreen(true);
        var chk = ValidationProcessing(validateModel003Setup, "err003");

        if (chk) {
            $("#divAddressSetUp").hide();
            $("#divAddressSendDoc").show();

            if ($('#ProvinceSendDoc').length > 0
                && !$('#chkSameAsAddrSetUp').is(':checked')) {
                getProvinceTo("SendDoc");
                getProvinceTo("SendDocIDCard");
            }

            if ($('input[name="typeselect"]:checked').val() != 'R') {
                $("#divSameAsAddrOnSendDoc").show();
            }
            else {
                $("#divSameAsAddrOnSendDoc").hide();
            }
            if ($('#ID_CARD_NAME :selected').val() != "ID_CARD") {
                $('#chkSameAsAddrSetUpIdCard').prop("checked", true);
                $("#divSameAddrIdCard").find("input,button,textarea").attr("readonly", "readonly");
                $("#divSameAddrIdCard").find("select").attr("disabled", "disabled");
                $('#chkSameAsAddrSetUpIdCard').attr("disabled", "disabled");
            }
            else {
                $("#divSameAddrIdCard").find("input,button,textarea").removeAttr("readonly");
                $("#divSameAddrIdCard").find("select").attr("disabled", false);
                $('#chkSameAsAddrSetUpIdCard').attr("disabled", false);
            }
            if (typeof aisNative != "undefined" && typeof aisNative != "" && typeof aisNative != null) {
                setTimeout(function () {
                    if ($('#chkSameAsAddrSetUpIdCard').is(':checked')) {
                        onClickSameAsAddrSetUpIdCard();
                        LockScreen(false);
                    }
                    else {
                        $('#chkSameAsIdCardAddr').prop("checked", false);
                        SetDefaultAddressPage("SendDoc");
                        LockScreen(false);
                    }

                }, 2000);
            } else {
                if ($('#chkSameAsAddrSetUpIdCard').is(':checked')) {
                    setTimeout(function () {
                        onClickSameAsAddrSetUpIdCard();
                        LockScreen(false);
                    }, 1000);

                }
                else {
                    $('#chkSameAsIdCardAddr').prop("checked", false);
                    SetDefaultAddressPage("SendDoc");
                    LockScreen(false);
                }
            }

            if ($('input[name="typeselect"]:checked').val() == 'R') {
                if ($('#chkSameAsAddrSetUp').is(':checked')) {
                    if (typeof aisNative != "undefined" && typeof aisNative != "" && typeof aisNative != null) {
                        setTimeout(function () {

                            onClickSameAsAddrSetUp();
                        }, 2000);
                    }
                    else { onClickSameAsAddrSetUp(); }

                }
                else if ($('#chkSameAsIdCardAddr').is(':checked')) {
                    setTimeout(function () {
                        onClickSameAsIdCardAddr();
                    }, 2000);


                }

            } else {
                if ($('#hdnTypeSelect').val() != $('input[name="typeselect"]:checked').val()) {
                    //$('#chkSameAsAddrSetUp').prop("checked", false);
                    if ($('#chkSameAsIdCardAddr').is(':checked')) {
                        $('#chkSameAsIdCardAddr').prop("checked", false);
                        SetDefaultAddressPage("SendDoc");
                    }
                }
            }

            $('#hdnTypeSelect').val($('input[name="typeselect"]:checked').val())

            if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
                if (sessionStorage.getItem('Use_Data_Card') == "Y") { // ถ้ามีการใช้ข้อมูลจาก card reader
                    copyAddressIdCardSmartCardTo("SendDocIDCard");
                }
                else {
                    SetDefaultAddressPage("SendDocIDCard");
                }
            } else {
                if ($('#hdnCard_province').val() != "" && $('#hdnCard_province').val() != null) { //ถ้ามีค่าใน smart card ให้ใช้ smart card
                    copyAddressIdCardSmartCardTo("SendDocIDCard");
                } else {
                    SetDefaultAddressPage("SendDocIDCard");
                }
            }

            //script Adobe Analytic
            var lang = $("#LanguagePage").val() == 1 ? "th" : "en";
            digitalData.page = {
                pageInfo: {
                    pageName: "newfibre:" + lang + ":addressSendDoc",
                    site: "newfibre",
                    language: lang
                }
            }

            //R23.04             
            checkCardTypeOfNewCus();

            console.log("page load addressSendDoc : ", lang);
            
        }
        //R23.04             
        checkCardTypeOfNewCus();

        console.log("page load addressSendDoc : ", lang);
        


    }

    function backToAddressSetUp() {
        clearErrorInputValidateIDCardAddr(); //19.7
        clearErrorInputValidateBillingAddr(); //19.10
        $("#divAddressSetUp").show();
        $("#divAddressSendDoc").hide();
        clearBillingAddressATN(); //R23.11 Clear Billing Address BA_NO
    }

    function validateEmailEbill(email) {
        var filter = /^(((([a-zA-Z0-9\_\-]{1,50})+(([\.]{1,50}[a-zA-Z0-9\_\-]{1,50}){0,50})){1,95})+@@([\w-]+\.)+[\w-]{2,4})?$/;
        if (email.substr(0, 2) == "-@@" || email.substr(0, 2) == "_@@") {
            return false;
        }
        if (!(email.indexOf('@@') > -1)) {
            return false;
        }
        if (filter.test(email)) {
            return true;
        }
        else {
            return false;
        }
    }

    function nextToVatOrPage() {
        $('#CustomerRegisterPanelModel_AddressPanelModelSendDocIDCard_ZIPCODE_ID').val($('#ZipCodeSendDocIDCard').val());
        $('#CustomerRegisterPanelModel_AddressPanelModelSendDocIDCard_L_PROVINCE').val($('#ProvinceSendDocIDCard').val());
        $('#CustomerRegisterPanelModel_AddressPanelModelSendDocIDCard_L_AMPHUR').val($('#AmphurSendDocIDCard').val());
        $('#CustomerRegisterPanelModel_AddressPanelModelSendDocIDCard_L_TUMBOL').val($('#TumbonSendDocIDCard').val());

        clearErrorInputValidateIDCardAddr(); //19.7
        clearErrorInputValidateBillingAddr(); //19.10

        var chk = ValidationProcessing(validateModel003SendDoc, "err003");
        var chk2 = true;
        if ($('input[name="typeselect"]:checked').val() == 'R') {
            chk2 = ValidationProcessing(validateModel003SendDocIDCard, "err003");
        }
        //Update R18.2
        var chk3 = true;
        if (($("#R_SMS_AND_EMAIL").prop('checked') == true) && $("#L_EMAIL_EBILL").val() == "") {
            //validateModel003R.push({ id: "L_EMAIL_EBILL", condition: "Email" });

            chk3 = false;
            $("#L_EMAIL_EBILL").addClass("form-control errorinput textFieldFalse");
            if ($("#LanguagePage").val() == "1") {

                temp = "กรุณาระบุข้อมูลให้ถูกต้องและครบถ้วน"
                toastrErrorMessage(temp);
            }
            else {
                temp = "Please Fill In All Required Fields."
                toastrErrorMessage(temp);
            }
        }
        else {

            if (($("#R_SMS_AND_EMAIL").prop('checked') == true) && $("#L_EMAIL_EBILL").val() != "") {

                chk3 = validateEmailEbill($("#L_EMAIL_EBILL").val());

                if (chk3 == true) {
                    $("#L_EMAIL_EBILL").removeClass("textFieldFalse").removeClass("form-control errorinput ").addClass("form-control");
                } else {
                    $("#L_EMAIL_EBILL").addClass("form-control errorinput textFieldFalse");
                    if ($("#LanguagePage").val() == "1") {

                        temp = "กรุณาระบุข้อมูลให้ถูกต้องและครบถ้วน"
                        toastrErrorMessage(temp);
                    }
                    else {
                        temp = "Please Fill In All Required Fields."
                        toastrErrorMessage(temp);
                    }
                }
            }
        }

        //R19.7 Validate ID_Card Address
        var chk4 = true;
        if ($('input[name="typeselect"]:checked').val() == 'R') {
            chk4 = ValidateIDCardAddress(chk2);
        }

        //R19.10 Validate Billing Address
        var chk5 = true;
        chk5 = ValidateBillingAddress(chk);

        if (chk == true && chk2 == true && chk3 == true && chk4 == true && chk5 == true) {
            if ($('input[name="typeselect"]:checked').val() == 'R') {
                clearErrorInputValidateIDCardAddr(); // 19.7
                clearErrorInputValidateBillingAddr(); //19.10
                $("#page3").hide();
                $("#page4").show();
                //script Adobe Analytic
                var lang = $("#LanguagePage").val() == 1 ? "th" : "en";
                digitalData.page = {
                    pageInfo: {
                        pageName: "newfibre:" + lang + ":registerSummary",
                        site: "newfibre",
                        language: lang
                    }
                }
                console.log("page load registerSummary : ", lang);
                

                DataBindPageV2();
            }
            else {
                if ($('#ProvinceVat').length > 0
                    && !$('#chkSameAsAddrSendDoc').is(':checked'))
                    getProvinceTo("Vat");

                clearErrorInputValidateBillingAddr(); //19.10
                $('#divAddressSendDoc').hide();
                $('#divAddressVat').show();
            }
        }

        //R23.08 Billing eBill
        if ($('input[name="CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_"]:checked').val() == '1') { //R23.08 Check Sent Data Billing eBill
            var billMediaText = $("#bill_media_get_id").text().trim();
            var eStatmentFlag = 'N';
            var eBillFlag = '1';

            switch (billMediaText) {
                case 'SMS and eBill':
                    eStatmentFlag = 'Y';
                    eBillFlag = '1';
                    break;
                case 'SMS and eMail':
                    eStatmentFlag = 'Y';
                    eBillFlag = '2';
                    break;
                case 'SMS + Email':
                    eStatmentFlag = 'Y';
                    eBillFlag = '2';
                    break;
                case 'Hard Copy':
                    eStatmentFlag = 'N';
                    eBillFlag = '0';
                    break;
                default:
                    eStatmentFlag = 'Y';
                    eBillFlag = '1';
                    break;
            }
            $('#CustomerRegisterPanelModel_EStatmentFlag').val(eStatmentFlag);
            $('#CustomerRegisterPanelModel_EBillFlag').val(eBillFlag);
        }
        else { // R18.2 Set Ebill Value
            if ($('#chkReceiptEbill').is(':checked')) {
                var valEBillval = $("input[name=R_EBILL_TYPE_RADIO]:checked").val();

                if (valEBillval == 'SMS_AND_MYAIS') {
                    $('#hdBillingMediaText').val('@L_SMS_AND_MYAIS');
                    $('#hdBillingMediaValue').val(valEBillval);
                    $('#hdBillingMediaEmail').val($('#CoverageMemberGetMember_CustomerEmail').val());
                    $('#CustomerRegisterPanelModel_EStatmentFlag').val('Y');
                    $('#CustomerRegisterPanelModel_EBillFlag').val('1');

                }
                else if (valEBillval == 'SMS_AND_EMAIL') {
                    $('#hdBillingMediaText').val('@L_SMS_AND_EMAIL');
                    $('#hdBillingMediaValue').val(valEBillval);
                    $('#hdBillingMediaEmail').val($('#L_EMAIL_EBILL').val());
                    $('#CustomerRegisterPanelModel_EStatmentFlag').val('Y');
                    $('#CustomerRegisterPanelModel_EBillFlag').val('2');
                }
                else {
                    $('#hdBillingMediaText').val('@L_SMS_NON_SELECT');
                    $('#hdBillingMediaValue').val('');
                    $('#hdBillingMediaEmail').val('');
                    $('#CustomerRegisterPanelModel_EStatmentFlag').val('N');
                    $('#CustomerRegisterPanelModel_EBillFlag').val('0');

                    //if ($('#CoverageMemberGetMember_CustomerEmail').val() != "") {
                    //    $('#hdBillingMediaEmail').val($('#CoverageMemberGetMember_CustomerEmail').val());
                    //}
                }
            }
            else {
                $('#hdBillingMediaText').val('@L_SMS_NON_SELECT');
                $('#hdBillingMediaValue').val('');
                $('#hdBillingMediaEmail').val('');
                $('#CustomerRegisterPanelModel_EStatmentFlag').val('N');
                $('#CustomerRegisterPanelModel_ReceiveEmailFlag').val('N');
                $('#CustomerRegisterPanelModel_EBillFlag').val('0');

                //if ($('#CoverageMemberGetMember_CustomerEmail').val() != "") {
                //    $('#hdBillingMediaEmail').val($('#CoverageMemberGetMember_CustomerEmail').val());
                //}
            }
        }
        
        //Update 20.2 Product WTTx
        if ($("#WTTX_COVERAGE_RESULT").val() == "YES") {
            //$("#div_label_specific_time").hide();
            //$("#div_value_specific_time").hide();
            $("#div_label_install_date").hide();
            $("#div_value_install_date").hide();
        }
    }

    function ValidateIDCardAddress(chk2)
    {
        var AddrIDHomeNumber2 = $("#AddressPanelModelSendDocIDCard_L_HOME_NUMBER_2").val().length;
        var AddrIDBuildName = $("#AddressPanelModelSendDocIDCard_L_BUILD_NAME").val().length;
        var AddrIDFloor = $("#AddressPanelModelSendDocIDCard_L_FLOOR").val().length;
        var AddrIDRoom = $("#AddressPanelModelSendDocIDCard_L_ROOM").val().length;

        var AddrIDMoo = $("#AddressPanelModelSendDocIDCard_L_MOO").val().length;
        var AddrIDMooban = $("#AddressPanelModelSendDocIDCard_L_MOOBAN").val().length;
        var AddrIDSoi = $("#AddressPanelModelSendDocIDCard_L_SOI").val().length;

        var AddrIDRoad = $("#AddressPanelModelSendDocIDCard_L_ROAD").val().length;

        var FBB_Con_Validate_Length_Address = parseInt("@FBB_Con_Validate_Length_Address");

        if(chk2)
        {//R20.5 Validate Address Change 80 to 70
            if (AddrIDHomeNumber2 + AddrIDBuildName + AddrIDFloor + AddrIDRoom > FBB_Con_Validate_Length_Address)
            {
                $('#chkSameAsAddrSetUpIdCard').prop("checked", false);
                $("#AddressPanelModelSendDocIDCard_L_HOME_NUMBER_2").prop("readonly", false);
                $("#AddressPanelModelSendDocIDCard_L_BUILD_NAME").prop("readonly", false);
                $("#AddressPanelModelSendDocIDCard_L_FLOOR").prop("readonly", false);
                $("#AddressPanelModelSendDocIDCard_L_ROOM").prop("readonly", false);

                if(!$("#AddressPanelModelSendDocIDCard_L_HOME_NUMBER_2").hasClass("errorinput"))
                    $("#AddressPanelModelSendDocIDCard_L_HOME_NUMBER_2").removeClass("form-control").addClass("form-control errorinput");
                if(!$("#AddressPanelModelSendDocIDCard_L_BUILD_NAME").hasClass("errorinput"))
                    $("#AddressPanelModelSendDocIDCard_L_BUILD_NAME").removeClass("form-control").addClass("form-control errorinput");
                if(!$("#AddressPanelModelSendDocIDCard_L_FLOOR").hasClass("errorinput"))
                    $("#AddressPanelModelSendDocIDCard_L_FLOOR").removeClass("form-control").addClass("form-control errorinput");
                if(!$("#AddressPanelModelSendDocIDCard_L_ROOM").hasClass("errorinput"))
                    $("#AddressPanelModelSendDocIDCard_L_ROOM").removeClass("form-control").addClass("form-control errorinput");

                $("#modalValidateVATAddr").modal();
                document.getElementById("lblMsgValidateVATAddr").innerHTML = "@Html.Raw(L_VALIDATE_VAT_ADDR_L1)";
                return false;
            }
            else if (AddrIDMoo + AddrIDMooban + AddrIDSoi > FBB_Con_Validate_Length_Address)
            {
                $('#chkSameAsAddrSetUpIdCard').prop("checked", false);
                $("#AddressPanelModelSendDocIDCard_L_MOO").prop("readonly", false);
                $("#AddressPanelModelSendDocIDCard_L_MOOBAN").prop("readonly", false);
                $("#AddressPanelModelSendDocIDCard_L_SOI").prop("readonly", false);

                if(!$("#AddressPanelModelSendDocIDCard_L_MOO").hasClass("errorinput"))
                    $("#AddressPanelModelSendDocIDCard_L_MOO").removeClass("form-control").addClass("form-control errorinput");
                if(!$("#AddressPanelModelSendDocIDCard_L_MOOBAN").hasClass("errorinput"))
                    $("#AddressPanelModelSendDocIDCard_L_MOOBAN").removeClass("form-control").addClass("form-control errorinput");
                if(!$("#AddressPanelModelSendDocIDCard_L_SOI").hasClass("errorinput"))
                    $("#AddressPanelModelSendDocIDCard_L_SOI").removeClass("form-control").addClass("form-control errorinput");

                $("#modalValidateVATAddr").modal();
                document.getElementById("lblMsgValidateVATAddr").innerHTML = "@Html.Raw(L_VALIDATE_VAT_ADDR_L2)";
                return false;
            }
            else if (AddrIDRoad > FBB_Con_Validate_Length_Address)
            {
                $('#chkSameAsAddrSetUpIdCard').prop("checked", false);
                $("#AddressPanelModelSendDocIDCard_L_ROAD").prop("readonly", false);

                if(!$("#AddressPanelModelSendDocIDCard_L_ROAD").hasClass("errorinput"))
                    $("#AddressPanelModelSendDocIDCard_L_ROAD").removeClass("form-control").addClass("form-control errorinput");

                $("#modalValidateVATAddr").modal();
                document.getElementById("lblMsgValidateVATAddr").innerHTML = "@Html.Raw(L_VALIDATE_VAT_ADDR_L3)";
                return false;
            }
            else return true ;
        }
        else return true ;
    }

    function clearErrorInputValidateIDCardAddr()
    {
        if($("#AddressPanelModelSendDocIDCard_L_HOME_NUMBER_2").hasClass("errorinput"))
            $("#AddressPanelModelSendDocIDCard_L_HOME_NUMBER_2").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelSendDocIDCard_L_BUILD_NAME").hasClass("errorinput"))
            $("#AddressPanelModelSendDocIDCard_L_BUILD_NAME").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelSendDocIDCard_L_FLOOR").hasClass("errorinput"))
            $("#AddressPanelModelSendDocIDCard_L_FLOOR").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelSendDocIDCard_L_ROOM").hasClass("errorinput"))
            $("#AddressPanelModelSendDocIDCard_L_ROOM").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelSendDocIDCard_L_MOO").hasClass("errorinput"))
            $("#AddressPanelModelSendDocIDCard_L_MOO").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelSendDocIDCard_L_MOOBAN").hasClass("errorinput"))
            $("#AddressPanelModelSendDocIDCard_L_MOOBAN").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelSendDocIDCard_L_SOI").hasClass("errorinput"))
            $("#AddressPanelModelSendDocIDCard_L_SOI").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelSendDocIDCard_L_ROAD").hasClass("errorinput"))
            $("#AddressPanelModelSendDocIDCard_L_ROAD").removeClass("form-control errorinput").addClass("form-control");
    }

    function ValidateBillingAddress(chk)
    {
        var AddrBillHomeNumber2 = $("#AddressPanelModelSendDoc_L_HOME_NUMBER_2").val().length;
        var AddrBillBuildName = $("#AddressPanelModelSendDoc_L_BUILD_NAME").val().length;
        var AddrBillFloor = $("#AddressPanelModelSendDoc_L_FLOOR").val().length;
        var AddrBillRoom = $("#AddressPanelModelSendDoc_L_ROOM").val().length;

        var AddrBillMoo = $("#AddressPanelModelSendDoc_L_MOO").val().length;
        var AddrBillMooban = $("#AddressPanelModelSendDoc_L_MOOBAN").val().length;
        var AddrBillSoi = $("#AddressPanelModelSendDoc_L_SOI").val().length;

        var AddrBillRoad = $("#AddressPanelModelSendDoc_L_ROAD").val().length;

        var FBB_Con_Validate_Length_Address = parseInt("@FBB_Con_Validate_Length_Address");

        if(chk)
        {//R20.5 Validate Address Change 80 to 70
            if (AddrBillHomeNumber2 + AddrBillBuildName + AddrBillFloor + AddrBillRoom > FBB_Con_Validate_Length_Address)
            {
                $('#chkSameAsAddrSetUp').prop("checked", false);
                $('#chkSameAsIdCardAddr').prop("checked", false);
                $("#AddressPanelModelSendDoc_L_HOME_NUMBER_2").prop("readonly", false);
                $("#AddressPanelModelSendDoc_L_BUILD_NAME").prop("readonly", false);
                $("#AddressPanelModelSendDoc_L_FLOOR").prop("readonly", false);
                $("#AddressPanelModelSendDoc_L_ROOM").prop("readonly", false);

                if(!$("#AddressPanelModelSendDoc_L_HOME_NUMBER_2").hasClass("errorinput"))
                    $("#AddressPanelModelSendDoc_L_HOME_NUMBER_2").removeClass("form-control").addClass("form-control errorinput");
                if(!$("#AddressPanelModelSendDoc_L_BUILD_NAME").hasClass("errorinput"))
                    $("#AddressPanelModelSendDoc_L_BUILD_NAME").removeClass("form-control").addClass("form-control errorinput");
                if(!$("#AddressPanelModelSendDoc_L_FLOOR").hasClass("errorinput"))
                    $("#AddressPanelModelSendDoc_L_FLOOR").removeClass("form-control").addClass("form-control errorinput");
                if(!$("#AddressPanelModelSendDoc_L_ROOM").hasClass("errorinput"))
                    $("#AddressPanelModelSendDoc_L_ROOM").removeClass("form-control").addClass("form-control errorinput");

                $("#modalValidateVATAddr").modal();
                document.getElementById("lblMsgValidateVATAddr").innerHTML = "@Html.Raw(L_VALIDATE_VAT_ADDR_L1)";
                return false;
            }
            else if (AddrBillMoo + AddrBillMooban + AddrBillSoi > FBB_Con_Validate_Length_Address)
            {
                $('#chkSameAsAddrSetUp').prop("checked", false);
                $('#chkSameAsIdCardAddr').prop("checked", false);
                $("#AddressPanelModelSendDoc_L_MOO").prop("readonly", false);
                $("#AddressPanelModelSendDoc_L_MOOBAN").prop("readonly", false);
                $("#AddressPanelModelSendDoc_L_SOI").prop("readonly", false);

                if(!$("#AddressPanelModelSendDoc_L_MOO").hasClass("errorinput"))
                    $("#AddressPanelModelSendDoc_L_MOO").removeClass("form-control").addClass("form-control errorinput");
                if(!$("#AddressPanelModelSendDoc_L_MOOBAN").hasClass("errorinput"))
                    $("#AddressPanelModelSendDoc_L_MOOBAN").removeClass("form-control").addClass("form-control errorinput");
                if(!$("#AddressPanelModelSendDoc_L_SOI").hasClass("errorinput"))
                    $("#AddressPanelModelSendDoc_L_SOI").removeClass("form-control").addClass("form-control errorinput");

                $("#modalValidateVATAddr").modal();
                document.getElementById("lblMsgValidateVATAddr").innerHTML = "@Html.Raw(L_VALIDATE_VAT_ADDR_L2)";
                return false;
            }
            else if (AddrBillRoad > FBB_Con_Validate_Length_Address)
            {
                $('#chkSameAsAddrSetUp').prop("checked", false);
                $('#chkSameAsIdCardAddr').prop("checked", false);
                $("#AddressPanelModelSendDoc_L_ROAD").prop("readonly", false);

                if (!$("#AddressPanelModelSendDoc_L_ROAD").hasClass("errorinput"))
                    $("#AddressPanelModelSendDoc_L_ROAD").removeClass("form-control").addClass("form-control errorinput");

                $("#modalValidateVATAddr").modal();
                document.getElementById("lblMsgValidateVATAddr").innerHTML = "@Html.Raw(L_VALIDATE_VAT_ADDR_L3)";
                return false;
            }
            else return true ;
        }
        else return true ;
    }

    function clearErrorInputValidateBillingAddr()
    {
        if($("#AddressPanelModelSendDoc_L_HOME_NUMBER_2").hasClass("errorinput"))
            $("#AddressPanelModelSendDoc_L_HOME_NUMBER_2").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelSendDoc_L_BUILD_NAME").hasClass("errorinput"))
            $("#AddressPanelModelSendDoc_L_BUILD_NAME").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelSendDoc_L_FLOOR").hasClass("errorinput"))
            $("#AddressPanelModelSendDoc_L_FLOOR").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelSendDoc_L_ROOM").hasClass("errorinput"))
            $("#AddressPanelModelSendDoc_L_ROOM").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelSendDoc_L_MOO").hasClass("errorinput"))
            $("#AddressPanelModelSendDoc_L_MOO").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelSendDoc_L_MOOBAN").hasClass("errorinput"))
            $("#AddressPanelModelSendDoc_L_MOOBAN").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelSendDoc_L_SOI").hasClass("errorinput"))
            $("#AddressPanelModelSendDoc_L_SOI").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelSendDoc_L_ROAD").hasClass("errorinput"))
            $("#AddressPanelModelSendDoc_L_ROAD").removeClass("form-control errorinput").addClass("form-control");
    }

    function clearBillingAddressATN() {
        //R23.11 Clear Billing Address BA_NO
        $("#bill_address_merge_cycle").text('');
        $("#bill_address_detail_merge").text('');
        $("#bill_address_get_channel_merge").text('');
        $("#bill_media_get_id").text('');
        $("#mobile_have_relate").text('');
        $("#CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL").val('');
        $("#CustomerRegisterPanelModel_CONDITION_NEW_DOC").val('');
        $("#CustomerRegisterPanelModel_BILL_MOBILE_NO").val('');
        $("#CustomerRegisterPanelModel_BILL_CYCLE_INFO").val('');
        $("#CustomerRegisterPanelModel_BILL_CHANNEL_INFO").val('');
        $("#CustomerRegisterPanelModel_BILL_ADDRESS_NO").val('');
    }

    function backToAddressSendDoc() {
        clearErrorInputValidateVATAddr(); //19.5

        //R23.04             
        checkCardTypeOfNewCus();

        $('#divAddressVat').hide();
        $('#divAddressSendDoc').show();
    }

    function checkCardTypeOfNewCus() {
        //R23.04
        $("#AddressPanelModelSendDoc_L_HOME_NUMBER_2").val('');
        $("#AddressPanelModelSendDoc_L_BUILD_NAME").val('');
        $("#AddressPanelModelSendDoc_L_FLOOR").val('');
        $("#AddressPanelModelSendDoc_L_ROOM").val('');
        $("#AddressPanelModelSendDoc_L_MOO").val('');
        $("#AddressPanelModelSendDoc_L_MOOBAN").val('');
        $("#AddressPanelModelSendDoc_L_SOI").val('');
        $("#AddressPanelModelSendDoc_L_ROAD").val('');
        console.log("checkCardTypeOfNewCus ID_CARD_NAME:", $("#ID_CARD_NAME").val());
        console.log("checkCardTypeOfNewCus isRelated:", isRelated);
        $('#TumbonSendDoc').prop('disabled', false);
        $('#AmphurSendDoc').prop('disabled', false);
        $('#ProvinceSendDoc').prop('disabled', false);
        $('#ZipCodeSendDoc').prop('disabled', false);
        if (isRelated && billAddressData.length != 0) {
            $('#CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_').val('1');
            $('#CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_').prop("checked", true);
            $('.radio_1').prop("checked", true);
            $('.radio_2').prop("checked", false);
            $('#CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_').val() === '1' ? onClickSameAsAddrSetUp('1') : ""; //R23.08 Issue when back page
            $("#bill_address_merge_have_relate_mobile_content").show();
            $("#bill_address_merge_no_have_relate_mobile_content2").hide();
            $("#addrSetupOld").hide();
            $("#addrSetupOld_header").hide();
            $('#TumbonSendDoc').prop('disabled', true);
            $('#AmphurSendDoc').prop('disabled', true);
            $('#ProvinceSendDoc').prop('disabled', true);
            $('#ZipCodeSendDoc').prop('disabled', true);
            //hide input more
            $('#bill_address_new_hide').css("display", "none");
        }
        else if (!isRelated && billAddressData.length > 0) { //R23.08 Bill Consolidate check ba list not null and not related
            $('#CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_').val('1');
            $('#CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_').prop("checked", true);
            $('.radio_1').prop("checked", true);
            $('.radio_2').prop("checked", false);
            $('#CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_').val() === '1' ? onClickSameAsAddrSetUp('1') : ""; //R23.08 Issue when back page
            $("#bill_address_merge_have_relate_mobile_content").show();
            $("#bill_address_merge_no_have_relate_mobile_content2").show();
            $("#bill_address_merge_no_have_relate_mobile_content").show();
            $("#bill_address_merge_no_have_relate_mobile_content_header").show();
            $("#addrSetupOld").hide();
            $("#addrSetupOld_header").hide();
            $('#TumbonSendDoc').prop('disabled', true);
            $('#AmphurSendDoc').prop('disabled', true);
            $('#ProvinceSendDoc').prop('disabled', true);
            $('#ZipCodeSendDoc').prop('disabled', true);

            //show input more
            $('#bill_address_new_hide').css("display", "none");
        }
        else { //R23.08 Bill Consolidate old version
            $('#CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_').val('');
            $('#CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_').prop("checked", false);
            $('.radio_1').prop("checked", false);
            $('.radio_2').prop("checked", false);
            $("#AddressPanelModelSendDoc_L_HOME_NUMBER_2").val();
            $("#bill_address_merge_no_have_relate_mobile_content2").show();
            $("#bill_address_merge_have_relate_mobile_content").hide();
            $("#bill_address_merge_no_have_relate_mobile_content").hide();
            $("#bill_address_merge_no_have_relate_mobile_content_header").hide();
            $("#addrSetupOld").show();
            $("#addrSetupOld_header").show();
            $('#chkSameAsAddrSetUp').is(':checked') == true ? onClickSameAsAddrSetUp('') : "";
            //clear value in radio when show ui old
            $("#CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL").val("");
            $('#TumbonSendDoc').prop('disabled', false);
            $('#AmphurSendDoc').prop('disabled', false);
            $('#ProvinceSendDoc').prop('disabled', false);
            $('#ZipCodeSendDoc').prop('disabled', false);
            // $('input[name="CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_"]').prop("checked", false);
            // $('input[name="CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL"]').prop("checked", false);
            //show input more
            $('#bill_address_new_hide').css("display", "inline-block");

            //R23.08 Billing eBill
            if ($('#TopUp').val() == "5") {
                if ($('input[name="CustomerRegisterPanelModel_CHANNEL_RECEIVE_BILL_"]:checked').val() == '1') {
                    $("#chkEbillType").hide();
                }
                else {
                    $("#chkEbillType").show();
                }
            }
            else {
                $("#chkEbillType").hide();
            }
        }
        pushRequireFieldAddress();
    }
    

    function nextPage003() {
        clearErrorInputValidateVATAddr();
        var chk = ValidationProcessing(validateModel003Vat, "err003");

        //R19.5 Validate VAT Address
        var chkVATAddr = ValidateVATAddress(chk);

        if (chk && chkVATAddr) {
            clearErrorInputValidateVATAddr(); //19.5
            $("#page3").hide();
            $("#page4").show();
            //script Adobe Analytic
            var lang = $("#LanguagePage").val() == 1 ? "th" : "en";
            digitalData.page = {
                pageInfo: {
                    pageName: "newfibre:" + lang + ":registerSummary",
                    site: "newfibre",
                    language: lang
                }
            }
            console.log("page load registerSummary : ", lang);
            
            DataBindPageV2();

        }
        clearDataCardreader();
    }

    function ValidateVATAddress(chk)
    {
        var AddrHomeNumber2 = $("#AddressPanelModelVat_L_HOME_NUMBER_2").val().length;
        var AddrBuildName = $("#AddressPanelModelVat_L_BUILD_NAME").val().length;
        var AddrFloor = $("#AddressPanelModelVat_L_FLOOR").val().length;
        var AddrRoom = $("#AddressPanelModelVat_L_ROOM").val().length;

        var AddrMoo = $("#AddressPanelModelVat_L_MOO").val().length;
        var AddrMooban = $("#AddressPanelModelVat_L_MOOBAN").val().length;
        var AddrSoi = $("#AddressPanelModelVat_L_SOI").val().length;

        var AddrRoad = $("#AddressPanelModelVat_L_ROAD").val().length;

        var FBB_Con_Validate_Length_Address = parseInt("@FBB_Con_Validate_Length_Address");

        if(chk)
        {//R20.5 Validate Address Change 80 to 70
            if (AddrHomeNumber2 + AddrBuildName + AddrFloor + AddrRoom > FBB_Con_Validate_Length_Address)
            {
                if(!$("#AddressPanelModelVat_L_HOME_NUMBER_2").hasClass("errorinput"))
                    $("#AddressPanelModelVat_L_HOME_NUMBER_2").removeClass("form-control").addClass("form-control errorinput");
                if(!$("#AddressPanelModelVat_L_BUILD_NAME").hasClass("errorinput"))
                    $("#AddressPanelModelVat_L_BUILD_NAME").removeClass("form-control").addClass("form-control errorinput");
                if(!$("#AddressPanelModelVat_L_FLOOR").hasClass("errorinput"))
                    $("#AddressPanelModelVat_L_FLOOR").removeClass("form-control").addClass("form-control errorinput");
                if(!$("#AddressPanelModelVat_L_ROOM").hasClass("errorinput"))
                    $("#AddressPanelModelVat_L_ROOM").removeClass("form-control").addClass("form-control errorinput");

                $("#modalValidateVATAddr").modal();
                document.getElementById("lblMsgValidateVATAddr").innerHTML = "@Html.Raw(L_VALIDATE_VAT_ADDR_L1)";
                return false;
            }
            else if (AddrMoo + AddrMooban + AddrSoi > FBB_Con_Validate_Length_Address)
            {
                if(!$("#AddressPanelModelVat_L_MOO").hasClass("errorinput"))
                    $("#AddressPanelModelVat_L_MOO").removeClass("form-control").addClass("form-control errorinput");
                if(!$("#AddressPanelModelVat_L_MOOBAN").hasClass("errorinput"))
                    $("#AddressPanelModelVat_L_MOOBAN").removeClass("form-control").addClass("form-control errorinput");
                if(!$("#AddressPanelModelVat_L_SOI").hasClass("errorinput"))
                    $("#AddressPanelModelVat_L_SOI").removeClass("form-control").addClass("form-control errorinput");

                $("#modalValidateVATAddr").modal();
                document.getElementById("lblMsgValidateVATAddr").innerHTML = "@Html.Raw(L_VALIDATE_VAT_ADDR_L2)";
                return false;
            }
            else if(AddrRoad > FBB_Con_Validate_Length_Address)
            {
                if(!$("#AddressPanelModelVat_L_ROAD").hasClass("errorinput"))
                    $("#AddressPanelModelVat_L_ROAD").removeClass("form-control").addClass("form-control errorinput");

                $("#modalValidateVATAddr").modal();
                document.getElementById("lblMsgValidateVATAddr").innerHTML = "@Html.Raw(L_VALIDATE_VAT_ADDR_L3)";
                return false;
            }
            else return true ;
        }
        else return true ;
    }

    function clearErrorInputValidateVATAddr()
    {
        if($("#AddressPanelModelVat_L_HOME_NUMBER_2").hasClass("errorinput"))
            $("#AddressPanelModelVat_L_HOME_NUMBER_2").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelVat_L_BUILD_NAME").hasClass("errorinput"))
            $("#AddressPanelModelVat_L_BUILD_NAME").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelVat_L_FLOOR").hasClass("errorinput"))
            $("#AddressPanelModelVat_L_FLOOR").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelVat_L_ROOM").hasClass("errorinput"))
            $("#AddressPanelModelVat_L_ROOM").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelVat_L_MOO").hasClass("errorinput"))
            $("#AddressPanelModelVat_L_MOO").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelVat_L_MOOBAN").hasClass("errorinput"))
            $("#AddressPanelModelVat_L_MOOBAN").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelVat_L_SOI").hasClass("errorinput"))
            $("#AddressPanelModelVat_L_SOI").removeClass("form-control errorinput").addClass("form-control");

        if($("#AddressPanelModelVat_L_ROAD").hasClass("errorinput"))
            $("#AddressPanelModelVat_L_ROAD").removeClass("form-control errorinput").addClass("form-control");
    }

    function clearDataCardreader() {
        sessionStorage.setItem('Card_is_Active', null);
        sessionStorage.setItem('Card_l_TITLE_TH', null);
        sessionStorage.setItem('Card_f_name', null);
        sessionStorage.setItem('Card_l_name', null);
        sessionStorage.setItem('Card_l_TITLE_EN', null);
        sessionStorage.setItem('Card_f_name_en', null);
        sessionStorage.setItem('Card_l_name_en', null);
        sessionStorage.setItem('Card_id_card', null);
        sessionStorage.setItem('Card_province', null);
        sessionStorage.setItem('Card_district', null);
        sessionStorage.setItem('Card_subDistrict', null);
        sessionStorage.setItem('Card_moo', null);
        sessionStorage.setItem('Card_soi', null);
        sessionStorage.setItem('Card_road', null);
        sessionStorage.setItem('Card_houseNo', null);
        sessionStorage.setItem('card_ISSUEDATE', null);
        sessionStorage.setItem('card_EXPIREDATE', null);
        sessionStorage.setItem('card_PICTURE', null);
    }

    function setPackage() {

        var result = $("input[name=SelectPackage]:checked").val();

        if (!result) {
            return false;
        }

        if ($('#hdGetVoip').val() == 1) {
            $('#lblFixLine').text("@L_FIXEDLINE");
        }
        else {
            $('#lblFixLine').text("");
        }

        if ($("#fullHDAutoMappingMsg").val() != "") {
            $('#lblFullHDmsg').text($("#fullHDAutoMappingMsg").val());
        }
        else {
            $('#lblFullHDmsg').text("");
        }

        if ($("#fullHD2AutoMappingMsg").val() != "") {
            $('#lblFullHD2msg').text($("#fullHD2AutoMappingMsg").val());
        }
        else {
            $('#lblFullHD2msg').text("");
        }

        if ($("#SpeedBoostAutoMappingMsg").val() != "") {
            $('#lblSpeedBoostmsg').text($("#SpeedBoostAutoMappingMsg").val());
        }
        else {
            $('#lblSpeedBoostmsg').text("");
        }

        var r = $('#RECURRING_CHARGE' + result).val();
        var RECURRING_CHARGE = parseFloat(r);


        /// for special ontop
        if ($('#hdSelectSPONTOP').val() != "0") {
            $('#ProMain').html("");
            $('#ProMain').html($("#SFF_PROMOTION_BILL_THA" + result).val().replace($('#summVal3').text(), $('#summVal3Vas').text()).replace(/\|/g, '<br>'));
            $('#ProMainHid').val($("#SFF_PROMOTION_BILL_THA" + result).val().replace($('#summVal3').text(), $('#summVal3Vas').text()));
        }
            /// for gift voucher
        else if ($('#hdGiftVoucher').val() != "") {
            $('#ProMain').html("");
            $('#ProMain').html($("#SFF_PROMOTION_BILL_THA" + result).val().replace(RECURRING_CHARGE, $('#hdGiftVoucher').val()).replace(/\|/g, '<br>'));
            $('#ProMainHid').val($("#SFF_PROMOTION_BILL_THA" + result).val().replace(RECURRING_CHARGE, $('#hdGiftVoucher').val()));
        }
        else {
            $('#ProMain').html("");
            $('#ProMain').html($("#SFF_PROMOTION_BILL_THA" + result).val().replace(/\|/g, '<br>'));
            $('#ProMainHid').val($("#SFF_PROMOTION_BILL_THA" + result).val());
        }


        if (typeof isNoRouter !== "undefined" && !isNoRouter)
            $('#ProOnTop').text($('#summLb1').text() + " " + $('#summLb1Router').text());
        else
            $('#ProOnTop').text("");

        //18.1 FTTB Sell Router (ซื้อ และ ใช้ของตนเอง)
        //if ($("#ActiveSellRouterFlag").val() == "Y" && $('#TopUp').val() == "5" && ($('#CustomerRegisterPanelModel_RouterFlag').val() == "S" || $('#CustomerRegisterPanelModel_RouterFlag').val() == "M")) {
        //    $('#ProOnTop').text("");
        //}

        if ($("#LanguagePage").val() != "1") {
            /// for special ontop
            if ($('#hdSelectSPONTOP').val() != "0") {
                $('#ProMain').html("");
                $('#ProMain').html($("#SFF_PROMOTION_BILL_ENG" + result).val().replace($('#summVal3').text(), $('#summVal3Vas').text()));
                $('#ProMainHid').val($("#SFF_PROMOTION_BILL_ENG" + result).val().replace($('#summVal3').text(), $('#summVal3Vas').text()));
            }
            else if ($('#hdGiftVoucher').val() != "") {
                $('#ProMain').html("");
                $('#ProMain').html($("#SFF_PROMOTION_BILL_ENG" + result).val().replace(RECURRING_CHARGE, $('#hdGiftVoucher').val()));
                $('#ProMainHid').val($("#SFF_PROMOTION_BILL_ENG" + result).val().replace(RECURRING_CHARGE, $('#hdGiftVoucher').val()));
            }
            else {
                $('#ProMain').html("");
                $('#ProMain').html($("#SFF_PROMOTION_BILL_ENG" + result).val());
                $('#ProMainHid').val($("#SFF_PROMOTION_BILL_ENG" + result).val());
            }
        }
        //Playbox Package
        var i = $("input[name=SelectPackage]:checked").val();

        if ($("#PACKAGE_TYPE" + i).val() == "TRIPLE") {
            $("#lblPlayBoxPromotion").text("@Html.Raw(L_ONTOP_PLAYBOX_PRE_INITIATION)");
        }
        else {
            if ($("#hdGetPlayBox").val() == "1") {
                $("#lblPlayBoxPromotion").text($("#lblVasSumPromotion").text());
                $("#lblPlayBoxInitiation").text($("#lblVasSumInitiation").text());
                $("#lblPlayBoxHOOQ").text($("#lblVasSumHooq").text());
                if ($("#hdGetBPL").val() == "1") {
                    $("#lblBPLPack").html("@Html.Raw(L_ONTOP_PLAYBOX_BPL)");
                }
                else {
                    $("#lblBPLPack").text("");
                }
            }
            else {
                $("#lblPlayBoxPromotion").text("");
                $("#lblPlayBoxInitiation").text("");
                $("#lblPlayBoxHOOQ").text("");
                $("#lblBPLPack").text("");
                $("#lblSpecialDiscountRegis").text("");
            }
        }
        var allHide = true;
        $('#ontopSummaryDesctiption_div').show();
        $('#ontopSummaryDesctiption_div').find('dd').children().each(function () {
            if ($(this).text() !== "") {
                $(this).parent().show();
                if (this.id != "lblSpecialDiscountRegis")
                    allHide = false;
            }
            else {
                $(this).parent().hide();
            }

            if ($("#CoveragePanelModel_BUNDLINGSPECIALFLAG").val() == "Y" && $("#DisplayPackagePanelModel_L_SPECIAL_BUNDLING_DISCOUNT").val() != "") {
                $("#lblSpecialDiscountRegis").text("@Html.Raw(L_SPECIAL_BUNDLING_DISCOUNT)".replace("{0}", $("#DisplayPackagePanelModel_L_SPECIAL_BUNDLING_DISCOUNT").val()));
                $("#lblSpecialDiscountRegisDiv").show();
            }
            else if ($("#CoveragePanelModel_BUNDLINGSPECIALFLAG").val() == "N" && $("#DisplayPackagePanelModel_L_SPECIAL_DISCOUNT").val() != "") {
                $("#lblSpecialDiscountRegis").text("@Html.Raw(L_SPECIAL_DISCOUNT)".replace("{0}", $("#DisplayPackagePanelModel_L_SPECIAL_DISCOUNT").val()));
                $("#lblSpecialDiscountRegisDiv").show();
            }
            else {
                $("#lblSpecialDiscountRegis").text("");
                $("#lblSpecialDiscountRegisDiv").hide();
            }
        });
        if (allHide) {
            $('#ontopSummaryDesctiption_div').hide();
        }

    }

    var objDiscountArry = [];
    function setPackageV2() {
        var havePlaybox = false;

        // GREETING
        var showRemarkGreeting = false;
        var myCheckATTACHED = [];
        @foreach (var CheckATTACHED in ATTACHED)
        {
           @:myCheckATTACHED.push("@CheckATTACHED");
        }

        // find main
        var packageIndexVale = $("input[name=SelectPackage]:checked").val();
        var mappingCode = $("#MAPPING_CODE" + packageIndexVale).val();
        var packageGroupMain = $("#PACKAGE_GROUP" + packageIndexVale).val().toUpperCase();
        var packageGroupOntopDiscount = "";
        $.each(myCheckATTACHED, function (index, item) {
            if (packageGroupMain.indexOf(item) > -1) {
                showRemarkGreeting = true;
            }
        });

        /// Add Main to list package
        $('#ProMain').html("");
        $('#ontopSummaryDesctiption_div').html("");

        if ('@language' == "1") {
            $('#ProMain').html($("#SFF_WORD_IN_STATEMENT_THA" + packageIndexVale).val().replace(/\|/g, '<br>'));
            $('#ProMainHid').val($("#SFF_WORD_IN_STATEMENT_THA" + packageIndexVale).val());
        }
        else {
            $('#ProMain').html($("#SFF_WORD_IN_STATEMENT_ENG" + packageIndexVale).val().replace(/\|/g, '<br>'));
            $('#ProMainHid').val($("#SFF_WORD_IN_STATEMENT_ENG" + packageIndexVale).val());
        }
        var strOntopSummaryDesctiption = "";
        strOntopSummaryDesctiption += "<dl class='dl-horizontal'>";
        strOntopSummaryDesctiption += "<dt><label>@lONTOP_PACK :</label></dt>";
        // find ontp
        if (tmpPackageDataV2 != undefined) {
            // Install Internet
            var sffPromotionCodeInstall = $("input[name='SelectOptionInstallation']:checked").val();
            if (sffPromotionCodeInstall != undefined && sffPromotionCodeInstall != "") {
                if (tmpPackageDataV2.packageInstallList.length > 0) {
                    var tmpPackageInstall = tmpPackageDataV2.packageInstallList.filter(function (elem) {
                        return elem.MAPPING_CODE.indexOf(mappingCode) !== -1
                            && elem.SFF_PROMOTION_CODE.indexOf(sffPromotionCodeInstall) !== -1;
                    });
                    $.each(tmpPackageInstall, function (indexData, PackageInstallData) {
                        strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>@L_SUMM_DETAIL6</label></dd>";
                    });
                }
            }
            if ("@Html.Raw(meshArpu_Month_Flag)" == "Y") {
                // SuperMESHWifi //mesh arpu
                if (objMonthlySuperMESHWifiArry != undefined && objMonthlySuperMESHWifiArry.length > 0) {

                    $.each(objMonthlySuperMESHWifiArry, function (indexData, selectMeshWifiData) {

                        //mesh arpu
                        if (selectMeshWifiData.qty != undefined && selectMeshWifiData.qty == "1") {
                            strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectMeshWifiData.NameR1 + " " + selectMeshWifiData.Price1 + " " + selectMeshWifiData.currency + "</label></dd>";
                            //strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectMeshWifiData.NameS + " " + selectMeshWifiData.Value + " " + selectMeshWifiData.currency + "</label></dd>";
                        } else if (selectMeshWifiData.qty != undefined && selectMeshWifiData.qty == "2") {
                            strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectMeshWifiData.NameR1 + " " + selectMeshWifiData.Price1 + " " + selectMeshWifiData.currency + "</label></dd>";
                            strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectMeshWifiData.NameR2 + " " + selectMeshWifiData.Price2 + " " + selectMeshWifiData.currency + "</label></dd>";
                            if (selectMeshWifiData.NameR2_Discount != "") {
                                strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectMeshWifiData.NameR2_Discount + " " + selectMeshWifiData.Price2_Discount + " " + selectMeshWifiData.currency + "</label></dd>";
                            }
                            //strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectMeshWifiData.NameS + " " + selectMeshWifiData.Value + " " + selectMeshWifiData.currency + "</label></dd>";
                        } else if (selectMeshWifiData.qty != undefined && selectMeshWifiData.qty == "3") {
                            strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectMeshWifiData.NameR1 + " " + selectMeshWifiData.Price1 + " " + selectMeshWifiData.currency + "</label></dd>";
                            strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectMeshWifiData.NameR2 + " " + selectMeshWifiData.Price2 + " " + selectMeshWifiData.currency + "</label></dd>";
                            strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectMeshWifiData.NameR3 + " " + selectMeshWifiData.Price3 + " " + selectMeshWifiData.currency + "</label></dd>";
                            if (selectMeshWifiData.NameR2_Discount != "") {
                                strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectMeshWifiData.NameR2_Discount + " " + selectMeshWifiData.Price2_Discount + " " + selectMeshWifiData.currency + "</label></dd>";
                            }
                            if (selectMeshWifiData.NameR3_Discount != "") {
                                strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectMeshWifiData.NameR3_Discount + " " + selectMeshWifiData.Price3_Discount + " " + selectMeshWifiData.currency + "</label></dd>";
                            }
                            //strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectMeshWifiData.NameS + " " + selectMeshWifiData.Value + " " + selectMeshWifiData.currency + "</label></dd>";
                        }
                        else {
                            strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectMeshWifiData.NameR + " " + selectMeshWifiData.Value + " " + selectMeshWifiData.currency + "</label></dd>";
                        }

                    });

                }
            } else {
                // SuperMESHWifi
                if (objMonthlySuperMESHWifiArry != undefined && objMonthlySuperMESHWifiArry.length > 0) {
                    $.each(objMonthlySuperMESHWifiArry, function (indexData, selectMeshWifiData) {
                        strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectMeshWifiData.NameR + " " + selectMeshWifiData.Value + " " + selectMeshWifiData.currency + "</label></dd>";
                    });
                }
                if (objInstallContentSuperMESHWifiArry != undefined && objInstallContentSuperMESHWifiArry.length > 0) {
                var tmpMeshCodeMain = "";
                var strInstallSuperMESHWifi = "";
                $.each(objInstallContentSuperMESHWifiArry, function (indexData, selectMeshWifiData) {
                    if (selectMeshWifiData.Action == "Del") {
                        tmpMeshCodeMain = selectMeshWifiData.MeshCodeMain;
                        strInstallSuperMESHWifi = selectMeshWifiData.Name;
                    }
                });

                var MESH_COUNT = parseInt($("#ddlSuperMESHWifi" + tmpMeshCodeMain).val());
                if (MESH_COUNT == 1) {
                    strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + strInstallSuperMESHWifi + "</label></dd>";
                }
                else {
                    var icMesh = 0;
                    var strWORDIND_MESH = "";
                    while (icMesh < MESH_COUNT) {
                        strWORDIND_MESH = "@WORDIND_MESH";
                        strWORDIND_MESH = strWORDIND_MESH.replace("{x}", (icMesh + 1).toString());

                        strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + strInstallSuperMESHWifi + " " + strWORDIND_MESH + "</label></dd>";


                        icMesh++;
                    }
                }
                }
            }
              //IPCAMERA BY FIRST

            var activeFlagIPCamera = "@GetlovCusregisIPcamera";
            var strWORDIND_IPCamera = "@WORDIND_MESH";
                var ipcamera = objMonthlyIpCameraGroupArry;
                if (ipcamera != undefined && ipcamera.length > 0) {
                var ipcamerafilter = ipcamera.filter(d => d.length > 0);
                var count = 1;
                $.each(ipcamerafilter, function (indexData, ipcameraData) {
                    var MonthlyFee = "";
                    var MonthlyFee_Price = 0;
                    var SetupFee_Discount = "";
                    var L_BAHT = "";
                    $.each(ipcameraData, function (indexData2, ipcameraData2) {

                        if (indexData < ipcamerafilter.length)
                        {
                            if (indexData == indexData )
                            {
                                var IPCamera_MonthlyFee = ipcameraData2.IPCamera_MonthlyFee;
                                L_BAHT = ipcameraData2.L_BAHT;
                                MonthlyFee = "<dd><label style='font-weight: bold;'>" + IPCamera_MonthlyFee + "";
                            }

                            var IPCamera_MonthlyFee_Price = ipcameraData2.IPCamera_MonthlyFee_Price;
                            var IPCamera_SetupFee_Discount = ipcameraData2.IPCamera_SetupFee_Discount;
                            MonthlyFee_Price += IPCamera_MonthlyFee_Price;
                           if (activeFlagIPCamera != null && activeFlagIPCamera != "") {
                               var lovCusregisIPcamera = "@GetlovCusregisIPcamera";
                               var strWORDIND_IPCamera = "@WORDIND_MESH";
                                if (ipcameraData.length == 1) {
                                    SetupFee_Discount += "<dd><label style='font-weight: bold;'>" + lovCusregisIPcamera + "</label></dd>";
                                }
                                else { 
                                    strWORDIND_IPCamera = strWORDIND_IPCamera.replace('{x}', count.toString());
                                    SetupFee_Discount += "<dd><label style='font-weight: bold;'>" + lovCusregisIPcamera + " " + strWORDIND_IPCamera + "</label></dd>";
                                }
                            }
                            if (activeFlagIPCamera == null || activeFlagIPCamera == "") {
                                SetupFee_Discount += "<dd><label style='font-weight: bold;'>" + IPCamera_SetupFee_Discount + "</label></dd>";
                            }
                            count++;
                        }

                    });
                    strOntopSummaryDesctiption += MonthlyFee + " " + MonthlyFee_Price.toString() + " " + L_BAHT + "</label></dd>";
                    strOntopSummaryDesctiption += SetupFee_Discount;
                });
                }
            // Install SuperMESHWifi //R21.12PP ATV

            // PlayBox (packagePlayboxMonthlyFeeList)
            $('#hdGetPlayBox').val("0");
            var selectPlaybox = $("#divVasBoxDynamic input[name=contentPlaybox]:checked");
            if (selectPlaybox != undefined && selectPlaybox.length > 0) {
                havePlaybox = true;
                $('#hdGetPlayBox').val("1");
                $.each(selectPlaybox, function (indexData, selectPlayboxData) {
                    var sffPromotionCodePlayBox = selectPlayboxData.id;
                    sffPromotionCodePlayBox = sffPromotionCodePlayBox.replace("contentPlaybox_", "");
                    if (tmpPackageDataV2.packagePlayboxMonthlyFeeList.length > 0) {
                        var tmpPackagePlayboxMonthlyFee = tmpPackageDataV2.packagePlayboxMonthlyFeeList.filter(function (elem) {
                            return elem.MAPPING_CODE.indexOf(mappingCode) !== -1
                                && elem.SFF_PROMOTION_CODE.indexOf(sffPromotionCodePlayBox) !== -1;
                        });
                        $.each(tmpPackagePlayboxMonthlyFee, function (indexSubData, PackagePlayboxData) {
                            if ('@language' == "1") {
                                strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + PackagePlayboxData.PACKAGE_DISPLAY_THA + "</label></dd>";
                            }
                            else {
                                strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + PackagePlayboxData.PACKAGE_DISPLAY_ENG + "</label></dd>";
                            }
                        });
                    }
                    //R21.11 ATV (แบบเก่า ไม่ได้ใช้ เก็บไว้ก่อน)
                    @*if (tmpPackageDataV2.packagePlayboxList.length > 0) {
                        var tmpPackagePlaybox = tmpPackageDataV2.packagePlayboxList.filter(function (elem) {
                            return elem.MAPPING_CODE.indexOf(mappingCode) !== -1;
                        });
                        $.each(tmpPackagePlaybox, function (indexSubData, PackagePlayboxData) {
                            if ('@language' == "1") {
                                strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>@L_ONTOP_PLAYBOX_FREE " + PackagePlayboxData.PACKAGE_DISPLAY_THA + "</label></dd>";
                            }
                            else {
                                strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>@L_ONTOP_PLAYBOX_FREE " + PackagePlayboxData.PACKAGE_DISPLAY_ENG + "</label></dd>";
                            }
                        });
                    }*@

                    // Install PlayBox
                    if (objInstallContentPlayboxArry != undefined && objInstallContentPlayboxArry.length > 0) {
                        //var sumInstallPlaybox = 0;
                        var strInstallPlaybox = "";
                        $.each(objInstallContentPlayboxArry, function (indexData, PackageData) {
                            //R21.12PP ATV
                            // (ค่าติดตั้ง Action == "Add" , ส่วนลดค่าติดตั้ง Action == "Del", ข้อมูลที่มาจาก ATV ใช้ flagATV == true)
                            if (PackageData.Action == "Del") strInstallPlaybox = PackageData.Name;
                            //---------

                            //R21.12PP ATV (แบบเก่า ไม่ได้ใช้ เก็บไว้ก่อน)
                            @*if (PackageData.Action == "Add") {
                                sumInstallPlaybox += PackageData.Value;
                            }
                            else {
                                sumInstallPlaybox -= PackageData.Value;
                            }*@
                        });

                        strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + strInstallPlaybox + "</label></dd>"; //R21.12PP ATV

                        //R21.12PP ATV (แบบเก่า ไม่ได้ใช้ เก็บไว้ก่อน)
                        @*if (sumInstallPlaybox == 0) {
                            strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>@L_ONTOP_PLAYBOX_FREE " + strInstallPlaybox + "</label></dd>";
                        }
                        else {
                            strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + strInstallPlaybox + "</label></dd>";
                        }*@
                    }
                    //package packageContentPlayboxAutoList show
                    if (tmpPackageDataV2.packageAutoList.length > 0) {
                        var tmpPackageContentPlayboxAuto = tmpPackageDataV2.packageAutoList.filter(function (elem) {
                            return elem.MAPPING_CODE.indexOf(mappingCode) !== -1
                                && elem.DISPLAY_FLAG.indexOf("Y") !== -1
                                && elem.PACKAGE_SERVICE_CODE.indexOf("00002") !== -1;
                        });
                        $.each(tmpPackageContentPlayboxAuto, function (indexSubData, PackagePlayboxData) {
                            if ('@language' == "1") {
                                strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + PackagePlayboxData.PACKAGE_DISPLAY_THA + "</label></dd>";
                            }
                            else {
                                strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + PackagePlayboxData.PACKAGE_DISPLAY_ENG + "</label></dd>";
                            }
                        });
                    }
                    //package packageContentPlayboxAutoList
                    if (tmpPackageDataV2.packageAutoList.length > 0) {
                        var tmpPackageContentPlayboxAuto = tmpPackageDataV2.packageAutoList.filter(function (elem) {
                            return elem.MAPPING_CODE.indexOf(mappingCode) !== -1
                                && elem.DISPLAY_FLAG.indexOf("N") !== -1
                                && elem.PACKAGE_SERVICE_CODE.indexOf("00002") !== -1;
                        });
                    }
                });
            }

            // Content Playbox (packageContentPlayboxList) //R21.11 ATV (แบบเก่า ไม่ได้ใช้ เก็บไว้ก่อน)
            @*var selectContentPlaybox = $("#divCheckboxContentPlaybox input[type=checkbox]:checked");
            if (selectContentPlaybox != undefined && selectContentPlaybox.length > 0) {
                selectContentPlaybox.each(function (indexData, selectContentPlayboxData) {
                    var sffPromotionCodeContentPlayBox = "";
                    sffPromotionCodeContentPlayBox = this.id;
                    sffPromotionCodeContentPlayBox = sffPromotionCodeContentPlayBox.replace("contentSubPlaybox_", "");
                    if (tmpPackageDataV2.packageContentPlayboxList.length > 0) {
                        var tmpPackageContentPlaybox = tmpPackageDataV2.packageContentPlayboxList.filter(function (elem) {
                            return elem.MAPPING_CODE.indexOf(mappingCode) !== -1
                                && elem.SFF_PROMOTION_CODE.indexOf(sffPromotionCodeContentPlayBox) !== -1;
                        });
                        $.each(tmpPackageContentPlaybox, function (indexData, PackageContentPlayboxData) {
                            if ('@language' == "1") {
                                strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + PackageContentPlayboxData.PACKAGE_DISPLAY_THA + "</label></dd>";
                            }
                            else {
                                strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + PackageContentPlayboxData.PACKAGE_DISPLAY_ENG + "</label></dd>";
                            }
                        });
                    }
                });
            }*@
            // Content Playbox Auto //R21.11 ATV
            if (objMonthlyContentPlayBoxAutoArry != undefined && objMonthlyContentPlayBoxAutoArry.length > 0) {
                $.each(objMonthlyContentPlayBoxAutoArry, function (indexData, selectContentPlayBoxAutoData) {
                    strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectContentPlayBoxAutoData.Name + "</label></dd>";
                });
            }

            // Content Playbox Ontop //R21.11 ATV
            if (objMonthlyContentPlayBoxOntopArry != undefined && objMonthlyContentPlayBoxOntopArry.length > 0) {
                $.each(objMonthlyContentPlayBoxOntopArry, function (indexData, selectContentPlayBoxOntopData) {
                    strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectContentPlayBoxOntopData.Name + "</label></dd>";
                });
            }

            // Fixline
            $('#hdGetVoip').val("0");
            var isShowed = true;
            var selectFixline = $("#divVasBoxDynamic input[name=contentFixline]:checked");
            if (selectFixline != undefined && selectFixline.length > 0) {
                $('#hdGetVoip').val("1");
                $.each(selectFixline, function (indexData, selectFixlineData) {
                    var sffPromotionCodeFixline = selectFixlineData.id;
                    sffPromotionCodeFixline = sffPromotionCodeFixline.replace("contentFixline_", "");
                    if (tmpPackageDataV2.packageFixlineList.length > 0) {
                        var tmpPackageFixline = tmpPackageDataV2.packageFixlineList.filter(function (elem) {
                            return elem.MAPPING_CODE.indexOf(mappingCode) !== -1
                                && elem.SFF_PROMOTION_CODE.indexOf(sffPromotionCodeFixline) !== -1;
                        });
                        $.each(tmpPackageFixline, function (indexData, PackageFixlineData) {
                            if (isShowed) {
                                strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>@L_FIXEDLINE</label></dd>";
                                isShowed = false;
                            }
                        });
                    }
                    if (tmpPackageDataV2.packageFixlineInstallList.length > 0) {
                        var tmpPackageFixlineInstall = tmpPackageDataV2.packageFixlineInstallList.filter(function (elem) {
                            return elem.MAPPING_CODE.indexOf(mappingCode) !== -1
                                && elem.SFF_PROMOTION_CODE.indexOf(sffPromotionCodeFixline) !== -1;
                        });
                        $.each(tmpPackageFixlineInstall, function (indexSubData, PackageFixlineInstallData) {
                            if (isShowed) {
                                strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>@L_FIXEDLINE</label></dd>";
                                isShowed = false;
                            }
                        });
                    }
                });
            }

            // WifiLog
            if (objMonthlyWiFiLogArry != undefined && objMonthlyWiFiLogArry.length > 0) {
                $.each(objMonthlyWiFiLogArry, function (indexData, selectWifiLogData) {
                    strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectWifiLogData.Name + "</label></dd>";
                });
            }

            // SpeedBoost
            if (objMonthlySpeedBoostArry != undefined && objMonthlySpeedBoostArry.length > 0) {
                $.each(objMonthlySpeedBoostArry, function (indexData, selectSpeedBoostData) {
                    strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + selectSpeedBoostData.Name + "</label></dd>";
                });
            }

            // Auto Package (packageAutoList show)
            if (tmpPackageDataV2.packageAutoList.length > 0) {
                var tmpPackageAuto = tmpPackageDataV2.packageAutoList.filter(function (elem) {
                    return elem.MAPPING_CODE.indexOf(mappingCode) !== -1
                        && elem.DISPLAY_FLAG.indexOf("Y") !== -1
                        && elem.PACKAGE_SERVICE_CODE.indexOf("00001") !== -1;
                });
                $.each(tmpPackageAuto, function (indexData, PackageAutoData) {
                    if ('@language' == "1") {
                        strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + PackageAutoData.PACKAGE_DISPLAY_THA + "</label></dd>";
                    }
                    else {
                        strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + PackageAutoData.PACKAGE_DISPLAY_ENG + "</label></dd>";
                    }
                });
            }

            // Discount (packageDiscountList)
            var discountSffPromotionCode = "";
            objDiscountArry = [];
            discountSffPromotionCode = $("input[name=SelectOntopRadioSP]:checked").val();
            if (discountSffPromotionCode != undefined && discountSffPromotionCode != "") {
                if (tmpPackageDataV2.packageDiscountList.length > 0) {
                    var tmpPackageDiscount = tmpPackageDataV2.packageDiscountList.filter(function (elem) {
                        return elem.MAPPING_CODE.indexOf(mappingCode) !== -1
                            && elem.SFF_PROMOTION_CODE.indexOf(discountSffPromotionCode) !== -1;
                    });
                    if (tmpPackageDiscount != undefined && tmpPackageDiscount.length > 0) {
                        packageGroupOntopDiscount = tmpPackageDiscount[0].PACKAGE_GROUP.toUpperCase();
                        if ('@language' == "1") {
                            strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + tmpPackageDiscount[0].PACKAGE_DISPLAY_THA + "</label></dd>";
                        }
                        else {
                            strOntopSummaryDesctiption += "<dd><label style='font-weight: bold;'>" + tmpPackageDiscount[0].PACKAGE_DISPLAY_ENG + "</label></dd>";
                        }
                        objDiscountArry.push({ SffPromotionCode: tmpPackageDiscount[0].SFF_PROMOTION_CODE, Name: tmpPackageDiscount[0].PACKAGE_NAME, Value: tmpPackageDiscount[0].PRICE_CHARGE });
                        /// ShowRemarkGreeting
                        if (!showRemarkGreeting) {
                            $.each(myCheckATTACHED, function (index, item) {
                                if (packageGroupOntopDiscount.indexOf(item) > -1) {
                                    showRemarkGreeting = true;
                                }
                            });
                        }
                    }
                }
            }
        }
        strOntopSummaryDesctiption += "</dl> <p class='clearfix'></p>";
        $('#ontopSummaryDesctiption_div').html(strOntopSummaryDesctiption);

        SetSummarytab9Detail();
        SetPreprintDetail(havePlaybox);
        SetQrCodeLine();

        /// ShowRemarkGreeting
        if (showRemarkGreeting) {
            $("#divUploadpicBill").show();
            $("#RemarkGreeting").show();
            $('#txtfor_L_REMARK_GREETING').show();
        }
        else {
            $("#divUploadpicBill").hide();
            $("#RemarkGreeting").hide();
            $('#txtfor_L_REMARK_GREETING').hide();
        }

    }


    function SetSummarytab9Detail() {
        var packageIndexVale = $("input[name=SelectPackage]:checked").val();
        var mappingCode = $("#MAPPING_CODE" + packageIndexVale).val();
        //RegisterSummary summarytab9Detail
        $('#summarytab9Detail').html('');
        var strSummarytab9Detail = "<h4 class='tgreen'><span class='hightlight'>@L_YOUR_PACK</span></h4><p class='clearfix'></p>";

        //Monthly Main Package
        if (objMonthlyMainPackageArry != undefined && objMonthlyMainPackageArry.length > 0) {
            strSummarytab9Detail += "<dl class='dl-horizontal'><dt>@L_MAIN_PACK : </dt>";
            $.each(objMonthlyMainPackageArry, function (indexData, PackageData) {
                strSummarytab9Detail += "<dd><div style='font-weight: bold;'>" + PackageData.NameSFF + "</div><p id='txtfor_L_REMARK_GREETING'>@L_REMARK_GREETING</p></dd>";
            });
            strSummarytab9Detail += "</dl><p class='clearfix'></p>";
        }

        if ((objInstallArry != undefined && objInstallArry.length > 0)
            || (objInstallContentSuperMESHWifiArry != undefined && objInstallContentSuperMESHWifiArry.length > 0) //R21.11 ATV
            || (objMonthlySuperMESHWifiArry != undefined && objMonthlySuperMESHWifiArry.length > 0)
            || (objInstallContentPlayboxArry != undefined && objInstallContentPlayboxArry.length > 0)
            || (objMonthlyPlayBoxArry != undefined && objMonthlyPlayBoxArry.length > 0)
            || (objMonthlyContentPlayBoxArry != undefined && objMonthlyContentPlayBoxArry.length > 0) //R21.11 ATV (แบบเก่า ไม่ได้ใช้ เก็บไว้ก่อน)
            || (objMonthlyContentPlayBoxAutoArry != undefined && objMonthlyContentPlayBoxAutoArry.length > 0) //R21.11 ATV
            || (objMonthlyContentPlayBoxOntopArry != undefined && objMonthlyContentPlayBoxOntopArry.length > 0) //R21.11 ATV
            || (objInstallContentFixlineArry != undefined && objInstallContentFixlineArry.length > 0)
            || (objMonthlyFixlineArry != undefined && objMonthlyFixlineArry.length > 0)
            || (objMonthlyWiFiLogArry != undefined && objMonthlyWiFiLogArry.length > 0)
            || (objMonthlySpeedBoostArry != undefined && objMonthlySpeedBoostArry.length > 0)
            || (objMonthlyAutoPackageArry != undefined && objMonthlyAutoPackageArry.length > 0)
            || (objMonthlyDiscountPackageArry != undefined && objMonthlyDiscountPackageArry.length > 0)) {

            strSummarytab9Detail += "<dl class='dl-horizontal'><dt>@lONTOP_PACK : </dt>";

            //Install Internet
            if (objInstallArry != undefined && objInstallArry.length > 0) {
                strSummarytab9Detail += "<dd><span style='font-weight: bold;'>@L_SUMM_DETAIL6</span></dd>";
            }
            if ("@Html.Raw(meshArpu_Month_Flag)" == "Y") {
                //Monthly SuperMESHWifi //mesh arpu
                if (objMonthlySuperMESHWifiArry != undefined && objMonthlySuperMESHWifiArry.length > 0) {
                    $.each(objMonthlySuperMESHWifiArry, function (indexData, PackageData) {

                        if (PackageData.qty == "2") {
                            strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.NameR1 + " " + PackageData.Price1 + " " + PackageData.currency + "</span></dd>";
                            strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.NameR2 + " " + PackageData.Price2 + " " + PackageData.currency + "</span></dd>";
                            if (PackageData.NameR2_Discount != "") {
                                strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.NameR2_Discount + " " + PackageData.Price2_Discount + " " + PackageData.currency + "</span></dd>";
                            }
                            //strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.NameS + " " + PackageData.Value + " " + PackageData.currency + "</span></dd>";
                        } else if (PackageData.qty == "3") {
                            strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.NameR1 + " " + PackageData.Price1 + " " + PackageData.currency + "</span></dd>";
                            strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.NameR2 + " " + PackageData.Price2 + " " + PackageData.currency + "</span></dd>";
                            strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.NameR3 + " " + PackageData.Price3 + " " + PackageData.currency + "</span></dd>";
                            if (PackageData.NameR2_Discount != "") {
                                strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.NameR2_Discount + " " + PackageData.Price2_Discount + " " + PackageData.currency + "</span></dd>";
                            }
                            if (PackageData.NameR3_Discount != "") {
                                strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.NameR3_Discount + " " + PackageData.Price3_Discount + " " + PackageData.currency + "</span></dd>";
                            }
                            //strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.NameS + " " + PackageData.Value + " " + PackageData.currency + "</span></dd>";
                        } else {

                            strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.NameR1 + " " + PackageData.Price1 + " " + PackageData.currency + "</span></dd>";
                            //strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.NameS + " " + PackageData.Value + " " + PackageData.currency + "</span></dd>";
                        }


                    });
                }
            } else {
                //Monthly SuperMESHWifi
                if (objMonthlySuperMESHWifiArry != undefined && objMonthlySuperMESHWifiArry.length > 0) {
                    $.each(objMonthlySuperMESHWifiArry, function (indexData, PackageData) {
                        strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.NameR + " " + PackageData.Value + " " + PackageData.currency + "</span></dd>";
                    });
                }
            }

            //Install SuperMESHWifi //R21.12PP ATV
            if (objInstallContentSuperMESHWifiArry != undefined && objInstallContentSuperMESHWifiArry.length > 0) {
                var tmpMeshCodeMain = "";
                var strInstallSuperMESHWifi = "";
                $.each(objInstallContentSuperMESHWifiArry, function (indexData, PackageData) {
                    if (PackageData.Action == "Del") {
                        tmpMeshCodeMain = PackageData.MeshCodeMain;
                        strInstallSuperMESHWifi = PackageData.Name;
                    }
                });

                var MESH_COUNT = parseInt($("#ddlSuperMESHWifi" + tmpMeshCodeMain).val());
                if (MESH_COUNT == 1) {
                    strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + strInstallSuperMESHWifi + "</span></dd>";
                }
                else {
                    var icMesh = 0;
                    var strWORDIND_MESH = "";
                    while (icMesh < MESH_COUNT) {
                        strWORDIND_MESH = "@WORDIND_MESH";
                        strWORDIND_MESH = strWORDIND_MESH.replace("{x}", (icMesh + 1).toString());

                        strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + strInstallSuperMESHWifi + " " + strWORDIND_MESH + "</span></dd>";

                        icMesh++;
                    }
                }
            }

           // IP Camera
           // แพ็คเกจเสริม
            if ( "@CHK_IPCAMERA_ACTIVESTATUS" == "Open") { //R23.06 IP Camera
                if(objMonthlyIpCameraGroupArry != undefined )
                {
                    var activeFlagIPCamera = "@GetlovCusregisIPcamera";
                    var count = 1;
                    $.each(objMonthlyIpCameraGroupArry, function (indexData, selectIpCameraDatas) {
                        $.each(selectIpCameraDatas, function (indexData, selectIpCameraData) {
                            let quantity = selectIpCameraDatas.length;
                            let priceAll = selectIpCameraData.IPCamera_MonthlyFee_Price * quantity;
                            var lovCusregisIPcamera = "@GetlovCusregisIPcamera";
                            var strWORDIND_IPCamera = "@WORDIND_MESH";
                            strWORDIND_IPCamera = strWORDIND_IPCamera.replace('{x}', count.toString());
                            if (indexData == 0) {
                                strSummarytab9Detail += "<dd><label style='font-weight: bold;'>" + selectIpCameraData.IPCamera_MonthlyFee + " " + accounting.formatNumber(priceAll, 2) + " " + selectIpCameraData.L_BAHT + "</label></dd>";
                            }
                            if (activeFlagIPCamera != null && activeFlagIPCamera != "") {
                                if (quantity == 1) {
                                    strSummarytab9Detail += "<dd><label style='font-weight: bold;'>" + lovCusregisIPcamera + "</label></dd>";
                                }
                                else {

                                    strSummarytab9Detail += "<dd><label style='font-weight: bold;'>" + lovCusregisIPcamera + " " + strWORDIND_IPCamera + "</label></dd>";
                                }
                            }
                            if (activeFlagIPCamera == null || activeFlagIPCamera == "") {
                                strSummarytab9Detail += "<dd><label style='font-weight: bold;'>" + selectIpCameraData.IPCamera_SetupFee_Discount + "</label></dd>"; 
                            }
                            count++;         
                        }); 
                    });
                }
            }

            //Monthly PlayBox
            if (objMonthlyPlayBoxArry != undefined && objMonthlyPlayBoxArry.length > 0) {
                $.each(objMonthlyPlayBoxArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.Name + "</span></dd>";
                });
            }
            //Install Playbox
            if (objInstallContentPlayboxArry != undefined && objInstallContentPlayboxArry.length > 0) {
                var sumInstallPlaybox = 0;
                var strInstallPlaybox = "";
                $.each(objInstallContentPlayboxArry, function (indexData, PackageData) {
                    //R21.12PP ATV
                    // (ค่าติดตั้ง Action == "Add" , ส่วนลดค่าติดตั้ง Action == "Del", ข้อมูลที่มาจาก ATV ใช้ flagATV == true)
                    if (PackageData.Action == "Del") strInstallPlaybox = PackageData.Name;
                    //---------

                    //R21.12PP ATV (แบบเก่า ไม่ได้ใช้ เก็บไว้ก่อน)
                    @*if (PackageData.Action == "Add") {
                        sumInstallPlaybox += PackageData.Value;
                    }
                    else {
                        sumInstallPlaybox -= PackageData.Value;
                    }*@
                });

                strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + strInstallPlaybox + "</span></dd>"; //R21.12PP ATV

                //R21.12PP ATV (แบบเก่า ไม่ได้ใช้ เก็บไว้ก่อน)
                @*if (sumInstallPlaybox == 0) {
                    strSummarytab9Detail += "<dd><span style='font-weight: bold;'>@L_ONTOP_PLAYBOX_FREE " + strInstallPlaybox + "</span></dd>";
                }
                else {
                    strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + strInstallPlaybox + "</span></dd>";
                }*@
            }
            //Monthly Content Playbox //R21.11 ATV (แบบเก่า ไม่ได้ใช้ เก็บไว้ก่อน)
            @*if (objMonthlyContentPlayBoxArry != undefined && objMonthlyContentPlayBoxArry.length > 0) {
                $.each(objMonthlyContentPlayBoxArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.Name + "</span></dd>";
                });
            }*@
            //Monthly Content Playbox Auto //R21.11 ATV
            if (objMonthlyContentPlayBoxAutoArry != undefined && objMonthlyContentPlayBoxAutoArry.length > 0) {
                $.each(objMonthlyContentPlayBoxAutoArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.Name + "</span></dd>";
                });
            }
            //Monthly Content Playbox Ontop //R21.11 ATV
            if (objMonthlyContentPlayBoxOntopArry != undefined && objMonthlyContentPlayBoxOntopArry.length > 0) {
                $.each(objMonthlyContentPlayBoxOntopArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.Name + "</span></dd>";
                });
            }
            //Monthly Install Fixline
            if ((objMonthlyFixlineArry != undefined && objMonthlyFixlineArry.length > 0)
                || (objInstallContentFixlineArry != undefined && objInstallContentFixlineArry.length > 0)) {
                strSummarytab9Detail += "<dd><span style='font-weight: bold;'>@L_FIXEDLINE</span></dd>";
            }
            //Monthly WiFiLog
            if (objMonthlyWiFiLogArry != undefined && objMonthlyWiFiLogArry.length > 0) {
                $.each(objMonthlyWiFiLogArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.Name + "</span></dd>";
                });
            }
            //Monthly SpeedBoost
            if (objMonthlySpeedBoostArry != undefined && objMonthlySpeedBoostArry.length > 0) {
                $.each(objMonthlySpeedBoostArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.Name + "</span></dd>";
                });
            }
            //Monthly Auto Package
            if (objMonthlyAutoPackageArry != undefined && objMonthlyAutoPackageArry.length > 0) {
                $.each(objMonthlyAutoPackageArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.Name + "</span></dd>";
                });
            }
            //Monthly Discount Package
            if (objMonthlyDiscountPackageArry != undefined && objMonthlyDiscountPackageArry.length > 0) {
                $.each(objMonthlyDiscountPackageArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<dd><span style='font-weight: bold;'>" + PackageData.Name + "</span></dd>";
                });
            }

            strSummarytab9Detail += "</dl><p class='clearfix page-header'></p>";
        }

        //----------------------------------------------------------------------------------------------------------------------------------------------------------

        //EntryFee
        if (objEntryFeeArry != undefined && objEntryFeeArry.length > 0) {
            strSummarytab9Detail += "<div class='col-md-12 col-xs-12'><span style='font-weight: bold;'>@L_CHARGE_ON_INSTALL_DATE</span></div>";
            $.each(objEntryFeeArry, function (indexData, PackageData) {
                strSummarytab9Detail += "<div class='col-md-12 col-xs-12' ><p class='clearfix'></p>";
                strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.Name + "</span></div>";
                strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                strSummarytab9Detail += "</div><p class='clearfix'></p>";
            });
        }

        strSummarytab9Detail += "<div class='col-md-12 col-xs-12'><span style='font-weight: bold;'>@L_SUMM_DETAIL1</span></div><p class='clearfix'></p>";
        strSummarytab9Detail += "<div class='col-md-12 col-xs-12'><span>" + lineSetupDetail +"</span></div><p class='clearfix'></p>";

        //----------------------------------------------------------------------------------------------------------------------------------------------------------

        //Install
        if ((objInstallArry != undefined && objInstallArry.length > 0)
            || (objInstallContentSuperMESHWifiArry != undefined && objInstallContentSuperMESHWifiArry.length > 0)
            || (objInstallContentFixlineArry != undefined && objInstallContentFixlineArry.length > 0)
            || (objInstallContentPlayboxArry != undefined && objInstallContentPlayboxArry.length > 0)) {

            var sumInstall = 0;
            strSummarytab9Detail += "<div class='col-md-12 col-xs-12'><span style='font-weight: bold;'>@L_SUMM_DETAIL5</span></div><p class='clearfix'></p>";

            //Install Internet
            if (objInstallArry != undefined && objInstallArry.length > 0) {
                $.each(objInstallArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.Name + "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    if (PackageData.Action == "Add") {
                        sumInstall += PackageData.Value;
                    }
                    else {
                        sumInstall -= PackageData.Value;
                    }
                });
            }
            //Install SuperMESHWifi //R21.11 ATV
            if (objInstallContentSuperMESHWifiArry != undefined && objInstallContentSuperMESHWifiArry.length > 0) {
                @*$.each(objInstallContentSuperMESHWifiArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.Name + "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    if (PackageData.Action == "Add") {
                        sumInstall += PackageData.Value;
                    }
                    else {
                        sumInstall -= PackageData.Value;
                    }
                });*@
                //R21.12PP ATV
                var tmpMeshCodeMain = "";
                var tmpstrMeshInstall = "";
                var tmpstrMeshDisInstall = "";
                var tmpprePriceCharge = 0;
                var tmppriceCharge = 0;
                $.each(objInstallContentSuperMESHWifiArry, function (indexData, PackageData) {
                    if (PackageData.Action == "Add") {
                        tmpMeshCodeMain = PackageData.MeshCodeMain;
                        tmpstrMeshInstall = PackageData.Name;
                        tmpprePriceCharge = PackageData.Value;
                        sumInstall += PackageData.Value;
                    }
                    else {
                        tmpstrMeshDisInstall = PackageData.Name;
                        tmppriceCharge = PackageData.Value;
                        sumInstall -= PackageData.Value;
                    }
                });
                var MESH_COUNT = parseInt($("#ddlSuperMESHWifi" + tmpMeshCodeMain).val());
                if (MESH_COUNT == 1) {
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + tmpstrMeshInstall + "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(tmpprePriceCharge, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";

                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + tmpstrMeshDisInstall + "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(tmppriceCharge, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                }
                else {
                    var icMesh = 0;
                    var strWORDIND_MESH = "";
                    while (icMesh < MESH_COUNT) {
                        strWORDIND_MESH = "@WORDIND_MESH";
                        strWORDIND_MESH = strWORDIND_MESH.replace("{x}", (icMesh + 1).toString());
                        strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                        strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + tmpstrMeshInstall + " " + strWORDIND_MESH + "</span></div>";
                        strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(tmpprePriceCharge, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                        strSummarytab9Detail += "</div><p class='clearfix'></p>";

                        strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                        strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + tmpstrMeshDisInstall + " " + strWORDIND_MESH + "</span></div>";
                        strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(tmppriceCharge, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                        strSummarytab9Detail += "</div><p class='clearfix'></p>";

                        icMesh++;
                    }
                }
                //ผลรวม(sumInstall) ของ Install SuperMESHWifi คิดครั้งเดียว เพราะใช้ข้อมูลที่มากจากตัวเดียวกัน
                //------------------
            }

            //Install IP Camera
            // ค่าติดตั้ง
            if ( "@CHK_IPCAMERA_ACTIVESTATUS" == "Open") { //R23.06 IP Camera
                if(objMonthlyIpCameraGroupArry != undefined)
                {
                    var sumInstallIPCamera = 0;
                    // Default 1
                    $.each(objMonthlyIpCameraGroupArry, function (indexData, selectIpCameraDatas) {
                        $.each(selectIpCameraDatas, function (indexData, selectIpCameraData) {
                        //ราคา Install
                            strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                            strSummarytab9Detail += "<div class='col-md-8 col-xs-8'><span >" + selectIpCameraData.IPCamera_SetupFee + "</span></div>";
                            strSummarytab9Detail += "<div class='text-right col-md-4 col-xs-4'><span>" + accounting.formatNumber(selectIpCameraData.SetupFee_Price, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                            strSummarytab9Detail += "</div><p class='clearfix'></p>";

                            sumInstall += selectIpCameraData.SetupFee_Price;
                            sumInstallIPCamera += selectIpCameraData.SetupFee_Price;

                            if(selectIpCameraData.IPCamera_SetupFee_Discount != "" && selectIpCameraData.IPCamera_SetupFee_Discount != null)
                            {
                                strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                                strSummarytab9Detail += "<div class='col-md-8 col-xs-8'><span >" + selectIpCameraData.IPCamera_SetupFee_Discount + "</span></div>";
                                strSummarytab9Detail += "<div class='text-right col-md-4 col-xs-4'><span>" + accounting.formatNumber(selectIpCameraData.SetupFee_Price_Discount, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                                strSummarytab9Detail += "</div><p class='clearfix'></p>";
                            }

                            if(selectIpCameraData.SetupFee_Price_Discount != 0)
                            {
                                sumInstall -= selectIpCameraData.SetupFee_Price_Discount;
                                sumInstallIPCamera -= selectIpCameraData.SetupFee_Price_Discount;
                            }

                        });
                    });

                    // ไม่ต้องรวม หน้าselect package รวมมาให้แล้ว
                    // if(sumInstallIPCamera != 0)
                    // {
                    //     //บวกค่าติดตั้งของip camera เข้ากับยอดสุดท้ายที่ต้องชำระ
                    //     firstShellCostArry[2].Value += sumInstallIPCamera;
                    // }
                }
            }

            //Install Playbox
            if (objInstallContentPlayboxArry != undefined && objInstallContentPlayboxArry.length > 0) {
                $.each(objInstallContentPlayboxArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.Name + "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    if (PackageData.Action == "Add") {
                        sumInstall += PackageData.Value;
                    }
                    else {
                        sumInstall -= PackageData.Value;
                    }
                });
            }
            //Install Fixline
            if (objInstallContentFixlineArry != undefined && objInstallContentFixlineArry.length > 0) {
                $.each(objInstallContentFixlineArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.Name + "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    if (PackageData.Action == "Add") {
                        sumInstall += PackageData.Value;
                    }
                    else {
                        sumInstall -= PackageData.Value;
                    }
                });
            }

            strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
            strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >@L_SUMM_DETAIL8</span></div>";
            strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(sumInstall, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
            strSummarytab9Detail += "</div><p class='clearfix'></p>";
        }

        //----------------------------------------------------------------------------------------------------------------------------------------------------------

        //Monthly
        if ((objMonthlyMainPackageArry != undefined && objMonthlyMainPackageArry.length > 0)
            || (objMonthlySuperMESHWifiArry != undefined && objMonthlySuperMESHWifiArry.length > 0) //R21.11 ATV
            || (objMonthlyPlayBoxArry != undefined && objMonthlyPlayBoxArry.length > 0)
            || (objMonthlyContentPlayBoxArry != undefined && objMonthlyContentPlayBoxArry.length > 0) //R21.11 ATV (แบบเก่า ไม่ได้ใช้ เก็บไว้ก่อน)
            || (objMonthlyContentPlayBoxAutoArry != undefined && objMonthlyContentPlayBoxAutoArry.length > 0) //R21.11 ATV
            || (objMonthlyContentPlayBoxOntopArry != undefined && objMonthlyContentPlayBoxOntopArry.length > 0) //R21.11 ATV
            || (objMonthlyFixlineArry != undefined && objMonthlyFixlineArry.length > 0)
            || (objMonthlyWiFiLogArry != undefined && objMonthlyWiFiLogArry.length > 0)
            || (objMonthlySpeedBoostArry != undefined && objMonthlySpeedBoostArry.length > 0)
            || (objMonthlyAutoPackageArry != undefined && objMonthlyAutoPackageArry.length > 0)
            || (objMonthlyDiscountPackageArry != undefined && objMonthlyDiscountPackageArry.length > 0)) {

            var sumMonthly = 0;
            strSummarytab9Detail += "<div class='col-md-12 col-xs-12'><span style='font-weight: bold;'>@L_SUMM_DETAIL9</span></div><p class='clearfix'></p>";

            //Monthly Main Package
            if (objMonthlyMainPackageArry != undefined && objMonthlyMainPackageArry.length > 0) {
                $.each(objMonthlyMainPackageArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.Name + "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    sumMonthly += PackageData.Value;
                });
            }
            if ("@Html.Raw(meshArpu_Month_Flag)" == "Y") {

                        //Monthly SuperMESHWifi //mesh arpu
             if (objMonthlySuperMESHWifiArry != undefined && objMonthlySuperMESHWifiArry.length > 0) {
                $.each(objMonthlySuperMESHWifiArry, function (indexData, PackageData) {

                    if(PackageData.qty=="2"){
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.NameR1.replace("100", PackageData.Price1)+ "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Price1, 2) + "</span>&nbsp;<span> @Html.Raw(L_BAHT)</span></div>";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.NameR2.replace("100", PackageData.Price2)+ "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Price2, 2) + "</span>&nbsp;<span> @Html.Raw(L_BAHT)</span></div>";
                    if(PackageData.NameR2_Discount != "")
                    {
                        strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.NameR2_Discount.replace("100", PackageData.Price2_Discount)+ "</span></div>";
                        strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Price2_Discount, 2) + "</span>&nbsp;<span> @Html.Raw(L_BAHT)</span></div>";                    
                    }
                    //strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.NameS+ "</span></div>";
                    //strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @Html.Raw(L_BAHT)</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    sumMonthly += PackageData.Value;

                    }else if(PackageData.qty=="3"){
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.NameR1.replace("100", PackageData.Price1)+ "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Price1, 2) + "</span>&nbsp;<span> @Html.Raw(L_BAHT)</span></div>";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.NameR2.replace("100", PackageData.Price2)+ "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Price2, 2) + "</span>&nbsp;<span> @Html.Raw(L_BAHT)</span></div>";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.NameR3.replace("100", PackageData.Price3)+ "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Price3, 2) + "</span>&nbsp;<span> @Html.Raw(L_BAHT)</span></div>";
                    if(PackageData.NameR2_Discount != "")
                    {
                        strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.NameR2_Discount.replace("100", PackageData.Price2_Discount)+ "</span></div>";
                        strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Price2_Discount, 2) + "</span>&nbsp;<span> @Html.Raw(L_BAHT)</span></div>";                 
                    }
                    if(PackageData.NameR3_Discount != "")
                    {
                        strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.NameR3_Discount.replace("100", PackageData.Price3_Discount)+ "</span></div>";
                        strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Price3_Discount, 2) + "</span>&nbsp;<span> @Html.Raw(L_BAHT)</span></div>";                 
                    }
                    //strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.NameS+ "</span></div>";
                    @*strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @Html.Raw(L_BAHT)</span></div>";*@
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    sumMonthly += PackageData.Value;

                    }
                    else{
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.NameR1.replace("100", PackageData.Price1)+ "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Price1, 2) + "</span>&nbsp;<span> @Html.Raw(L_BAHT)</span></div>";
                     //strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.NameS+ "</span></div>";
                    //strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @Html.Raw(L_BAHT)</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    sumMonthly += PackageData.Value;

                    }

                });
            }
            } else {
                //Monthly SuperMESHWifi
                if (objMonthlySuperMESHWifiArry != undefined && objMonthlySuperMESHWifiArry.length > 0) {
                    $.each(objMonthlySuperMESHWifiArry, function (indexData, PackageData) {
                        strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                        strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.NameR.replace("100", PackageData.Value) + "</span></div>";
                        strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                        strSummarytab9Detail += "</div><p class='clearfix'></p>";
                        sumMonthly += PackageData.Value;
                    });
                }
            }

            // IP Camera
            // รายเดือน
            if ( "@CHK_IPCAMERA_ACTIVESTATUS" == "Open") { //R23.06 IP Camera
                if(objMonthlyIpCameraGroupArry != undefined)
                {
                    var sumMonthlyIPCamera = 0;
                    $.each(objMonthlyIpCameraGroupArry, function (indexDatas, selectIpCameraDatas) {
                        // 7 Days
                        // 14 Days
                        // 30 Days
                        $.each(selectIpCameraDatas, function (indexData, selectIpCameraData) {
                            if(indexData == 0)
                            {
                                //ราคา * จำนวนตัวกล้อง
                                let quantity = selectIpCameraDatas.length;
                                let priceAll = selectIpCameraData.IPCamera_MonthlyFee_Price * quantity;
                                strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                                strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + selectIpCameraData.IPCamera_MonthlyFee + "</span></div>";
                                strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(priceAll, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                                strSummarytab9Detail += "</div><p class='clearfix'></p>";
                                sumMonthly += priceAll;
                                sumMonthlyIPCamera += priceAll;
                            }
                        });
                    });

                    // ไม่ต้องรวม หน้าselect package รวมมาให้แล้ว
                    // if(sumMonthlyIPCamera != 0)
                    // {
                    //     //บวกค่ารายเดือนของip camera เข้ากับยอดสุดท้ายที่ต้องชำระ
                    //     firstShellCostArry[2].Value += sumMonthlyIPCamera;
                    // }
                }
            }



            //Monthly PlayBox
            if (objMonthlyPlayBoxArry != undefined && objMonthlyPlayBoxArry.length > 0) {
                $.each(objMonthlyPlayBoxArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.Name + "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    sumMonthly += PackageData.Value;
                });
            }
            //Monthly Content Playbox //R21.11 ATV (แบบเก่า ไม่ได้ใช้ เก็บไว้ก่อน)
            @*if (objMonthlyContentPlayBoxArry != undefined && objMonthlyContentPlayBoxArry.length > 0) {
                $.each(objMonthlyContentPlayBoxArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.Name + "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    sumMonthly += PackageData.Value;
                });
            }*@
            //Monthly Content Playbox Auto
            if (objMonthlyContentPlayBoxAutoArry != undefined && objMonthlyContentPlayBoxAutoArry.length > 0) {// Content Playbox Auto //R21.11 ATV
                $.each(objMonthlyContentPlayBoxAutoArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.Name.replace("100", PackageData.Value)+ "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    sumMonthly += PackageData.Value;
                });
            }
            //Monthly Content Playbox Ontop
            if (objMonthlyContentPlayBoxOntopArry != undefined && objMonthlyContentPlayBoxOntopArry.length > 0) {// Content Playbox Ontop //R21.11 ATV
                $.each(objMonthlyContentPlayBoxOntopArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.Name.replace("100", PackageData.Value)+ "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    sumMonthly += PackageData.Value;
                });
            }
            //Monthly Fixline
            if (objMonthlyFixlineArry != undefined && objMonthlyFixlineArry.length > 0) {
                $.each(objMonthlyFixlineArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.Name + "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    sumMonthly += PackageData.Value;
                });
            }
            //Monthly WiFiLog
            if (objMonthlyWiFiLogArry != undefined && objMonthlyWiFiLogArry.length > 0) {
                $.each(objMonthlyWiFiLogArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.NameR + "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    sumMonthly += PackageData.Value;
                });
            }
            //Monthly SpeedBoost
            if (objMonthlySpeedBoostArry != undefined && objMonthlySpeedBoostArry.length > 0) {
                $.each(objMonthlySpeedBoostArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.NameR + "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    sumMonthly += PackageData.Value;
                });
            }
            //Monthly Auto Package
            if (objMonthlyAutoPackageArry != undefined && objMonthlyAutoPackageArry.length > 0) {
                $.each(objMonthlyAutoPackageArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.Name + "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    sumMonthly += PackageData.Value;
                });
            }
            //Monthly Discount Package
            if (objMonthlyDiscountPackageArry != undefined && objMonthlyDiscountPackageArry.length > 0) {
                $.each(objMonthlyDiscountPackageArry, function (indexData, PackageData) {
                    strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
                    strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >" + PackageData.Name + "</span></div>";
                    strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(PackageData.Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
                    strSummarytab9Detail += "</div><p class='clearfix'></p>";
                    sumMonthly -= PackageData.Value;
                });
            }
            //R23.04
            firstShellCostArry.push({ Name: "sumMonthly", Value: sumMonthly });

            strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
            strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span >@L_SUMM_DETAIL8</span></div>";
            strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span>" + accounting.formatNumber(sumMonthly, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
            strSummarytab9Detail += "</div><p class='clearfix'></p>";
        }

        // firstShellCostArry
        if (firstShellCostArry != undefined && firstShellCostArry.length > 4) {
             // calculateProrateAvg(firstShellCostArry);

            strSummarytab9Detail += "<div class='col-md-12 col-xs-12'><span style='font-weight: bold;'>" + firstShellCostArry[0].Name + "</span></div><p class='clearfix'></p>";

            strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
            // strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span>" + firstShellCostArry[1].Name + "</span></div>";

            //R23.04
            strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span id='prorate-avg-text'>" + firstShellCostArry[4].Name + "</span></div>";

            strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span id='prorate-avg-value'>" + accounting.formatNumber(firstShellCostArry[1].Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
            strSummarytab9Detail += "</div><p class='clearfix'></p>";

            strSummarytab9Detail += "<div class='col-md-12 col-xs-12' >";
            strSummarytab9Detail += "<div class='col-md-6 col-xs-6'><span style='font-weight: bold;'>" + firstShellCostArry[2].Name + "</span></div>";
            strSummarytab9Detail += "<div class='text-right col-md-6 col-xs-6'><span id='summary-all'>" + accounting.formatNumber(firstShellCostArry[2].Value, 2) + "</span>&nbsp;<span> @L_BAHT</span></div>";
            strSummarytab9Detail += "</div><p class='clearfix'></p>";

            strSummarytab9Detail += "<div class='col-md-12 col-xs-12'><span style='font-weight: bold;'>" + firstShellCostArry[3].Name + "</span></div><p class='clearfix'></p>";
        }
        strSummarytab9Detail += "<p class='clearfix'></p><p class='clearfix'></p>";

        $('#summarytab9Detail').html(strSummarytab9Detail);
    }



    // R23.05.2023 Created: THOTST49
    // ถ้ารู้สึกหงุดใจ โค้ดเดิมมันยิ่งกว่านี้ :)
    // ใหม่
    function SetPreprintDetail(havePlaybox) {
        if ('@Html.Raw(meshArpu_Month_Flag)' == 'Y') {

        } else {

        }

        var meshArpu_Month_Flag = "@Html.Raw(meshArpu_Month_Flag)".trim();
        var packageIndexVale = $("input[name=SelectPackage]:checked").val();
        var mappingCode = $("#MAPPING_CODE" + packageIndexVale).val();
        var packageIndexVale = $("input[name=SelectPackage]:checked").val();
        var mappingCode = $("#MAPPING_CODE" + packageIndexVale).val();
        var ProMainName = "";
        if ('@language' == "1") {
            ProMainName = $("#SFF_WORD_IN_STATEMENT_THA" + packageIndexVale).val().replace(/\|/g, '<br>');
        }
        else {
            ProMainName = $("#SFF_WORD_IN_STATEMENT_ENG" + packageIndexVale).val().replace(/\|/g, '<br>');
        }

        var strPreprintDetail = "";
        $('#preprintDetail').html("");
        strPreprintDetail += "<table style='width: 80%; margin: 5% auto;'><tbody>";
        strPreprintDetail += "<tr><td style='width: 80%; font-weight: bold;' colspan='10' id='bindData_AWN_NAME'></td>";
        strPreprintDetail += "<td style='width: 20%;' colspan='2' rowspan='2' align=right><img src='~/Images/aisFibre.JPG' alt='' border=0 height=55 width=106 /></td></tr>";
        strPreprintDetail += "<tr><td style='width: 100%; font-weight: bold;' colspan='12' id='bindData_AWN_ADDRESS'></td></tr>";
        strPreprintDetail += "<tr bgcolor='#66CC00'><td style='text-align: center; width: 100%; font-weight: bold;' colspan='12' id='bindData_APPLICATION_FORM'></td></tr>";
        strPreprintDetail += "<tr><td style='width: 50%; font-weight:bold;' colspan='6' id='bindData_SUBSCRIBER'></td><td style='width: 50%;' colspan='6' id='bindData_DATE'></td></tr>";
        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 25%;' colspan='3' id='bindData_NAME'></td><td style='width: 25%;' colspan='3' id='bindData_NAME_DATA'></td>";
        strPreprintDetail += "<td style='width: 30%;' colspan='3' id='bindData_CARD_TYPE'></td><td style='width: 25%;' colspan='3' id='bindData_CARD_NO'></td></tr>";
        strPreprintDetail += "<tr><td style='width: 25%;' colspan='3' id='bindData_MOBILE_NO'></td><td style='width: 25%;' colspan='3' id='bindData_MOBILE_NO_DATA'></td>";
        strPreprintDetail += "<td style='width: 25%;' colspan='3' id='bindData_TELEPHONE_NO'></td><td style='width: 25%;' colspan='3' id='bindData_TELEPHONE_NO_DATA'></td></tr>";
        strPreprintDetail += "<tr bgcolor='#C0C0C0' style='vertical-align: top;'><td style='width: 100%; font-weight: bold;' colspan='12' id='bindData_INSTALLATION_ADDRESS'></td></tr>"; // => สถานที่ติดตั้งอุปกรณ์
        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12' id='bindData_INSTALLATION_ADDRESS_DATA'></td></tr>"; // => เลขที่ 1 อาคาร/ชั้น/ห้อง ลุมพินี สวีท ปิ่นเกล้า เอ ตำบล/แขวง บางยี่ขัน อำเภอ/เขต บางพลัด จังหวัด กรุงเทพ รหัสไปรษณีย์ 10700
        strPreprintDetail += "<tr bgcolor='#C0C0C0' style='vertical-align: top;'><td style='width: 100%; font-weight: bold;' colspan='12' id=''>@L_RECEIVING_CHANNEL_EBILL</td></tr>"; // => ช่องทางการรับใบแจ้งค่าบริการ
        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12' id='bindData_BILLING_MEDIA_EBILL'></td></tr>"; // => eBill: SMS + ดูบิลผ่าน my AIS
        strPreprintDetail += "<tr bgcolor='#C0C0C0' style='vertical-align: top;'><td style='width: 100%; font-weight: bold;' colspan='12' id=''>@L_BILLING_ADDRESS</td></tr>"; // => ที่อยู่จัดส่งเอกสาร
        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12' id='bindData_BILLING_ADDRESS_DATA'></td></tr>"; // => เลขที่ a ตำบล/แขวง เกาะกลาง อำเภอ/เขต เกาะลันตา จังหวัด กระบี่ รหัสไปรษณีย์ 81120
        strPreprintDetail += "<tr bgcolor='#C0C0C0' style='vertical-align: top;'><td style='width: 100%; font-weight: bold;' colspan='12' id='bindData_FOR_REQUEST_SERVICE'><b></b></td></tr>"; // => ขอแจ้งความประสงค์สมัครใช้บริการอินเทอร์เน็ต เอไอเอสไฟเบอร์(AIS Fibre) ดังนี้

        //-----------------------------------------------------------------------------EntryFee-------------------------------------------------------------------------------------------
        // EntryFee
        var payEntryFee = 0;
        if (objEntryFeeArry != undefined && objEntryFeeArry.length > 0) {
            var strEntryFeeDetail = "";
            $.each(objEntryFeeArry, function (indexData, PackageData) {

                if (PackageData.Value > 0) {
                    payEntryFee = PackageData.Value;
                    strEntryFeeDetail = "@PreprintEntryFee";
                    strEntryFeeDetail = strEntryFeeDetail.replace("{EntryFee}", accounting.formatNumber(payEntryFee)); //R21.12PP ATV Float=>Int
                    strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>" + strEntryFeeDetail + "</td></tr>"; // => - ค่าแรกเข้า 800 บาท
                } else {
                    strEntryFeeDetail = "@PreprintExceptEntryFee";
                    strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>" + strEntryFeeDetail + "</td></tr>";
                }
            });
        }
        //------------------------------------------------------------------------------------------------------------------------------------------------------------------------

        //----------------------------------------------------------------------------Main Pack--------------------------------------------------------------------------------------------
        // Main Pack {RecurringCharge}
        var ProMainPrice = accounting.formatNumber(parseInt($("#PRICE_CHARGE" + packageIndexVale).val())); //R21.12PP ATV Float=>Int
        var ProMainPriceDetail = "@PreprintMonthlyFee";
        ProMainPriceDetail = ProMainPriceDetail.replace("{RecurringCharge}", ProMainPrice);
        if ($("#PRODUCT_SUBTYPE_" + packageIndexVale).val() == 'WTTx') {
            strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 67%;' colspan='8'>" + ProMainName + " @PreprintForWTTx</td>";
            strPreprintDetail += "<td style='width: 33%; text-align: right;' colspan='4'> </td></tr>";
        }
        else {
            strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 67%;' colspan='8'>" + ProMainName + "</td>";
            strPreprintDetail += "<td style='width: 33%; text-align: right;' colspan='4'>" + ProMainPriceDetail + "</td></tr>";
        }

         // รับสิทธิ์ยืมอุปกรณ์ MESH WiFi จากแพ็กเกจหลัก มูลค่า 2,500 บาท หรือ มูลค่า 3,990 บาท (ตามเงื่อนไขของแพ็กเกจหลัก)
            strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12' id='bindData_REQUEST_SERVICE'></td></tr>";
        

        // Install => รับส่วนลดค่าติดตั้ง 4,800 บาทโดยตกลงใช้บริการอย่างน้อย 24 รอบบิล*
        var sumInstall = 0;
        if (objInstallArry != undefined && objInstallArry.length > 0) {
            $.each(objInstallArry, function (indexData, PackageData) {
                if (PackageData.Action == "Add") {
                    sumInstall += PackageData.Value;
                }
                else {
                    sumInstall -= PackageData.Value;
                }
            });
            if (sumInstall > 0) {
                if ($("#WTTX_COVERAGE_RESULT").val() == '') {
                    strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>@PreprintPayInstallation</td></tr>";
                } else {
                    strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>@PreprintPayManageWTTX</td></tr>";
                }
            }
            else {
                if ($("#WTTX_COVERAGE_RESULT").val() == '') {
                    //R21.6 eApplication
                    var strFREE_INSTALLATION = "@PreprintFreeInstallation";
                    if ($("#Install_Package_Duration").val() != "") {
                        strFREE_INSTALLATION = strFREE_INSTALLATION.replace("{Mouth}", $("#Install_Package_Duration").val());
                    }
                    else {
                        strFREE_INSTALLATION = strFREE_INSTALLATION.replace("{Mouth}", "null");
                    }
                    strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>" + strFREE_INSTALLATION + "</td></tr>";

                    //strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>@PreprintFreeInstallation</td></tr>";
                } else {
                    strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>@PreprintFreeManageWTTX</td></tr>";
                }
            }
        }
        //------------------------------------------------------------------------------------------------------------------------------------------------------------------------

        //-------------------------------------------------------------------------MESH WiFi จุดที่ 1-----------------------------------------------------------------------------------------------

        // DECLARE 
        //- รับสิทธิ์ยืมอุปกรณ์ MESH WiFi มูลค่าจุดละ 2,500 บาท หรือ 3,990 บาท(ตามเงื่อนไขของแพ็กเกจที่ลูกค้าตกลงใช้บริการ)
        //- รับส่วนลดค่าติดตั้งและบริหารจัดการอุปกรณ์ MESH WiFi 2,400 บาท โดยตกลงใช้บริการอย่างน้อย 24 เดือน
        var tempStrPreprintDetail = "";
        var tempStrPreprintDetails = [];
        if (objInstallContentSuperMESHWifiArry != undefined && objInstallContentSuperMESHWifiArry.length > 0) {
            var strInstallContentSuperMESHWifiDetail = "";
            var penaltyChargeMesh = "";
            var durationContractMesh = "";
            var tmpMeshCodeMain = ""; //R21.12PP ATV
            $.each(objInstallContentSuperMESHWifiArry, function (indexData, PackageData) {
                if (indexData == 1 && PackageData.Value > 0) {
                    tmpMeshCodeMain = PackageData.MeshCodeMain; //R21.12PP ATV
                    penaltyChargeMesh = accounting.formatNumber(PackageData.Value); //R21.12PP ATV Float=>Int
                    durationContractMesh = PackageData.DurationByMonth;

                    //R21.12PP ATV
                    var MESH_COUNT = parseInt($("#ddlSuperMESHWifi" + tmpMeshCodeMain).val());
                    if (MESH_COUNT == 1) {
                        strInstallContentSuperMESHWifiDetail = "@Html.Raw(PreprintDeviceContractMesh)";
                        strInstallContentSuperMESHWifiDetail = strInstallContentSuperMESHWifiDetail.replace("{x} ", "");
                        strInstallContentSuperMESHWifiDetail = strInstallContentSuperMESHWifiDetail.replace("{PenaltyChargeMesh}", penaltyChargeMesh);
                        strInstallContentSuperMESHWifiDetail = strInstallContentSuperMESHWifiDetail.replace("{DurationContractMesh}", durationContractMesh);
                        tempStrPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='8'>" + strInstallContentSuperMESHWifiDetail + "</td></tr>";
                    } else {                  
                        var icMesh = 0;
                        var strWORDIND_MESH = "";
                        while (icMesh < MESH_COUNT) {
                            strWORDIND_MESH = "@Html.Raw(WORDIND_MESH)";
                            strWORDIND_MESH = strWORDIND_MESH.replace("{x}", (icMesh + 1).toString());
                            
                            strInstallContentSuperMESHWifiDetail = "@Html.Raw(PreprintDeviceContractMesh)";
                            strInstallContentSuperMESHWifiDetail = strInstallContentSuperMESHWifiDetail.replace("{x}", strWORDIND_MESH);
                            strInstallContentSuperMESHWifiDetail = strInstallContentSuperMESHWifiDetail.replace("{PenaltyChargeMesh}", penaltyChargeMesh);
                            strInstallContentSuperMESHWifiDetail = strInstallContentSuperMESHWifiDetail.replace("{DurationContractMesh}", durationContractMesh);
                            const item = "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='8'>" + strInstallContentSuperMESHWifiDetail + "</td></tr>";

                            tempStrPreprintDetails[icMesh] = item;

                            icMesh++;
                        }
                    }
                }
            });
        }
        //IPCAMERA EAPP

         var ipcamera = objMonthlyIpCameraGroupArry;
         if (ipcamera != undefined && ipcamera.length > 0) {
         var ipcamerafilter = ipcamera.filter(d => d.length > 0);
             var setupPrice = 0;
             var ContactIpcameraCondition = true;
                $.each(ipcamerafilter, function (indexData, ipcameraData) {
                    $.each(ipcameraData, function (indexData2, ipcameraData2) {

                        if (ContactIpcameraCondition != false)
                        {
                             setupPrice = ipcameraData2.SetupFee_Price
                            var ContactIpcamera = "@DeviceContactipcamera";
                            var setUpFeePrice = setupPrice.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                            ContactIpcamera = ContactIpcamera.replace("{PenaltyChargeIPC}", setUpFeePrice);
                            strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>" + ContactIpcamera + "</td>";
                            ContactIpcameraCondition = false;
                        }
                    });
             });
            
         }
            


        // MESH WiFi จุดที่ x
        //const meshArpu_Month_Flag = "@Html.Raw(meshArpu_Month_Flag)";
        if ("@Html.Raw(meshArpu_Month_Flag)" == "Y") {

            // SuperMeshWifi Monthly objMonthlySuperMESHWifiArry //mesh arpu
            if (objMonthlySuperMESHWifiArry != undefined && objMonthlySuperMESHWifiArry.length > 0) {
                var ProPriceDetail = "@Html.Raw(PreprintMonthlyFee)";
                $.each(objMonthlySuperMESHWifiArry, function (indexData, PackageData) {
                    
                    if (PackageData.qty == "2" && tempStrPreprintDetails.length == 2) {
                        
                        ProPriceDetail = ProPriceDetail.replace("{RecurringCharge}", accounting.formatNumber(PackageData.Value)); //R21.12PP ATV Float=>Int
                        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 67%;' colspan='8'>" + PackageData.NameR1 + "</td>";
                        strPreprintDetail += tempStrPreprintDetails[0];
                        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>@PreprintMeshRouter</td></tr>";

                        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 67%;' colspan='8'>" + PackageData.NameR2 + "</td>";
                        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 67%;' colspan='8'>" + PackageData.NameR2_Discount + "</td>";
                        strPreprintDetail += tempStrPreprintDetails[1].replace("</tr>", "");

                        strPreprintDetail += "<td style='width: 50%; text-align: right;' colspan='4'>" + ProPriceDetail + "</td></tr>";
                        
                    } else if (PackageData.qty == "3" && tempStrPreprintDetails.length == 3) {
                      
                        ProPriceDetail = ProPriceDetail.replace("{RecurringCharge}", accounting.formatNumber(PackageData.Value)); //R21.12PP ATV Float=>Int
                        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 67%;' colspan='8'>" + PackageData.NameR1 + "</td>";
                        strPreprintDetail += tempStrPreprintDetails[0];
                        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>@PreprintMeshRouter</td></tr>";

                        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 67%;' colspan='8'>" + PackageData.NameR2 + "</td>";
                        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 67%;' colspan='8'>" + PackageData.NameR2_Discount + "</td>";
                        strPreprintDetail += tempStrPreprintDetails[1];

                        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 67%;' colspan='8'>" + PackageData.NameR3 + "</td>";
                        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 67%;' colspan='8'>" + PackageData.NameR3_Discount + "</td>";
                        strPreprintDetail += tempStrPreprintDetails[2].replace("</tr>", "");

                        strPreprintDetail += "<td style='width: 50%; text-align: right;' colspan='4'>" + ProPriceDetail + "</td></tr>";

                       
                        
                        
                    } else {
                       
                        ProPriceDetail = ProPriceDetail.replace("{RecurringCharge}", accounting.formatNumber(PackageData.Value)); //R21.12PP ATV Float=>Int
                        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='8'>" + PackageData.NameR1 + "</td>";
                        strPreprintDetail += tempStrPreprintDetails[0];
                        strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='8'>@PreprintMeshRouter</td>";
                        
                        strPreprintDetail += "<td style='width: 100%; text-align: right;' colspan='4'>" + ProPriceDetail + "</td></tr>";

                       
                    }

                    $("#CustomerRegisterPanelModel_mesh_count").val(PackageData.qty);
                });
            } else {
                $("#CustomerRegisterPanelModel_mesh_count").val("");
            }
        } else {
            // SuperMeshWifi Monthly objMonthlySuperMESHWifiArry //mesh arpu
            if (objMonthlySuperMESHWifiArry != undefined && objMonthlySuperMESHWifiArry.length > 0) {
            var ProPriceDetail = "@Html.Raw(PreprintMonthlyFee)";
            $.each(objMonthlySuperMESHWifiArry, function (indexData, PackageData) {
           
                ProPriceDetail = ProPriceDetail.replace("{RecurringCharge}", accounting.formatNumber(PackageData.Value)); //R21.12PP ATV Float=>Int
                strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 67%;' colspan='8'>" + PackageData.NameR + "</td>";
                strPreprintDetail += "<td style='width: 100%; text-align: right;' colspan='4'>" + ProPriceDetail + "</td></tr>";
                $("#CustomerRegisterPanelModel_mesh_count").val(PackageData.qty);
            });
            } else {
                $("#CustomerRegisterPanelModel_mesh_count").val("");
            }
            // ค่าบริการรายเดือน MESH WiFi จุดที่ x
        }

        @*// have mesh wifi => แพ็คเกจ ค่าบริการรายเดือน MESH WiFi จุดที่ 1
        if (objMonthlySuperMESHWifiArry != undefined && objMonthlySuperMESHWifiArry.length > 0) {
            strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>@PreprintMeshRouter</td></tr>";
        }*@

        
        //------------------------------------------------------------------------------------------------------------------------------------------------------------------------

        //------------------------------------------------------------------------IP Camera------------------------------------------------------------------------------------------------
        // Cloud IP Camera => รับสิทธิ์ยืมอุปกรณ์ Cloud IP Camera มูลค่าจุดละ X,XXX บาท
        //if ($("#HaveIpCamera").val() == true) {
        //    strPreprintDetail = '<tr style="vertical-align: top;"><td style="width: 100%;" colspan="12">- รับสิทธิ์ยืมอุปกรณ์ Cloud IP Camera มูลค่าจุดละ X,XXX บาท (ตามเงื่อนไขแพ็กเกจที่ลูกค้าตกลงใช้บริการ)</td></tr>';
        //}
        //------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 

        //-------------------------------------------------------------------------AIS PLAYBOX จุดที่ 1-----------------------------------------------------------------------------------------------
        // แพ็กเกจรายเดือน AIS PLAYBOX กล่องที่ 1
        // PlayBox Monthly objMonthlyPlayBoxArry
        if (objMonthlyPlayBoxArry != undefined && objMonthlyPlayBoxArry.length > 0) {
            var ProPriceDetail = "@PreprintMonthlyFee";
            $.each(objMonthlyPlayBoxArry, function (indexData, PackageData) {
                ProPriceDetail = ProPriceDetail.replace("{RecurringCharge}", accounting.formatNumber(PackageData.Value)); //R21.12PP ATV Float=>Int
                strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='8'>" + PackageData.Name + "</td>";
                strPreprintDetail += "<td style='width: 100%; text-align: right;' colspan='4'>" + ProPriceDetail + "</td></tr>";
            });
        }


        //IPCAMERA EAPP
         var ipcamera = objMonthlyIpCameraGroupArry;
         if (ipcamera != undefined && ipcamera.length > 0) {
             var ipcamerafilter = ipcamera.filter(d => d.length > 0);
             var ProPriceDetailCondition = true;
             $.each(ipcamerafilter, function (indexData, ipcameraData) {
                 var wroddingDetail = "";
                 var ProPriceDetail = "";
                 var IPCameraMonthlyFeePrice = 0;
                 var countnum = 0;

                    $.each(ipcameraData, function (indexData2, ipcameraData2) {
                        //if (indexData < ipcamerafilter.length )
                        if (ProPriceDetailCondition != false)
                        {
                            //var wroddingDetail = ipcameraData2.IPCamera_MonthlyFee.replace("ค่าบริการรายเดือน", "- บริการ");
                             wroddingDetail = ipcameraData2.IPCamera_MonthlyFee_Word;
                            ProPriceDetail = "@PreprintMonthlyFee"; 
                            IPCameraMonthlyFeePrice = ipcameraData2.IPCamera_MonthlyFee_Price
                            ProPriceDetailCondition = false;         
                        }
                        countnum++;
                 });
                 var total = IPCameraMonthlyFeePrice * countnum;
                 ProPriceDetail = ProPriceDetail.replace("{RecurringCharge}", total); //R21.12PP ATV Float=>Int                      
                 strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='8'>- " + wroddingDetail + "</td>";
                 strPreprintDetail += "<td style='width: 100%; text-align: right;' colspan='4'>" + ProPriceDetail + "</td></tr>";
                });
         }
            


        // have playbox => รับสิทธิ์ยืมอุปกรณ์ AIS PLAYBOX มูลค่าจุดละ 2,000 บาท หรือ 2,490 บาท (ตามเงื่อนไขของแพ็กเกจที่ลูกค้าตกลงใช้บริการ)
        if (havePlaybox) {
            strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>@PreprintPlayboxRouter</td></tr>";
        }

        // Playbox Install => รับส่วนลดค่าบริหารจัดการอุปกรณ์ AIS PLAYBOX 3,096 บาทโดยตกลงใช้บริการอย่างน้อย 24 เดือน
        if (objInstallContentPlayboxArry != undefined && objInstallContentPlayboxArry.length > 0) {
            var strInstallContentPlayboxDetail = "";
            var penaltyChargePB = "";
            var durationContractPB = "";
            $.each(objInstallContentPlayboxArry, function (indexData, PackageData) {
                if (indexData == 1 && PackageData.Value > 0 && PackageData.flagATV == true) {
                    penaltyChargePB = accounting.formatNumber(PackageData.Value); //R21.12PP ATV Float=>Int
                    durationContractPB = PackageData.DurationByMonth;
                    strInstallContentPlayboxDetail = "@PreprintDeviceContractPB";
                    strInstallContentPlayboxDetail = strInstallContentPlayboxDetail.replace("{PenaltyChargePB}", penaltyChargePB);
                    strInstallContentPlayboxDetail = strInstallContentPlayboxDetail.replace("{DurationContractPB}", durationContractPB);
                    strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>" + strInstallContentPlayboxDetail + "</td></tr>";
                }
            });
        }

        // Conten PlayBox Auto Monthly objMonthlyContentPlayBoxAutoArry => - ฟรี! แพ็กเกจ PLAY FAMILY นาน 24 รอบบิล (พร้อม VIU นาน 12 เดือน ขึ้นอยู่กับเงื่อนไขแพ็กเกจหลัก)
        if (objMonthlyContentPlayBoxAutoArry != undefined && objMonthlyContentPlayBoxAutoArry.length > 0) {
            var ProPriceDetail = "@PreprintMonthlyFee";
            $.each(objMonthlyContentPlayBoxAutoArry, function (indexData, PackageData) {
                ProPriceDetail = ProPriceDetail.replace("{RecurringCharge}", accounting.formatNumber(PackageData.Value)); //R21.12PP ATV Float=>Int
                strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='8'>@Html.Raw(PreprintPackage) " + PackageData.Name + "</td>";
                strPreprintDetail += "<td style='width: 100%; text-align: right;' colspan='4'>" + ProPriceDetail + "</td></tr>";
            });
        }
        //------------------------------------------------------------------------------------------------------------------------------------------------------------------------



        // Conten PlayBox Ontop Monthly objMonthlyContentPlayBoxOntopArry
        if (objMonthlyContentPlayBoxOntopArry != undefined && objMonthlyContentPlayBoxOntopArry.length > 0) {
            var ProPriceDetail = "@PreprintMonthlyFee";
            $.each(objMonthlyContentPlayBoxOntopArry, function (indexData, PackageData) {
                ProPriceDetail = ProPriceDetail.replace("{RecurringCharge}", accounting.formatNumber(PackageData.Value)); //R21.12PP ATV Float=>Int
                strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='8'>" + PackageData.Name + "</td>";
                strPreprintDetail += "<td style='width: 100%; text-align: right;' colspan='4'>" + ProPriceDetail + "</td></tr>";
            });
        }

        // FixLine Monthly objMonthlyFixlineArry
        if (objMonthlyFixlineArry != undefined && objMonthlyFixlineArry.length > 0) {
            var ProPriceDetail = "@PreprintMonthlyFee";
            $.each(objMonthlyFixlineArry, function (indexData, PackageData) {
                ProPriceDetail = ProPriceDetail.replace("{RecurringCharge}", accounting.formatNumber(PackageData.Value)); //R21.12PP ATV Float=>Int
                strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='8'>" + PackageData.Name + "</td>";
                strPreprintDetail += "<td style='width: 100%; text-align: right;' colspan='4'>" + ProPriceDetail + "</td></tr>";
            });
        }

        // WifiLog Monthly objMonthlyWiFiLogArry
        if (objMonthlyWiFiLogArry != undefined && objMonthlyWiFiLogArry.length > 0) {
            var ProPriceDetail = "@PreprintMonthlyFee";
            $.each(objMonthlyWiFiLogArry, function (indexData, PackageData) {
                ProPriceDetail = ProPriceDetail.replace("{RecurringCharge}", accounting.formatNumber(PackageData.Value)); //R21.12PP ATV Float=>Int
                strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 67%;' colspan='8'>@PreprintPackage " + PackageData.NameR + "</td>";
                strPreprintDetail += "<td style='width: 33%; text-align: right;' colspan='4'>" + ProPriceDetail + "</td></tr>";
            });
        }

        // FixLine
        if ((objMonthlyFixlineArry != undefined && objMonthlyFixlineArry.length > 0)
            || (objInstallContentFixlineArry != undefined && objInstallContentFixlineArry.length > 0)) {
            strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>@PreprintFixlineService</td></tr>";
        }

        // SpeedBoost Monthly objMonthlySpeedBoostArry
        if (objMonthlySpeedBoostArry != undefined && objMonthlySpeedBoostArry.length > 0) {
            var ProPriceDetail = "@PreprintMonthlyFee";
            $.each(objMonthlySpeedBoostArry, function (indexData, PackageData) {
                ProPriceDetail = ProPriceDetail.replace("{RecurringCharge}", accounting.formatNumber(PackageData.Value)); //R21.12PP ATV Float=>Int
                strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 67%;' colspan='8'>" + PackageData.NameR + "</td>";
                strPreprintDetail += "<td style='width: 33%; text-align: right;' colspan='4'>" + ProPriceDetail + "</td></tr>";
            });
        }

          //IPCAMERA Eapp
        var ipcamera = objMonthlyIpCameraGroupArry;
         if (ipcamera != undefined && ipcamera.length > 0) {
             var ipcamerafilter = ipcamera.filter(d => d.length > 0);
             
             $.each(ipcamerafilter, function (indexData, ipcameraData) {
                 if (ipcameraData.length == 1) {
                     $.each(ipcameraData, function (indexData2, ipcameraData2) {
                         var ConditionDetail = "@PlayboxCondition";
                         var setUpFeePrice = ipcameraData2.SetupFee_Price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                         ConditionDetail = ConditionDetail.replace("{PenaltyChargeIPC}", setUpFeePrice);
                            ConditionDetail = ConditionDetail.replace("{DurationContractIPC}", ipcameraData2.Duration_ByMonth);
                            strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>" + ConditionDetail + "</td>";

                     }); 
                 }                             
             else {
                     $.each(ipcameraData, function (indexData2, ipcameraData2) {
                         var ConditionDetail = "@PlayboxConditionPoint";
                         var setUpFeePrice = ipcameraData2.SetupFee_Price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                         ConditionDetail = ConditionDetail.replace("{PenaltyChargeIPC}", setUpFeePrice);
                            ConditionDetail = ConditionDetail.replace("{DurationContractIPC}", ipcameraData2.Duration_ByMonth);
                            ConditionDetail = ConditionDetail.replace("{Point}", indexData2 + 1);
                            strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>" + ConditionDetail + "</td>";
                     });       
                 } 
             });
         }
        
        // Auto Monthly objMonthlyAutoPackageArry
        if (objMonthlyAutoPackageArry != undefined && objMonthlyAutoPackageArry.length > 0) {
            var ProPriceDetail = "@PreprintMonthlyFee";
            $.each(objMonthlyAutoPackageArry, function (indexData, PackageData) {
                ProPriceDetail = ProPriceDetail.replace("{RecurringCharge}", accounting.formatNumber(PackageData.Value)); //R21.12PP ATV Float=>Int
                strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 67%;' colspan='8'>@PreprintPackage " + PackageData.Name + "</td>";
                strPreprintDetail += "<td style='width: 33%; text-align: right;' colspan='4'>" + ProPriceDetail + "</td></tr>";
            });
        }

        // Wifilog
        if (objMonthlyWiFiLogArry != undefined && objMonthlyWiFiLogArry.length > 0) {
            strPreprintDetail += "<tr style='vertical-align: top;'><td style='width: 100%;' colspan='12'>- " + objMonthlyWiFiLogArry[0].NameR +"</td></tr>";
        }

        // Remark Install
        if (sumInstall == 0) {
            //R21.6 eApplication
            var strREMARK = "@Html.Raw(PreprintRemark)";
            if ($("#Install_Package_Duration").val() != "") {
                strREMARK = strREMARK.replace("{Mouth}", $("#Install_Package_Duration").val());
            } else {
                strREMARK = strREMARK.replace("{Mouth}", "null");
            }
            strPreprintDetail += "<tr><td style='width: 100%;' colspan='12'>" + strREMARK + "</td></tr>";
        }

        strPreprintDetail += "<tr><td style='width: 100%; padding-top: 1em;' colspan='12' id='bindData_CERTIFY'></td></tr>";
        strPreprintDetail += "<tr><td style='color: white'>.</td ></tr>";
        strPreprintDetail += "<tr><td style='width: 50%; text-align: right;' colspan='6' id='bindData_SIGN'></td>";
        strPreprintDetail += "<td style='width: 30%; text-align: Center;' colspan='3' id='bindData_SIGN_DATA'>";
        strPreprintDetail += "<canvas id='signaturePrePrint-pad' class='signaturePrePrint-pad-open' onclick='$('#modalSignaturePrePrint').modal()'></canvas></td>";
        strPreprintDetail += "<td style='width: 20%; text-align:right' colspan='2' id='bindData_SIGN_2'></td></tr >";
        strPreprintDetail += "</tbody></table>";
        $('#preprintDetail').html(strPreprintDetail);
    }
    
    function ConvertToCurrencyFormat(input) {

        var len = input.length;
        var result = "";
        var i = 1;
        for (; len >= 0; len--) {
            if (i == 4) {
                result = input.substr(len, 1) + "," + result;
                i = 1;
            }
            else {
                result = input.substr(len, 1) + result;
            }
            i++;
        }
        return result;
    }

    function setCondoModel() {

        $('#CustomerRegisterPanelModel_L_NUM_OF_FLOOR').val($('input[name="CustomerRegisterPanelModel.L_FLOOR_CONDO"]:checked').val());

        var strBuilder = "";

        if ($("#chkTop_Terrace").is(":checked")) {
            strBuilder = strBuilder + $('#chkTop_Terrace').val();
        }

        strBuilder = strBuilder + "|";

        if ($("#chkTerrace").is(":checked")) {
            strBuilder = strBuilder + $('#chkTerrace').val();
        }

        $('#CustomerRegisterPanelModel_L_BUILD_CONDO').val(strBuilder);

        strBuilder = "";

        if ($("#chkNorth").is(":checked")) {
            strBuilder = strBuilder + $('#chkNorth').val();
        }

        strBuilder = strBuilder + "|";

        if ($("#chkSouth").is(":checked")) {
            strBuilder = strBuilder + $('#chkSouth').val();
        }

        strBuilder = strBuilder + "|";

        if ($("#chkEast").is(":checked")) {
            strBuilder = strBuilder + $('#chkEast').val();
        }

        strBuilder = strBuilder + "|";

        if ($("#chkWest").is(":checked")) {
            strBuilder = strBuilder + $('#chkWest').val();
        }

        $('#CustomerRegisterPanelModel_L_TERRACE_DIRECTION').val(strBuilder);

        strBuilder = "";

        if ($("#chkCondoBuilding").is(":checked")) {
            strBuilder = strBuilder + $('#chkCondoBuilding').val();
        }

        strBuilder = strBuilder + "|";

        if ($("#chkCondoTree").is(":checked")) {
            strBuilder = strBuilder + $('#chkCondoTree').val();
        }

        strBuilder = strBuilder + "|";

        if ($("#chkCondoBillBoard").is(":checked")) {
            strBuilder = strBuilder + $('#chkCondoBillBoard').val();
        }

        strBuilder = strBuilder + "|";

        if ($("#chkCondoExpressWay").is(":checked")) {
            strBuilder = strBuilder + $('#chkCondoExpressWay').val();
        }

        $('#CustomerRegisterPanelModel_L_CONDO_AREA').val(strBuilder);
    }

    function setHouseModel() {
        $('#CustomerRegisterPanelModel_L_TYPE_ADDR').val($('input[name="CustomerRegisterPanelModel.L_TYPE_ADDR"]:checked').val());

        var strBuilder = "";

        if ($("#chkHouseBuilding").is(":checked")) {
            strBuilder = strBuilder + $('#chkHouseBuilding').val();
        }

        strBuilder = strBuilder + "|";

        if ($("#chkHouseTree").is(":checked")) {
            strBuilder = strBuilder + $('#chkHouseTree').val();
        }

        strBuilder = strBuilder + "|";

        if ($("#chkHouseBillBoard").is(":checked")) {
            strBuilder = strBuilder + $('#chkHouseBillBoard').val();
        }

        strBuilder = strBuilder + "|";

        if ($("#chkHouseExpressWay").is(":checked")) {
            strBuilder = strBuilder + $('#chkHouseExpressWay').val();
        }

        $('#CustomerRegisterPanelModel_L_HOUSE_AREA').val(strBuilder);
    }

    function setDocType() {

        //var locationCode = $('#L_LOC_CODE').val();
        //var ascCode = $('#L_ASC_CODE').val();
        var staff = $('#L_STAFF_ID').val();
        //var saleRep = $('#L_SALE_REP').val();
        //var csAirNet = $('#L_FOR_CS_TEAM').val();

        if (staff != null && staff != "") {
            $('#CustomerRegisterPanelModel_DocType').val("STAFF");
        }
        else if ($('input[name="typeselect"]:checked').val() == 'R') {
            if ($('#ID_CARD_NAME :selected').val() == "MONK_CERT") {
                $('#CustomerRegisterPanelModel_DocType').val("MONK");
            }
            else {
                $('#CustomerRegisterPanelModel_DocType').val("RES");
            }
        }
        else {
            $('#CustomerRegisterPanelModel_DocType').val("NON_RES");
        }
    }

    function copyAddressCoverageTo(page) {
        $('#Province' + page).empty();
        $('#Tumbon' + page).empty();
        $('#Amphur' + page).empty();
        $('#ZipCode' + page).empty();

                var BuildTmp = $('input[name="R_BUILD"]:checked').val();


                if ('@ESRIflag' == 'true')
                {
                    BuildTmp = "VILLAGE";
                }

                if('@BypassESRIflag' == "true")
                {
                    if('@Model.CoveragePanelModel.BuildingType' == 'C')
                    {
                        BuildTmp = "CONDOMINIUM";
                    }
                    else
                    {
                        BuildTmp = "VILLAGE";
                    }
                }

        //บ้านเลขที่
        $('#AddressPanelModel' + page + '_L_HOME_NUMBER_2').val($('#CoveragePanelModel_Address_L_HOME_NUMBER_1').val());

        //หมู่
        $('#AddressPanelModel' + page + '_L_MOO').val($('#CoveragePanelModel_Address_L_MOO').val());

                if (BuildTmp == "CONDOMINIUM") {
                    //อาคาร
                    if('@BypassESRIflag' == "true")
                    {
                $('#AddressPanelModel' + page + '_L_BUILD_NAME').val('@Model.DataBypass_BuildNameSetup.ToSafeString()');
                $('#AddressPanelModel' + page + '_L_FLOOR').val($('#CoveragePanelModel_Address_L_FLOOR').val());
                    }
                    else
                    {
                        var buildname_to_model = "";
                        if ($('#UseMap').val() == 'True') {
                            buildname_to_model = $('#DIV_L_BUILD_NAME :selected').text();
                            if (selected_building_obj.building_name) {
                                buildname_to_model = selected_building_obj.building_name;
                            }
                            else {
                                buildname_to_model = "";
                            }
                    $('#AddressPanelModel' + page + '_L_BUILD_NAME').val("");
                    $('#AddressPanelModel' + page + '_L_MOOBAN').val(buildname_to_model);
                        }
                else {
                            buildname_to_model = selected_building_obj.building_name + ' ' + $('#DIV_D_L_BUILD_NO :selected').text()
                    if ($('#CoveragePanelModel_Address_L_BUILD_NO_Hied').val()) {
                                buildname_to_model = selected_building_obj.building_name + ' ' + $('#CoveragePanelModel_Address_L_BUILD_NO_Hied').val();
                            }
                    $('#AddressPanelModel' + page + '_L_BUILD_NAME').val(buildname_to_model);
                        }

                //ชั้น
                $('#AddressPanelModel' + page + '_L_FLOOR').val($('#CoveragePanelModel_Address_L_FLOOR').val());
                    }
                }
                else if (BuildTmp == "VILLAGE") { /// เพิ่ม other เพราะมาจาก map
            //หมู่บ้าน
            $('#AddressPanelModel' + page + '_L_MOOBAN').val($('#CoveragePanelModel_Address_L_MOOBAN').val());
            $('#AddressPanelModel' + page + '_L_BUILD_NAME').val("");
            $('#AddressPanelModel' + page + '_L_FLOOR').val("");
                }
                else {
                    var buildname_to_model = "";
                    if (selected_building_obj.building_name) {
                        buildname_to_model = selected_building_obj.building_name;
                    }
                    else {
                        buildname_to_model = "";
                    }
            $('#AddressPanelModel' + page + '_L_MOOBAN').val(buildname_to_model);
                }

        //ห้อง
        //$('#AddressPanelModel' + page + '_L_ROOM').val($('#AddressPanelModelSetup_L_ROOM').val());

        //ซอย
        $('#AddressPanelModel' + page + '_L_SOI').val($('#CoveragePanelModel_Address_L_SOI').val());

        //ถนน
        $('#AddressPanelModel' + page + '_L_ROAD').val($('#CoveragePanelModel_Address_L_ROAD').val());

                var msgRowid = "";
        $.ajax({
                    type: "GET",
            url: "/MasterData/GetAddress",
            data: { 'province': $('#COVERAGE_L_PROVINCE :selected').val(), 'amphur': $('#COVERAGE_L_AMPHUR :selected').val(), 'tumbon': $('#COVERAGE_L_TUMBOL :selected').val() },
            dataType: "json",
            async: false,
            success: function (data) {
                        var strProvince = "";
                        var strAumphur = "";
                        var strTumbon = "";
                        var strZipCode = "";

                $.each(data.province, function (i, e) {
                            var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            strProvince += str;
                        });

                $.each(data.amphur, function (i, e) {
                            var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            strAumphur += str;
                        });

                $.each(data.tumbon, function (i, e) {
                            var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            strTumbon += str;
                        });

                $.each(data.zipcode, function (i, e) {
                            var str = "";
                            if (data.zipcode.length == 1) {
                                str = '<option value="' + e.Value + '" selected>' + e.Text + '</option>';
                            }
                            else {
                                str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            }

                            strZipCode += str;
                        });

                $('#Province' + page).append(strProvince);
                $('#Amphur' + page).append(strAumphur);
                $('#Tumbon' + page).append(strTumbon);
                $('#ZipCode' + page).append(strZipCode);

                $('#Province' + page).val($('#COVERAGE_L_PROVINCE :selected').val());
                $('#Amphur' + page).val($('#COVERAGE_L_AMPHUR :selected').val());
                $('#Tumbon' + page).val($('#COVERAGE_L_TUMBOL :selected').val());
                $('#ZipCode' + page).val($('#CoveragePanelModel_Address_ZIPCODE_ID').val());

                $('#CustomerRegisterPanelModel_AddressPanelModelSetup_ZIPCODE_ID').val($('#CoveragePanelModel_Address_ZIPCODE_ID').val());

                $('#Province' + page).select2();
                $('#Amphur' + page).select2();
                $('#Tumbon' + page).select2();
                $('#ZipCode' + page).select2();

                        if ($('#CustomerRegisterPanelModel_AddressPanelModelSetup_ZIPCODE_ID').val() == null ||
                    $('#CustomerRegisterPanelModel_AddressPanelModelSetup_ZIPCODE_ID').val() == "" ||
                    $('#CustomerRegisterPanelModel_AddressPanelModelSetup_ZIPCODE_ID').val() == undefined) {
                    $('#CustomerRegisterPanelModel_AddressPanelModelSetup_ZIPCODE_ID').val($('#ZipCode' + page).val());
                        }

                        if ($('#CustomerRegisterPanelModel_AddressPanelModelSetup_ZIPCODE_ID').val() == null ||
                    $('#CustomerRegisterPanelModel_AddressPanelModelSetup_ZIPCODE_ID').val() == "" ||
                    $('#CustomerRegisterPanelModel_AddressPanelModelSetup_ZIPCODE_ID').val() == undefined) {
                    $('#CustomerRegisterPanelModel_AddressPanelModelSetup_ZIPCODE_ID').val($('#CoveragePanelModel_Address_L_ZIPCODE').val());
                        }

                        if ($('#CustomerRegisterPanelModel_AddressPanelModelSetup_ZIPCODE_ID').val() == null ||
                    $('#CustomerRegisterPanelModel_AddressPanelModelSetup_ZIPCODE_ID').val() == "" ||
                    $('#CustomerRegisterPanelModel_AddressPanelModelSetup_ZIPCODE_ID').val() == undefined) {
                            msgRowid += "CustomerRegisterPanelModel_AddressPanelModelSetup_ZIPCODE_ID --> " + $('#CustomerRegisterPanelModel_AddressPanelModelSetup_ZIPCODE_ID').val();
                            msgRowid += ", CoveragePanelModel_Address_ZIPCODE_ID --> " + $('#CoveragePanelModel_Address_ZIPCODE_ID').val();
                            msgRowid += ", ZipCode" + page + " --> " + $('#ZipCode' + page).val() + " : " + $('#ZipCode' + page).text();
                            msgRowid += ", CoveragePanelModel_Address_L_ZIPCODE --> " + $('#CoveragePanelModel_Address_L_ZIPCODE').val();
                        }

                    }
                });

                if (msgRowid != "") {
            $.ajax({
                        type: "GET",
                url: "/MasterData/WriteLogFromView",
                data: { 'msg': msgRowid },
                dataType: "json",
                success: function (data) {

                        }
                    });
                }

            }

    function SetDefaultAddressPage(page) {
        //R23.04
        document.getElementById("BillingAddrOptionValue").options.selectedIndex = 0;

        $("#Province" + page).empty();
        $("#Amphur" + page).empty();
        $("#Tumbon" + page).empty();
        $("#ZipCode" + page).empty();

        $('#AddressPanelModel' + page + '_L_HOME_NUMBER_2').val("");
        $('#AddressPanelModel' + page + '_L_MOO').val("");
        $('#AddressPanelModel' + page + '_L_MOOBAN').val("");
        $('#AddressPanelModel' + page + '_L_BUILD_NAME').val("");
        $('#AddressPanelModel' + page + '_L_FLOOR').val("");
        $('#AddressPanelModel' + page + '_L_ROOM').val("");
        $('#AddressPanelModel' + page + '_L_SOI').val("");
        $('#AddressPanelModel' + page + '_L_ROAD').val("");

        $.ajax({
                    type: "GET",
            url: "/MasterData/GetProvince",
            dataType: "json",
            async: false,
            success: function (data) {
                        var strBuilder = "<option value='' disabled selected >" + "@lPROVINCE" + "</option>";
                $.each(data, function (i, e) {
                            var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            strBuilder += str;
                        });
                $("#Province" + page).append(strBuilder);
                $("#Province" + page).select2();
                    }
                });

        $("#Amphur" + page).append("<option value='' disabled selected >" + "@lAMPHUR" + "</option>");
        $("#Tumbon" + page).append("<option value='' disabled selected >" + "@lTUMBOL" + "</option>");
        $("#ZipCode" + page).append("<option value='' disabled selected >" + "@lZIPCODE" + "</option>");

        $("#Amphur" + page).select2();
        $("#Tumbon" + page).select2();
        $("#ZipCode" + page).select2();
            }

        function getProvinceTo(page) {
            if ($("#Province" + page + " :selected").val()) {
                return;
            }
        $("#Province" + page).empty();
        //GetProvince
        $.ajax({
                    type: "GET",
            url: "/MasterData/GetProvince",
            dataType: "json",
            async: false,
            success: function (data) {
                        var strBuilder = "<option value='' disabled selected >" + "@lPROVINCE" + "</option>";
                $.each(data, function (i, e) {
                            var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            strBuilder += str;
                        });
                $("#Province" + page).append(strBuilder);
                $("#Province" + page).select2();
                    }
                });
            }

            function copyAddressSetUpTo(page) {

        $('#Province' + page).empty();
        $('#Amphur' + page).empty();
        $('#Tumbon' + page).empty();
        $('#ZipCode' + page).empty();

        $('#AddressPanelModel' + page + '_L_HOME_NUMBER_2').val($('#AddressPanelModelSetup_L_HOME_NUMBER_2').val());
        $('#AddressPanelModel' + page + '_L_MOO').val($('#AddressPanelModelSetup_L_MOO').val());
        $('#AddressPanelModel' + page + '_L_MOOBAN').val($('#AddressPanelModelSetup_L_MOOBAN').val());
        $('#AddressPanelModel' + page + '_L_BUILD_NAME').val($('#AddressPanelModelSetup_L_BUILD_NAME').val());
        $('#AddressPanelModel' + page + '_L_FLOOR').val($('#AddressPanelModelSetup_L_FLOOR').val());
        $('#AddressPanelModel' + page + '_L_ROOM').val($('#AddressPanelModelSetup_L_ROOM').val());
        $('#AddressPanelModel' + page + '_L_SOI').val($('#AddressPanelModelSetup_L_SOI').val());
        $('#AddressPanelModel' + page + '_L_ROAD').val($('#AddressPanelModelSetup_L_ROAD').val());

        $.ajax({
                    type: "GET",
            url: "/MasterData/GetAddress",
            data: { 'province': $('#ProvinceSetup :selected').val(), 'amphur': $('#AmphurSetup :selected').val(), 'tumbon': $('#TumbonSetup :selected').val() },
            dataType: "json",
            async: false,
            success: function (data) {
                        var strProvince = "";
                        var strAumphur = "";
                        var strTumbon = "";
                        var strZipCode = "";

                $.each(data.province, function (i, e) {
                            var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            strProvince += str;
                        });

                $.each(data.amphur, function (i, e) {
                            var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            strAumphur += str;
                        });

                $.each(data.tumbon, function (i, e) {
                            var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            strTumbon += str;
                        });

                $.each(data.zipcode, function (i, e) {
                            var str = "";
                            if (data.zipcode.length == 1)
                                str = '<option value="' + e.Value + '" selected>' + e.Text + '</option>';
                            else
                                str = '<option value="' + e.Value + '">' + e.Text + '</option>';

                            strZipCode += str;
                        });

                $('#Province' + page).append(strProvince);
                $('#Amphur' + page).append(strAumphur);
                $('#Tumbon' + page).append(strTumbon);
                $('#ZipCode' + page).append(strZipCode);

                $('#Province' + page).val($('#ProvinceSetup :selected').val());
                $('#Amphur' + page).val($('#AmphurSetup :selected').val());
                $('#Tumbon' + page).val($('#TumbonSetup :selected').val());
                $('#ZipCode' + page).val($('#ZipCodeSetup :selected').val());

                $("#CustomerRegisterPanelModel_AddressPanelModel" + page + "_ZIPCODE_ID").val($('#CustomerRegisterPanelModel_AddressPanelModelSetup_ZIPCODE_ID').val());

                $("#Province" + page).select2();
                $('#Amphur' + page).select2();
                $('#Tumbon' + page).select2();
                $('#ZipCode' + page).select2();
            }
        });
    }

    function copyAddressSetUpIdCardTo(page) {

        $('#Province' + page).empty();
        $('#Amphur' + page).empty();
        $('#Tumbon' + page).empty();
        $('#ZipCode' + page).empty();

        $('#AddressPanelModel' + page + '_L_HOME_NUMBER_2').val($('#AddressPanelModelSendDocIDCard_L_HOME_NUMBER_2').val());
        $('#AddressPanelModel' + page + '_L_MOO').val($('#AddressPanelModelSendDocIDCard_L_MOO').val());
        $('#AddressPanelModel' + page + '_L_MOOBAN').val($('#AddressPanelModelSendDocIDCard_L_MOOBAN').val());
        $('#AddressPanelModel' + page + '_L_BUILD_NAME').val($('#AddressPanelModelSendDocIDCard_L_BUILD_NAME').val());
        $('#AddressPanelModel' + page + '_L_FLOOR').val($('#AddressPanelModelSendDocIDCard_L_FLOOR').val());
        $('#AddressPanelModel' + page + '_L_ROOM').val($('#AddressPanelModelSendDocIDCard_L_ROOM').val());
        $('#AddressPanelModel' + page + '_L_SOI').val($('#AddressPanelModelSendDocIDCard_L_SOI').val());
        $('#AddressPanelModel' + page + '_L_ROAD').val($('#AddressPanelModelSendDocIDCard_L_ROAD').val());
        if ($('#ProvinceSendDocIDCard :selected').val() == "") {
            $.ajax({
                type: "GET",
                url: "/MasterData/GetProvince",
                dataType: "json",
                async: false,
                success: function (data) {
                    var strBuilder = "<option value='' disabled selected >" + "@lPROVINCE" + "</option>";
                    $.each(data, function (i, e) {
                        var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                        strBuilder += str;
                    });
                    $("#Province" + page).append(strBuilder);
                    $("#Province" + page).select2();

                }
            });

            $("#Amphur" + page).append("<option value='' disabled selected >" + "@lAMPHUR" + "</option>");
            $("#Tumbon" + page).append("<option value='' disabled selected >" + "@lTUMBOL" + "</option>");
            $("#ZipCode" + page).append("<option value='' disabled selected >" + "@lZIPCODE" + "</option>");

        } else {
            $.ajax({
                type: "GET",
                url: "/MasterData/GetAddress",
                data: { 'province': $('#ProvinceSendDocIDCard :selected').val(), 'amphur': $('#AmphurSendDocIDCard :selected').val(), 'tumbon': $('#TumbonSendDocIDCard :selected').val() },
                dataType: "json",
                async: false,
                success: function (data) {
                    var strProvince = "";
                    var strAumphur = "";
                    var strTumbon = "";
                    var strZipCode = "";

                    //alert($('#ProvinceSendDocIDCard :selected').val() + ", " + $('#AmphurSendDocIDCard :selected').val() + ", " + $('#TumbonSendDocIDCard :selected').val())

                    if (!!data.province && !!data.amphur && !!data.tumbon && data.zipcode) {
                        $.each(data.province, function (i, e) {
                            var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            strProvince += str;
                        });

                        $.each(data.amphur, function (i, e) {
                            var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            strAumphur += str;
                        });

                        $.each(data.tumbon, function (i, e) {
                            var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            strTumbon += str;
                        });

                        $.each(data.zipcode, function (i, e) {
                            var str = "";
                            if (data.zipcode.length == 1)
                                str = '<option value="' + e.Value + '" selected>' + e.Text + '</option>';
                            else
                                str = '<option value="' + e.Value + '">' + e.Text + '</option>';

                            strZipCode += str;
                        });

                        $('#Province' + page).append(strProvince);
                        $('#Amphur' + page).append(strAumphur);
                        $('#Tumbon' + page).append(strTumbon);
                        $('#ZipCode' + page).append(strZipCode);
                    }

                    $('#Province' + page).val($('#ProvinceSendDocIDCard :selected').val());
                    $('#Amphur' + page).val($('#AmphurSendDocIDCard :selected').val());
                    $('#Tumbon' + page).val($('#TumbonSendDocIDCard :selected').val());
                    $('#ZipCode' + page).val($('#ZipCodeSendDocIDCard :selected').val());

                    $("#CustomerRegisterPanelModel_AddressPanelModel" + page + "_ZIPCODE_ID").val($('#CustomerRegisterPanelModel_AddressPanelModelSendDocIDCard_ZIPCODE_ID').val());

                    $("#Province" + page).select2();
                    $('#Amphur' + page).select2();
                    $('#Tumbon' + page).select2();
                    $('#ZipCode' + page).select2();

                }
            });
        }
    }

    function copyAddressIdCardSmartCardTo(page) {
        try {
            $('#Province' + page).empty();
            $('#Amphur' + page).empty();
            $('#Tumbon' + page).empty();
            $('#ZipCode' + page).empty();

            //$('#AddressPanelModel' + page + '_L_HOME_NUMBER_2').val(sessionStorage.getItem('Card_houseNo'));
            //$('#AddressPanelModel' + page + '_L_MOO').val(sessionStorage.getItem('Card_moo'));
            //$('#AddressPanelModel' + page + '_L_MOOBAN').val('');
            //$('#AddressPanelModel' + page + '_L_BUILD_NAME').val('');
            //$('#AddressPanelModel' + page + '_L_FLOOR').val('');
            //$('#AddressPanelModel' + page + '_L_ROOM').val('');
            //$('#AddressPanelModel' + page + '_L_SOI').val(sessionStorage.getItem('Card_soi'));
            //$('#AddressPanelModel' + page + '_L_ROAD').val(sessionStorage.getItem('Card_road'));
            $('#AddressPanelModel' + page + '_L_HOME_NUMBER_2').val($('#hdnCard_houseNo').val().replace(/"/g, ""));
            $('#AddressPanelModel' + page + '_L_MOO').val($('#hdnCard_moo').val().replace(/"/g, "").replace(/หมู่ /g, "").replace(/หมู่ที่ /g, ""));
            $('#AddressPanelModel' + page + '_L_MOOBAN').val('');
            $('#AddressPanelModel' + page + '_L_BUILD_NAME').val('');
            $('#AddressPanelModel' + page + '_L_FLOOR').val('');
            $('#AddressPanelModel' + page + '_L_ROOM').val('');
            $('#AddressPanelModel' + page + '_L_SOI').val($('#hdnCard_soi').val().replace("ซอย", ""));
            $('#AddressPanelModel' + page + '_L_ROAD').val($('#hdnCard_road').val().replace(/ถนน/g, ""));
            var province = $('#hdnCard_province').val().replace("จ.", "").replace("จังหวัด", "").replace(/ /g, "").replace("กรุงเทพมหานคร", "กรุงเทพ");
            var amphur = $('#hdnCard_district').val().replace("อ.", "").replace("อำเภอ", "").replace(/เขต/g, "");
            var tumbon = $('#hdnCard_subDistrict').val().replace("ต.", "").replace("ตำบล", "").replace(/แขวง/g, "");

            //if (sessionStorage.getItem('Card_province') != "") {
            //    var p = sessionStorage.getItem('Card_province').split(".");
            //    province = p[1].trim();
            //}
            //if (sessionStorage.getItem('Card_subDistrict') != "") {
            //    var t = sessionStorage.getItem('Card_subDistrict').split(".");
            //    tumbon = t[1].trim();
            //}
            //if (sessionStorage.getItem('Card_district') != "") {
            //    var s = sessionStorage.getItem('Card_district').split(".");
            //    amphur = s[1].trim();
            //}
            if ($('#hdnCard_province').val() == "") {
                $.ajax({
                    type: "GET",
                    url: "/MasterData/GetProvince",
                    dataType: "json",
                    async: false,
                    success: function (data) {
                        var strBuilder = "<option value='' disabled selected >" + "@lPROVINCE" + "</option>";
                        $.each(data, function (i, e) {
                            var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            strBuilder += str;
                        });
                        $("#Province" + page).append(strBuilder);
                        $("#Province" + page).select2();
                    }
                });

                $("#Amphur" + page).append("<option value='' disabled selected >" + "@lAMPHUR" + "</option>");
                $("#Tumbon" + page).append("<option value='' disabled selected >" + "@lTUMBOL" + "</option>");
                $("#ZipCode" + page).append("<option value='' disabled selected >" + "@lZIPCODE" + "</option>");

            } else {
                $.ajax({
                    type: "GET",
                    url: "/MasterData/GetAddress",
                    async: false,
                    data: { 'province': province, 'amphur': amphur, 'tumbon': tumbon },
                    dataType: "json",
                    success: function (data) {
                        var strProvince = "<option value='' disabled selected >" + "@lPROVINCE" + "</option>";
                        var strAumphur = "<option value='' disabled selected >" + "@lAMPHUR" + "</option>";
                        var strTumbon = "<option value='' disabled selected >" + "@lTUMBOL" + "</option>";
                        var strZipCode = "<option value='' disabled selected >" + "@lZIPCODE" + "</option>";

                        $.each(data.province, function (i, e) {
                            var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            strProvince += str;
                        });

                        $.each(data.amphur, function (i, e) {
                            var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            strAumphur += str;
                        });

                        $.each(data.tumbon, function (i, e) {
                            var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                            strTumbon += str;
                        });

                        $.each(data.zipcode, function (i, e) {
                            var str = "";
                            if (data.zipcode.length == 1)
                                str = '<option value="' + e.Value + '" selected>' + e.Text + '</option>';
                            else
                                str = '<option value="' + e.Value + '">' + e.Text + '</option>';

                            strZipCode += str;
                        });

                        $('#Province' + page).append(strProvince);
                        $('#Amphur' + page).append(strAumphur);
                        $('#Tumbon' + page).append(strTumbon);
                        $('#ZipCode' + page).append(strZipCode);

                        $('#Province' + page).val(province);
                        $('#Amphur' + page).val(amphur);
                        $('#Tumbon' + page).val(tumbon);
                        //$('#ZipCode' + page).val($('#ZipCodeSendDocIDCard :selected').val());
                        //$("#CustomerRegisterPanelModel_AddressPanelModel" + page + "_ZIPCODE_ID").val($('#CustomerRegisterPanelModel_AddressPanelModelSendDocIDCard_ZIPCODE_ID').val());

                        $("#Province" + page).select2();
                        $('#Amphur' + page).select2();
                        $('#Tumbon' + page).select2();
                        $('#ZipCode' + page).select2();

                        // ถ้า selectbox เป็นค่าว่าง
                        if ($('#select2-Province' + page + '-container').html() == "") {
                            $('#select2-Province' + page + '-container').html("@lPROVINCE");
                        }
                        if ($('#select2-Amphur' + page + '-container').html() == "") {
                            $('#select2-Amphur' + page + '-container').html("@lAMPHUR");
                        }
                        if ($('#select2-Tumbon' + page + '-container').html() == "") {
                            $('#select2-Tumbon' + page + '-container').html("@lTUMBOL");
                        }
                    }
                });
            }
        }
        catch(err) {
            toastrErrorMessage(err.message);
        }
    }

    function getAppointment(e, isThai, timeSlotId, setDefault) {
        $("#divResponsiveTimeSLot").hide();
        $('#divTextSelectTimeSlot').html("");
        $("#divTimeFlag").html("");
        var i = $("input[name=SelectPackage]:checked").val();

        var installDate = e;
        $("#L_INSTALL_DATE").val("");
        //$("#ZTEAddressID").val("20614863"); // fortest

        $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate_Initial').val(installDate);
        $('#CustomerRegisterPanelModel_FBSSTimeSlot_CurrentDate_Initial').val($("#hdCurrentDateTime").val());
        $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlotRegisterHR').val($("#hdTimeSlotRegisterHR").val());
        LockScreen(true, "");
        $.ajax({
            type: "POST",
            //type: "GET",
            url: "/CustomerRegister/GetAppointment",
            data: {
                'installation_Date': installDate, "access_Mode": $("#ACCESS_MODE" + i).val(), "address_Id": $("#ZTEAddressID").val(),
                "serviceCode": $("#ACCESS_MODE" + i).val(), "district": $('#COVERAGE_L_AMPHUR :selected').text(),
                "subDistrict": $('#COVERAGE_L_TUMBOL :selected').text(), "province": $('#COVERAGE_L_PROVINCE :selected').text(),
                "postalCode": $("#CoveragePanelModel_Address_L_ZIPCODE :selected").text(), "lineSelect": 1,
                "days": dayTimeslot, "productSpecCode": $("#SERVICE_CODE" + i).val(), "isThai": isThai, "timeSlotId": timeSlotId, "smallSize": false,
                "SubAccessMode": $('#CustomerRegisterPanelModel_SUB_ACCESS_MODE').val(),
                "AisAirNumber": sessionStorage.getItem("AisAirNumber"),
                "SetDefault" : setDefault,
                "timeSlotRegisterFlag": "Y",
                "timeSlotRegisterHR" : $("#hdTimeSlotRegisterHR").val(),
                "timeSlotRegisterFlowActionNo" : $("#hdTimeSlotRegisterFlowActionNo").val(),
                "installation_DateTimeNow": $("#hdCurrentDateTime").val(),
                "serviceLevel": $("#ServiceLevel").val(),
                "areaRegion": $("#CoveragePanelModel_Address_AreaRegion").val(),
                "eventRule": "@EVENT_RULE",
                "SpecialSkilL": ""
            },
            dataType: "json",
            beforeSend: function() {
                $("#" + timeSlotId).html("");
                $("#divTimeSlotRemark").html("");
                if ($("#WTTX_COVERAGE_RESULT").val() != "YES" ) {
                    $("#divResponsiveTimeSLotWarning").show();
                }
            },
            success: function (data) {
                $("#" + timeSlotId).html(data.timeSlotData);
                $("#divTimeSlotRemark").html(data.timeSlotRemark);

                var dataCount = data.timeSlotData.toString().indexOf("List data = 0");
                var dataNull = data.timeSlotData.toString().indexOf(" Data null");
                var dataError = data.timeSlotData.toString().indexOf("Data error");

                //$("#checkTimeSlot").val(dataCount);
                $("#dataCount").val(dataCount);
                $("#dataNull").val(dataNull);
                $("#dataError").val(dataError);

                //set dllTimeFlage
                if (data.dllTimeFlag != "") {
                    $("#divTimeFlag").html(data.dllTimeFlag);
                    $('#dll_TimeFlag').select2();
                    $(".slot-m").hide();
                    $(".slot-a").hide();
                    if ($('#dll_TimeFlag :selected').val() == "M") {
                        $(".slot-m").show();
                    }
                    else {
                        $(".slot-a").show();
                    }
                }

                @{SHOW_TIME_SLOT = SHOW_TIME_SLOT_LIST.Any(f => f.Validation == Model.FlowFlag) ? SHOW_TIME_SLOT_LIST.First(f => f.Validation == Model.FlowFlag).SubValidation : "";}
                if ('@SHOW_TIME_SLOT' == "N" || $("#ZTEAddressID").val() == "") {
                    $("#divInstallDate").hide();
                    $("#divResponsiveTimeSLot").hide();
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val("");
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_InstallationCapacity').val("");
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlot').val("");
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlotId').val("");
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_FirstTimeSlot').val("");
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_FirstInstallDate').val("");

                    $('#L_INSTALL_DATE').val("");
                    $("#L_EVENT_CODE").attr('disabled', true);
                } else {
                    if (dataCount != "-1" || dataNull != "-1" || dataError != "-1") {
                        $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val($("#" + timeSlotId).find("input[name='FBSSAppointmentDate']").val());
                        $('#CustomerRegisterPanelModel_FBSSTimeSlot_InstallationCapacity').val($("#" + timeSlotId).find("input[name='FBSSInstallationCapacity']").val());
                        $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlot').val($("#" + timeSlotId).find("input[name='FBSSTimeSlot']").val());
                        $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlotId').val($("#" + timeSlotId).find("input[name='TimeSlotId']").val());
                        $('#L_INSTALL_DATE').val($("#" + timeSlotId).find("input[name='FBSSInstallDate']").val());
                    } else {
                         // case WTTx
                        if ($("#WTTX_COVERAGE_RESULT").val() == "YES" ) {
                            $("#divResponsiveTimeSLot").hide();
                        }
                        else {
                            $("#divResponsiveTimeSLot").show();
                        }
                        //$("#divResponsiveTimeSLot").show();
                        //R19.5
                        $("#divPromoInstallWorkDay").show();

                        var getDiv = "";
                        var parentDiv = "";

                        // Check Set Default and Check Show Time Slot

                        @*console.log("------------------------------------------------------------------------");
                        console.log($("#" + timeSlotId).find(".color-green").length);
                        console.log(!$("#" + timeSlotId).is(":hidden"));
                        console.log($("#" + timeSlotId).find(".color-green").length > 0 && !$("#" + timeSlotId).is(":hidden"));
                        console.log(!$("#divResponsiveTimeSLot").is(":hidden"));
                        console.log("------------------------------------------------------------------------");*@

                        if ($("#" + timeSlotId).find(".color-green").length > 0) {

                            getDiv = $("#" + timeSlotId).find(".color-green").parent().parent();
                            parentDiv = getDiv.parent();

                            $(parentDiv).find(".select-header").show();
                            $(parentDiv).find(".day-item").addClass("day-item-select");
                            $(parentDiv).find(".day-footer").show();

                            $(parentDiv).find(".header-label").hide();
                            $(parentDiv).find(".header-label-hidden").show();

                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val($(getDiv).find("input[name='FBSSAppointmentDate']").val());
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_InstallationCapacity').val($(getDiv).find("input[name='FBSSInstallationCapacity']").val());
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlot').val($(getDiv).find("input[name='FBSSTimeSlot']").val());
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlotId').val($(getDiv).find("input[name='TimeSlotId']").val());
                            $('#L_INSTALL_DATE').val($(getDiv).find("input[name='FBSSInstallDate']").val());

                            if (setDefault == "Y" && data.firstInstallDate != "" && data.firstTimeSlot != "") {
                                $('#CustomerRegisterPanelModel_FBSSTimeSlot_FirstInstallDate').val(data.firstInstallDate);
                                $('#CustomerRegisterPanelModel_FBSSTimeSlot_FirstTimeSlot').val(data.firstTimeSlot);
                            }

                            checkDateTimeSlot = true;

                            var textSelectTimeSlot = "@DISPLAY_TIMESLOT";
                            textSelectTimeSlot = textSelectTimeSlot.replace("{TIMESLOT}", $(getDiv).find("input[name='FBSSTimeSlot']").val());
                            $('#divTextSelectTimeSlot').html(textSelectTimeSlot);

                        }
                        else {
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val("");
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_InstallationCapacity').val("");
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlot').val("");
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlotId').val("");
                            $('#L_INSTALL_DATE').val("");

                            if (setDefault == "Y") {
                                $('#CustomerRegisterPanelModel_FBSSTimeSlot_FirstInstallDate').val("");
                                $('#CustomerRegisterPanelModel_FBSSTimeSlot_FirstTimeSlot').val("");
                            }

                            checkDateTimeSlot = false;
                        }
                        setDefaultRedcap();//R19.4
                    }
                }

                var divInstallDateTMP = document.getElementById("divInstallDate");
                //console.log("JavaScript check hidden : ", (window.getComputedStyle(divInstallDateTMP).display === "none"));
                //if ($("#divResponsiveTimeSLot").is(":hidden"))
                if (window.getComputedStyle(divInstallDateTMP).display === "none") {
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val("");
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_InstallationCapacity').val("");
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlot').val("");
                    $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlotId').val("");
                    $('#L_INSTALL_DATE').val("");
                    $('#hdUseTimeslot').val("N");
                }
                else {
                    $('#hdUseTimeslot').val("Y");
                }

                if (setDefault == "Y" && !checkDateTimeSlot) {
                    $.ajax({
                        type: "POST",
                        url: "/CustomerRegister/GetAppointmentFirstTimeSlot",
                        data: {
                            'installation_Date': installDate, "access_Mode": $("#ACCESS_MODE" + i).val(), "address_Id": $("#ZTEAddressID").val(),
                            "serviceCode": $("#ACCESS_MODE" + i).val(), "district": $('#COVERAGE_L_AMPHUR :selected').text(),
                            "subDistrict": $('#COVERAGE_L_TUMBOL :selected').text(), "province": $('#COVERAGE_L_PROVINCE :selected').text(),
                            "postalCode": $("#CoveragePanelModel_Address_L_ZIPCODE :selected").text(), "lineSelect": 1,
                            "days": 30, "productSpecCode": $("#SERVICE_CODE" + i).val(), "isThai": isThai, "timeSlotId": timeSlotId, "smallSize": false,
                            "SubAccessMode": $('#CustomerRegisterPanelModel_SUB_ACCESS_MODE').val(),
                            "AisAirNumber": sessionStorage.getItem("AisAirNumber"),
                            "SetDefault": setDefault,
                            "timeSlotRegisterFlag": "Y",
                            "timeSlotRegisterHR": $("#hdTimeSlotRegisterHR").val(),
                            "timeSlotRegisterFlowActionNo": $("#hdTimeSlotRegisterFlowActionNo").val(),
                            "installation_DateTimeNow": $("#hdCurrentDateTime").val(),
                            "serviceLevel": $("#ServiceLevel").val(),
                            "areaRegion": $("#CoveragePanelModel_Address_AreaRegion").val(),
                            "eventRule": "@EVENT_RULE"
                        },
                        dataType: "json",
                        success: function (dataFirstTimeSlot) {
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_FirstInstallDate').val(dataFirstTimeSlot.FirstInstallDate);
                            $('#CustomerRegisterPanelModel_FBSSTimeSlot_FirstTimeSlot').val(dataFirstTimeSlot.FirstTimeSlot);
                        }
                    });
                }
            },
            complete: function() {
                $("#divResponsiveTimeSLotWarning").hide();
                LockScreen(false);
                $('.modal-backdrop').remove();
            },
        });
    }

    function SetQrCodeLine() {
        if ("@L_SCAN_QR_LINE" != "") {
            $.ajax({
                type: "POST",
                url: "/Process/GenQrCodeLine",
                data: { MobileNo: sessionStorage.getItem("AisAirNumber")},
                dataType: "json",
                success: function (datas) {
                    if (datas.resultQrCode != "") {
                        $('#divQrCode').html(datas.resultQrCode);
                        $('#divLovQrCode').html('@Html.Raw(L_SCAN_QR_LINE)');
                        $('#Customer_LINE_TEMP_ID').val(datas.linetmpid);
                        $("#summarytabQrCode  ").show();
                    }
                    else {
                        $("#summarytabQrCode  ").hide();
                    }
                }
            });
        }
        else {
            $("#summarytabQrCode  ").hide();
        }
    }

    function onDayItemClick(t, timeSlotId) {
        var parentDiv = $(t).parent();

        if ($(t).find(".color-red").length > 0 || $(t).find(".color-darkgrey").length > 0 || $(t).find(".color-holiday").length > 0) {
            setDefaultRedcap();//R19.4
            return;
        }

        $("#" + timeSlotId).find(".select-header").hide();
        $("#" + timeSlotId).find(".day-item").removeClass("day-item-select");
        $("#" + timeSlotId).find(".day-footer").hide();
        $("#" + timeSlotId).find(".header-label").show();
        $("#" + timeSlotId).find(".header-label-hidden").hide();
        $('#divTextSelectTimeSlot').html("");

        $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val("");
        $('#CustomerRegisterPanelModel_FBSSTimeSlot_InstallationCapacity').val("");
        $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlot').val("");
        $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlotId').val("");
        $('#L_INSTALL_DATE').val("");

        if ($(t).find(".color-green").length > 0) {
            $(t).find(".color-green").removeClass().addClass("fa fa-circle color-gray");
            checkDateTimeSlot = false;
            setDefaultRedcap();//R19.4
            return;
        }
        else if ($("#" + timeSlotId).find(".color-green").length > 0) {
            $("#" + timeSlotId).find(".color-green").removeClass().addClass("fa fa-circle color-gray");
        }

        if ($(t).find(".color-gray").length > 0) {
            $(parentDiv).find(".select-header").show();
            $(parentDiv).find(".day-item").addClass("day-item-select");
            $(parentDiv).find(".day-footer").show();

            $(parentDiv).find(".header-label").hide();
            $(parentDiv).find(".header-label-hidden").show();

            $(t).find(".color-gray").removeClass("color-gray").addClass("color-green");

            $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val($(t).find("input[name='FBSSAppointmentDate']").val());
            $('#CustomerRegisterPanelModel_FBSSTimeSlot_InstallationCapacity').val($(t).find("input[name='FBSSInstallationCapacity']").val());
            $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlot').val($(t).find("input[name='FBSSTimeSlot']").val());
            $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlotId').val($(t).find("input[name='TimeSlotId']").val());
            $('#L_INSTALL_DATE').val($(t).find("input[name='FBSSInstallDate']").val());

            checkDateTimeSlot = true;

            var textSelectTimeSlot = "@DISPLAY_TIMESLOT";
            textSelectTimeSlot = textSelectTimeSlot.replace("{TIMESLOT}", $(t).find("input[name='FBSSTimeSlot']").val());
            $('#divTextSelectTimeSlot').html(textSelectTimeSlot);

        }
        setDefaultRedcap();//R19.4
    }

    function CheckKeyUps(id, RexStr, checkMobile) {
        var strKey = $("#" + id).val();
        var strBuilder = "";
        if (checkMobile == undefined || checkMobile != "M") {
            var filter = new RegExp(RexStr);
            for (var i = 0; i < strKey.length; i++) {
                if (filter.test(strKey.substr(i, 1))) {
                    strBuilder += strKey.substr(i, 1);
                }
            }
        }
        else {
            var filterM = new RegExp(RexStr, "g");
            strBuilder = strKey.match(filterM);
        }
        $("#" + id).val(strBuilder);
    }

    function validateUploadFile(maxSize, fileType, idTextPath, fileClient) {
        var browser = get_browser_info();
        var previewID = idTextPath.replace("textImage", "btnPreview") + (idTextPath == "textImage" ? "R1" : "");
        if (browser.name != "MSIE") /// not IE
        {
            /// check file size

            @*if (((fileClient.files[0].size) / 1024) > maxSize) {

                    $("#" + idTextPath).removeClass('form-control').addClass('form-control errorinput');
                    $("#err003").html("@lERR_FILE_SIZE");
                    $("#" + idTextPath).val("");
                    return;
                }*@

            /// check file type

            var chk = false;
            var txt = "";
            fileType = fileType.split('|');
            for (var i = 0; i < fileType.length; i++) {

                if (fileType[i].toUpperCase() == fileClient.files[0].name.substr((fileClient.files[0].name.lastIndexOf('.') + 1)).toUpperCase()) {
                    chk = true;
                    break;
                }
            }

            if (!chk) {
                $("#" + idTextPath).removeClass('form-control').addClass('form-control errorinput');
                toastrErrorMessage("@lERR_FILE_TYPE")
                $("#" + idTextPath).val("");
                $("#" + previewID).addClass("disabled");
                return;
            }
            else {
                $("#" + idTextPath).removeClass('form-control errorinput').addClass('form-control');
                $("#" + idTextPath).val(fileClient.files[0].name);
            }
        }
        else {

            var objFSO = new ActiveXObject("Scripting.FileSystemObject");
            var file = $(fileClient)[0].value;
            var objFile = objFSO.getFile(file);
            var objFileName = objFSO.GetFileName(file)

            /// check file type
            @*var fileSize = objFile.size; //size in kb

                if ((fileSize / 1024) > maxSize) {
                    $("#" + idTextPath).removeClass('form-control').addClass('form-control errorinput');
                    $("#err003").html("@lERR_FILE_SIZE");
                    $("#" + idTextPath).val("");
                    return;
                }*@
            /// check file type

            var chk = false;
            var txt = "";
            fileType = fileType.split('|');
            for (var i = 0; i < fileType.length; i++) {
                if (file.substr(file.lastIndexOf('.') + 1).toUpperCase() == fileType[i].toUpperCase()) {
                    chk = true;
                    break;
                }
            }
            if (!chk) {
                $("#" + idTextPath).removeClass('form-control').addClass('form-control errorinput');
                toastrErrorMessage("@lERR_FILE_TYPE")
                $("#" + idTextPath).val("");
                $("#" + previewID).addClass("disabled");
                return;
            }
            else {
                $("#" + idTextPath).removeClass('form-control errorinput').removeClass('textFieldFalse').addClass('form-control');
                $("#" + idTextPath).val(objFileName);
            }
        }

        $("#" + idTextPath).removeClass('form-control errorinput').removeClass('textFieldFalse').addClass('form-control');
    }

    //function onCameraCallback(result) {

    //    var genName = "test001.jpeg"
    //    $('#textImage').val(genName);

    //    var base64str = result.replace("<camera>", "").replace("</camera>", "");
    //    var img = document.getElementById("imgPhoto");
    //    img.setAttribute("src", 'data:image/jpg;base64,' + base64str + '');


    //    var rawData = document.getElementById("imgPhoto").src;
    //    rawData = rawData.replace("data:image/jpg;base64,", "");
    //    $('#base64Photo').val(rawData);
    //    $.ajax({
    //        type: "GET",
    //        url: "/Process/Base64Photo",
    //        data: { 'base64photo': rawData },
    //        dataType: "json",
    //        success: function (data) {
    //            var img = document.getElementById("imgPhoto");
    //            img.setAttribute("src", 'data:image/jpg;base64,' + data + '');
    //        }
    //    });
    //}

    var currentPhotoFileType = "";
    var takePhotoNativeFrom = "";

    var video0 = null;
    var canvasTemp0 = null;
    var imgPreview0 = null;
    var startbutton0 = null;
    var constraints0 = null;
    var deviceList0 = [];
    var listID0 = 0;

    var vidWidth0 = 320;
    var vidHeight0 = 0;
    var turnRight = true;

    function aisNativeTakePhoto(p_fileType) {
        clearSessionTakePhoto();
        $("#canTempImageTakePhoto").hide();

        $("#closeModalTakePhoto").hide();
        $("#closeModalTakePhotoDisabled").show();

        video0 = document.getElementById('video0');
        canvasTemp0 = document.getElementById('canvasTemp0');
        imgPreview0 = document.getElementById('imgPreview0');
        startbutton0 = document.getElementById('btnStart0');

        currentPhotoFileType = p_fileType;

        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
            navigator.getMedia = (navigator.getUserMedia ||
                                   navigator.webkitGetUserMedia ||
                                   navigator.mozGetUserMedia ||
                                   navigator.msGetUserMedia);

            video0.addEventListener('canplay', function (ev) {
                if (!streaming0) {
                    vidHeight0 = video0.videoHeight / (video0.videoWidth / vidWidth0);

                    if (isNaN(vidHeight)) {
                        vidHeight0 = vidWidth0 / (4 / 3);
                    }

                    video0.setAttribute('width', vidWidth0);
                    video0.setAttribute('height', vidHeight0);
                    canvasTemp0.setAttribute('width', vidWidth0);
                    canvasTemp0.setAttribute('height', vidHeight0);

                    streaming0 = true;
                }
            }, false);

            var backCamID = "";
            var i = 0;

            if (!!navigator.mediaDevices) {
                navigator.mediaDevices.enumerateDevices().then(function (devices) {
                    devices.forEach(function (device) {
                        if (device.kind == "videoinput") {
                            deviceList0.push(device);
                            //alert(i + ": " + deviceList[i].deviceId)
                            if (device.label.match(/back/) != null) {
                                backCamID = device.deviceId;
                                listID0 = i;
                            }
                            i++;
                        }
                    });

                    if (!!backCamID) {

                        constraints0 = {
                            audio: false, video: {
                                optional: [{ sourceId: backCamID }]
                            }
                        };

                    }
                    else {
                        constraints0 = {
                            audio: false, video: true
                        };
                    }

                    startTakephoto();
                })
            }

            //clearphoto();

            if (navigator.userAgent.match(/Line/i)) {
                $("#errorText0").show();
                $("#errorText0").text("Line in-app Browser does not supported, please open in another browser or copy link to open in another browser");
            }

            //startTakephoto();
            //$('#textImageTakePhoto').val(base64str);
            //$('#btnConvertTakePhoto').click();
        }
        else {
            currentPhotoFileType = p_fileType;
            takePhotoNativeFrom = "Browse"
            aisNative.takePhotoFromCamera();
        }

    }

    var startTakephoto = function () {
        if (!!navigator.getMedia) {
            LockScreen(true);
            navigator.mediaDevices.getUserMedia(constraints0).then(openVideoTakephoto)
        }

        //startbutton0.addEventListener('click', function (ev) {
        //    alert("test");
        //    takePhotoFromModal();
        //    ev.preventDefault();
        //}, false);
        startbutton0.onclick = takePhotoFromModal

        //alert(startbutton0.onclick)
    }

    var openVideoTakephoto = function (stream) {
        $("#imgPreview0").hide();
        $("#video0").show();

        //$("#closeVideobutton").show();

        video0.srcObject = stream;
        localstream = stream;

        video0.play();

        $('.modal-dialog').addClass('modal-md');
        $('#modal_TakePhoto').find('.modal-title').text('TakePhoto');
        $('#modal_TakePhoto').modal();

        $("#btnStart0").show();

        LockScreen(false);

        if (navigator.userAgent.match(/Line/i)) {
            $("#errorText0").show();
            $("#errorText0").text("Line in-app Browser does not supported, please open in another browser or copy link to open in another browser");
        }
    }

    var imageFromTakePhotoR1 = "";

    function takePhotoFromModal() {
        LockScreen(true);
        var context = canvasTemp0.getContext('2d');
        if (vidWidth0 && vidHeight0) {
            canvasTemp0.width = vidWidth0;
            canvasTemp0.height = vidHeight0;
            var drawimageVideo = video0;
            context.drawImage(drawimageVideo, 0, 0, vidWidth0, vidHeight0);

            var data = canvasTemp0.toDataURL('image/png');
            $('#textImageTakePhoto').val(data.replace("data:image/png;base64,",""));

            //imgPreview0.setAttribute('src', data);

            $("#video0").hide();
            $("#btnStart0").hide();

            //$("#imgPreview0").show();
            turnRight = false;

            if (currentPhotoFileType == 'fileTakePhoto') {

                $("#imgPreviewOrigin").hide();
                $("#imgPreviewOrigin").attr('src', "");

                $("#verifyIdentity").hide();
                $("#btnVerifyFace").hide();

                canMake1 = false;
                fromTake1 = false;
                if (canMake1 && canMake2) {
                    $("#btnValidateFaceDisabled").hide();
                    $("#btnValidateFace").show();
                }


                imageFromTakePhotoR1 = canvasTemp0.toDataURL('image/png');

                if (videoOpen != "") {
                    $("#" + videoOpen).hide();
                    $("#" + btnVideoID + "Take").hide();
                    $("#" + btnVideoID).show();

                    window[videoOpen].pause();
                    localstream.getTracks()[0].stop();
                    videoOpen = "";
                }
            }

            context.fillStyle = "#AAA";
            context.fillRect(0, 0, canvasTemp0.width, canvasTemp0.height);

            $("#closeModalTakePhoto").show();
            $("#closeModalTakePhotoDisabled").hide();

            $('#btnConvertTakePhoto').click();


            LockScreen(false);

            //imgtmp.onload = renderImage;
            //imgtmp.src = data;

            video0.pause();
            localstream.getTracks()[0].stop();

        }
    };

    function closeModalSignature() {
        $.ajax({
            type: "GET",
            url: "/Process/get_signature_flag",
            dataType: "json",
            success: function (data) {
                if (data.result == 'Y') {
                    $('#textImage').val("signature.jpg");
                    $("#isSignature").val("t");
                    //data.signature64result
                    $("#signaturePhoto").val(data.signature64result);
                    $("#imgAtth1").attr('src', data.signature64result);
                    $("#imgAtth1").show();
                    $("#canvasAtth1").hide();
                    $("#atthF1").show();
                    $("#atthF1").css("display", "inline-flex");

                    //R18.11 IdCard Reader on PC
                    var sizeFileText = calculateSizeFileByBase64(data.signature64result, "signature.jpg");
                    if (sizeFileText) {
                        $("#textImage").val(sizeFileText);
                        $("#hdtextImagename").val($("#textImage").val());
                    }

                    //disabled remove file
                    $('#btnRemove').hide();
                    $('#btnRemoveDisabled').show();
                }
                else {
                    $('#textImage').val('');
                }
            }
        });
    }

    var takephoto1 = false;
    var takephoto1_2 = false;
    var takephoto1_3 = false;
    var takephoto1_4 = false;
    var takephoto2 = false;
    var takephoto3 = false;
    var takephoto4 = false;
    var takephoto5 = false;
    var takephoto5_2 = false;
    var takephoto5_3 = false;
    var takephoto5_4 = false;
    var takephoto6 = false;
    var takephoto7 = false;
    var takephoto8 = false;
    var takephoto9 = false;
    var takephoto9_2 = false;
    var takephoto9_3 = false;
    var takephoto9_4 = false;

    var takephoto64bit1, takephoto64bit2, takephoto64bit3, takephoto64bit4, takephoto64bit5, takephoto64bit6, takephoto64bit7, takephoto64bit8, takephoto64bit9;
    var takephoto64bit1_2, takephoto64bit1_3, takephoto64bit1_4;
    var takephoto64bit5_2, takephoto64bit5_3, takephoto64bit5_4;
    var takephoto64bit9_2, takephoto64bit9_3, takephoto64bit9_4;

    var fromTake1 = false;

    function onCameraCallback(result) {

        var base64str = "";
        base64str = result.replace("<camera>", "").replace("</camera>", "");
        LockScreen(true);
        if (takePhotoNativeFrom == "Browse") {
            //var genName = Date.now = function () { return new Date().getTime(); }
            //var rawData = "";

            // Update 17.5 show modal_TakePhoto
            $('.modal-dialog').addClass('modal-md');
            $('#modal_TakePhoto').find('.modal-title').text('TakePhoto');
            $('#modal_TakePhoto').modal();

            $('#textImageTakePhoto').val(base64str);

            if (currentPhotoFileType == 'fileTakePhoto'){
                $("#imgPreviewOrigin").hide();
                //$("#imgPreviewOrigin").src = event.target.result;
                $("#imgPreviewOrigin").attr('src', "");
                imageFromTakePhotoR1 = "data:image/jpeg;base64," + base64str

                $("#verifyIdentity").hide();
                $("#btnVerifyFace").hide();

                canMake1 = false;
                fromTake1 = false;
                if (canMake1 && canMake2) {
                    $("#btnValidateFaceDisabled").hide();
                    $("#btnValidateFace").show();
                }

                if (videoOpen != "") {
                    $("#" + videoOpen).hide();
                    $("#" + btnVideoID + "Take").hide();
                    $("#" + btnVideoID).show();

                    window[videoOpen].pause();
                    localstream.getTracks()[0].stop();
                    videoOpen = "";
                }
            }
            $("#closeModalTakePhoto").show();
            $("#closeModalTakePhotoDisabled").hide();
            $('#btnConvertTakePhoto').click();
        }
        else if (takePhotoNativeFrom == "video1") {
            window[previewPhoto].setAttribute('src', "data:image/jpeg;base64," + base64str);
            canMake1 = true;
            fromTake1 = true;

            $("#" + videoOpen).hide();
            $("#" + previewPhoto).show();

            $('#textImage').val('IDCardImage.jpeg');
            $("#hdtextImagename").val($("#textImage").val());
            renderImageBase64("data:image/jpeg;base64," + base64str, "textImage", "1");

            var sizeFileText = calculateSizeFileByBase64('data:image/jpeg;base64,' + base64str, "IDCardImage.jpeg");
            if (sizeFileText) {
                $("#textImage").val(sizeFileText);
                $("#hdtextImagename").val($("#textImage").val());
            }

            //19.1 fix 18/1/2019
            $("#btnRemove").hide();
            $("#btnRemoveDisabled").show();
            $("#verifyIdentity").hide();
            $("#btnVerifyFace").hide();

            if (canMake1 && canMake2) {
                $("#btnValidateFaceDisabled").hide();
                $("#btnValidateFace").show();
            }

            videoOpen = "";

            //if (takeTab1 == 0) {
            //    takeTab1++;
            //    startbutton1.addEventListener('click', function (ev) {
            //        takeTab1--;

            //        videoOpen = "video1";
            //        btnVideoID = "btnOrigin";
            //        previewPhoto = "imgPreviewOrigin";
            //        canMake1 = false;
            //        $("#btnValidateFaceDisabled").show();
            //        $("#btnValidateFace").hide();

            //        $("#verifyIdentity").hide();
            //        $("#btnVerifyFace").hide();

            //        takepicture();
            //        ev.preventDefault();
            //    }, false);
            //}


        }
        else if (takePhotoNativeFrom == "video2") {
            window[previewPhoto].setAttribute('src', "data:image/jpeg;base64," + base64str);
            canMake2 = true;

            $("#" + videoOpen).hide();
            $("#" + previewPhoto).show();

            if (canMake1 && canMake2) {
                $("#btnValidateFaceDisabled").hide();
                $("#btnValidateFace").show();
            }

            videoOpen = "";

            //if (takeTab2 == 0) {
            //    takeTab2++;
            //    startbutton2.addEventListener('click', function (ev) {
            //        takeTab2--;

            //        videoOpen = "video2";
            //        btnVideoID = "btnFromCamera";
            //        previewPhoto = "imgPreviewFromCamera";
            //        canMake2 = false;
            //        $("#btnValidateFaceDisabled").show();
            //        $("#btnValidateFace").hide();

            //        $("#verifyIdentity").hide();
            //        $("#btnVerifyFace").hide();

            //        takepicture();
            //        ev.preventDefault();
            //    }, false);
            //}
        }
        LockScreen(false);
        //--- End ---


    }

    function closeModalTakePhotoFunc() {
        $.ajax({
            type: "GET",
            url: "/Process/get_signature_flag",
            dataType: "json",
            success: function (data) {
                if (data.result == 'Y') {
                    if (currentPhotoFileType == 'fileTakePhoto') {
                        $('#textImage').val("file.jpg");
                        $(".imgPreviewR1").attr('src', data.signature64result);
                        $(".imgPreviewR1").removeClass("disabled");
                        $("#imgAtth1").attr('src', data.signature64result);
                        $("#imgAtth1").show();
                        $("#canvasAtth1").hide();
                        $("#atthF1").show();
                        $("#atthF1").css("display", "inline-flex");
                        takephoto64bit1 = data.signature64result;
                        takephoto1 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImage', "file.jpg"); //R18.11 IdCard Reader on PC
                        $("#hdtextImagename").val($('#textImage').val());

                        $("#imgPreviewOrigin").attr('src', imageFromTakePhotoR1);
                        $("#imgPreviewOrigin").show();
                        //$("#imgPreviewOrigin").attr('src', canvasTemp0.toDataURL('image/png'));

                        $("#verifyIdentity").hide();
                        $("#btnVerifyFace").hide();

                        canMake1 = true;
                        fromTake1 = false;
                        if (canMake1 && canMake2) {
                            $("#btnValidateFaceDisabled").hide();
                            $("#btnValidateFace").show();
                        }

                    }
                    else if (currentPhotoFileType == 'fileR2TakePhoto') {
                        $('#textImageR2').val("fileR2.jpg");
                        $(".imgPreviewR2").attr('src', data.signature64result);
                        $(".imgPreviewR2").removeClass("disabled");
                        $("#imgAtth1_2").attr('src', data.signature64result);
                        $("#imgAtth1_2").show();
                        $("#canvasAtth1_2").hide();
                        $("#atthF1_2").show();
                        $("#atthF1_2").css("display", "inline-flex");
                        takephoto64bit1_2 = data.signature64result;
                        takephoto1_2 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageR2', "fileR2.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileR3TakePhoto') {
                        $('#textImageR3').val("fileR3.jpg");
                        $(".imgPreviewR3").attr('src', data.signature64result);
                        $(".imgPreviewR3").removeClass("disabled");
                        $("#imgAtth1_3").attr('src', data.signature64result);
                        $("#imgAtth1_3").show();
                        $("#canvasAtth1_3").hide();
                        $("#atthF1_3").show();
                        $("#atthF1_3").css("display", "inline-flex");
                        takephoto64bit1_3 = data.signature64result;
                        takephoto1_3 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageR3', "fileR3.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileR4TakePhoto') {
                        $('#textImageR4').val("fileR4.jpg");
                        $(".imgPreviewR4").attr('src', data.signature64result);
                        $(".imgPreviewR4").removeClass("disabled");
                        $("#imgAtth1_4").attr('src', data.signature64result);
                        $("#imgAtth1_4").show();
                        $("#canvasAtth1_4").hide();
                        $("#atthF1_4").show();
                        $("#atthF1_4").css("display", "inline-flex");
                        takephoto64bit1_4 = data.signature64result;
                        takephoto1_4 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageR4', "fileR4.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileBillTakePhoto') {
                        $('#textImageBill').val("filebill.jpg");
                        $(".imgPreviewBill").attr('src', data.signature64result);
                        $(".imgPreviewBill").removeClass("disabled");
                        $("#imgAtth2").attr('src', data.signature64result);
                        $("#imgAtth2").show();
                        $("#canvasAtth2").hide();
                        $("#atthF2").show();
                        $("#atthF2").css("display", "inline-flex");
                        takephoto64bit2 = data.signature64result;
                        takephoto2 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageBill', "filebill.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileG1TakePhoto') {
                        $('#textImageG1').val("fileG1.jpg");
                        $(".imgPreviewG1").attr('src', data.signature64result);
                        $(".imgPreviewG1").removeClass("disabled");
                        $("#imgAtth3").attr('src', data.signature64result);
                        $("#imgAtth3").show();
                        $("#canvasAtth3").hide();
                        $("#atthF3").show();
                        $("#atthF3").css("display", "inline-flex");
                        takephoto64bit3 = data.signature64result;
                        takephoto3 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageG1', "fileG1.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileG2TakePhoto') {
                        $('#textImageG2').val("fileG2.jpg");
                        $(".imgPreviewG2").attr('src', data.signature64result);
                        $(".imgPreviewG2").removeClass("disabled");
                        $("#imgAtth4").attr('src', data.signature64result);
                        $("#imgAtth4").show();
                        $("#canvasAtth4").hide();
                        $("#atthF4").show();
                        $("#atthF4").css("display", "inline-flex");
                        takephoto64bit4 = data.signature64result;
                        takephoto4 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageG2', "fileG2.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileG3TakePhoto') {
                        $('#textImageG3').val("fileG3.jpg");
                        $(".imgPreviewG3").attr('src', data.signature64result);
                        $(".imgPreviewG3").removeClass("disabled");
                        $("#imgAtth5").attr('src', data.signature64result);
                        $("#imgAtth5").show();
                        $("#canvasAtth5").hide();
                        $("#atthF5").show();
                        $("#atthF5").css("display", "inline-flex");
                        takephoto64bit5 = data.signature64result;
                        takephoto5 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageG3', "fileG3.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileG4TakePhoto') {
                        $('#textImageG4').val("fileG4.jpg");
                        $(".imgPreviewG4").attr('src', data.signature64result);
                        $(".imgPreviewG4").removeClass("disabled");
                        $("#imgAtth5_2").attr('src', data.signature64result);
                        $("#imgAtth5_2").show();
                        $("#canvasAtth5_2").hide();
                        $("#atthF5_2").show();
                        $("#atthF5_2").css("display", "inline-flex");
                        takephoto64bit5_2 = data.signature64result;
                        takephoto5_2 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageG4', "fileG4.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileG5TakePhoto') {
                        $('#textImageG5').val("fileG5.jpg");
                        $(".imgPreviewG5").attr('src', data.signature64result);
                        $(".imgPreviewG5").removeClass("disabled");
                        $("#imgAtth5_3").attr('src', data.signature64result);
                        $("#imgAtth5_3").show();
                        $("#canvasAtth5_3").hide();
                        $("#atthF5_3").show();
                        $("#atthF5_3").css("display", "inline-flex");
                        takephoto64bit5_3 = data.signature64result;
                        takephoto5_3 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageG5', "fileG5.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileG6TakePhoto') {
                        $('#textImageG6').val("fileG6.jpg");
                        $(".imgPreviewG6").attr('src', data.signature64result);
                        $(".imgPreviewG6").removeClass("disabled");
                        $("#imgAtth5_4").attr('src', data.signature64result);
                        $("#imgAtth5_4").show();
                        $("#canvasAtth5_4").hide();
                        $("#atthF5_4").show();
                        $("#atthF5_4").css("display", "inline-flex");
                        takephoto64bit5_4 = data.signature64result;
                        takephoto5_4 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageG6', "fileG6.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileB1TakePhoto') {
                        $('#textImageB1').val("fileB1.jpg");
                        $(".imgPreviewB1").attr('src', data.signature64result);
                        $(".imgPreviewB1").removeClass("disabled");
                        $("#imgAtth6").attr('src', data.signature64result);
                        $("#imgAtth6").show();
                        $("#canvasAtth6").hide();
                        $("#atthF6").show();
                        $("#atthF6").css("display", "inline-flex");
                        takephoto64bit6 = data.signature64result;
                        takephoto6 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageB1', "fileB1.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileB2TakePhoto') {
                        $('#textImageB2').val("fileB2.jpg");
                        $(".imgPreviewB2").attr('src', data.signature64result);
                        $(".imgPreviewB2").removeClass("disabled");
                        $("#imgAtth7").attr('src', data.signature64result);
                        $("#imgAtth7").show();
                        $("#canvasAtth7").hide();
                        $("#atthF7").show();
                        $("#atthF7").css("display", "inline-flex");
                        takephoto64bit7 = data.signature64result;
                        takephoto7 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageB2', "fileB2.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileB3TakePhoto') {
                        $('#textImageB3').val("fileB3.jpg");
                        $(".imgPreviewB3").attr('src', data.signature64result);
                        $(".imgPreviewB3").removeClass("disabled");
                        $("#imgAtth8").attr('src', data.signature64result);
                        $("#imgAtth8").show();
                        $("#canvasAtth8").hide();
                        $("#atthF8").show();
                        $("#atthF8").css("display", "inline-flex");
                        takephoto64bit8 = data.signature64result;
                        takephoto8 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageB3', "fileB3.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileB4TakePhoto') {
                        $('#textImageB4').val("fileB4.jpg");
                        $(".imgPreviewB4").attr('src', data.signature64result);
                        $(".imgPreviewB4").removeClass("disabled");
                        $("#imgAtth9").attr('src', data.signature64result);
                        $("#imgAtth9").show();
                        $("#canvasAtth9").hide();
                        $("#atthF9").show();
                        $("#atthF9").css("display", "inline-flex");
                        takephoto64bit9 = data.signature64result;
                        takephoto9 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageB4', "fileB4.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileB5TakePhoto') {
                        $('#textImageB5').val("fileB5.jpg");
                        $(".imgPreviewB5").attr('src', data.signature64result);
                        $(".imgPreviewB5").removeClass("disabled");
                        $("#imgAtth9_2").attr('src', data.signature64result);
                        $("#imgAtth9_2").show();
                        $("#canvasAtth9_2").hide();
                        $("#atthF9_2").show();
                        $("#atthF9_2").css("display", "inline-flex");
                        takephoto64bit9_2 = data.signature64result;
                        takephoto9_2 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageB5', "fileB5.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileB6TakePhoto') {
                        $('#textImageB6').val("fileB6.jpg");
                        $(".imgPreviewB6").attr('src', data.signature64result);
                        $(".imgPreviewB6").removeClass("disabled");
                        $("#imgAtth9_3").attr('src', data.signature64result);
                        $("#imgAtth9_3").show();
                        $("#canvasAtth9_3").hide();
                        $("#atthF9_3").show();
                        $("#atthF9_3").css("display", "inline-flex");
                        takephoto64bit9_3 = data.signature64result;
                        takephoto9_3 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageB6', "fileB6.jpg"); //R18.11 IdCard Reader on PC
                    }
                    else if (currentPhotoFileType == 'fileB7TakePhoto') {
                        $('#textImageB7').val("fileB7.jpg");
                        $(".imgPreviewB7").attr('src', data.signature64result);
                        $(".imgPreviewB7").removeClass("disabled");
                        $("#imgAtth9_4").attr('src', data.signature64result);
                        $("#imgAtth9_4").show();
                        $("#canvasAtth9_4").hide();
                        $("#atthF9_4").show();
                        $("#atthF9_4").css("display", "inline-flex");
                        takephoto64bit9_4 = data.signature64result;
                        takephoto9_4 = true;
                        setSizeFileByTakePhoto(data.signature64result, '#textImageB7', "fileB7.jpg"); //R18.11 IdCard Reader on PC
                    }
                }
                else {
                    if (currentPhotoFileType == 'fileTakePhoto') {
                        $('#textImage').val('');
                    }
                    else if (currentPhotoFileType == 'fileR2TakePhoto') {
                        $('#textImageR2').val('');
                    }
                    else if (currentPhotoFileType == 'fileR3TakePhoto') {
                        $('#textImageR3').val('');
                    }
                    else if (currentPhotoFileType == 'fileR4TakePhoto') {
                        $('#textImageR4').val('');
                    }
                    else if (currentPhotoFileType == 'fileBillTakePhoto') {
                        $('#textImageBill').val('');
                    }
                    else if (currentPhotoFileType == 'fileG1TakePhoto') {
                        $('#textImageG1').val('');
                    }
                    else if (currentPhotoFileType == 'fileG2TakePhoto') {
                        $('#textImageG2').val('');
                    }
                    else if (currentPhotoFileType == 'fileG3TakePhoto') {
                        $('#textImageG3').val('');
                    }
                    else if (currentPhotoFileType == 'fileG4TakePhoto') {
                        $('#textImageG4').val('');
                    }
                    else if (currentPhotoFileType == 'fileG5TakePhoto') {
                        $('#textImageG5').val('');
                    }
                    else if (currentPhotoFileType == 'fileG6TakePhoto') {
                        $('#textImageG6').val('');
                    }
                    else if (currentPhotoFileType == 'fileB1TakePhoto') {
                        $('#textImageB1').val('');
                    }
                    else if (currentPhotoFileType == 'fileB2TakePhoto') {
                        $('#textImageB2').val('');
                    }
                    else if (currentPhotoFileType == 'fileB3TakePhoto') {
                        $('#textImageB3').val('');
                    }
                    else if (currentPhotoFileType == 'fileB4TakePhoto') {
                        $('#textImageB4').val('');
                    }
                    else if (currentPhotoFileType == 'fileB5TakePhoto') {
                        $('#textImageB5').val('');
                    }
                    else if (currentPhotoFileType == 'fileB6TakePhoto') {
                        $('#textImageB6').val('');
                    }
                    else if (currentPhotoFileType == 'fileB7TakePhoto') {
                        $('#textImageB7').val('');
                    }
                }
            }
        });
    }

    //R18.11 IdCard Reader on PC
    function setSizeFileByTakePhoto(signature64result, fileid, filename) {
        var sizeFileText = calculateSizeFileByBase64(signature64result, filename);
        if (sizeFileText) {
            $(fileid).val(sizeFileText);
        }
    }

    // Update 17.5 Get LOV for Watermark
    function getWatermark() {

        var watermarkcardtxt = "";

        $.ajax({
            type: "GET",
            url: "/Process/getWatermark",
            dataType: "json",
            async: false,
            success: function (txtdata) {
                watermarkcardtxt = txtdata;
            },
            error: function () {
                watermarkcardtxt = "use for registration at AIS FIBRE only";
            }

        });
        return watermarkcardtxt;
    }

    var video1 = null;
    var video2 = null;
    var canvasTempRecog = null;
    var imgPreviewOrigin = null;
    var imgPreviewFromCamera = null;
    var startbutton1 = null;
    var startbutton2 = null;
    var constraints = null;
    var deviceList = [];
    var listID = 0;

    var vidWidth = 320;
    var vidHeight = 0;
    var streaming0 = false;
    var streaming1 = false;
    var streaming2 = false;

    var localstream;
    var videoOpen = "";
    var btnVideoID = "";
    var previewPhoto = "";

    var percentPass = 0;

    var canMake1 = false;
    var canMake2 = false;

    var fromMakeFace = false;

    var takeTab1 = 0;
    var takeTab2 = 0;




    $("#btnOrigin").on("click", function () {
        if (videoOpen != "") {

            $("#" + videoOpen).hide();
            $("#" + btnVideoID + "Take").hide();
            $("#" + btnVideoID).show();

            window[videoOpen].pause();
            localstream.getTracks()[0].stop();
        }
        videoOpen = "video1";
        btnVideoID = "btnOrigin";
        previewPhoto = "imgPreviewOrigin";
        canMake1 = false;
        $("#btnValidateFaceDisabled").show();
        $("#btnValidateFace").hide();

        $("#verifyIdentity").hide();
        $("#btnVerifyFace").hide();

        startVideo();
    });
    $("#btnFromCamera").on("click", function () {
        if (videoOpen != "") {

            $("#" + videoOpen).hide();
            $("#" + btnVideoID + "Take").hide();
            $("#" + btnVideoID).show();

            window[videoOpen].pause();
            localstream.getTracks()[0].stop();
        }
        videoOpen = "video2";
        btnVideoID = "btnFromCamera";
        previewPhoto = "imgPreviewFromCamera";
        canMake2 = false;
        $("#btnValidateFaceDisabled").show();
        $("#btnValidateFace").hide();

        $("#verifyIdentity").hide();
        $("#btnVerifyFace").hide();

        startVideo();
    });

    $("#btnValidateFace").on("click", function () {
        LockScreen(true);
        $.ajax({
            type: "POST",
            url: "/process/compareFace",
            data: { 'cardBase64Imgs': imgPreviewOrigin.src.slice(imgPreviewOrigin.src.indexOf(',') + 1), 'selfieBase64Imgs': imgPreviewFromCamera.src.slice(imgPreviewFromCamera.src.indexOf(',') + 1), 'AisAirNumber': sessionStorage.getItem("AisAirNumber") },
            //dataType: "application/x-www-form-urlencoded",
            success: function (data) {
                //console.log("Data : ", data);
                if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {

                }
                else{
                    $("#dvCollapse1").removeClass('in');
                    $("#dvCollapse2").removeClass('in');
                }

                percentPass = 0;
                if (data.success == "True") {
                    percentPass = 100 - (data.score * 100);
                    percentPass = percentPass.toFixed(2);

                    if (percentPass > parseInt("@PASS_FACE_RECOGNITION")) {
                        $("#showResultRecog").show();
                        $("#showResultRecog").html("<h3>" + "@L_RESULT_FACE_RECOGNITION" + " " + percentPass + "% " + "@L_PASS_FACE_RECOGNITION" + "</h3>");
                        $("#btnRemove").hide();
                        $("#btnRemoveDisabled").show();

                        // check pc/mobile
                        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
                            $("#btnbrowse").hide();
                            $("#btnbrowseDisabled").show();

                        }
                        else {
                            if (signatureShowFlag) {
                                $("#filesignature").hide();
                                $("#filesignatureDisabled").show();
                            }
                        }

                        if ($("#CustomerRegisterPanelModel_FlagTakePhoto").val() == "Y" && navigator.userAgent.indexOf("SamsungBrowser") == -1 && !iOSSafari && !iOS && !signatureShowFlag) {
                            $("#fileTakePhoto").hide();
                            $("#fileTakePhotoDisabled").show();
                        }

                        $("btnFaceRecog").css("color", "#8DC63F");

                        $("#btnOrigin").hide();
                        $("#btnFromCamera").hide();
                        $("#btnOriginTake").hide();
                        $("#btnFromCameraTake").hide();
                        $("#btnValidateFace").hide();
                        $("#btnValidateFaceDisabled").hide();

                        $("#verifyIdentity").hide();
                        $("#btnVerifyFace").hide();

                        $("#faceRecogCheckedFlag").val("Y");
                        $('#CustomerRegisterPanelModel_FlagFaceRecognitionSubmit').val("Y");
                    }
                    else {
                        $("#showResultRecog").show();
                        $("#showResultRecog").html("<h3>" + "@L_RESULT_FACE_RECOGNITION" + " " + percentPass + "% " + "@L_FAIL_FACE_RECOGNITION" + "</h3> <br>" + "@L_APPROVE_FACE_RECOGNITION");
                        $("btnFaceRecog").css("color", "red");
                        $("#verifyIdentity").show();
                        $("#btnVerifyFace").show();
                        $("#faceRecogCheckedFlag").val("N");
                        $('#CustomerRegisterPanelModel_FlagFaceRecognitionSubmit').val("N");

                    }
                }
                else {
                    $("#showResultRecog").show();
                    $("#showResultRecog").html("<h3>" + "@L_FAIL_FACE_RECOGNITION"+ " " + "@L_FAIL_NO_FACE_DETECTED" + "</h3> <br>" + "@L_APPROVE_FACE_RECOGNITION");
                    $("btnFaceRecog").css("color", "red");
                    $("#verifyIdentity").show();
                    $("#btnVerifyFace").show();
                    $("#faceRecogCheckedFlag").val("N");
                    $('#CustomerRegisterPanelModel_FlagFaceRecognitionSubmit').val("N");
                }

            },
            complete: function (data) {
                fromMakeFace = true;
                LockScreen(false);
            }
        });
    });

    $("#btnVerifyFace").on("click", function () {
        $("#showResultRecog").html("<h3>" + "@L_RESULT_FACE_RECOGNITION" + " " + percentPass + "% " + "@L_PASS_FACE_RECOGNITION" + "</h3>");
        $("#btnRemove").hide();
        $("#btnRemoveDisabled").show();

        // check pc/mobile
        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
            $("#btnbrowse").hide();
            $("#btnbrowseDisabled").show();
        }
        else {
            if (signatureShowFlag) {
                $("#filesignature").hide();
                $("#filesignatureDisabled").show();
            }
        }

        if ($("#CustomerRegisterPanelModel_FlagTakePhoto").val() == "Y" && navigator.userAgent.indexOf("SamsungBrowser") == -1 && !iOSSafari && !iOS && !signatureShowFlag) {
            $("#fileTakePhoto").hide();
            $("#fileTakePhotoDisabled").show();
        }

        $("btnFaceRecog").css("color", "#8DC63F");

        $("#btnOrigin").hide();
        $("#btnFromCamera").hide();
        $("#btnOriginTake").hide();
        $("#btnFromCameraTake").hide();
        $("#btnValidateFace").hide();
        $("#btnValidateFaceDisabled").hide();

        $("#verifyIdentity").hide();
        $("#btnVerifyFace").hide();

        $("#faceRecogCheckedFlag").val("Y");
        $('#CustomerRegisterPanelModel_FlagFaceRecognitionSubmit').val("Y");
    });

    function startup() {

        LockScreen(true);

        video1 = document.getElementById('video1');
        video2 = document.getElementById('video2');
        canvasTempRecog = document.getElementById('canvasTempRecog');
        imgPreviewOrigin = document.getElementById('imgPreviewOrigin');
        imgPreviewFromCamera = document.getElementById('imgPreviewFromCamera');
        startbutton1 = document.getElementById('btnOriginTake');
        startbutton2 = document.getElementById('btnFromCameraTake');

        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
            navigator.getMedia = (navigator.getUserMedia ||
                                   navigator.webkitGetUserMedia ||
                                   navigator.mozGetUserMedia ||
                                   navigator.msGetUserMedia);

            video1.addEventListener('canplay', function (ev) {
                if (!streaming1) {
                    vidHeight = video1.videoHeight / (video1.videoWidth / vidWidth);

                    // Firefox currently has a bug where the height can't be read from
                    // the video, so we will make assumptions if this happens.

                    if (isNaN(vidHeight)) {
                        vidHeight = vidWidth / (4 / 3);
                    }

                    video1.setAttribute('width', vidWidth);
                    video1.setAttribute('height', vidHeight);
                    canvasTempRecog.setAttribute('width', vidWidth);
                    canvasTempRecog.setAttribute('height', vidHeight);
                    streaming1 = true;
                }
            }, false);

            video2.addEventListener('canplay', function (ev) {
                if (!streaming2) {
                    vidHeight = video2.videoHeight / (video2.videoWidth / vidWidth);

                    // Firefox currently has a bug where the height can't be read from
                    // the video, so we will make assumptions if this happens.

                    if (isNaN(vidHeight)) {
                        vidHeight = vidWidth / (4 / 3);
                    }

                    video2.setAttribute('width', vidWidth);
                    video2.setAttribute('height', vidHeight);
                    canvasTempRecog.setAttribute('width', vidWidth);
                    canvasTempRecog.setAttribute('height', vidHeight);
                    streaming2 = true;
                }
            }, false);

            var backCamID = "";
            var i = 0;

            if (!!navigator.mediaDevices) {
                navigator.mediaDevices.enumerateDevices().then(function (devices) {
                    devices.forEach(function (device) {
                        if (device.kind == "videoinput") {
                            deviceList.push(device);
                            //alert(i + ": " + deviceList[i].deviceId)
                            if (device.label.match(/back/) != null) {
                                backCamID = device.deviceId;
                                listID = i;
                            }
                            i++;
                        }
                    });

                    if (!!backCamID) {

                        constraints = {
                            audio: false, video: {
                                optional: [{ sourceId: backCamID }]
                            }
                        };
                    }
                    else {
                        constraints = {
                            audio: false, video: true
                        };
                    }
                })
            }

            //clearphoto();

            if (navigator.userAgent.match(/Line/i)) {
                $("#errorText").show();
                $("#errorText").text("Line in-app Browser does not supported, please open in another browser or copy link to open in another browser");
            }
        }
        else {
            $("#btnOrigin").hide();
            $("#btnFromCamera").hide();

            if ($("#faceRecogCheckedFlag").val() == "Y") {
                $("#btnOriginTake").hide();
                $("#btnFromCameraTake").hide();
            }
            else {
                $("#btnOriginTake").show();
                $("#btnFromCameraTake").show();
            }

            var useDataCardTablet = sessionStorage.getItem('Use_Data_Card_Tablet');

            // alert('canMake1='+canMake1 + ",fromTake1="+fromTake1 + "useDataCardTablet=" + useDataCardTablet);
            if (canMake1 && !fromTake1 && useDataCardTablet == "Y")
                $("#btnOriginTake").hide();

            if (takeTab1 == 0) {
                takeTab1++;
                startbutton1.addEventListener('click', function (ev) {
                    //takeTab1--;

                    videoOpen = "video1";
                    btnVideoID = "btnOrigin";
                    previewPhoto = "imgPreviewOrigin";
                    canMake1 = false;
                    $("#btnValidateFaceDisabled").show();
                    $("#btnValidateFace").hide();

                    $("#verifyIdentity").hide();
                    $("#btnVerifyFace").hide();

                    takepicture();
                    ev.preventDefault();
                }, false);
            }
            if (takeTab2 == 0) {
                takeTab2++;
                startbutton2.addEventListener('click', function (ev) {
                    //takeTab2--;

                    videoOpen = "video2";
                    btnVideoID = "btnFromCamera";
                    previewPhoto = "imgPreviewFromCamera";
                    canMake2 = false;
                    $("#btnValidateFaceDisabled").show();
                    $("#btnValidateFace").hide();

                    $("#verifyIdentity").hide();
                    $("#btnVerifyFace").hide();

                    takepicture();
                    ev.preventDefault();
                }, false);
            }
        }

        LockScreen(false);
    }

    function startVideo() {

        if (!!navigator.getMedia) {
            LockScreen(true);
            navigator.mediaDevices.getUserMedia(constraints).then(handleSuccess)
        }
        else {

            $("#errorText").show();
            if (navigator.userAgent.match(/Line/i)) {
                $("#errorText").text("Line in-app Browser does not supported, please open in another browser or copy link to open in another browser");
            }
            else if (iOSSafari || iOS) {
                $("#errorText").text("IOS does not supported");
            }
            else {
                $("#errorText").text("Your browser does not supported, please open in Chrome or Firefox");
            }
        }

        window[videoOpen.replace("video", "startbutton")].addEventListener('click', function (ev) {
            if (videoOpen != "")
                takepicture();
            ev.preventDefault();
        }, false);

    }

    var handleSuccess = function (stream) {
        $("#" + previewPhoto).hide();
        $("#" + videoOpen).show();
        $("#" + btnVideoID + "Take").show();
        //$("#switchCamerabutton").show();
        $("#" + btnVideoID).hide();

        //$("#closeVideobutton").show();

        window[videoOpen].srcObject = stream;
        localstream = stream;

        window[videoOpen].play();

        LockScreen(false);

        if (navigator.userAgent.match(/Line/i)) {
            $("#errorText").show();
            $("#errorText").text("Line in-app Browser does not supported, please open in another browser or copy link to open in another browser");
        }
    };

    function handleImage(e) {
        $("#hdFlagUploadImage").val("N");
        var validate = validateUploadFile(parseInt("@FILE_SIZE"), "@FILE_TYPE", e.dataset.fileimage, e);
        if($("#" + e.dataset.fileimage).val() != ""){
            var reader = new FileReader();
            if (e.files[0].type != "application/pdf") {
                var reader = new FileReader();
                reader.onload = function (event) {

                    if (e.dataset.imageno == "1") {
                        $("#imgPreviewOrigin").show();
                        //$("#imgPreviewOrigin").src = event.target.result;
                        $("#imgPreviewOrigin").attr('src', event.target.result);

                        $("#verifyIdentity").hide();
                        $("#btnVerifyFace").hide();

                        canMake1 = true;
                        fromTake1 = false;
                        if (canMake1 && canMake2) {
                            $("#btnValidateFaceDisabled").hide();
                            $("#btnValidateFace").show();
                        }

                        if (videoOpen != "") {
                            $("#" + videoOpen).hide();
                            $("#" + btnVideoID + "Take").hide();
                            $("#" + btnVideoID).show();

                            window[videoOpen].pause();
                            localstream.getTracks()[0].stop();
                            videoOpen = "";
                        }
                    }

                    //renderImageBase64(event.target.result, e.dataset.fileimage, e.dataset.imageno);

                    //var rawData = document.getElementById(e.dataset.fileimage.replace("textImage", "imgPhoto")).src;
                    var rawData = event.target.result.substr(event.target.result.indexOf(',') + 1);

                    var previewID = e.dataset.fileimage.replace("textImage", "imgPreview") + (e.dataset.fileimage == "textImage" ? "R1" : "");
                    $("." + previewID).attr('src', event.target.result);
                    $("." + previewID).removeClass("disabled");


                    //readURLPic(this, "#imgAtth1", "#canvasAtth1");
                    $("#imgAtth" + e.dataset.imageno).attr('src', event.target.result);
                    $("#imgAtth" + e.dataset.imageno).show();
                    $("#canvasAtth" + e.dataset.imageno).hide();
                    window["pic" + e.dataset.imageno + "dl"] = event.target.result;
                    $("#atthF" + e.dataset.imageno).show();
                    $("#atthF" + e.dataset.imageno).css("display", "inline-flex");
                    isUpload.push(e.dataset.imageno);

                    $("#canvasAtth" + e.dataset.imageno).hide();

                    window["takephoto" + e.dataset.imageno] = false;

                    $.ajax({
                        type: "POST",
                        url: "/Process/StoreBase64Photo",
                        data: { 'base64photo': rawData, 'fileType': "fileTakePhoto" + e.dataset.imageno },
                        dataType: "json",
                        success: function (data) {
                            $.ajax({
                                type: "POST",
                                url: "/Process/signature_flag",
                                data: { 'status': 'Y', 'pic64signature': event.target.result },
                                dataType: "json",
                                success: function (data) {
                                    LockScreen(false);

                                }
                            });
                        }
                    });
                }
            }
            else {
                //R18.11 IdCard Reader on PC
                removeImageBase64(e.dataset.fileimage, e.dataset.imageno);
                window["takephoto" + e.dataset.imageno] = false;
            }
            reader.readAsDataURL(e.files[0]);

            //R18.11 IdCard Reader on PC
            var sizeFileText = calculateSizeFile(e);
            if (sizeFileText) {
                $("#" + e.dataset.fileimage).val(sizeFileText);
            }
        }
        else {
            if (e.dataset.imageno == "1") {
                if (!!imgPreviewOrigin)
                    imgPreviewOrigin.setAttribute('src', "");
                $("#imgPreviewOrigin").hide();
                canMake1 = false;
                fromTake1 = false;

                $("#btnValidateFaceDisabled").show();
                $("#btnValidateFace").hide();

                $("#showResultRecog").hide();
                $("#verifyIdentity").hide();
                $("#btnVerifyFace").hide();
                $("#faceRecogCheckedFlag").val("N");
                $('#CustomerRegisterPanelModel_FlagFaceRecognitionSubmit').val("N");
            }
        }
    }

    //R18.11 IdCard Reader on PC
    function calculateSizeFile(e) {
        var nameId = e.dataset.fileimage;
        var nameFile = e.files[0].name;
        var sizeFile = e.files[0].size;
        var sizeFileCal = 0;
        var sizeFileText = '';
        if (sizeFile) {
            if (sizeFile < 1048576) {
                sizeFileCal = Math.ceil(sizeFile / 1024);
                sizeFileText = nameFile + ' (' + sizeFileCal + ' KB)';
            }
            else {
                var sizeMb = Math.floor(sizeFile / 1024 / 1024);
                var sizeKb = Math.ceil(((sizeFile / 1024 / 1024) - sizeMb) * 100);
                sizeFileText = nameFile + ' (' + sizeMb + '.' + sizeKb + ' MB)';
            }
            //console.log(sizeFileText);
        }
        return sizeFileText;
    }

    //R18.11 IdCard Reader on PC
    function calculateSizeFileByBase64(base64, nameFile) {
        var sizeFile = Math.round(base64.split(",")[1].length * 3 / 4);
        var sizeFileCal = 0;
        var sizeFileText = '';
        if (sizeFile) {
            if (sizeFile < 1048576) {
                sizeFileCal = Math.ceil(sizeFile / 1024);
                sizeFileText = nameFile + ' (' + sizeFileCal + ' KB)';
            }
            else {
                var sizeMb = Math.floor(sizeFile / 1024 / 1024);
                var sizeKb = Math.ceil(((sizeFile / 1024 / 1024) - sizeMb) * 100);
                sizeFileText = nameFile + ' (' + sizeMb + '.' + sizeKb + ' MB)';
            }
            //console.log(sizeFileText);
        }
        return sizeFileText;
    }

    function takepicture() {
        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
            LockScreen(true);
            var context = canvasTempRecog.getContext('2d');
            if (vidWidth && vidHeight) {
                canvasTempRecog.width = vidWidth;
                canvasTempRecog.height = vidHeight;
                var drawimageVideo = window[videoOpen]
                context.drawImage(drawimageVideo, 0, 0, vidWidth, vidHeight);

                var data = canvasTempRecog.toDataURL('image/png');
                window[previewPhoto].setAttribute('src', data);

                window[videoOpen.replace("video", "canMake")] = true;
                $("#" + videoOpen).hide();
                $("#" + btnVideoID + "Take").hide();
                $("#" + btnVideoID).show();
                //$("#closeVideobutton").hide();

                $("#" + previewPhoto).show();

                if (videoOpen == "video1") {
                    $('#textImage').val('IDCardImage.jpeg');
                    $("#hdtextImagename").val($("#textImage").val());
                    renderImageBase64(data, "textImage", "1");

                    var sizeFileText = calculateSizeFileByBase64(data, "IDCardImage.jpeg");
                    if (sizeFileText) {
                        $("#textImage").val(sizeFileText);
                        $("#hdtextImagename").val($("#textImage").val());
                    }

                    $("#btnRemove").hide();
                    $("#btnRemoveDisabled").show();
                }

                if (canMake1 && canMake2) {
                    $("#btnValidateFaceDisabled").hide();
                    $("#btnValidateFace").show();
                }

                LockScreen(false);

                //imgtmp.onload = renderImage;
                //imgtmp.src = data;

                window[videoOpen].pause();
                localstream.getTracks()[0].stop();
                videoOpen = "";

            } else {
                clearphoto();
            }
        }
        else {
            takePhotoNativeFrom = videoOpen;
            aisNative.takePhotoFromCamera();
        }
    }

    function clearphoto() {
        var context = canvasTempRecog.getContext('2d');
        context.fillStyle = "#AAA";
        context.fillRect(0, 0, canvasTempRecog.width, canvasTempRecog.height);
    }

    function renderImageBase64(base64, fileImage, imageNo) {
        LockScreen(true);

        //for upload new file
        //$("#hdFlagUploadImage").val("N");

        var watermarkstr = getWatermark();

        var canvastmp = document.getElementById('canTempImageTakePhoto'),
        ctx = canvastmp.getContext('2d');

        var imgtmp = new Image();
        imgtmp.src = base64;

        imgtmp.onload = function () {
            canvastmp.width = imgtmp.width;
            canvastmp.height = imgtmp.height;

            /// draw image and reset transform
            ctx.drawImage(imgtmp, 0, 0);
            ctx.setTransform(1, 0, 0, 1, 0, 0);

            ctx.font = Math.ceil((Math.sqrt((imgtmp.width * imgtmp.width) + (imgtmp.height * imgtmp.height)) / watermarkstr.length) * 2) + 'px db_helvethaicaais_x55_regular'; //54

            //ctx.globalCompositeOperation = 'lighter'; //ใส
            ctx.globalCompositeOperation = "difference";
            //ctx.fillStyle = '#444'; //สี
            ctx.fillStyle = 'rgba(255, 255, 255, 0.4)'; //สี
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            var metrics = ctx.measureText("WaterMark");
            var width = 0;
            var height = 0;
            ctx.translate(canvastmp.width / 2, canvastmp.height / 2);
            ctx.rotate(-Math.atan(canvastmp.height / canvastmp.width));
            ctx.fillText(watermarkstr, -width / 2, height / 2);

            ctx.translate(-canvastmp.width / 4, -canvastmp.height / 4);
            ctx.fillText(watermarkstr, -width, height);

            ctx.translate(canvastmp.width / 2, canvastmp.height / 2);
            ctx.fillText(watermarkstr, -width, height);

            //ctx.translate(canvastmp.width, canvastmp.height);
            //ctx.fillText(watermarkstr, -width, height);

            //photo.setAttribute('src', canvastmp.toDataURL('image/jpg'));

            $("#canTempImageTakePhoto").show();

            var img = $("#" + fileImage.replace("textImage", "imgPhoto"))[0];
            img.src = canvastmp.toDataURL('image/png');

            var img_64str = canvastmp.toDataURL('image/png');
            base64str = img_64str.replace("data:image/png;base64,", "");

            var rawData = document.getElementById(fileImage.replace("textImage", "imgPhoto")).src;
            rawData = rawData.replace("data:image/png;base64,", "");

            var previewID = fileImage.replace("textImage", "imgPreview") + (fileImage == "textImage" ? "R1" : "");
            $("." + previewID).attr('src', canvastmp.toDataURL('image/png'));
            $("." + previewID).removeClass("disabled");


            //readURLPic(this, "#imgAtth1", "#canvasAtth1");
            $("#imgAtth" + imageNo).attr('src', canvastmp.toDataURL('image/png'));
            $("#imgAtth" + imageNo).show();
            $("#canvasAtth" + imageNo).hide();
            window["pic" + imageNo + "dl"] = canvastmp.toDataURL('image/png');
            $("#atthF" + imageNo).show();
            $("#atthF" + imageNo).css("display", "inline-flex");
            isUpload.push(imageNo);


            $.ajax({
                type: "POST",
                url: "/Process/StoreBase64Photo",
                data: { 'base64photo': rawData, 'fileType': "fileTakePhoto" + imageNo },
                dataType: "json",
                success: function (data) {
                    $.ajax({
                        type: "POST",
                        url: "/Process/signature_flag",
                        data: { 'status': 'Y', 'pic64signature': img_64str },
                        dataType: "json",
                        success: function (data) {
                            LockScreen(false);

                        }
                    });
                }
            });
        }





        //if (canvastmp.toBlob) {
        //    canvastmp.toBlob(function (blob) {
        //        blobData = blob;

        //        LockScreen(false);
        //    });
        //}
        //else {
        //    blobData = null;
        //    LockScreen(false);
        //}
    }

    //R18.11 IdCard Reader on PC
    function removeImageBase64(fileImage, imageNo) {
        LockScreen(true);

        var previewID = fileImage.replace("textImage", "imgPreview") + (fileImage == "textImage" ? "R1" : "");
        $("." + previewID).attr('src', '#');
        $("." + previewID).removeClass("disabled");

        $.ajax({
            type: "POST",
            url: "/Process/RemoveStoreBase64Photo",
            data: { 'fileType': "fileTakePhoto" + imageNo },
            dataType: "json",
            success: function (data) {
                LockScreen(false);
            }
        });
    }

    $('#file').bind('change', function () {
        handleImage(this);

        $("#hdtextImagename").val($("#textImage").val());
    });

    $('#fileR2').bind('change', function () {
        handleImage(this);
    });

    $('#fileR3').bind('change', function () {
        handleImage(this);
    });

    $('#fileR4').bind('change', function () {
        handleImage(this);
    });

    $('#fileBill').bind('change', function () {
        handleImage(this);
    });

    $('#fileG1').bind('change', function () {
        handleImage(this);
    });

    $('#fileG2').bind('change', function () {
        handleImage(this);
    });

    $('#fileG3').bind('change', function () {
        handleImage(this);
    });

    $('#fileG4').bind('change', function () {
        handleImage(this);
    });

    $('#fileG5').bind('change', function () {
        handleImage(this);
    });

    $('#fileG6').bind('change', function () {
        handleImage(this);
    });

    $('#fileB1').bind('change', function () {
        handleImage(this);
    });

    $('#fileB2').bind('change', function () {
        handleImage(this);
    });

    $('#fileB3').bind('change', function () {
        handleImage(this);
    });

    $('#fileB4').bind('change', function () {
        handleImage(this);
    });

    $('#fileB5').bind('change', function () {
        handleImage(this);
    });

    $('#fileB6').bind('change', function () {
        handleImage(this);
    });

    $('#fileB7').bind('change', function () {
        handleImage(this);
    });

    var lastValueLOC = "";
    var lastValueLOC_FaceReg = "";

    var lastValueASC = "";
    var lastValueASC_FaceReg = "";

    var lastValueStaffID = "";
    var lastValueStaffID_FaceReg = "";

    var canEdit = false;

    $("#L_LOC_CODE").on('change keyup paste mouseup', function () {
        if ($(this).val() != lastValueLOC) {
            lastValueLOC = $(this).val();
            $("#L_LOC_CODE_FaceRecog").val(lastValueLOC);
            $("#CustomerRegisterPanelModel_L_LOC_CODE").val(lastValueLOC);
        }
    });
    $("#L_LOC_CODE_FaceRecog").on('change keyup paste mouseup', function () {
        if ($(this).val() != lastValueLOC_FaceReg) {
            lastValueLOC_FaceReg = $(this).val();
            $("#L_LOC_CODE").val(lastValueLOC_FaceReg);
            $("#CustomerRegisterPanelModel_L_LOC_CODE").val(lastValueLOC_FaceReg);
        }
    });

    $("#L_ASC_CODE").on('change keyup paste mouseup', function () {
        if (!$(this).is('[readonly]')) {
            if ($(this).val() != lastValueASC) {
                lastValueASC = $(this).val();
                $("#L_ASC_CODE_FaceRecog").val(lastValueASC);
                $("#CustomerRegisterPanelModel_L_ASC_CODE").val(lastValueASC);
            }
            if ($('#L_STAFF_ID').val() == "") {
                if ($(this).val() == "") {
                    $('#L_STAFF_ID').attr('readonly', false).css("background-color", "#FFF");
                }
                else {
                    $('#L_STAFF_ID').attr('readonly', true).css("background-color", "#F0F0F0");
                    canEdit = true;
                }
            }
        }
    });
    $("#L_ASC_CODE_FaceRecog").on('change keyup paste mouseup', function () {
        if ($(this).val() != lastValueASC_FaceReg) {
            lastValueASC_FaceReg = $(this).val();
            $("#L_ASC_CODE").val(lastValueASC_FaceReg);
            $("#CustomerRegisterPanelModel_L_ASC_CODE").val(lastValueASC_FaceReg);
        }
    });

    $("#L_STAFF_ID").on('change keyup paste mouseup', function () {
        if (!$(this).is('[readonly]')) {
            if ($(this).val() != lastValueStaffID) {
                lastValueStaffID = $(this).val();
                $("#L_STAFF_ID_FaceRecog").val(lastValueStaffID);
                $("#CustomerRegisterPanelModel_L_STAFF_ID").val(lastValueStaffID);
            }
            if ($('#L_ASC_CODE').val() == "") {
                if ($(this).val() == "") {
                    $('#L_ASC_CODE').attr('readonly', false).css("background-color", "#FFF");
                }
                else {
                    $('#L_ASC_CODE').attr('readonly', true).css("background-color", "#F0F0F0");
                    canEdit = true;
                }
            }
        }
    });
    $("#L_STAFF_ID_FaceRecog").on('change keyup paste mouseup', function () {
        if ($(this).val() != lastValueStaffID_FaceReg) {
            lastValueStaffID_FaceReg = $(this).val();
            $("#L_STAFF_ID").val(lastValueStaffID_FaceReg);
            $("#CustomerRegisterPanelModel_L_STAFF_ID").val(lastValueStaffID_FaceReg);
        }
    });




    function get_browser_info() {
        var ua = navigator.userAgent, tem, M = ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || [];
        if (/trident/i.test(M[1])) {
            tem = /\brv[ :]+(\d+)/g.exec(ua) || [];
            return { name: 'IE', version: (tem[1] || '') };
        }
        if (M[1] === 'Chrome') {
            tem = ua.match(/\bOPR\/(\d+)/)
            if (tem != null) { return { name: 'Opera', version: tem[1] }; }
        }
        M = M[2] ? [M[1], M[2]] : [navigator.appName, navigator.appVersion, '-?'];
        if ((tem = ua.match(/version\/(\d+)/i)) != null) { M.splice(1, 1, tem[1]); }
        return {
            name: M[0],
            version: M[1]
        };
    }

    var OrderDupmodel = [];
    var OrderDupmodelDel = [];

    function getOrderlist() {
        var newOrderDupmodel = [];
        var checkcountorder = 0;
        var check_load_new = "";
        $("#chk_del_itself").val("");
        $("#chk_have_no").val("");

        $("#CustomerRegisterPanelModel_DeleteOrderNo").val("");
        if ($("#chk_old_id_card").val() != $("#L_CARD_NO").val()) {
            OrderDupmodel = [];
            OrderDupmodelDel = [];
        }
        if ((OrderDupmodel.length == 0)) {
            $("#chk_old_id_card").val($("#L_CARD_NO").val());

            $("#OrderDupSerializer").val("");
            $.ajax({
                type: "POST",
                url: "/CustomerRegister/GetOrderDup",
                data: {
                    "p_id_card": codefbb.fbbMessage($("#L_CARD_NO").val()),
                },
                dataType: "json",
                async: false,
                success: function (data) {
                    $.each(data, function (i, e) {
                        var tmpOrderDupModel = new OrderDupModeInfo();
                        tmpOrderDupModel.CAN_DELETE = e.CAN_DELETE;
                        tmpOrderDupModel.ID_CARD_NO = e.ID_CARD_NO;
                        tmpOrderDupModel.ORDER_CREATED_DTM = e.ORDER_CREATED_DTM;
                        tmpOrderDupModel.CUSTOMER_ADDRESS = e.CUSTOMER_ADDRESS;
                        tmpOrderDupModel.INSTALL_DATE = e.INSTALL_DATE;
                        tmpOrderDupModel.ORDER_STATUS = e.ORDER_STATUS;
                        tmpOrderDupModel.PACKAGE_NAME = e.PACKAGE_NAME;
                        tmpOrderDupModel.ORDER_NO = e.ORDER_NO;
                        newOrderDupmodel.push(tmpOrderDupModel);
                        checkcountorder += 1;
                        check_load_new = "new";
                    });

                    OrderDupmodel = newOrderDupmodel;
                    $("#chk_count_order").val(checkcountorder.toString());
                }
            });
        }


        /* Add new Order to list*/
        var addr = "";
        addr += $("#CoveragePanelModel_Address_L_HOME_NUMBER_1").val() + " ";

        if ($("#R_BUILD").is(":checked")) {
            if ($("#L_BUILD_NAME").val() == "0") {
                addr += selected_building_obj.building_name + " " +
                    $("#CoveragePanelModel_Address_L_BUILD_NO_Hied").val() + " " +
                    $("#CoveragePanelModel_Address_L_FLOOR").val();
            }
            else {
                addr += $('#L_BUILD_NAME :selected').text() + " " +
                    $("#L_BUILD_NO").val() + " " +
                    $("#CoveragePanelModel_Address_L_FLOOR").val();
            }
        }
        else if ($("#R_MOOBAN").is(":checked")) {

            //หมู่บ้าน
            if ($("#Mooban1").val() == "0")
                addr += selected_building_obj.building_name;
            else
                addr += $("#Mooban1 :selected").text();
        }

        if ($("#CoveragePanelModel_Address_L_MOO").val() != "") {
            addr += " @L_MOO " + $("#CoveragePanelModel_Address_L_MOO").val();
        }
        if ($("#CoveragePanelModel_Address_L_SOI").val() != "") {
            addr += " @L_SOI " + $("#CoveragePanelModel_Address_L_SOI").val();
        }
        if ($("#CoveragePanelModel_Address_L_ROAD").val() != "") {
            addr += " @L_ROAD " + $("#CoveragePanelModel_Address_L_ROAD").val();
        }

        addr += " " + $('#COVERAGE_L_TUMBOL :selected').text() + " " + $('#COVERAGE_L_AMPHUR :selected').text() + " " + $('#COVERAGE_L_PROVINCE :selected').text();
        addr += " " + $("#CoveragePanelModel_Address_L_ZIPCODE :selected").text();

        var insataldate = "";

        var value = $("#L_INSTALL_DATE").val();
        if ($("#LanguagePage").val() == 1) {
            if (value != "") {
                var temp = value.split("/");
                temp[2] = temp[2] * 1 + 543;
                value = temp[0] + "/" + temp[1] + "/" + temp[2];
            }
        }


        insataldate = value + "  " + $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlot').val();

        var toDayDate = new Date(parseInt(@DateTime.Now.Year), parseInt(@DateTime.Now.Month) - 1, parseInt(@DateTime.Now.Day), parseInt(@DateTime.Now.Hour), parseInt(@DateTime.Now.Minute), parseInt(@DateTime.Now.Second), parseInt(@DateTime.Now.Millisecond));
        var hh = toDayDate.getHours();
        var mn = toDayDate.getMinutes();
        var ss = toDayDate.getSeconds();
        var toDayMonth = ((toDayDate.getMonth() + 1) < 10) ? '0' + (toDayDate.getMonth() + 1) : (toDayDate.getMonth() + 1);
        var toDayDateString = toDayDate.getDate() + '/' + toDayMonth + '/' + toDayDate.getFullYear();
        var createdatetime = toDateStringByLanguage(toDayDateString) + " " + hh.toString() + ":" + mn.toString() + ":" + ss.toString();

        var i = $("input[name=SelectPackage]:checked").val();
        var packageNameDup = "";
        if ('@language' == '1') {
            packageNameDup = $("#PACKAGE_DISPLAY_THA" + i).val();
        }
        else {
            packageNameDup = $("#PACKAGE_DISPLAY_ENG" + i).val();
        }

        if (check_load_new == "new") {
            //Get current date time to ORDER_CREATED_DTM
            var tmpOrderDupModel = new OrderDupModeInfo();
            tmpOrderDupModel.CAN_DELETE = "N";
            tmpOrderDupModel.ID_CARD_NO = $("#L_CARD_NO").val();
            tmpOrderDupModel.ORDER_CREATED_DTM = createdatetime;
            tmpOrderDupModel.CUSTOMER_ADDRESS = addr;
            tmpOrderDupModel.INSTALL_DATE = insataldate;
            tmpOrderDupModel.ORDER_STATUS = "New Register";
            tmpOrderDupModel.PACKAGE_NAME = packageNameDup;
            tmpOrderDupModel.ORDER_NO = "New";
            OrderDupmodel.push(tmpOrderDupModel);
        } else {

            $.each(OrderDupmodel, function (j, e) {
                if (e.ORDER_NO == "New") {
                    OrderDupmodel.pop();
                }
            });

            var tmpOrderDupModel = new OrderDupModeInfo();
            tmpOrderDupModel.CAN_DELETE = "N";
            tmpOrderDupModel.ID_CARD_NO = $("#L_CARD_NO").val();
            tmpOrderDupModel.ORDER_CREATED_DTM = createdatetime;
            tmpOrderDupModel.CUSTOMER_ADDRESS = addr;
            tmpOrderDupModel.INSTALL_DATE = insataldate;
            tmpOrderDupModel.ORDER_STATUS = "New Register";
            tmpOrderDupModel.PACKAGE_NAME = packageNameDup;
            tmpOrderDupModel.ORDER_NO = "New";
            OrderDupmodel.push(tmpOrderDupModel);
        }
    }

    function toDateStringByLanguage(dateString) {
        var value = '';
        if ($("#LanguagePage").val() == 1) {
            if (dateString != "") {
                var temp = dateString.split("/");
                temp[2] = temp[2] * 1 + 543;
                value = temp[0] + "/" + temp[1] + "/" + temp[2];
            }
        } else {
            return dateString;
        }

        return value;
    }

    function BindGvOrder() {
        var have_no = "no";//no,ok
        var count_yes = 0;
        var strBuilder = "";
        var strDeleteonclick = "";
        $("#chk_count_yes").val("0");
        $.each(OrderDupmodel, function (i, e) {

            var bgColors = "bg002";
            var classNew = "";
            if (i % 2 == 0)
                bgColors = "bg001";

            if (e.ORDER_STATUS == "New Register") {
                strBuilder += "<TR class='bg-info'>";
            } else {
                strBuilder += "<TR>";
            }

            if (e.CAN_DELETE == "Y") {
                strBuilder += "<TH><button button type='button' ctype='deler_dup_order' class='btn btn-xs btn-danger' onclick=DeleteOrder_ShowModal('" + e.ORDER_NO + "');>&nbsp; @L_BUTTON_DUP &nbsp;</button></TH>";
                strDeleteonclick = e.ORDER_NO;
                count_yes += 1;
            } else {
                strBuilder += '<TD></TD>';
                have_no = "ok";
            }

            strBuilder += '<TD>' + privacyInfoCard(e.ID_CARD_NO) + '</TD>';
            strBuilder += '<TD>' + e.ORDER_CREATED_DTM + '</TD>';
            strBuilder += '<TD>' + e.CUSTOMER_ADDRESS + '</TD>';
            strBuilder += '<TD>' + e.INSTALL_DATE + '</TD>';
            strBuilder += '<TD>' + e.PACKAGE_NAME + '</TD>';
            strBuilder += '<TD>' + e.ORDER_STATUS + '</TD>';
            strBuilder += '</TR>'
        });

        $("#chk_count_yes").val(count_yes.toString());
        $("#chk_have_no").val(have_no);

        if (count_yes.toString() == "1" && $("#chk_have_no").val() == "no") {
            strBuilder = strBuilder.replace("deler_dup_order'", "deler_dup_order' disabled");
            strBuilder = strBuilder.replace("onclick=DeleteOrder_ShowModal('" + strDeleteonclick + "');", "");
        }
        if (strBuilder != "") {
            $("#temptt").empty();
            $("#temptt").append(strBuilder);
        }
    }

    function DeleteOrder_ShowModal(order_id) {
        $("#modal003_perorder").attr("data-order-id", order_id);
        $("#modal003_perorder").modal();
    }

    function DeleteOrder() {
        var order_id = $("#modal003_perorder").attr("data-order-id");
        if (order_id == "New") {
            $("#chk_del_itself").val("ok");
        }
        else {
            OrderDupmodelDel.push(order_id);
        }
        var chkdel = "N";
        if ($("#chk_have_no").val() == "ok") {
            chkdel = "Y"
        } else {
            if ($("#chk_count_yes").val() == "1") {

                alert('ไม่สามารถลบรายการได้');
                chkdel = "N";
            } else {
                chkdel = "Y";
            }
        }

        if (chkdel == "Y") {
            var newOrderDupmodel = [];
            $.each(OrderDupmodel, function (j, e) {
                if (e.ORDER_NO != order_id) {
                    newOrderDupmodel.push(OrderDupmodel[j]);
                }
            });
            OrderDupmodel = newOrderDupmodel;
        }
        BindGvOrder();
        $("#modal003_perorder").modal('hide');
    }

    function nextToBeforeAddressSetUp() {
        getOrderlist();
        if ($("#chk_count_order").val() != "0") {
            $("#divRegisterInfo").hide();
            $("#divOrderDup").show();
            BindGvOrder();
            //script Adobe Analytic
            var lang = $("#LanguagePage").val() == 1 ? "th" : "en";
            digitalData.page = {
                pageInfo: {
                    pageName: "newfibre:" + lang + ":orderDup",
                    site: "newfibre",
                    language: lang
                }
            }
            console.log("page load orderDup : ", lang);
            
        }
        else {
            $("#divRegisterInfo").hide();
            $("#divAddressSetUp").show();
            //script Adobe Analytic
            var lang = $("#LanguagePage").val() == 1 ? "th" : "en";
            digitalData.page = {
                pageInfo: {
                    pageName: "newfibre:" + lang + ":addressSetup",
                    site: "newfibre",
                    language: lang
                }
            }
            console.log("page load addressSetup : ", lang);
            
        }
    }

    function nextToSummaryPage() {
        if ($("#chk_del_itself").val() == "ok") {
            CancelDeleteOrderDup();
            redirectForCancel();
        } else {
            if (parseInt(OrderDupmodelDel.length) != 0) {
                $("#CustomerRegisterPanelModel_DeleteOrderNo").val(JSON.stringify(OrderDupmodelDel));
            }
            $("#divOrderDup").hide();
            $("#divAddressSetUp").show();
            //script Adobe Analytic
            var lang = $("#LanguagePage").val() == 1 ? "th" : "en";
            digitalData.page = {
                pageInfo: {
                    pageName: "newfibre:" + lang + ":addressSetup",
                    site: "newfibre",
                    language: lang
                }
            }
            console.log("page load addressSetup : ", lang);
            
        }


    }

    function showPopupCancelDup() {
        $("#modal003").modal();
        var div1 = $("#simplemodal-container");
        div1.css('width', '450px');
        div1.css('height', '185px');
    }

    function orderDupConfirm(c) {
        if (c == 1) {
            CancelDeleteOrderDup();
            $("#modal003").modal("hide")
            redirectForCancel();
        }
    }

    function CancelDeleteOrderDup() {
        if (parseInt(OrderDupmodelDel.length) != 0) {
            $("#CustomerRegisterPanelModel_DeleteOrderNo").val(JSON.stringify(OrderDupmodelDel));
            $.ajax({
                type: "GET",
                url: "/Process/CancelOrder",
                data: { "templist": $("#CustomerRegisterPanelModel_DeleteOrderNo").val(), "idcard": $("#L_CARD_NO").val() },
                dataType: "json",
                async: false,
                success: function (data) {
                    OrderDupmodelDel = [];
                    $("#chk_old_id_card").val("");
                    OrderDupmodel = [];
                }
            });

        } else {
            $("#CustomerRegisterPanelModel_DeleteOrderNo").val("");
        }
        OrderDupmodelDel = [];
        $("#chk_old_id_card").val("");
        OrderDupmodel = [];
    }

    var OrderDupModeInfo = function () {
        CAN_DELETE: "";
        ID_CARD_NO: "";
        ORDER_CREATED_DTM: null;
        CUSTOMER_ADDRESS: "";
        INSTALL_DATE: null;
        ORDER_STATUS: "";
        PACKAGE_NAME: "";
        ORDER_NO: "";
    }

    function Reload2() {
        if ($("[name*='SummaryPanelModel.VAS_FLAG']").val() == "0") {
            window.location.href = "/Process/Index";
        }
        else if ($("[name*='SummaryPanelModel.VAS_FLAG']").val() == "1") {
            window.location.href = "/Process/ProcessTempVas";
        }
    }

    function redirectForCancel() {
        if ("@Model.SummaryPanelModel.VAS_FLAG" == "") {
            window.location.href = '@Url.Action("Index", "Process")';
        }
        else {
            window.location.href = '@Url.Action("Index", "ProcessSelect")';
        }
    }

    function onAddUpload_Click(e, type) {
        if (type == 'R') {
            if ($('#divUploadpicR2').css('display') == 'none') {
                $('#hdndivUploadpicR2').val('');
                $('#divUploadpicR2').show();
            }
            else if ($('#divUploadpicR3').css('display') == 'none') {
                $('#hdndivUploadpicR3').val('');
                $('#divUploadpicR3').show();
            }
            else if ($('#divUploadpicR4').css('display') == 'none') {
                $('#hdndivUploadpicR4').val('');
                $('#divUploadpicR4').show();
            }

            if ($('div[id^=divUploadpicR]:visible').length == 4) {
                $('#hdnAddUploadR').val('Y');
                $('#btnAddUploadR').addClass('disabled');
            }
        }
        else if (type == 'G') {
            if ($('#divUploadpicG4').css('display') == 'none') {
                $('#hdndivUploadpicG4').val('');
                $('#divUploadpicG4').show();
            }
            else if ($('#divUploadpicG5').css('display') == 'none') {
                $('#hdndivUploadpicG5').val('');
                $('#divUploadpicG5').show();
            }
            else if ($('#divUploadpicG6').css('display') == 'none') {
                $('#hdndivUploadpicG6').val('');
                $('#divUploadpicG6').show();
            }

            if ($('div[id^=divUploadpicG]:visible').length == 6) {
                $('#hdnAddUploadG').val('Y');
                $('#btnAddUploadG').addClass('disabled');
            }
        }
        else if (type == 'B') {
            if ($('#divUploadpicB5').css('display') == 'none') {
                $('#hdndivUploadpicB5').val('');
                $('#divUploadpicB5').show();
            }
            else if ($('#divUploadpicB6').css('display') == 'none') {
                $('#hdndivUploadpicB6').val('');
                $('#divUploadpicB6').show();
            }
            else if ($('#divUploadpicB7').css('display') == 'none') {
                $('#hdndivUploadpicB7').val('');
                $('#divUploadpicB7').show();
            }

            if ($('div[id^=divUploadpicB]:visible').length == 7) {
                $('#hdnAddUploadB').val('Y');
                $('#btnAddUploadB').addClass('disabled');
            }
        }
    }

    function removeIsUpload(value) {
        for (var i = isUpload.length - 1; i >= 0; i--) {
            if (isUpload[i] === value) {
                isUpload.splice(i, 1);
            }
        }
    }

    function onRemoveUpload_Click(e, idTextImege, idFile, fileTakePhoto, imgPhoto) {

        var idfileSession = "";
        sessionStorage.setItem('Use_Data_Card_Tablet', "N");
        if (idFile == 'file') {
            idfileSession = "1";
            $("#btnPreviewR1").addClass("disabled");

            if (!!imgPreviewOrigin)
                imgPreviewOrigin.setAttribute('src', "");
            $("#imgPreviewOrigin").hide();
            canMake1 = false;
            fromTake1 = false;

            $("#btnValidateFaceDisabled").show();
            $("#btnValidateFace").hide();

            $("#showResultRecog").hide();
            $("#verifyIdentity").hide();
            $("#btnVerifyFace").hide();
            $("#faceRecogCheckedFlag").val("N");
            $('#CustomerRegisterPanelModel_FlagFaceRecognitionSubmit').val("N");

        }
        else if (idFile == 'fileR2') {
            idfileSession = "1_2";
            $("#btnPreviewR2").addClass("disabled");
            removeIsUpload('1_2');
            $("#atthF1_2").hide();

        }
        else if (idFile == 'fileR3') {
            idfileSession = "1_3";
            $("#btnPreviewR3").addClass("disabled");
            removeIsUpload('1_3');
            $("#atthF1_3").hide();
        }
        else if (idFile == 'fileR4') {
            idfileSession = "1_4";
            $("#btnPreviewR4").addClass("disabled");
            removeIsUpload('1_4');
            $("#atthF1_4").hide();
        }
        else if (idFile == 'fileBill') {
            idfileSession = "2";
            $("#btnPreviewBill").addClass("disabled");
        }
        else if (idFile == 'fileG1') {
            idfileSession = "3";
            $("#btnPreviewG1").addClass("disabled");
        }
        else if (idFile == 'fileG2') {
            idfileSession = "4";
            $("#btnPreviewG2").addClass("disabled");
        }
        else if (idFile == 'fileG3') {
            idfileSession = "5";
            $("#btnPreviewG3").addClass("disabled");
            removeIsUpload('5');
            $("#atthF5").hide();
        }
        else if (idFile == 'fileG4') {
            idfileSession = "5_2";
            $(".imgPreviewG4").addClass("disabled");
            removeIsUpload('5_2');
            $("#atthF5_2").hide();
        }
        else if (idFile == 'fileG5') {
            idfileSession = "5_3";
            $("#btnPreviewG5").addClass("disabled");
            removeIsUpload('5_3');
            $("#atthF5_3").hide();
        }
        else if (idFile == 'fileG6') {
            idfileSession = "5_4";
            $("#btnPreviewG6").addClass("disabled");
            removeIsUpload('5_4');
            $("#atthF5_4").hide();
        }
        else if (idFile == 'fileB1') {
            idfileSession = "6";
            $("#btnPreviewB1").addClass("disabled");
        }
        else if (idFile == 'fileB2') {
            idfileSession = "7";
            $("#btnPreviewB2").addClass("disabled");
        }
        else if (idFile == 'fileB3') {
            idfileSession = "8";
            $("#btnPreviewB3").addClass("disabled");
        }
        else if (idFile == 'fileB4') {
            idfileSession = "9"
            $("#btnPreviewB4").addClass("disabled");
            removeIsUpload('9');
            $("#atthF9").hide();
        }
        else if (idFile == 'fileB5') {
            idfileSession = "9_2"
            $("#btnPreviewB5").addClass("disabled");
            removeIsUpload('9_2');
            $("#atthF9_2").hide();
        }
        else if (idFile == 'fileB6') {
            idfileSession = "9_3"
            $("#btnPreviewB6").addClass("disabled");
            removeIsUpload('9_3');
            $("#atthF9_3").hide();
        }
        else if (idFile == 'fileB7') {
            idfileSession = "9_4"
            $("#btnPreviewB7").addClass("disabled");
            removeIsUpload('9_4');
            $("#atthF9_4").hide();
        }

        RemoveUpload(idTextImege, idFile, fileTakePhoto, imgPhoto, idfileSession);
    }

    function RemoveUpload(idTextImege, idFile, fileTakePhoto, imgPhoto, idfileSession) {
        $('#' + idTextImege).val("");

        var img = document.getElementById(imgPhoto);
        img.setAttribute("src", 'data:image/jpg;base64,""');

        var control = $('#' + idFile);
        control.replaceWith(control = control.clone(true));

        removeImageBase64("fileTakePhoto", idfileSession);

        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {

        }
        else {

            $.ajax({
                type: "POST",
                url: "/Process/RemovePhoto",
                data: { 'control_id': fileTakePhoto },
                dataType: "json",
                success: function (data) {

                }
            });

            clearSessionTakePhoto();

        }

        //reload after remove file
        var iframe = document.getElementById('iframeCard');
        iframe.src = iframe.src;


        //$.ajax({
        //    type: "GET",
        //    url: "/Process/deleteSignature_flag",
        //    dataType: "json",
        //    data:{'status':'Y'},
        //    success: function (data) {
        //    }
        //});
        $('#' + idFile).val("");
    }

    function clearSessionTakePhoto() {
        $.ajax({
            type: "POST",
            url: "/Process/signature_flag",
            data: { 'status': 'N' },
            dataType: "json",
            success: function (data) {

            }
        });
    }

    $('#divShowStaffSection').css("cursor", "pointer");

    $('#divShowStaffSection').click(function () {
        $("#divStaffSection").slideToggle("fast");
        $('i.fa.fa-plus').toggleClass('fa-minus');
    });

    //R19.1
    $('#divShowSpecialAccount').css("cursor", "pointer");
    $('#divShowSpecialAccount').click(function () {
        $("#divSpecialAccount").slideToggle("fast");
        $('i.fa.fa-plus').toggleClass('fa-minus');
    });

    $("#swipe").click(function () { $("#swipe > img").hide(); });


    function set_idcardno_validation() {
        var cus_reg_idcardno_regex = "";

        if ($('#ID_CARD_NAME :selected').val() == "TAX_ID") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_Length_ID_Card_Number_TAX_ID");
            cus_reg_idcardno_regex = "@FBB_Con_Input_TAX_ID";
        }
        else if ($('#ID_CARD_NAME :selected').val() == "MONK_CERT") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_LengthIDCardNumberMONK_CERT");
            cus_reg_idcardno_regex = "@FBB_Con_Input_MONK_CERT";
        }
        else if ($('#ID_CARD_NAME :selected').val() == "GOV_LET") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_Length_ID_Card_Number_GOV_LET");
            cus_reg_idcardno_regex = "@FBB_Con_Input_GOV_LET";
        }
        else if ($('#ID_CARD_NAME :selected').val() == "PASSPORT") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_Length_ID_Card_Number_PASSPORT");
            cus_reg_idcardno_regex = "@FBB_Con_Input_PASSPORT";
        }
        else if ($('#ID_CARD_NAME :selected').val() == "EMB_LET") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_Length_ID_Card_Number_EMB_LET");
            cus_reg_idcardno_regex = "@FBB_Con_Input_EMB_LET";
        }
        else if ($('#ID_CARD_NAME :selected').val() == "IMM_CARD") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_LengthIDCardNumberIMM_CARD");
            cus_reg_idcardno_regex = "@FBB_Con_Input_IMM_CARD";
        }
        else if ($('#ID_CARD_NAME :selected').val() == "STA_LET") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_Length_ID_Card_Number_STA_LET");
            cus_reg_idcardno_regex = "@FBB_Con_Input_STA_LET";
        }
        else if ($('#ID_CARD_NAME :selected').val() == "HILL_CARD") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_LengthIDCardNumberHILL_CARD");
            cus_reg_idcardno_regex = "@FBB_Con_Input_HILL_CARD";
        }
        else if ($('#ID_CARD_NAME :selected').val() == "CERT_FOUND") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_Length_ID_Card_Number_CERT_FOUND");
            cus_reg_idcardno_regex = "@FBB_Con_Input_CERT_FOUND";
        }
        else if ($('#ID_CARD_NAME :selected').val() == "ID_CARD") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_LengthIDCardNumberID_CARD");
            cus_reg_idcardno_regex = "@FBB_Con_Input_ID_CARD";
        }
        else if ($('#ID_CARD_NAME :selected').val() == "ROY_LET") {
            $('#L_CARD_NO').attr("maxlength", "@FBB_Con_Length_ID_Card_Number_ROY_LET");
            cus_reg_idcardno_regex = "@FBB_Con_Input_ROY_LET";
        }

        $('#L_CARD_NO').inputmask('Regex', {
            regex: cus_reg_idcardno_regex,
        });
    }

    function ChkImagefile() {
        // use image from card
        if (sessionStorage.getItem('Use_Data_Card') == "Y") {
            if (!!sessionStorage.getItem('Card_id_card_PICTURE_Pc')) {
                $('#textImage').val($('#hdtextImagename').val());
            }
        }
    }

    $(function () {


        $('#L_MOBILE').inputmask('Regex', {
            regex: "[0-9]+",
        });
        $('#L_OR').inputmask('Regex', {
            regex: "[0-9]+",
        });
        $('#txtHomePhone').inputmask('Regex', {
            regex: "[0-9]+",
        });

        if ('@Model.SummaryPanelModel.VAS_FLAG' == "6") {
            $('#L_FIRST_NAME').attr('readonly', true).css("background-color", "Gainsboro");
            $('#L_LAST_NAME').attr('readonly', true).css("background-color", "Gainsboro");
            $('#L_LOC_CODE').attr('readonly', true).css("background-color", "Gainsboro");
            $('#L_STAFF_ID').attr('readonly', true).css("background-color", "Gainsboro");
            $('#TITLE_CODE').attr('disabled', true);
        }

        //var d = new Date(new Date().getTime() + 24 * 60 * 60 * 1000);
        var d = new Date(parseInt(@DateTime.Now.Year), parseInt(@DateTime.Now.Month) - 1, parseInt(@DateTime.Now.Day) + 1);

        var month = d.getMonth() + 1;
        var day = d.getDate();

        var tomorrowDateTH = (day < 10 ? '0' : '') + day + '/' +
            (month < 10 ? '0' : '') + month + '/' +
            (d.getFullYear() + 543);

        var tomorrowDateEN = (day < 10 ? '0' : '') + day + '/' +
            (month < 10 ? '0' : '') + month + '/' +
            d.getFullYear();

        $('#dtpInstallDateTH').datetimepicker({
            format: 'd/m/Y',
            lang: "th",
            timepicker: false,
            closeOnDateSelect: true,
        });

        $('#dtpInstallDateEN').datetimepicker({
            format: 'd/m/Y',
            lang: 'en',
            timepicker: false,
            closeOnDateSelect: true,
        });

        $('#dtpSpecialExpireDateTH').datetimepicker({
            format: 'd/m/Y',
            lang: "th",
            timepicker: false,
            closeOnDateSelect: true,
        });

        $('#dtpSpecialExpireDateEN').datetimepicker({
            format: 'd/m/Y',
            lang: 'en',
            timepicker: false,
            closeOnDateSelect: true,
        });

        $('#dtpPreSurveyDateTH').datetimepicker({
            format: 'd/m/Y',
            lang: "th",
            timepicker: false,
            closeOnDateSelect: true,
        });

        $('#dtpPreSurveyDateEN').datetimepicker({
            format: 'd/m/Y',
            lang: 'en',
            timepicker: false,
            closeOnDateSelect: true,
        });

        $('#divPeriodDate').hide();

        $('#L_EVENT_CODE').keyup(function () {

            this.value = this.value.toUpperCase();
        })

        $("#L_MOBILE").keyup(function () {
            CheckKeyUps("L_MOBILE", '@FBB_Input_MobileNo', 'M');
        });

        $("#L_OR").keyup(function () {
            CheckKeyUps("L_OR", '@FBB_Input_MobileNo', 'M');
        });

        setCustomerRegisterWaterMark();

        function CheckKeyUp(id, RexStr) {
            var strKey = $("#" + id).val();
            var strBuilder = "";
            var filter = new RegExp(RexStr);
            for (var i = 0; i < strKey.length; i++) {
                if (filter.test(strKey.substr(i, 1))) {
                    strBuilder += strKey.substr(i, 1);
                }
            }
            $("#" + id).val(strBuilder);
        }

        $('#L_FIRST_NAME').keyup(function () {
            CheckKeyUp("L_FIRST_NAME", "@FBB_Con_CharNotonName");
        });

        $('#L_LAST_NAME').keyup(function () {
            CheckKeyUp("L_LAST_NAME", "@FBB_Con_CharNotOnNameLastName");
        });

        $('#L_GOVERNMENT_NAME').keyup(function () {
            CheckKeyUp("L_GOVERNMENT_NAME", "@FBB_InputCompanyName");
        });

        $('#L_CONTACT_PERSON').keyup(function () {
            CheckKeyUp("L_CONTACT_PERSON", "@FBB_Con_CharNotOnNameLastName");
        });

        $('#txtHomePhone').keyup(function () {
            validateHomePhone = false;
            unvalidateHomePhone = false;
            CheckKeyUps("txtHomePhone", "@FBB_Con_Input_HomePhone", 'M');
            if ($('#txtHomePhone').val().length > 0) {
                if ($('input[name=L_HAVE_FIXED_LINE]:checked').val() != "Y")
                    validateHomePhone = true;
            }
            else {
                if ($('input[name=L_HAVE_FIXED_LINE]:checked').val() != "Y") {
                    unvalidateHomePhone = true;
                }
            }

        });

        $('#txtHomePhoneTo').keyup(function () {
            CheckKeyUp("txtHomePhoneTo", "@FBB_Con_Input_ExtNumber");
        });

        $('#AddressPanelModelSetup_L_MOO').keyup(function () {
            CheckKeyUp("AddressPanelModelSetup_L_MOO", "@FBB_Con_Input_Moo");
        });

        $('#AddressPanelModelSetup_L_FLOOR').keyup(function () {
            CheckKeyUp("AddressPanelModelSetup_L_FLOOR", "@FBB_Con_Input_Floor");
        });

        $('#AddressPanelModelSetup_L_ROOM').keyup(function () {
            CheckKeyUp("AddressPanelModelSetup_L_ROOM", "@FBB_Con_Input_Room");
        });

        $('#AddressPanelModelSetup_L_SOI').keyup(function () {
            CheckKeyUp("AddressPanelModelSetup_L_SOI", "@FBB_Con_Input_Soi");
        });

        $('#AddressPanelModelSetup_L_ROAD').keyup(function () {
            CheckKeyUp("AddressPanelModelSetup_L_ROAD", "@FBB_Con_Input_Road");
        });

        $('#AddressPanelModelSendDoc_L_HOME_NUMBER_2').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDoc_L_HOME_NUMBER_2", "@FBB_Con_Input_Home_Number");
        });

        $('#AddressPanelModelSendDoc_L_MOO').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDoc_L_MOO", "@FBB_Con_Input_Moo");
        });

        $('#AddressPanelModelSendDoc_L_MOOBAN').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDoc_L_MOOBAN", "@FBB_Con_Input_Mooban");
        });

        $('#AddressPanelModelSendDoc_L_BUILD_NAME').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDoc_L_BUILD_NAME", "@FBB_Con_Input_Building");
        });

        $('#AddressPanelModelSendDoc_L_FLOOR').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDoc_L_FLOOR", "@FBB_Con_Input_Floor");
        });

        $('#AddressPanelModelSendDoc_L_ROOM').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDoc_L_ROOM", "@FBB_Con_Input_Room");
        });

        $('#AddressPanelModelSendDoc_L_SOI').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDoc_L_SOI", "@FBB_Con_Input_Soi");
        });

        $('#AddressPanelModelSendDoc_L_ROAD').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDoc_L_ROAD", "@FBB_Con_Input_Road");
        });

        $('#AddressPanelModelVat_L_HOME_NUMBER_2').keyup(function () {
            CheckKeyUp("AddressPanelModelVat_L_HOME_NUMBER_2", "@FBB_Con_Input_Home_Number");
        });

        $('#AddressPanelModelVat_L_MOO').keyup(function () {
            CheckKeyUp("AddressPanelModelVat_L_MOO", "@FBB_Con_Input_Moo");
        });

        $('#AddressPanelModelVat_L_MOOBAN').keyup(function () {
            CheckKeyUp("AddressPanelModelVat_L_MOOBAN", "@FBB_Con_Input_Mooban");
        });

        $('#AddressPanelModelVat_L_BUILD_NAME').keyup(function () {
            CheckKeyUp("AddressPanelModelVat_L_BUILD_NAME", "@FBB_Con_Input_Building");
        });

        $('#AddressPanelModelVat_L_FLOOR').keyup(function () {
            CheckKeyUp("AddressPanelModelVat_L_FLOOR", "@FBB_Con_Input_Floor");
        });

        $('#AddressPanelModelVat_L_ROOM').keyup(function () {
            CheckKeyUp("AddressPanelModelVat_L_ROOM", "@FBB_Con_Input_Room");
        });

        $('#AddressPanelModelVat_L_SOI').keyup(function () {
            CheckKeyUp("AddressPanelModelVat_L_SOI", "@FBB_Con_Input_Soi");
        });

        $('#AddressPanelModelVat_L_ROAD').keyup(function () {
            CheckKeyUp("AddressPanelModelVat_L_ROAD", "@FBB_Con_Input_Road");
        });
        //17.09
        $('#AddressPanelModelSendDocIDCard_L_HOME_NUMBER_2').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDocIDCard_L_HOME_NUMBER_2", "@FBB_Con_Input_Home_Number");
        });

        $('#AddressPanelModelSendDocIDCard_L_MOO').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDocIDCard_L_MOO", "@FBB_Con_Input_Moo");
        });

        $('#AddressPanelModelSendDocIDCard_L_MOOBAN').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDocIDCard_L_MOOBAN", "@FBB_Con_Input_Mooban");
        });

        $('#AddressPanelModelSendDocIDCard_L_BUILD_NAME').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDocIDCard_L_BUILD_NAME", "@FBB_Con_Input_Building");
        });

        $('#AddressPanelModelSendDocIDCard_L_FLOOR').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDocIDCard_L_FLOOR", "@FBB_Con_Input_Floor");
        });

        $('#AddressPanelModelSendDocIDCard_L_ROOM').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDocIDCard_L_ROOM", "@FBB_Con_Input_Room");
        });

        $('#AddressPanelModelSendDocIDCard_L_SOI').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDocIDCard_L_SOI", "@FBB_Con_Input_Soi");
        });

        $('#AddressPanelModelSendDocIDCard_L_ROAD').keyup(function () {
            CheckKeyUp("AddressPanelModelSendDocIDCard_L_ROAD", "@FBB_Con_Input_Road");
        });
        set_idcardno_validation();
        //getdeverloper
        $.ajax({
            type: "GET",
            url: "/process/Getdropdowndeveloper",
            dataType: "json",
            success: function (data) {
                //console.log(data);
                var strBuilder = "<option value='' disabled selected >" + "@L_DEVERLOPER" + "</option>";
                $.each(data, function (i, e) {
                    strBuilder += '<option value="' + e.Value + '">' + e.Text + '</option>';
                });
                //console.log(strBuilder);
                $('#ddlDeverloper').append(strBuilder);
                $('#ddlDeverloper').select2();
            },
        });
        //GetCustomerGender
        $.ajax({
            type: "GET",
            url: "/MasterData/GetCustomerGender",
            dataType: "json",
            success: function (data) {
                var strBuilder = "<option value='' selected >" + "@lGENDER" + "</option>";
                $.each(data, function (i, e) {
                    var str = "";
                    if (i == 1)
                        str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                    else
                        str = '<option value="' + e.Value + '">' + e.Text + '</option>';

                    strBuilder += str;
                });
                $('#ddlGender').append(strBuilder);
                $('#ddlGender').select2();
            }
        });

        //GetContactTime
        $.ajax({
            type: "GET",
            url: "/MasterData/GetContactTime",
            dataType: "json",
            success: function (data) {
                var strBuilder = "<option value='' disabled selected >" + "@lSPECIFIC_TIME" + "</option>";
                $.each(data, function (i, e) {
                    var str = "";

                    if (e.DefaultValue != undefined) {
                        if (e.DefaultValue.toString().toUpperCase() == "Y")
                            str = '<option value="' + e.Value + '" selected>' + e.Text + '</option>';
                        else
                            str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                    }
                    else
                        str = '<option value="' + e.Value + '">' + e.Text + '</option>';

                    strBuilder += str;
                });
                $('#ContactTime').append(strBuilder);
                $('#ContactTime').select2();
            }
        });

        $.ajax({
            type: "GET",
            url: "/MasterData/GetListISP",
            dataType: "json",
            success: function (data) {
                var strBuilder = "<option value='' disabled selected >" + "@lBILL_BRAND" + "</option>";
                $.each(data, function (i, e) {
                    var str = "";
                    if (i == 1)
                        str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                    else
                        str = '<option value="' + e.Value + '">' + e.Text + '</option>';

                    strBuilder += str;
                });
                $('#ddlBillBrand').append(strBuilder);
                $('#ddlBillBrand').select2();
            }
        });
    });

    function checkIdCard(idcard) {
        var num = strSplit(idcard); // function เพิ่มเติม
        var sum = 0;
        var total = 0;
        var digi = 13;

        for (i = 0; i < 12; i++) {
            sum = sum + (num[i] * digi);
            digi--;
        }
        total = ((11 - (sum % 11)) % 10);

        if (total != num[12]) {
            return false;
        }
        else {
            return true;
        }
    }

    function strSplit(f_string, f_split_length) {

        f_string += '';
        if (f_split_length == undefined) {
            f_split_length = 1;
        }
        if (f_split_length > 0) {
            var result = [];
            while (f_string.length > f_split_length) {
                result[result.length] = f_string.substring(0, f_split_length);
                f_string = f_string.substring(f_split_length);
            }
            result[result.length] = f_string;
            return result;
        }
        return false;
    }

    var isp = "";
    function onChangeddlBillBrand() {
        $('#CustomerRegisterPanelModel_L_OLD_ISP').val($('#ddlBillBrand :selected').text());
        isp = $('#ddlBillBrand :selected').text();

    }
    var chk = true;
    function displayCPEPlayBox() {
        $('#CPE_Serial').val("");
        $('#PlayBox_Serial').val("");
        $("#CPE_Serial").removeClass("form-control errorinput ").addClass("form-control");
        $("#PlayBox_Serial").removeClass("form-control errorinput ").addClass("form-control");
        var isPlaybox = $('#hdGetPlayBox').val();
        if (chk) {
            $('#CPE_Serial').prop('disabled', false);
            $('#PlayBox_Serial').prop('disabled', false);
            if (isPlaybox == "1") {
                $('#PlayBox_Serial').show();

            } if (isPlaybox == "0") {
                $('#PlayBox_Serial').hide();
            }
            chk = false;
        }
        $('#chkEventCode').click(function () {
            if ($(this).prop('checked')) {
                if (isPlaybox == "1") {
                    $('#PlayBox_Serial').show();
                } if (isPlaybox == "0") {
                    $('#PlayBox_Serial').hide();
                }
                $('#CPE_Serial').prop('disabled', false);
                $('#PlayBox_Serial').prop('disabled', false);

            } else {
                $('#CPE_Serial').prop('disabled', true);
                $('#PlayBox_Serial').prop('disabled', true);

            }
        });
        isPlaybox = "";
    }

    function chkOnlineChange() {
        if ($('#chkOnline').is(":checked")) {
            $("#Online_Flag").val("Y");
        }
        else {
            $("#Online_Flag").val("");
        }
    }

    function onBarcodeCallback(result) {
        try {
            $("#cpe_serial_barcode_hdn").html(result);

            if (isCPE == true) {
                $("#CPE_Serial").val($("#cpe_serial_barcode_hdn").find("barcode").html());
            }
            else if (isPB == true) {
                $("#PlayBox_Serial").val($("#cpe_serial_barcode_hdn").find("barcode").html());
            }

        } catch (e) {
            $("#CPE_Serial").val(e.message);
            $("#PlayBox_Serial").val(e.message);
        }
    }

    function isAisNative() {
        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
            return false;

        } else {
            return true;
        }

        return false;
    }

    function isOnMobileDevice() {
        if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
            return true;
        } else {
            return false;
        }
    }

    function isElementReadOnly(element) {
        return $(element).is(':disabled');
    }

    //R18.9 eBill: TODO: Update
    $("#chkReceiptEbill").prop("checked", false);
    $("#R_SMS_AND_MYAIS").prop("checked", false);
    $("#L_EMAIL_EBILL").prop('disabled', true);
    $("#R_SMS_AND_MYAIS,#R_SMS_AND_EMAIL").prop('disabled', true);
    $("#chkEbillType").attr('style', 'color: #ccc;');
    $("#divBillMsg").show();

    var emailValue = "";

    if ($('#CoverageMemberGetMember_CustomerEmail').val() != "") {
        emailValue = $('#CoverageMemberGetMember_CustomerEmail').val();
        $('#L_EMAIL_EBILL').val('');
    }

    function onChkCardType() {
        if ($('#CustomerRegisterPanelModel_CateType').val() != 'R') {
            $('#L_EMAIL_EBILL').val("");
            $("#chkReceiptEbill").prop('disabled', true);
            $("#chkReceiptEbill").prop("checked", false);
            $("#R_SMS_AND_MYAIS").prop("checked", false);
            $("#R_SMS_AND_EMAIL").prop("checked", false);
            $("#R_SMS_AND_MYAIS,#R_SMS_AND_EMAIL").prop('disabled', true);
            $('#L_EMAIL_EBILL').prop('disabled', true);
            $("#chkEbillType").attr('style', 'color: #ccc;');
            $("#divBillMsg").show();
        }
        else {
            $("#chkReceiptEbill").prop('disabled', false);
            $("#chkReceiptEbill").prop("checked", true);
            $("#R_SMS_AND_MYAIS").prop("checked", true);
            $("#R_SMS_AND_EMAIL").prop("checked", false);
            $("#R_SMS_AND_MYAIS,#R_SMS_AND_EMAIL").prop('disabled', false);
            $("#L_EMAIL_EBILL").prop('disabled', true);
            $("#chkEbillType").attr('style', 'color: #666;');
            $("#divBillMsg").hide();
            $('#L_EMAIL_EBILL').val("");
        }

    }

    function onCkEbillChange() {
        $("#L_EMAIL_EBILL").removeClass("textFieldFalse").removeClass("form-control errorinput ").addClass("form-control");
        // Check out  All
        if ($("#chkReceiptEbill").is(":checked")) {
            $("#R_SMS_AND_MYAIS").prop("checked", true);
            $("#R_SMS_AND_EMAIL").prop("checked", false);
            $("#R_SMS_AND_MYAIS,#R_SMS_AND_EMAIL").prop('disabled', false);
            $("#L_EMAIL_EBILL").prop('disabled', true);
            $("#chkEbillType").attr('style', 'color: #666;');
            $("#divBillMsg").hide();
        }
        else {
            $("#R_SMS_AND_MYAIS").prop("checked", false);
            $("#R_SMS_AND_EMAIL").prop("checked", false);
            $("#R_SMS_AND_MYAIS,#R_SMS_AND_EMAIL").prop('disabled', true);
            $('#L_EMAIL_EBILL').prop('disabled', true);
            $("#chkEbillType").attr('style', 'color: #ccc;');
            $("#divBillMsg").show();
        }
        $('#L_EMAIL_EBILL').val("");
    }

    function onEbillChange() {
        $("#L_EMAIL_EBILL").removeClass("textFieldFalse").removeClass("form-control errorinput ").addClass("form-control");
        // Check out  All
        if ($('#R_SMS_AND_MYAIS').is(':checked')) {
            $('#R_SMS_AND_EMAIL').prop("checked", false);
            $('#L_EMAIL_EBILL').prop('disabled', true);
            $('#L_EMAIL_EBILL').val("");
            $('#hdBillingMediaEmail').val(emailValue);
        }
        else {
            $('#R_SMS_AND_MYAIS').prop("checked", false);
            $('#L_EMAIL_EBILL').prop('disabled', false);
            $('#L_EMAIL_EBILL').val(emailValue);
        }
    }

    //R18.11 IdCard Reader on PC
    function showLoadIdCardReaderPC() {
        $('#TITLE_CODE').prop('disabled', false);
        $('#L_FIRST_NAME').prop('readonly', false);
        $('#L_LAST_NAME').prop('readonly', false);
        $('#ID_CARD_NAME').prop('disabled', false);
        $('#L_CARD_NO').prop('readonly', false);
        $('#ddlGender').prop('disabled', false);
        $('#ddlDay').prop('disabled', false);
        $('#ddlMonth').prop('disabled', false);
        $('#ddlYear').prop('disabled', false);
        $('#L_ID_CARD_LASER').prop('readonly', false);
        if ($('#ID_CARD_NAME :selected').val() == "ID_CARD") {
            if ($('#CustomerRegisterPanelModel_FlagDopa').val() == "Y") {
                $("#divIdCardVerify").show();
                $('#idCardVerify').show();
                $('#idCardVerifyDisable').hide();
            }
            if ($("#CustomerRegisterPanelModel_FlagFaceRecognition").val() == "Y") {
                $("#faceRecog").show();
            }
        }
        else {
            $("#divIdCardVerify").hide();
            $('#idCardVerify').hide();
            $('#idCardVerifyDisable').hide();
            $("#faceRecog").hide();
        }

        // check pc/mobile
        if (typeof aisNative == "undefined" || typeof aisNative == "" || typeof aisNative == null) {
            $('#btnbrowse').show();
            $('#btnbrowseDisabled').hide();
        }
        else {
            if (signatureShowFlag) {
                $("#filesignature").show();
                $("#filesignatureDisabled").hide();
            }
        }

        if ($("#CustomerRegisterPanelModel_FlagTakePhoto").val() == "Y" && navigator.userAgent.indexOf("SamsungBrowser") == -1 && !iOSSafari && !iOS && !signatureShowFlag) {

            $("#fileTakePhoto").show();
            $("#fileTakePhotoDisabled").hide();
        }

        $('#btnRemove').show();
        $('#btnRemoveDisabled').hide();
        $('#btnPreviewR1').addClass('disabled');

        $('#hdnCard_province').val("");
        $('#hdnCard_district').val("");
        $('#hdnCard_subDistrict').val("");
        $('#hdnCard_moo').val("");
        $('#hdnCard_soi').val("");
        $('#hdnCard_road').val("");
        $('#hdnCard_houseNo').val("");

        $("#L_FIRST_NAME").val("");
        $("#L_LAST_NAME").val("");
        $("#L_CARD_NO").val("");
        $("#L_ID_CARD_LASER").val("");
        $("#textImage").val("");
        $('#message').html("");

        if ($("#hdIdCardNoUserAis").val() != "" && $("#hdIdCardNoUserAis").val() != "undefined") {
            $("#L_CARD_NO").val($("#hdIdCardNoUserAis").val());
        }

        //GetCustomerGender
        $('#ddlGender').empty();
        $.ajax({
            type: "GET",
            url: "/MasterData/GetCustomerGender",
            dataType: "json",
            success: function (data) {
                var strBuilder = "<option value='' selected >" + "@lGENDER" + "</option>";

                $.each(data, function (i, e) {
                    var str = '<option value="' + e.Value + '">' + e.Text + '</option>';
                    strBuilder += str;
                });
                $('#ddlGender').append(strBuilder);
                $('#ddlGender').select2();
                $('#CustomerRegisterPanelModel_L_GENDER').val($('#ddlGender :selected').text());
            }
        });

        $('#dayBirthdate').val("");
        $('#dayBirthMonth').val("");
        $('#dayBirthdyear').val("");
        $('#ddlDay :selected').val("");
        $('#ddlMonth :selected').val("");
        $('#ddlYear :selected').val("");
        setBirthDate();
        sessionStorage.setItem('Use_Data_Card', null);

        $('#Modal-used-idcard-Pc').modal('show');
    }

    $('#idCardVerify').click(function () {
        var chkRequireField = true;

        if ($('input[name="typeselect"]:checked').val() == 'R') {
            popRequireFieldR();
            pushRequireFieldVerify();

            chkRequireField = ValidationProcessing(validateModel003R, "err003");
        }

        if (!chkRequireField) {
            return false;
        }
        LockScreen(true);

        $.ajax({
            type: "POST",
            url: '@Url.Action("CheckCardByLaser", "CustomerRegister")',
            async: false,
            data: {
                "firstname": $('#L_FIRST_NAME').val(),
                "lastname": $('#L_LAST_NAME').val(),
                "birthday": $('#ddlDay :selected').val(),
                "birthmonth": $('#ddlMonth :selected').val(),
                "birthyear": $('#ddlYear :selected').val(),
                "idcardno": $('#L_CARD_NO').val(),
                "idcardlaser": $('#L_ID_CARD_LASER').val()
            },
            datatype: "json",
            success: function (data) {
                //console.log("data : ", data);
                LockScreen(false);

                if (data != null) {

                    $('#showMessageVerify').show();
                    $('#message').empty();

                    if (data.resultCode == "20000") {

                        $('#CustomerRegisterPanelModel_FlagDopaSubmit').val("Y");

                        $('#message').append(data.messageMapping);
                        $('#message').css({ "color": "green", "text-align": "center" });
                        $('#FLAG_CHECK_VERIFY').val("Y");
                        $('#TITLE_CODE').prop('disabled', true);
                        $('#L_FIRST_NAME').prop('readonly', true);
                        $('#L_LAST_NAME').prop('readonly', true);
                        $('#ID_CARD_NAME').prop('disabled', true);
                        $('#L_CARD_NO').prop('readonly', true);
                        $('#L_ID_CARD_LASER').prop('readonly', true);
                        $('#ddlGender').prop('disabled', true);
                        $('#ddlDay').prop('disabled', true);
                        $('#ddlMonth').prop('disabled', true);
                        $('#ddlYear').prop('disabled', true);
                        $('#idCardVerify').hide();
                        $('#idCardVerifyDisable').show();
                    }
                    else {
                        $('#CustomerRegisterPanelModel_FlagDopaSubmit').val("N");

                        $('#message').append(data.messageMapping);
                        $('#message').css({ "color": "red", "text-align": "center" });
                        $('#FLAG_CHECK_VERIFY').val("N");
                    }
                }
            }
        });
    });

    // R19.4 Redcap => Line Officer
    function displayRedcap()
    {
        var i = $("input[name=SelectPackage]:checked").val();
        var tmp_technology = $("#ACCESS_MODE" + i).val();
        var tmp_loc_code = $("#CustomerRegisterPanelModel_L_LOC_CODE").val();
        var tmp_recurring_charge = $("#PRICE_CHARGE" + i).val();
        var tmp_province = $('#COVERAGE_L_PROVINCE').val();
        var download_speed = $('#CustomerRegisterPanelModel_DownloadSpeed').val();
        if($('#TopUp').val() == "5" && "FTTH" == tmp_technology
            && listPreSurveyLocation.indexOf(tmp_loc_code) > -1
            && parseFloat(tmp_recurring_charge) >= parseFloat(("@PRE_SURVEY_RECURRING_CHARGE_START"))
            && parseFloat(tmp_recurring_charge) <= parseFloat(("@PRE_SURVEY_RECURRING_CHARGE_END"))
            && listPreSurveyProvince.indexOf(tmp_province) > -1
            && $("#divTimeSlot").find('.fa-circle').length > 0
            && parseInt(download_speed) >= parseInt(("@PRE_SURVEY_DOWNLOAD_SPEED"))
            )
        { return true; }
        else
        { return false; }
    }

    function setDefaultRedcap()
    {
        var display_div_Redcap = displayRedcap();

        if (display_div_Redcap)
        {
            $("#div_Redcap").show();

            var vDateNow = new Date(parseInt(@DateTime.Now.Year), parseInt(@DateTime.Now.Month) - 1, parseInt(@DateTime.Now.Day));
            var appointmentDate = $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val(); // formate yyyy/MM/dd
            var vAppointmentDate = new Date(parseInt(appointmentDate.substring('0', '4')), parseInt(appointmentDate.substring('5', '7')) - 1, parseInt(appointmentDate.substring('8', '10')));
            var diffPreSurveyDate = Math.abs(((((vAppointmentDate - vDateNow)/24)/60)/60)/1000);
            $("#diffPreSurveyDate").val(diffPreSurveyDate);

            if ($("#divTimeSlot").find(".color-green").length > 0 && diffPreSurveyDate >= 2)
            {
                $("#chkPreSurvey").removeAttr('checked');
                $('#CustomerRegisterPanelModel_PreSurveyDate').val("");
                $('#CustomerRegisterPanelModel_PreSurveyTimeslot').val("");
                $("#divPreSurveyTimeSlot").empty();
                displayPreSurveyTimeSlot();
                $("#chkPreSurvey").attr('disabled', false);
            }
            else
            {
                $("#chkPreSurvey").removeAttr('checked');
                $("#chkPreSurvey").attr('disabled', true);

                $('#CustomerRegisterPanelModel_PreSurveyDate').val("");
                $('#CustomerRegisterPanelModel_PreSurveyTimeslot').val("");
                $("#divPreSurveyTimeSlot").empty();

                $("#divPreSurveyDate").hide();
                $("#divResponsivePreSurveyTimeSlot").hide();
            }
        }
        else
        {
            $("#chkPreSurvey").removeAttr('checked');
            $("#chkPreSurvey").attr('disabled', true);

            $('#CustomerRegisterPanelModel_PreSurveyDate').val("");
            $('#CustomerRegisterPanelModel_PreSurveyTimeslot').val("");
            $("#divPreSurveyTimeSlot").empty();

            $("#divPreSurveyDate").hide();
            $("#divResponsivePreSurveyTimeSlot").hide();

            $("#div_Redcap").hide();
        }
    }

    function setPreSurveyDatePicker()
    {
        if ($("#LanguagePage").val() == "1") {
            $("#divEnPreSurveyDatePicker").hide();
            $("#divThPreSurveyDatePicker").show();
        }
        else {
            $("#divThPreSurveyDatePicker").hide();
            $("#divEnPreSurveyDatePicker").show();
        }

        var defaultDatePreSurvey = new Date(parseInt(@DateTime.Now.Year), parseInt(@DateTime.Now.Month) - 1, parseInt(@DateTime.Now.Day) + 1);
        var month = defaultDatePreSurvey.getMonth() + 1;
        var day = defaultDatePreSurvey.getDate();

        var minDateEN = defaultDatePreSurvey.getFullYear() + '/' + (month < 10 ? '0' : '') + month + '/' + (day < 10 ? '0' : '') + day;
        var currentDateEN = (day < 10 ? '0' : '') + day + '/' + (month < 10 ? '0' : '') + month + '/' + defaultDatePreSurvey.getFullYear();

        var appointmentDate = $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val(); // formate yyyy/MM/dd
        var defaultDateMax = new Date(parseInt(appointmentDate.substring('0', '4')), parseInt(appointmentDate.substring('5', '7')) - 1 , parseInt(appointmentDate.substring('8', '10')) - 1);
        var monthMax = defaultDateMax.getMonth() + 1;
        var dayMax = defaultDateMax.getDate();

        var maxDateEN = defaultDateMax.getFullYear() + '/' + (monthMax < 10 ? '0' : '') + monthMax + '/' + (dayMax < 10 ? '0' : '') + dayMax;

        minDate = minDateEN;
        maxDate = maxDateEN;
        currentDate = currentDateEN;

        if ($("#LanguagePage").val() == "1") {
            $('#dtpPreSurveyDateTH').val(currentDate);
            $("#dtpPreSurveyDateTH_text").val(convertToThaiDate($('#dtpPreSurveyDateTH').val()));
        }
        else {
            $('#dtpPreSurveyDateEN').val(currentDate);
            $("#dtpPreSurveyDateTH_text").val($('#dtpPreSurveyDateEN').val());
        }

        $('#dtpPreSurveyDateTH').datetimepicker({
            onGenerate: function (ct) {
                jQuery(this).find('.xdsoft_disabled')
                    .toggleClass('xdsoft_date');
            },
            onSelectDate: function (ct, $i) {
                var ctTh = convertToThaiDate($('#dtpPreSurveyDateTH').val());
                $("#dtpPreSurveyDateTH_text").val(ctTh);
                getPreSurveyTimeSlot(ctTh, true, "divPreSurveyTimeSlot");
            },
            minDate: minDateEN,
            maxDate: maxDateEN,
            currentDate: currentDate
        });

        $("#dtpPreSurveyDateTH_text").click(function () {
            $("#dtpPreSurveyDateTH").trigger('open.xdsoft');
        });

        $('#dtpPreSurveyDateEN').datetimepicker({
            onGenerate: function (ct) {
                jQuery(this).find('.xdsoft_disabled')
                    .toggleClass('xdsoft_date');
            },
            onSelectDate: function (ct, $i) {
                var ctEN = $('#dtpPreSurveyDateEN').val();
                $("#dtpPreSurveyDateTH_text").val(ctEN);
                getPreSurveyTimeSlot(ctEN, false, "divPreSurveyTimeSlot");
            },
            minDate: minDateEN,
            maxDate: maxDateEN,
            currentDate: currentDate
        });

        if ($("#LanguagePage").val() == "1") {
            getPreSurveyTimeSlot(convertToThaiDate($('#dtpPreSurveyDateTH').val()), true, "divPreSurveyTimeSlot");
        }
        else {
            getPreSurveyTimeSlot($('#dtpPreSurveyDateEN').val(), false, "divPreSurveyTimeSlot");
        }
    }

    function displayPreSurveyTimeSlot()
    {
        var isThai = $("#LanguagePage").val() == "1" ? true : false;

        var checkBox = document.getElementById("chkPreSurvey");
        if (checkBox.checked == true) {
            $("#divPreSurveyDate").show();
            $("#divResponsivePreSurveyTimeSlot").show();
            setPreSurveyDatePicker();
        } else {
            $("#divPreSurveyDate").hide();
            $("#divResponsivePreSurveyTimeSlot").hide();
        }
    }

    function getPreSurveyTimeSlot(e, isThai, preSurveyTimeSlotId)
    {
        var FBSSTimeSlot_AppointmentDate = $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val();
        var tmpAppointmentDate = FBSSTimeSlot_AppointmentDate.substring('8', '10') + '/' + FBSSTimeSlot_AppointmentDate.substring('5', '7') + '/' + FBSSTimeSlot_AppointmentDate.substring('0', '4');

        var AppointmentDate = $("#LanguagePage").val() == "1" ? convertToThaiDate(tmpAppointmentDate) : tmpAppointmentDate;
        var PreSurveyDate = e;

        $.ajax({
            type: "GET",
            url: "/CustomerRegister/GetPreSurveyTimeSlot",
            data: {
                "Appointment_Date": AppointmentDate, "Pre_Survey_Date": PreSurveyDate, "isThai": isThai, "preSurveyTimeSlotId": preSurveyTimeSlotId, "smallSize": false
            },
            dataType: "json",
            async: false,
            success: function (data) {
                //console.log("tmpHTML PreSurveyTimeSlot--------", $("#" + preSurveyTimeSlotId).html());
                $("#" + preSurveyTimeSlotId).html(data.preSurveyTimeSlotData);

                $('#CustomerRegisterPanelModel_PreSurveyDate').val("");
                $('#CustomerRegisterPanelModel_PreSurveyTimeslot').val("");
            }
        });
    }

    function onDayPreSurveyItemClick(t, preSurveyTimeSlotId) {
        var parentDiv = $(t).parent();

        $("#" + preSurveyTimeSlotId).find(".select-header").hide();
        $("#" + preSurveyTimeSlotId).find(".day-item").removeClass("day-item-select");
        $("#" + preSurveyTimeSlotId).find(".day-footer").hide();
        $("#" + preSurveyTimeSlotId).find(".header-label").show();
        $("#" + preSurveyTimeSlotId).find(".header-label-hidden").hide();

        $('#CustomerRegisterPanelModel_PreSurveyDate').val("");
        $('#CustomerRegisterPanelModel_PreSurveyTimeslot').val("");

        if ($(t).find(".color-green").length > 0) {
            $(t).find(".color-green").removeClass().addClass("fa fa-circle color-gray");

            return;
        }
        else if ($("#" + preSurveyTimeSlotId).find(".color-green").length > 0) {
            $("#" + preSurveyTimeSlotId).find(".color-green").removeClass().addClass("fa fa-circle color-gray");
        }

        if ($(t).find(".color-gray").length > 0) {
            $(parentDiv).find(".select-header").show();
            $(parentDiv).find(".day-item").addClass("day-item-select");
            $(parentDiv).find(".day-footer").show();

            $(parentDiv).find(".header-label").hide();
            $(parentDiv).find(".header-label-hidden").show();

            $(t).find(".color-gray").removeClass("color-gray").addClass("color-green");

            $('#CustomerRegisterPanelModel_PreSurveyDate').val($(t).find("input[name='FBSSPreSurveyDate']").val());
            $('#CustomerRegisterPanelModel_PreSurveyTimeslot').val($(t).find("input[name='FBSSPreSurveyTimeSlot']").val());

        }

    }

    function onChangeTimeFlag(timeFlag, timeSlotId) {
        if ($("#" + timeSlotId).find(".color-green").length > 0) {
            $("#" + timeSlotId).find(".select-header").hide();
            $("#" + timeSlotId).find(".day-item").removeClass("day-item-select");
            $("#" + timeSlotId).find(".day-footer").hide();
            $("#" + timeSlotId).find(".header-label").show();
            $("#" + timeSlotId).find(".header-label-hidden").hide();
            $("#" + timeSlotId).find(".color-green").removeClass().addClass("fa fa-circle color-gray");
            $("#divTextSelectTimeSlot").html("");

            $('#CustomerRegisterPanelModel_FBSSTimeSlot_AppointmentDate').val("");
            $('#CustomerRegisterPanelModel_FBSSTimeSlot_InstallationCapacity').val("");
            $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlot').val("");
            $('#CustomerRegisterPanelModel_FBSSTimeSlot_TimeSlotId').val("");
            $('#L_INSTALL_DATE').val("");

            checkDateTimeSlot = false;
        }
        $(".slot-m").hide();
        $(".slot-a").hide();
        if (timeFlag.value == "M") {
            $(".slot-m").show();
        }
        else {
            $(".slot-a").show();
        }
    }

    function testGetApp() {
        $.ajax({
            type: "POST",
            url: "/CustomerRegister/GetAppointment",
            data: {
                'installation_Date': "10/03/2563",
                "access_Mode": "FTTH",
                "address_Id": "20626686",
                "serviceCode": "FTTH",
                "district": "เมืองนนทบุรี",
                "subDistrict": "ท่าทราย",
                "province": "นนทบุรี",
                "postalCode": "11000",
                "lineSelect": 1,
                "days": "7",
                "productSpecCode": "P14090150",
                "isThai": true,
                "timeSlotId": "divTimeSlot",
                "smallSize": false,
                "SubAccessMode": "PREMIUM",
                "AisAirNumber": "0985622132",
                "SetDefault": "Y",
                "timeSlotRegisterFlag": "Y",
                "timeSlotRegisterHR": "24",
                "timeSlotRegisterFlowActionNo": "P|1",
                "installation_DateTimeNow": "10/03/2563"
            },
            dataType: "json",
            success: function (data) {
                console.log("tmpHTML--------", data);
            },
            complete: function () {
            }
        });
    }

    </text>);

</script>